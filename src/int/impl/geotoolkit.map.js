/* eslint-disable */
import {__decorate as t} from 'tslib';import {Zi,_s,OA,qi,ki,NA,lA,mA,PA,Wi,Zs,bn,xA,Gn,wh,TA,Au,ds,NC,YC,ma,dA,cE,hl,wr,Rd,bo,nA,Es,Mo,RA,$n,lu,Ss,CB,Pi,rh,ru,ou,ys,ap,oE,zQ,ch,nl,Al,xo,Fa,qa,df,fr,Nl,fl,ff,Mi,Is,tI,bC,Ms,Im,tp,IE,fE,da,el,Yu,Ca,ie,nu,su,nn,en,Rl,Hs,Zf,jf,yQ,In,fA,Gi,je,Tc,Oc,rP,sI,po,gm,iu,ZA,LA,Ju,gE,De,kc,UQ,xs,Ks,Ts,Bh,Ch,me,ke,zn,kn,ur,Ic,il,Ci} from '@int/impl/geotoolkit.base.js';import {FB,DB} from '@int/impl/geotoolkit.http.js';import {wq} from '@int/impl/geotoolkit.data.js';import {Mp,vp,om} from '@int/impl/geotoolkit.tiledshape.js';import {mL,Lk,Mx,xk,LL,ML,vL,zL,Ck,CF,jS,rY,nY,xS,rU,AU,iY,Ek,mk,Bk,MF} from '@int/impl/geotoolkit.controls.js';import {_H} from '@int/impl/geotoolkit.widgets.js';var a3=Ci({h2i_:"Aerial",r2i_:"AerialWithLabels",o2i_:"AerialWithLabelsOnDemand",l2i_:"Birdseye",u2i_:"BirdseyeWithLabels",a2i_:"BirdseyeV2",g2i_:"CanvasDark",c2i_:"CanvasLight",I2i_:"CanvasGray",f2i_:"Road",C2i_:"RoadOnDemand",d2i_:"OrdnanceSurvey"},2,"eyJBZXJpYWwiOiJoMmlfIiwiQWVyaWFsV2l0aExhYmVscyI6InIyaV8iLCJBZXJpYWxXaXRoTGFiZWxzT25EZW1hbmQiOiJvMmlfIiwiQmlyZHNleWUiOiJsMmlfIiwiQmlyZHNleWVXaXRoTGFiZWxzIjoidTJpXyIsIkJpcmRzZXllVjIiOiJhMmlfIiwiQ2FudmFzRGFyayI6ImcyaV8iLCJDYW52YXNMaWdodCI6ImMyaV8iLCJDYW52YXNHcmF5IjoiSTJpXyIsIlJvYWQiOiJmMmlfIiwiUm9hZE9uRGVtYW5kIjoiQzJpXyIsIk9yZG5hbmNlU3VydmV5IjoiZDJpXyJ9");var g3=Ci(function(){let i=class t{constructor(t){this.ov_=t["name"];this.WH_=t["limits"];this.sNi_=OA.Ai_().gn_(t["units"]);this.B2i_=t["epsg"]}dn_(){return this.ov_}xQ_(){return this.sNi_}w2i_(){return this.B2i_}Q2i_(){return!0}E2i_(){return this.WH_}};i.prototype.transform=Zi;i.prototype.uI_=Zi;i=t([_s("geotoolkit.map.coordinatesystems.AbstractSystem")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXROYW1lIjoiZG5fIiwiZ2V0VW5pdHMiOiJ4UV8iLCJnZXRFcHNnQ29kZSI6IncyaV8iLCJpc1ZlcnRpY2FsQXhpc1VwIjoiUTJpXyIsImdldERlZmF1bHRNb2RlbExpbWl0cyI6IkUyaV8iLCJpbnZlcnNlVHJhbnNmb3JtIjoidUlfIn19LCJnZXRDbGFzc05hbWUiOiJEXyJ9");var c3=Ci({eG_:"north",nG_:"south",sG_:"west",AG_:"east"},2,"eyJOb3J0aCI6ImVHXyIsIlNvdXRoIjoibkdfIiwiV2VzdCI6InNHXyIsIkVhc3QiOiJBR18ifSAg");const I3={4203:{towgs84:[-134,-48,149]},4230:{spheroid:[6378388,297],towgs84:[-87,-98,-121]},4326:{},4269:{},102100:{name:"WGS84"},3857:{name:"WGS84"},20436:{zone:36,southhemi:!1},20437:{zone:37,southhemi:!1},20438:{zone:38,southhemi:!1},20439:{zone:39,southhemi:!1},20440:{zone:40,southhemi:!1},2058:{zone:38,southhemi:!1},2059:{zone:39,southhemi:!1},2060:{zone:40,southhemi:!1},2061:{zone:41,southhemi:!1},2067:{zone:20,southhemi:!1},2077:{zone:32,southhemi:!1},2078:{zone:33,southhemi:!1},2079:{zone:34,southhemi:!1},2080:{zone:35,southhemi:!1},20822:{zone:22,southhemi:!0},20823:{zone:23,southhemi:!0},20824:{zone:24,southhemi:!0},2084:{zone:19,southhemi:!0},2089:{zone:38,southhemi:!1},2090:{zone:39,southhemi:!1},2095:{zone:28,southhemi:!1},21818:{zone:18,southhemi:!1},2188:{zone:25,southhemi:!1},2189:{zone:26,southhemi:!1},2190:{zone:26,southhemi:!1},2216:{zone:22,southhemi:!1},2217:{zone:23,southhemi:!1},22521:{zone:21,southhemi:!0},22522:{zone:22,southhemi:!0},22523:{zone:23,southhemi:!0},22524:{zone:24,southhemi:!0},22525:{zone:25,southhemi:!0},23028:{zone:28,southhemi:!1},23029:{zone:29,southhemi:!1},23030:{zone:30,southhemi:!1},23031:{zone:31,southhemi:!1},23032:{zone:32,southhemi:!1},23033:{zone:33,southhemi:!1},23034:{zone:34,southhemi:!1},23035:{zone:35,southhemi:!1},23036:{zone:36,southhemi:!1},23037:{zone:37,southhemi:!1},23038:{zone:38,southhemi:!1},2315:{zone:19,southhemi:!0},2316:{zone:20,southhemi:!0},23866:{zone:46,southhemi:!1},23867:{zone:47,southhemi:!1},23868:{zone:48,southhemi:!1},23869:{zone:49,southhemi:!1},23870:{zone:50,southhemi:!1},23871:{zone:51,southhemi:!1},23872:{zone:52,southhemi:!1},23877:{zone:47,southhemi:!0},23878:{zone:48,southhemi:!0},23879:{zone:49,southhemi:!0},23880:{zone:50,southhemi:!0},23881:{zone:51,southhemi:!0},23882:{zone:52,southhemi:!0},23883:{zone:53,southhemi:!0},23884:{zone:54,southhemi:!0},24718:{zone:18,southhemi:!1},24719:{zone:19,southhemi:!1},24720:{zone:20,southhemi:!1},24817:{zone:17,southhemi:!1},24818:{zone:18,southhemi:!1},24819:{zone:19,southhemi:!1},24820:{zone:20,southhemi:!1},24821:{zone:21,southhemi:!1},24877:{zone:17,southhemi:!0},24878:{zone:18,southhemi:!0},24879:{zone:19,southhemi:!0},24880:{zone:20,southhemi:!0},24881:{zone:21,southhemi:!0},24882:{zone:22,southhemi:!0},25932:{zone:32,southhemi:!0},27120:{zone:20,southhemi:!1},27258:{zone:58,southhemi:!0},27259:{zone:59,southhemi:!0},27260:{zone:60,southhemi:!0},27429:{zone:29,southhemi:!1},29220:{zone:20,southhemi:!0},29221:{zone:21,southhemi:!0},2942:{zone:28,southhemi:!1},2943:{zone:28,southhemi:!1},2969:{zone:20,southhemi:!1},2970:{zone:20,southhemi:!1},2971:{zone:22,southhemi:!1},2973:{zone:20,southhemi:!1},29738:{zone:38,southhemi:!0},29739:{zone:39,southhemi:!0},2976:{zone:6,southhemi:!0},2977:{zone:5,southhemi:!0},2978:{zone:7,southhemi:!0},2980:{zone:38,southhemi:!0},2981:{zone:58,southhemi:!0},2988:{zone:1,southhemi:!0},2995:{zone:58,southhemi:!0},2996:{zone:58,southhemi:!0},2997:{zone:58,southhemi:!0},2998:{zone:58,southhemi:!0},2999:{zone:38,southhemi:!0},3036:{zone:36,southhemi:!0},3037:{zone:37,southhemi:!0},3054:{zone:26,southhemi:!1},3055:{zone:27,southhemi:!1},3056:{zone:28,southhemi:!1},3060:{zone:58,southhemi:!0},3061:{zone:28,southhemi:!1},3062:{zone:26,southhemi:!1},3063:{zone:26,southhemi:!1},3064:{zone:32,southhemi:!1},3065:{zone:33,southhemi:!1},31121:{zone:21,southhemi:!1},3141:{zone:60,southhemi:!0},3142:{zone:1,southhemi:!0},3164:{zone:58,southhemi:!0},3172:{zone:59,southhemi:!0},31838:{zone:38,southhemi:!1},31839:{zone:39,southhemi:!1},3199:{zone:32,southhemi:!1},3201:{zone:33,southhemi:!1},3202:{zone:34,southhemi:!1},3203:{zone:35,southhemi:!1},32601:{zone:1,southhemi:!1},32602:{zone:2,southhemi:!1},32603:{zone:3,southhemi:!1},32604:{zone:4,southhemi:!1},32605:{zone:5,southhemi:!1},32606:{zone:6,southhemi:!1},32607:{zone:7,southhemi:!1},32608:{zone:8,southhemi:!1},32609:{zone:9,southhemi:!1},32610:{zone:10,southhemi:!1},32611:{zone:11,southhemi:!1},32612:{zone:12,southhemi:!1},32613:{zone:13,southhemi:!1},32614:{zone:14,southhemi:!1},32615:{zone:15,southhemi:!1},32616:{zone:16,southhemi:!1},32617:{zone:17,southhemi:!1},32618:{zone:18,southhemi:!1},32619:{zone:19,southhemi:!1},32620:{zone:20,southhemi:!1},32621:{zone:21,southhemi:!1},32622:{zone:22,southhemi:!1},32623:{zone:23,southhemi:!1},32624:{zone:24,southhemi:!1},32625:{zone:25,southhemi:!1},32626:{zone:26,southhemi:!1},32627:{zone:27,southhemi:!1},32628:{zone:28,southhemi:!1},32629:{zone:29,southhemi:!1},32630:{zone:30,southhemi:!1},32631:{zone:31,southhemi:!1},32632:{zone:32,southhemi:!1},32633:{zone:33,southhemi:!1},32634:{zone:34,southhemi:!1},32635:{zone:35,southhemi:!1},32636:{zone:36,southhemi:!1},32637:{zone:37,southhemi:!1},32638:{zone:38,southhemi:!1},32639:{zone:39,southhemi:!1},32640:{zone:40,southhemi:!1},32641:{zone:41,southhemi:!1},32642:{zone:42,southhemi:!1},32643:{zone:43,southhemi:!1},32644:{zone:44,southhemi:!1},32645:{zone:45,southhemi:!1},32646:{zone:46,southhemi:!1},32647:{zone:47,southhemi:!1},32648:{zone:48,southhemi:!1},32649:{zone:49,southhemi:!1},32650:{zone:50,southhemi:!1},32651:{zone:51,southhemi:!1},32652:{zone:52,southhemi:!1},32653:{zone:53,southhemi:!1},32654:{zone:54,southhemi:!1},32655:{zone:55,southhemi:!1},32656:{zone:56,southhemi:!1},32657:{zone:57,southhemi:!1},32658:{zone:58,southhemi:!1},32659:{zone:59,southhemi:!1},32660:{zone:60,southhemi:!1},32701:{zone:1,southhemi:!0},32702:{zone:2,southhemi:!0},32703:{zone:3,southhemi:!0},32704:{zone:4,southhemi:!0},32705:{zone:5,southhemi:!0},32706:{zone:6,southhemi:!0},32707:{zone:7,southhemi:!0},32708:{zone:8,southhemi:!0},32709:{zone:9,southhemi:!0},32710:{zone:10,southhemi:!0},32711:{zone:11,southhemi:!0},32712:{zone:12,southhemi:!0},32713:{zone:13,southhemi:!0},32714:{zone:14,southhemi:!0},32715:{zone:15,southhemi:!0},32716:{zone:16,southhemi:!0},32717:{zone:17,southhemi:!0},32718:{zone:18,southhemi:!0},32719:{zone:19,southhemi:!0},32720:{zone:20,southhemi:!0},32721:{zone:21,southhemi:!0},32722:{zone:22,southhemi:!0},32723:{zone:23,southhemi:!0},32724:{zone:24,southhemi:!0},32725:{zone:25,southhemi:!0},32726:{zone:26,southhemi:!0},32727:{zone:27,southhemi:!0},32728:{zone:28,southhemi:!0},32729:{zone:29,southhemi:!0},32730:{zone:30,southhemi:!0},32731:{zone:31,southhemi:!0},32732:{zone:32,southhemi:!0},32733:{zone:33,southhemi:!0},32734:{zone:34,southhemi:!0},32735:{zone:35,southhemi:!0},32736:{zone:36,southhemi:!0},32737:{zone:37,southhemi:!0},32738:{zone:38,southhemi:!0},32739:{zone:39,southhemi:!0},32740:{zone:40,southhemi:!0},32741:{zone:41,southhemi:!0},32742:{zone:42,southhemi:!0},32743:{zone:43,southhemi:!0},32744:{zone:44,southhemi:!0},32745:{zone:45,southhemi:!0},32746:{zone:46,southhemi:!0},32747:{zone:47,southhemi:!0},32748:{zone:48,southhemi:!0},32749:{zone:49,southhemi:!0},32750:{zone:50,southhemi:!0},32751:{zone:51,southhemi:!0},32752:{zone:52,southhemi:!0},32753:{zone:53,southhemi:!0},32754:{zone:54,southhemi:!0},32755:{zone:55,southhemi:!0},32756:{zone:56,southhemi:!0},32757:{zone:57,southhemi:!0},32758:{zone:58,southhemi:!0},32759:{zone:59,southhemi:!0},32760:{zone:60,southhemi:!0},3302:{zone:7,southhemi:!0},3303:{zone:7,southhemi:!0},3304:{zone:6,southhemi:!0},3305:{zone:6,southhemi:!0},3306:{zone:5,southhemi:!0},3307:{zone:39,southhemi:!1},3312:{zone:21,southhemi:!1},3336:{zone:42,southhemi:!0},3353:{zone:32,southhemi:!0},3354:{zone:32,southhemi:!0},3374:{zone:29,southhemi:!1},3405:{zone:48,southhemi:!1},3406:{zone:49,southhemi:!1},3449:{zone:17,southhemi:!1},3450:{zone:18,southhemi:!1},3784:{zone:9,southhemi:!0},3829:{zone:51,southhemi:!1},4037:{zone:35,southhemi:!1},4038:{zone:36,southhemi:!1},4071:{zone:23,southhemi:!0},5337:{zone:25,southhemi:!0},5382:{zone:21,southhemi:!0},5383:{zone:22,southhemi:!0},5536:{zone:21,southhemi:!0},5537:{zone:22,southhemi:!0},5538:{zone:23,southhemi:!0},5539:{zone:24,southhemi:!0},5629:{zone:38,southhemi:!0},5836:{zone:37,southhemi:!1},5837:{zone:40,southhemi:!1},5879:{zone:38,southhemi:!0},7878:{zone:30,southhemi:!0},7883:{zone:30,southhemi:!0},7992:{zone:33,southhemi:!0},2009:{latitudeoforigin:0,centralmeridian:-58.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2010:{latitudeoforigin:0,centralmeridian:-61.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2011:{latitudeoforigin:0,centralmeridian:-64.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2012:{latitudeoforigin:0,centralmeridian:-67.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2013:{latitudeoforigin:0,centralmeridian:-70.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2014:{latitudeoforigin:0,centralmeridian:-73.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2015:{latitudeoforigin:0,centralmeridian:-76.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2016:{latitudeoforigin:0,centralmeridian:-79.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2017:{latitudeoforigin:0,centralmeridian:-73.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2018:{latitudeoforigin:0,centralmeridian:-76.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2019:{latitudeoforigin:0,centralmeridian:-79.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2020:{latitudeoforigin:0,centralmeridian:-82.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2021:{latitudeoforigin:0,centralmeridian:-81,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2022:{latitudeoforigin:0,centralmeridian:-84,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2023:{latitudeoforigin:0,centralmeridian:-87,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2024:{latitudeoforigin:0,centralmeridian:-90,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2025:{latitudeoforigin:0,centralmeridian:-93,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2026:{latitudeoforigin:0,centralmeridian:-96,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},2027:{latitudeoforigin:0,centralmeridian:-93,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},2028:{latitudeoforigin:0,centralmeridian:-87,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},2029:{latitudeoforigin:0,centralmeridian:-81,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},2030:{latitudeoforigin:0,centralmeridian:-75,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},2031:{latitudeoforigin:0,centralmeridian:-81,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},2032:{latitudeoforigin:0,centralmeridian:-75,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},2033:{latitudeoforigin:0,centralmeridian:-69,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},2034:{latitudeoforigin:0,centralmeridian:-63,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},2035:{latitudeoforigin:0,centralmeridian:-57,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},2138:{latitudeoforigin:44,centralmeridian:-68.5,falseeasting:0,falsenorthing:0,scalefactor:1,standardparallel1:60,standardparallel2:46,units:"metre"},2204:{latitudeoforigin:34.666666666667,centralmeridian:-86,falseeasting:2e6,falsenorthing:1e5,scalefactor:1,standardparallel1:35.25,standardparallel2:36.416666666667,units:"foot"},26701:{latitudeoforigin:0,centralmeridian:-177,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26702:{latitudeoforigin:0,centralmeridian:-171,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26703:{latitudeoforigin:0,centralmeridian:-165,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26704:{latitudeoforigin:0,centralmeridian:-159,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26705:{latitudeoforigin:0,centralmeridian:-153,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26706:{latitudeoforigin:0,centralmeridian:-147,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26707:{latitudeoforigin:0,centralmeridian:-141,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26708:{latitudeoforigin:0,centralmeridian:-135,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26709:{latitudeoforigin:0,centralmeridian:-129,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26710:{latitudeoforigin:0,centralmeridian:-123,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26711:{latitudeoforigin:0,centralmeridian:-117,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26712:{latitudeoforigin:0,centralmeridian:-111,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26713:{latitudeoforigin:0,centralmeridian:-105,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26714:{latitudeoforigin:0,centralmeridian:-99,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26715:{latitudeoforigin:0,centralmeridian:-93,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26716:{latitudeoforigin:0,centralmeridian:-87,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26717:{latitudeoforigin:0,centralmeridian:-81,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26718:{latitudeoforigin:0,centralmeridian:-75,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26719:{latitudeoforigin:0,centralmeridian:-69,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26720:{latitudeoforigin:0,centralmeridian:-63,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26721:{latitudeoforigin:0,centralmeridian:-57,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26722:{latitudeoforigin:0,centralmeridian:-51,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},26729:{latitudeoforigin:30.5,centralmeridian:-85.833333333333,falseeasting:5e5,falsenorthing:0,scalefactor:.99996,units:"foot"},26730:{latitudeoforigin:30,centralmeridian:-87.5,falseeasting:5e5,falsenorthing:0,scalefactor:.999933333,units:"foot"},26732:{latitudeoforigin:54,centralmeridian:-142,falseeasting:5e5,falsenorthing:0,scalefactor:.9999,units:"foot"},26733:{latitudeoforigin:54,centralmeridian:-146,falseeasting:5e5,falsenorthing:0,scalefactor:.9999,units:"foot"},26734:{latitudeoforigin:54,centralmeridian:-150,falseeasting:5e5,falsenorthing:0,scalefactor:.9999,units:"foot"},26735:{latitudeoforigin:54,centralmeridian:-154,falseeasting:5e5,falsenorthing:0,scalefactor:.9999,units:"foot"},26736:{latitudeoforigin:54,centralmeridian:-158,falseeasting:5e5,falsenorthing:0,scalefactor:.9999,units:"foot"},26737:{latitudeoforigin:54,centralmeridian:-162,falseeasting:7e5,falsenorthing:0,scalefactor:.9999,units:"foot"},26738:{latitudeoforigin:54,centralmeridian:-166,falseeasting:5e5,falsenorthing:0,scalefactor:.9999,units:"foot"},26739:{latitudeoforigin:54,centralmeridian:-170,falseeasting:6e5,falsenorthing:0,scalefactor:.9999,units:"foot"},26740:{latitudeoforigin:51,centralmeridian:-176,falseeasting:3e6,falsenorthing:0,scalefactor:1,standardparallel1:53.833333333333,standardparallel2:51.833333333333,units:"foot"},26741:{latitudeoforigin:39.333333333333,centralmeridian:-122,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:41.666666666667,standardparallel2:40,units:"foot"},26742:{latitudeoforigin:37.666666666667,centralmeridian:-122,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:39.833333333333,standardparallel2:38.333333333333,units:"foot"},26743:{latitudeoforigin:36.5,centralmeridian:-120.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:38.433333333333,standardparallel2:37.066666666667,units:"foot"},26744:{latitudeoforigin:35.333333333333,centralmeridian:-119,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:37.25,standardparallel2:36,units:"foot"},26745:{latitudeoforigin:33.5,centralmeridian:-118,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:35.466666666667,standardparallel2:34.033333333333,units:"foot"},26746:{latitudeoforigin:32.166666666667,centralmeridian:-116.25,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:33.883333333333,standardparallel2:32.783333333333,units:"foot"},26748:{latitudeoforigin:31,centralmeridian:-110.166666666667,falseeasting:5e5,falsenorthing:0,scalefactor:.9999,units:"foot"},26749:{latitudeoforigin:31,centralmeridian:-111.916666666667,falseeasting:5e5,falsenorthing:0,scalefactor:.9999,units:"foot"},26750:{latitudeoforigin:31,centralmeridian:-113.75,falseeasting:5e5,falsenorthing:0,scalefactor:.999933333,units:"foot"},26751:{latitudeoforigin:34.333333333333,centralmeridian:-92,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:36.233333333333,standardparallel2:34.933333333333,units:"foot"},26752:{latitudeoforigin:32.666666666667,centralmeridian:-92,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:34.766666666667,standardparallel2:33.3,units:"foot"},26753:{latitudeoforigin:39.333333333333,centralmeridian:-105.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:39.716666666667,standardparallel2:40.783333333333,units:"foot"},26754:{latitudeoforigin:37.833333333333,centralmeridian:-105.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:39.75,standardparallel2:38.45,units:"foot"},26755:{latitudeoforigin:36.666666666667,centralmeridian:-105.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:38.433333333333,standardparallel2:37.233333333333,units:"foot"},26756:{latitudeoforigin:40.833333333333,centralmeridian:-72.75,falseeasting:6e5,falsenorthing:0,scalefactor:1,standardparallel1:41.866666666667,standardparallel2:41.2,units:"foot"},26757:{latitudeoforigin:38,centralmeridian:-75.416666666667,falseeasting:5e5,falsenorthing:0,scalefactor:.999995,units:"foot"},26758:{latitudeoforigin:24.333333333333,centralmeridian:-81,falseeasting:5e5,falsenorthing:0,scalefactor:.999941177,units:"foot"},26759:{latitudeoforigin:24.333333333333,centralmeridian:-82,falseeasting:5e5,falsenorthing:0,scalefactor:.999941177,units:"foot"},26760:{latitudeoforigin:29,centralmeridian:-84.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:30.75,standardparallel2:29.583333333333,units:"foot"},26766:{latitudeoforigin:30,centralmeridian:-82.166666666667,falseeasting:5e5,falsenorthing:0,scalefactor:.9999,units:"foot"},26767:{latitudeoforigin:30,centralmeridian:-84.166666666667,falseeasting:5e5,falsenorthing:0,scalefactor:.9999,units:"foot"},26768:{latitudeoforigin:41.666666666667,centralmeridian:-112.166666666667,falseeasting:5e5,falsenorthing:0,scalefactor:.999947368,units:"foot"},26769:{latitudeoforigin:41.666666666667,centralmeridian:-114,falseeasting:5e5,falsenorthing:0,scalefactor:.999947368,units:"foot"},26770:{latitudeoforigin:41.666666666667,centralmeridian:-115.75,falseeasting:5e5,falsenorthing:0,scalefactor:.999933333,units:"foot"},26771:{latitudeoforigin:36.666666666667,centralmeridian:-88.333333333333,falseeasting:5e5,falsenorthing:0,scalefactor:.999975,units:"foot"},26772:{latitudeoforigin:36.666666666667,centralmeridian:-90.166666666667,falseeasting:5e5,falsenorthing:0,scalefactor:.999941177,units:"foot"},26773:{latitudeoforigin:37.5,centralmeridian:-85.666666666667,falseeasting:5e5,falsenorthing:0,scalefactor:.999966667,units:"foot"},26774:{latitudeoforigin:37.5,centralmeridian:-87.083333333333,falseeasting:5e5,falsenorthing:0,scalefactor:.999966667,units:"foot"},26775:{latitudeoforigin:41.5,centralmeridian:-93.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:43.266666666667,standardparallel2:42.066666666667,units:"foot"},26776:{latitudeoforigin:40,centralmeridian:-93.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:41.783333333333,standardparallel2:40.616666666667,units:"foot"},26777:{latitudeoforigin:38.333333333333,centralmeridian:-98,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:39.783333333333,standardparallel2:38.716666666667,units:"foot"},26778:{latitudeoforigin:36.666666666667,centralmeridian:-98.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:38.566666666667,standardparallel2:37.266666666667,units:"foot"},26779:{latitudeoforigin:37.5,centralmeridian:-84.25,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:37.966666666667,standardparallel2:38.966666666667,units:"foot"},26780:{latitudeoforigin:36.333333333333,centralmeridian:-85.75,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:36.733333333333,standardparallel2:37.933333333333,units:"foot"},26781:{latitudeoforigin:30.666666666667,centralmeridian:-92.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:31.166666666667,standardparallel2:32.666666666667,units:"foot"},26782:{latitudeoforigin:28.666666666667,centralmeridian:-91.333333333333,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:29.3,standardparallel2:30.7,units:"foot"},26783:{latitudeoforigin:43.833333333333,centralmeridian:-68.5,falseeasting:5e5,falsenorthing:0,scalefactor:.9999,units:"foot"},26784:{latitudeoforigin:42.833333333333,centralmeridian:-70.166666666667,falseeasting:5e5,falsenorthing:0,scalefactor:.999966667,units:"foot"},26785:{latitudeoforigin:37.833333333333,centralmeridian:-77,falseeasting:8e5,falsenorthing:0,scalefactor:1,standardparallel1:38.3,standardparallel2:39.45,units:"foot"},26786:{latitudeoforigin:41,centralmeridian:-71.5,falseeasting:6e5,falsenorthing:0,scalefactor:1,standardparallel1:41.716666666667,standardparallel2:42.683333333333,units:"foot"},26787:{latitudeoforigin:41,centralmeridian:-70.5,falseeasting:2e5,falsenorthing:0,scalefactor:1,standardparallel1:41.283333333333,standardparallel2:41.483333333333,units:"foot"},26791:{latitudeoforigin:46.5,centralmeridian:-93.1,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:47.033333333333,standardparallel2:48.633333333333,units:"foot"},26792:{latitudeoforigin:45,centralmeridian:-94.25,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:45.616666666667,standardparallel2:47.05,units:"foot"},26793:{latitudeoforigin:43,centralmeridian:-94,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:43.783333333333,standardparallel2:45.216666666667,units:"foot"},26794:{latitudeoforigin:29.666666666667,centralmeridian:-88.833333333333,falseeasting:5e5,falsenorthing:0,scalefactor:.99996,units:"foot"},26795:{latitudeoforigin:30.5,centralmeridian:-90.333333333333,falseeasting:5e5,falsenorthing:0,scalefactor:.999941177,units:"foot"},26796:{latitudeoforigin:35.833333333333,centralmeridian:-90.5,falseeasting:5e5,falsenorthing:0,scalefactor:.999933333,units:"foot"},26797:{latitudeoforigin:35.833333333333,centralmeridian:-92.5,falseeasting:5e5,falsenorthing:0,scalefactor:.999933333,units:"foot"},26798:{latitudeoforigin:36.166666666667,centralmeridian:-94.5,falseeasting:5e5,falsenorthing:0,scalefactor:.999941177,units:"foot"},26799:{latitudeoforigin:34.133333333333,centralmeridian:-118.333333333333,falseeasting:4186692.58,falsenorthing:4160926.74,scalefactor:1,standardparallel1:34.416666666667,standardparallel2:33.866666666667,units:"foot"},3069:{latitudeoforigin:0,centralmeridian:-90,falseeasting:5e5,falsenorthing:-45e5,scalefactor:.9996,units:"metre"},3080:{latitudeoforigin:31.166666666667,centralmeridian:-100,falseeasting:3e6,falsenorthing:3e6,scalefactor:1,standardparallel1:27.416666666667,standardparallel2:34.916666666667,units:"foot"},32001:{latitudeoforigin:47,centralmeridian:-109.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:48.716666666667,standardparallel2:47.85,units:"foot"},32002:{latitudeoforigin:45.833333333333,centralmeridian:-109.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:47.883333333333,standardparallel2:46.45,units:"foot"},32003:{latitudeoforigin:44,centralmeridian:-109.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:46.4,standardparallel2:44.866666666667,units:"foot"},32005:{latitudeoforigin:41.333333333333,centralmeridian:-100,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:41.85,standardparallel2:42.816666666667,units:"foot"},32006:{latitudeoforigin:39.666666666667,centralmeridian:-99.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:40.283333333333,standardparallel2:41.716666666667,units:"foot"},32007:{latitudeoforigin:34.75,centralmeridian:-115.583333333333,falseeasting:5e5,falsenorthing:0,scalefactor:.9999,units:"foot"},32008:{latitudeoforigin:34.75,centralmeridian:-116.666666666667,falseeasting:5e5,falsenorthing:0,scalefactor:.9999,units:"foot"},32009:{latitudeoforigin:34.75,centralmeridian:-118.583333333333,falseeasting:5e5,falsenorthing:0,scalefactor:.9999,units:"foot"},32010:{latitudeoforigin:42.5,centralmeridian:-71.666666666667,falseeasting:5e5,falsenorthing:0,scalefactor:.999966667,units:"foot"},32011:{latitudeoforigin:38.833333333333,centralmeridian:-74.666666666667,falseeasting:2e6,falsenorthing:0,scalefactor:.999975,units:"foot"},32012:{latitudeoforigin:31,centralmeridian:-104.333333333333,falseeasting:5e5,falsenorthing:0,scalefactor:.999909091,units:"foot"},32013:{latitudeoforigin:31,centralmeridian:-106.25,falseeasting:5e5,falsenorthing:0,scalefactor:.9999,units:"foot"},32014:{latitudeoforigin:31,centralmeridian:-107.833333333333,falseeasting:5e5,falsenorthing:0,scalefactor:.999916667,units:"foot"},32015:{latitudeoforigin:40,centralmeridian:-74.333333333333,falseeasting:5e5,falsenorthing:0,scalefactor:.999966667,units:"foot"},32016:{latitudeoforigin:40,centralmeridian:-76.583333333333,falseeasting:5e5,falsenorthing:0,scalefactor:.9999375,units:"foot"},32017:{latitudeoforigin:40,centralmeridian:-78.583333333333,falseeasting:5e5,falsenorthing:0,scalefactor:.9999375,units:"foot"},32019:{latitudeoforigin:33.75,centralmeridian:-79,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:34.333333333333,standardparallel2:36.166666666667,units:"foot"},32020:{latitudeoforigin:47,centralmeridian:-100.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:47.433333333333,standardparallel2:48.733333333333,units:"foot"},32021:{latitudeoforigin:45.666666666667,centralmeridian:-100.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:46.183333333333,standardparallel2:47.483333333333,units:"foot"},32022:{latitudeoforigin:39.666666666667,centralmeridian:-82.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:40.433333333333,standardparallel2:41.7,units:"foot"},32023:{latitudeoforigin:38,centralmeridian:-82.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:38.733333333333,standardparallel2:40.033333333333,units:"foot"},32024:{latitudeoforigin:35,centralmeridian:-98,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:35.566666666667,standardparallel2:36.766666666667,units:"foot"},32025:{latitudeoforigin:33.333333333333,centralmeridian:-98,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:33.933333333333,standardparallel2:35.233333333333,units:"foot"},32026:{latitudeoforigin:43.666666666667,centralmeridian:-120.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:44.333333333333,standardparallel2:46,units:"foot"},32027:{latitudeoforigin:41.666666666667,centralmeridian:-120.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:42.333333333333,standardparallel2:44,units:"foot"},32028:{latitudeoforigin:40.166666666667,centralmeridian:-77.75,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:40.883333333333,standardparallel2:41.95,units:"foot"},32030:{latitudeoforigin:41.083333333333,centralmeridian:-71.5,falseeasting:5e5,falsenorthing:0,scalefactor:.9999938,units:"foot"},32031:{latitudeoforigin:33,centralmeridian:-81,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:33.766666666667,standardparallel2:34.966666666667,units:"foot"},32033:{latitudeoforigin:31.833333333333,centralmeridian:-81,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:32.333333333333,standardparallel2:33.666666666667,units:"foot"},32034:{latitudeoforigin:43.833333333333,centralmeridian:-100,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:44.416666666667,standardparallel2:45.683333333333,units:"foot"},32035:{latitudeoforigin:42.333333333333,centralmeridian:-100.333333333333,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:42.833333333333,standardparallel2:44.4,units:"foot"},32037:{latitudeoforigin:34,centralmeridian:-101.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:34.65,standardparallel2:36.183333333333,units:"foot"},32038:{latitudeoforigin:31.666666666667,centralmeridian:-97.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:32.133333333333,standardparallel2:33.966666666667,units:"foot"},32039:{latitudeoforigin:29.666666666667,centralmeridian:-100.333333333333,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:30.116666666667,standardparallel2:31.883333333333,units:"foot"},32040:{latitudeoforigin:27.833333333333,centralmeridian:-99,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:28.383333333333,standardparallel2:30.283333333333,units:"foot"},32041:{latitudeoforigin:25.666666666667,centralmeridian:-98.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:26.166666666667,standardparallel2:27.833333333333,units:"foot"},32042:{latitudeoforigin:40.333333333333,centralmeridian:-111.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:40.716666666667,standardparallel2:41.783333333333,units:"foot"},32043:{latitudeoforigin:38.333333333333,centralmeridian:-111.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:39.016666666667,standardparallel2:40.65,units:"foot"},32044:{latitudeoforigin:36.666666666667,centralmeridian:-111.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:37.216666666667,standardparallel2:38.35,units:"foot"},32045:{latitudeoforigin:42.5,centralmeridian:-72.5,falseeasting:5e5,falsenorthing:0,scalefactor:.999964286,units:"foot"},32046:{latitudeoforigin:37.666666666667,centralmeridian:-78.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:38.033333333333,standardparallel2:39.2,units:"foot"},32047:{latitudeoforigin:36.333333333333,centralmeridian:-78.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:36.766666666667,standardparallel2:37.966666666667,units:"foot"},32048:{latitudeoforigin:47,centralmeridian:-120.833333333333,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:47.5,standardparallel2:48.733333333333,units:"foot"},32049:{latitudeoforigin:45.333333333333,centralmeridian:-120.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:45.833333333333,standardparallel2:47.333333333333,units:"foot"},32050:{latitudeoforigin:38.5,centralmeridian:-79.5,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:39,standardparallel2:40.25,units:"foot"},32051:{latitudeoforigin:37,centralmeridian:-81,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:37.483333333333,standardparallel2:38.883333333333,units:"foot"},32052:{latitudeoforigin:45.166666666667,centralmeridian:-90,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:45.566666666667,standardparallel2:46.766666666667,units:"foot"},32053:{latitudeoforigin:43.833333333333,centralmeridian:-90,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:44.25,standardparallel2:45.5,units:"foot"},32054:{latitudeoforigin:42,centralmeridian:-90,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:42.733333333333,standardparallel2:44.066666666667,units:"foot"},32055:{latitudeoforigin:40.666666666667,centralmeridian:-105.166666666667,falseeasting:5e5,falsenorthing:0,scalefactor:.999941177,units:"foot"},32056:{latitudeoforigin:40.666666666667,centralmeridian:-107.333333333333,falseeasting:5e5,falsenorthing:0,scalefactor:.999941177,units:"foot"},32057:{latitudeoforigin:40.666666666667,centralmeridian:-108.75,falseeasting:5e5,falsenorthing:0,scalefactor:.999941177,units:"foot"},32058:{latitudeoforigin:40.666666666667,centralmeridian:-110.083333333333,falseeasting:5e5,falsenorthing:0,scalefactor:.999941177,units:"foot"},32064:{latitudeoforigin:0,centralmeridian:-99,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},32065:{latitudeoforigin:0,centralmeridian:-93,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},32066:{latitudeoforigin:0,centralmeridian:-87,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},32067:{latitudeoforigin:0,centralmeridian:-81,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},32081:{latitudeoforigin:0,centralmeridian:-53,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},32082:{latitudeoforigin:0,centralmeridian:-56,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},32083:{latitudeoforigin:0,centralmeridian:-58.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},32084:{latitudeoforigin:0,centralmeridian:-61.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},32085:{latitudeoforigin:0,centralmeridian:-64.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},32086:{latitudeoforigin:0,centralmeridian:-67.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"},32098:{latitudeoforigin:44,centralmeridian:-68.5,falseeasting:0,falsenorthing:0,scalefactor:1,standardparallel1:60,standardparallel2:46,units:"metre"},32099:{latitudeoforigin:25.666666666667,centralmeridian:-91.333333333333,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:27.833333333333,standardparallel2:26.166666666667,units:"foot"},3370:{latitudeoforigin:0,centralmeridian:171,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},3371:{latitudeoforigin:0,centralmeridian:177,falseeasting:5e5,falsenorthing:0,scalefactor:.9996,units:"metre"},3771:{latitudeoforigin:0,centralmeridian:-111,falseeasting:0,falsenorthing:0,scalefactor:.9999,units:"metre"},3772:{latitudeoforigin:0,centralmeridian:-114,falseeasting:0,falsenorthing:0,scalefactor:.9999,units:"metre"},3773:{latitudeoforigin:0,centralmeridian:-117,falseeasting:0,falsenorthing:0,scalefactor:.9999,units:"metre"},3795:{latitudeoforigin:22.35,centralmeridian:-81,falseeasting:5e5,falsenorthing:280296.016,scalefactor:1,standardparallel1:23,standardparallel2:21.7,units:"metre"},3796:{latitudeoforigin:20.716666666667,centralmeridian:-76.833333333333,falseeasting:5e5,falsenorthing:229126.939,scalefactor:1,standardparallel1:21.3,standardparallel2:20.133333333333,units:"metre"},3797:{latitudeoforigin:44,centralmeridian:-70,falseeasting:8e5,falsenorthing:0,scalefactor:1,standardparallel1:50,standardparallel2:46,units:"metre"},3800:{latitudeoforigin:0,centralmeridian:-120,falseeasting:0,falsenorthing:0,scalefactor:.9999,units:"metre"},4399:{latitudeoforigin:0,centralmeridian:171,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4400:{latitudeoforigin:0,centralmeridian:177,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4401:{latitudeoforigin:0,centralmeridian:-177,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4402:{latitudeoforigin:0,centralmeridian:-171,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4403:{latitudeoforigin:0,centralmeridian:-165,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4404:{latitudeoforigin:0,centralmeridian:-159,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4405:{latitudeoforigin:0,centralmeridian:-153,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4406:{latitudeoforigin:0,centralmeridian:-147,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4407:{latitudeoforigin:0,centralmeridian:-141,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4408:{latitudeoforigin:0,centralmeridian:-135,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4409:{latitudeoforigin:0,centralmeridian:-129,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4410:{latitudeoforigin:0,centralmeridian:-123,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4411:{latitudeoforigin:0,centralmeridian:-117,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4412:{latitudeoforigin:0,centralmeridian:-111,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4413:{latitudeoforigin:0,centralmeridian:-105,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4418:{latitudeoforigin:0,centralmeridian:-75,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4419:{latitudeoforigin:0,centralmeridian:-69,falseeasting:1640416.67,falsenorthing:0,scalefactor:.9996,units:"foot"},4455:{latitudeoforigin:39.333333333333,centralmeridian:-77.75,falseeasting:2e6,falsenorthing:0,scalefactor:1,standardparallel1:40.966666666667,standardparallel2:39.933333333333,units:"foot"},4456:{latitudeoforigin:40.5,centralmeridian:-74,falseeasting:2e6,falsenorthing:1e5,scalefactor:1,standardparallel1:41.033333333333,standardparallel2:40.666666666667,units:"foot"},5623:{latitudeoforigin:41.5,centralmeridian:-83.666666666667,falseeasting:5e5,falsenorthing:0,scalefactor:.999942857,units:"foot"},5624:{latitudeoforigin:41.5,centralmeridian:-85.75,falseeasting:5e5,falsenorthing:0,scalefactor:.999909091,units:"foot"},5625:{latitudeoforigin:41.5,centralmeridian:-88.75,falseeasting:5e5,falsenorthing:0,scalefactor:.999909091,units:"foot"},6201:{latitudeoforigin:43.316666666667,centralmeridian:-84.333333333333,falseeasting:2e6,falsenorthing:0,scalefactor:1.0000382,standardparallel1:44.183333333333,standardparallel2:45.7,units:"foot"},6202:{latitudeoforigin:41.5,centralmeridian:-84.333333333333,falseeasting:2e6,falsenorthing:0,scalefactor:1.0000382,standardparallel1:42.1,standardparallel2:43.666666666667,units:"foot"},6966:{latitudeoforigin:44.783333333333,centralmeridian:-87,falseeasting:2e6,falsenorthing:0,scalefactor:1.0000382,standardparallel1:45.483333333333,standardparallel2:47.083333333333,units:"foot"},7991:{latitudeoforigin:0,centralmeridian:-79.5,falseeasting:304800,falsenorthing:0,scalefactor:.9999,units:"metre"}};var f3=function(){let i=class t{constructor(t,i){this._a=t;this._f=i}p2i_(){return this._a}m2i_(){return-(this._f*this._a-this._a)}y2i_(){return Math.sqrt(2*this._f-this._f*this._f)}D2i_(){return this._f}};i=t([_s("geotoolkit.map.coordinatesystems.Spheroid")],i);return i}();const C3=10;var d3=Ci(function(){let i=class t extends g3{constructor(t){t["standartparallel1"]!=null&&t["standartparallel2"]!=null&&ki("standartparallel1 and standartparallel2 are deprecated since 4.0. Use correct spelling.");const i=qi(t,{spheroid:[6378137,298.2572236],name:"LambertConicConformal",units:"metre",standartparallel1:0,standartparallel2:0,latitudeoforigin:0,centralmeridian:0,falseeasting:0,falsenorthing:0,scalefactor:1},!0);super(i);this.M2i_=new f3(i["spheroid"][0],1/i["spheroid"][1]);this.v2i_=i["standardparallel1"]!=null?NA.degToRad(i["standardparallel1"]):NA.degToRad(i["standartparallel1"]);this.b2i_=i["standardparallel2"]!=null?NA.degToRad(i["standardparallel2"]):NA.degToRad(i["standartparallel2"]);this.N2i_=NA.degToRad(i["latitudeoforigin"]);this.S2i_=NA.degToRad(i["centralmeridian"]);this.G2i_=i["falseeasting"];this.R2i_=i["falsenorthing"];this.xm_=i["scalefactor"];this._a=OA.Ai_().gn_("metre").wn_(this.M2i_.p2i_(),this.xQ_())*this.xm_;this._e=this.M2i_.y2i_();this._m1=Math.cos(this.v2i_)/Math.sqrt(1-this._e*this._e*(Math.sin(this.v2i_)*Math.sin(this.v2i_)));this._m2=Math.cos(this.b2i_)/Math.sqrt(1-this._e*this._e*(Math.sin(this.b2i_)*Math.sin(this.b2i_)));this._t1=Math.tan(Math.PI/4-this.v2i_/2)/Math.pow((1-this._e*Math.sin(this.v2i_))/(1+this._e*Math.sin(this.v2i_)),this._e/2);this._t2=Math.tan(Math.PI/4-this.b2i_/2)/Math.pow((1-this._e*Math.sin(this.b2i_))/(1+this._e*Math.sin(this.b2i_)),this._e/2);this._tF=Math.tan(Math.PI/4-this.N2i_/2)/Math.pow((1-this._e*Math.sin(this.N2i_))/(1+this._e*Math.sin(this.N2i_)),this._e/2);this._n=(Math.log(this._m1)-Math.log(this._m2))/(Math.log(this._t1)-Math.log(this._t2));this.k2i_=this._n<0?-1:1;this._rF=this._a*(this._m1/(this._n*Math.pow(this._t1,this._n)))*Math.pow(this._tF,this._n);this.F2i_=this._a*(this._m1/(this._n*Math.pow(this._t1,this._n)));this.x2i_=Math.pow(1/(this._a*(this._m1/(this._n*Math.pow(this._t1,this._n)))),1/this._n)}transform(t,i,s,e){s==null&&(s=new lA);const A=NA.degToRad(s.x),n=NA.degToRad(s.y),h=Math.tan(Math.PI/4-n/2)/Math.pow((1-this._e*Math.sin(n))/(1+this._e*Math.sin(n)),this._e/2),r=this.F2i_*Math.pow(h,this._n),o=this._n*(A-this.S2i_),l=this.G2i_+r*Math.sin(o),u=this.R2i_+this._rF-r*Math.cos(o);s.vs_(l,u);return s}uI_(t,i,s){s==null&&(s=new lA);let e,A,n;const h=t-this.G2i_,r=i-this.R2i_,o=this.k2i_*Math.sqrt(h*h+(this._rF-r)*(this._rF-r)),l=this.x2i_*Math.pow(o,1/this._n),u=undefined,a=Math.atan(h/(this._rF-r))/this._n+this.S2i_;n=Math.PI/2-2*Math.atan(l);A=0;do{e=n;n=Math.PI/2-2*Math.atan(l*Math.pow((1-this._e*Math.sin(n))/(1+this._e*Math.sin(n)),this._e/2));A++}while(Math.abs(n-e)>NA.Je_&&A<C3);s.vs_(NA.radToDeg(a),NA.radToDeg(n));return s}};i=t([_s("geotoolkit.map.coordinatesystems.LambertConicConformal")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnZlcnNlVHJhbnNmb3JtIjoidUlfIn19fSAg");var B3=Ci({L2i_:"WGS84",U2i_:"LatLon",UTM:"UTM",W_:"None"},2,"eyJXR1M4NCI6IkwyaV8iLCJMYXRMb24iOiJVMmlfIiwiTm9uZSI6IldfIn0g");const w3=new mA(-180,-90,180,90);var Q3=Ci(function(){let i=class t extends g3{constructor(t){super({epsg:t||4326,name:B3.U2i_,limits:w3,units:OA.Ai_().gn_("degrees")})}transform(t,i,s,e){s==null&&(s=new lA);if(e!==!1){t=NA.clamp(t,-180,180);i=NA.clamp(i,-90,90)}return s.vs_(t,i)}uI_(t,i,s){s==null&&(s=new lA);t=NA.clamp(t,-180,180);i=NA.clamp(i,-90,90);return s.vs_(t,i)}static Y2i_(t){if(t.length===0)return 0;if(t.indexOf("°")===-1)return+t;const i=t[t.length-1].toUpperCase(),s=t.match(/^([\d]+\.?[\d]*)° ?([\d]+\.?[\d]*)′ ?([\d]+\.?[\d]*)″/)||t.match(/^([\d]+\.?[\d]*)° ?([\d]+\.?[\d]*)′/)||t.match(/^([\d]+\.?[\d]*)°/),e=s!=null?s.length:0,A=undefined,n=undefined,h=undefined,r=(e>1?+s[1]:0)+(e>2?+s[2]:0)/60+(e>3?+s[3]:0)/3600;return i==="S"||i==="W"?-r:r}};i=t([_s("geotoolkit.map.coordinatesystems.LatLon")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnZlcnNlVHJhbnNmb3JtIjoidUlfIn19fSAg");const E3=new mA(-20037507.067161843,-20037507.067161843,20037507.067161843,20037507.067161843),p3=E3.Ie_()/360,m3=E3.Ts_()/(2*Math.PI),y3=Math.PI/360;var D3=Ci(function(){let i=class t extends g3{constructor(t){super({epsg:t||3857,name:B3.L2i_,limits:E3,units:"meters"})}transform(t,i,s,e){s==null&&(s=new lA);s.vs_(t,i);if(e!==!1){i<-85?s.y=-85:i>85&&(s.y=85);t<-180?s.x=-180:t>180&&(s.x=180)}s.x=s.x*p3;s.y=Math.log(Math.tan((90+s.y)*y3));s.y=s.y*m3;return s}uI_(t,i,s){s==null&&(s=new lA(t,i));s.x=t/p3;s.y=i/m3;s.y=(Math.atan(Math.exp(s.y))-Math.PI/4)/y3;s.x=NA.clamp(s.x,-180,180);s.y=NA.clamp(s.y,-85,85);return s}};i=t([_s("geotoolkit.map.coordinatesystems.WebMercator")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnZlcnNlVHJhbnNmb3JtIjoidUlfIn19fSAg");const M3=new mA(-2e7,-2e7,2e7,2e7),v3=6378137,b3=6356752.314,N3=.9996;function S3(t){const i=(v3-b3)/(v3+b3),s=(v3+b3)/2*(1+Math.pow(i,2)/4+Math.pow(i,4)/64),e=-3*i/2+9*Math.pow(i,3)/16+-3*Math.pow(i,5)/32,A=15*Math.pow(i,2)/16+-15*Math.pow(i,4)/32,n=-35*Math.pow(i,3)/48+105*Math.pow(i,5)/256,h=315*Math.pow(i,4)/512,r=undefined;return s*(t+e*Math.sin(2*t)+A*Math.sin(4*t)+n*Math.sin(6*t)+h*Math.sin(8*t))}function G3(t,i,s,e){const A=undefined,n=(Math.pow(v3,2)-Math.pow(b3,2))/Math.pow(b3,2)*Math.pow(Math.cos(t),2),h=Math.pow(v3,2)/(b3*Math.sqrt(1+n)),r=Math.tan(t),o=r*r,l=i-s,u=1-o+n,a=5-o+9*n+4*(n*n),g=5-18*o+o*o+14*n-58*o*n,c=61-58*o+o*o+270*n-330*o*n,I=61-479*o+179*(o*o)-o*o*o,f=1385-3111*o+543*(o*o)-o*o*o,C=h*Math.cos(t)*l+h/6*Math.pow(Math.cos(t),3)*u*Math.pow(l,3)+h/120*Math.pow(Math.cos(t),5)*g*Math.pow(l,5)+h/5040*Math.pow(Math.cos(t),7)*I*Math.pow(l,7),d=S3(t)+r/2*h*Math.pow(Math.cos(t),2)*Math.pow(l,2)+r/24*h*Math.pow(Math.cos(t),4)*a*Math.pow(l,4)+r/720*h*Math.pow(Math.cos(t),6)*c*Math.pow(l,6)+r/40320*h*Math.pow(Math.cos(t),8)*f*Math.pow(l,8);e.vs_(C,d);return e}function R3(t){const i=(v3-b3)/(v3+b3),s=undefined,e=t/((v3+b3)/2*(1+Math.pow(i,2)/4+Math.pow(i,4)/64)),A=3*i/2+-27*Math.pow(i,3)/32+269*Math.pow(i,5)/512,n=21*Math.pow(i,2)/16+-55*Math.pow(i,4)/32,h=151*Math.pow(i,3)/96+-417*Math.pow(i,5)/128,r=1097*Math.pow(i,4)/512,o=undefined;return e+A*Math.sin(2*e)+n*Math.sin(4*e)+h*Math.sin(6*e)+r*Math.sin(8*e)}function k3(t,i,s,e){let A;const n=R3(i),h=(Math.pow(v3,2)-Math.pow(b3,2))/Math.pow(b3,2),r=Math.cos(n),o=h*Math.pow(r,2),l=Math.pow(v3,2)/(b3*Math.sqrt(1+o));A=l;const u=Math.tan(n),a=u*u,g=a*a,c=1/(A*r);A*=l;const I=u/(2*A);A*=l;const f=1/(6*A*r);A*=l;const C=u/(24*A);A*=l;const d=1/(120*A*r);A*=l;const B=u/(720*A);A*=l;const w=1/(5040*A*r);A*=l;const Q=u/(40320*A),E=-1-o,p=-1-2*a-o,m=5+3*a+6*o-6*a*o-3*(o*o)-9*a*(o*o),y=5+28*a+24*g+6*o+8*a*o,D=-61-90*a-45*g-107*o+162*a*o,M=-61-662*a-1320*g-720*(g*a),v=1385+3633*a+4095*g+1575*(g*a);e.vs_(s+c*t+f*p*Math.pow(t,3)+d*y*Math.pow(t,5)+w*M*Math.pow(t,7),n+I*E*(t*t)+C*m*Math.pow(t,4)+B*D*Math.pow(t,6)+Q*v*Math.pow(t,8));return e}var F3=Ci(function(){let i=class t extends g3{constructor(t,i){const s=qi(t,{zone:typeof t=="number"?t:null,southhemi:i,name:B3.UTM,limits:M3,units:"meters"},!0);super(s);this.T2i_=s["zone"];this.K2i_=s["southhemi"]}transform(t,i,s){s==null&&(s=new lA);s.vs_(t,i);const e=NA.degToRad(-183+this.T2i_*6);G3(NA.degToRad(s.y),NA.degToRad(s.x),e,s);s.x=s.x*N3+5e5;s.y=s.y*N3;s.y<0&&(s.y=s.y+1e7);return s}H2i_(){return this.T2i_}q2i_(t){this.T2i_=t;return this}J2i_(t){this.K2i_=t;return this}P2i_(){return this.K2i_}uI_(t,i,s){s==null&&(s=new lA);s.vs_(t,i);const e=NA.degToRad(-183+this.T2i_*6);s.x-=5e5;s.x/=N3;this.K2i_&&(s.y-=1e7);s.y/=N3;k3(s.x,s.y,e,s);s.x=NA.radToDeg(s.x);s.y=NA.radToDeg(s.y);return s}};i=t([_s("geotoolkit.map.coordinatesystems.UTM")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRab25lIjoiSDJpXyIsInNldFpvbmUiOiJxMmlfIiwic2V0U291dGhlcm5IZW1pc3BoZXJlIjoiSjJpXyIsImlzU291dGhlcm5IZW1pc3BoZXJlIjoiUDJpXyIsImludmVyc2VUcmFuc2Zvcm0iOiJ1SV8ifX19");const x3=10,L3=function(t){return Math.log(t+Math.sqrt(t*t+1))},U3=function(t){return.5*Math.log((1+t)/(1-t))};var Y3=Ci(function(){let i=class t extends g3{constructor(t){const i=qi(t,{units:"metre",name:"TranverseMercator",spheroid:[6378137,298.2572236],latitudeoforigin:0,centralmeridian:0,falseeasting:0,falsenorthing:0,scalefactor:1},!0);super(i);this.M2i_=new f3(i["spheroid"][0],1/i["spheroid"][1]);this.N2i_=NA.degToRad(i["latitudeoforigin"]);this.S2i_=NA.degToRad(i["centralmeridian"]);this.G2i_=i["falseeasting"];this.R2i_=i["falsenorthing"];this.xm_=i["scalefactor"];const s=OA.Ai_().gn_("metre").wn_(this.M2i_.p2i_(),this.xQ_()),e=OA.Ai_().gn_("metre").wn_(this.M2i_.m2i_(),this.xQ_());this._e=this.M2i_.y2i_();const A=(s-e)/s,n=A/(2-A),h=n*n;this._Bi=s/(1+n)*(1+h/4+h*h/64);this._hs=[n/2-2/3*h+5/16*h*n+41/180*h*h,13/48*h-3/5*h*n+557/1440*h*h,61/240*h*n-103/140*h*h,49561/161280*h*h];this.V2i_=[n/2-2/3*h+37/96*h*n-1/360*h*h,1/48*h+1/15*h*n-437/1440*h*h,17/480*h*n-37/840*h*h,4397/161280*h*h];this._mO=0;if(Math.abs(this.N2i_)>NA.Je_)if(this.N2i_===Math.PI/2)this._mO=this._Bi*(Math.PI/2);else if(this.N2i_===-Math.PI/2)this._mO=-this._Bi*(Math.PI/2);else{let t;const i=L3(Math.tan(this.N2i_))-this._e*U3(this._e*Math.sin(this.N2i_)),s=Math.atan(Math.sinh(i));t=Math.asin(Math.sin(s));t=t+this._hs[0]*Math.sin(2*t)+this._hs[1]*Math.sin(4*t)+this._hs[2]*Math.sin(6*t)+this._hs[3]*Math.sin(8*t);this._mO=this._Bi*t}}transform(t,i,s,e){s==null&&(s=new lA);const A=NA.degToRad(t),n=NA.degToRad(i),h=L3(Math.tan(n))-this._e*U3(this._e*Math.sin(n)),r=Math.atan(Math.sinh(h)),o=U3(Math.cos(r)*Math.sin(A-this.S2i_)),l=Math.asin(Math.sin(r)*Math.cosh(o)),u=l+this._hs[0]*Math.sin(2*l)*Math.cosh(2*o)+this._hs[1]*Math.sin(4*l)*Math.cosh(4*o)+this._hs[2]*Math.sin(6*l)*Math.cosh(6*o)+this._hs[3]*Math.sin(8*l)*Math.cosh(8*o),a=o+this._hs[0]*Math.cos(2*l)*Math.sinh(2*o)+this._hs[1]*Math.cos(4*l)*Math.sinh(4*o)+this._hs[2]*Math.cos(6*l)*Math.sinh(6*o)+this._hs[3]*Math.cos(8*l)*Math.sinh(8*o),g=this.G2i_+this.xm_*this._Bi*a,c=this.R2i_+this.xm_*(this._Bi*u-this._mO);s.vs_(g,c);return s}uI_(t,i,s){s==null&&(s=new lA);let e,A,n;const h=(t-this.G2i_)/(this._Bi*this.xm_),r=(i-this.R2i_+this._mO*this.xm_)/(this._Bi*this.xm_),o=r-this.V2i_[0]*Math.sin(2*r)*Math.cosh(2*h)-this.V2i_[1]*Math.sin(4*r)*Math.cosh(4*h)-this.V2i_[2]*Math.sin(6*r)*Math.cosh(6*h)-this.V2i_[3]*Math.sin(8*r)*Math.cosh(8*h),l=h-this.V2i_[0]*Math.cos(2*r)*Math.sinh(2*h)-this.V2i_[1]*Math.cos(4*r)*Math.sinh(4*h)-this.V2i_[2]*Math.cos(6*r)*Math.sinh(6*h)-this.V2i_[3]*Math.cos(8*r)*Math.sinh(8*h),u=Math.asin(Math.sin(o)/Math.cosh(l)),a=L3(Math.tan(u));n=a+this._e*U3(this._e*Math.tanh(a));A=0;do{e=n;n=a+this._e*U3(this._e*Math.tanh(n));A++}while(Math.abs(n-e)>NA.Je_&&A<x3);const g=Math.atan(Math.sinh(n)),c=this.S2i_+Math.asin(Math.tanh(l)/Math.cos(u));s.vs_(NA.radToDeg(c),NA.radToDeg(g));return s}};i=t([_s("geotoolkit.map.coordinatesystems.TransverseMercator")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnZlcnNlVHJhbnNmb3JtIjoidUlfIn19fSAg");const T3=1e-12,K3=30,H3=6378137,q3=.006694379990141316,J3=function(t){switch(t.toLowerCase()){case c3.eG_:return c3.eG_;case c3.nG_:return c3.nG_;case c3.sG_:return c3.sG_}return c3.AG_},P3=function(t){if(!t)return null;const i={axis:[]};let s;(s=t.match(/SPHEROID\["[^"]+",\s*([-\.\d]+),\s*([-\.\d]+)/i))&&(i["spheroid"]=[+s[1],+s[2]]);(s=t.match(/TOWGS84\[([-\.\d]+),([-\.\d]+),([-\.\d]+),([-\.\d]+),([-\.\d]+),([-\.\d]+)/i))&&(i["towgs84"]=[+s[1],+s[2],+s[3],+s[4],+s[5],+s[6]]);(s=t.match(/PRIMEM\["[^"]+",\s*([-\.\d]+)/i))&&(i["primem"]=+s[1]);const e=/UNIT\[["\s]*(\w+)["\s]*,\s*([-\.\d]+)/gi;if(s=e.exec(t)){const A=new PA(s[1],["length"],s[1],"m",0,+s[2],1,0);if(s=e.exec(t)){i["spheroidunits"]=A.dt_({baseunitsymbol:"degrees"});i["units"]=new PA(s[1],["length"],s[1],"m",0,+s[2],1,0)}else i["units"]=A}(s=t.match(/AXIS\["x",["\s]*(\w+)["\s]*/i))?i["axis"][0]=J3(s[1]):i["axis"][0]=c3.AG_;(s=t.match(/AXIS\["y",["\s]*([\w]+)["\s]*/i))?i["axis"][1]=J3(s[1]):i["axis"][1]=c3.eG_;(s=t.match(/PARAMETER\["standard_parallel_1",\s*([-\.\d]+)/i)||t.match(/PARAMETER\["Latitude of 1st standard parallel",\s*([-\.\d]+)/i))&&(i["standardparallel1"]=+s[1]);(s=t.match(/PARAMETER\["standard_parallel_2",\s*([-\.\d]+)/i))&&(i["standardparallel2"]=+s[1]);(s=t.match(/PARAMETER\["latitude_of_origin",\s*([-\.\d]+)/i))&&(i["latitudeoforigin"]=+s[1]);(s=t.match(/PARAMETER\["central_meridian",\s*([-\.\d]+)/i)||t.match(/PARAMETER\["longitude_of_origin",\s*([-\.\d]+)/i)||t.match(/PARAMETER\["Longitude of natural origin",\s*([-\.\d]+)/i))&&(i["centralmeridian"]=+s[1]);(s=t.match(/PARAMETER\["false_easting",\s*([-\.\d]+)/i)||t.match(/PARAMETER\["False easting",\s*([-\.\d]+)/i))&&(i["falseeasting"]=+s[1]);(s=t.match(/PARAMETER\["false_northing",\s*([-\.\d]+)/i)||t.match(/PARAMETER\["False northing",\s*([-\.\d]+)/i))&&(i["falsenorthing"]=+s[1]);(s=t.match(/PARAMETER\["scale_factor",\s*([-\.\d]+)/i))&&(i["scalefactor"]=+s[1]);return i};var V3=function(){var t=class{constructor(t){this.M2i_=t;this._e=this.M2i_.y2i_()}transform(t,i,s){i=NA.degToRad(i);s=NA.degToRad(s);const e=t?H3:this.M2i_.p2i_(),A=t?q3:this._e*this._e,n=Math.sin(s),h=Math.cos(s),r=e/Math.sqrt(1-A*n*n);return{x:r*h*Math.cos(i),y:r*h*Math.sin(i),z:r*(1-A)*n}}uI_(t,i,s,e,A){A=A||new lA;const n=t?H3:this.M2i_.p2i_(),h=t?q3:this._e*this._e,r=Math.sqrt(i*i+s*s),o=Math.sqrt(i*i+s*s+e*e);let l,u,a,g,c,I,f,C,d,B,w;if(r/n<T3){B=0;if(o/n<T3)return A}else B=Math.atan2(s,i);const Q=e/o,E=r/o;l=1/Math.sqrt(1-h*(2-h)*E*E);g=E*(1-h)*l;c=Q*l;d=0;do{d++;a=n/Math.sqrt(1-h*c*c);w=r*g+e*c-a*(1-h*c*c);u=h*a/(a+w);l=1/Math.sqrt(1-u*(2-u)*E*E);I=E*(1-u)*l;f=Q*l;C=f*g-I*c;g=I;c=f}while(C*C>T3*T3&&d<K3);const p=Math.atan(f/Math.abs(I));A.x=NA.radToDeg(B);A.y=NA.radToDeg(p);return A}};return t}();const O3=OA.Ai_().gn_("degrees");var W3=Ci(function(){var i;let s=i=class t extends g3{constructor(t){if(typeof t=="string"){const i=P3(t);if(!i)throw new Error("Coordinate system ("+t+") is not supported, "+"use geotoolkit.map.coordinatesystems.Registry to register it manually.");t=i}(t=qi(t,{spheroid:[6378137,298.2572236],primem:0,spheroidunits:O3,axis:[c3.AG_,c3.eG_]},!0))["standartparallel1"]!=null&&t["standartparallel2"]!=null&&ki("standartparallel1 and standartparallel2 are deprecated since 4.0. Use correct spelling.");const i=new f3(t["spheroid"][0],1/t["spheroid"][1]);t["limits"]=t["limits"]||new mA(-i.p2i_()*180,-i.m2i_()*180,i.p2i_()*180,i.m2i_()*180);super(t);this.M2i_=i;if(t["towgs84"]!=null){this.O2i_=t["towgs84"][0]||0;this.W2i_=t["towgs84"][1]||0;this.z2i_=t["towgs84"][2]||0;this.X2i_=NA.degToRad((t["towgs84"][3]||0)/3600);this.j2i_=NA.degToRad((t["towgs84"][4]||0)/3600);this.Z2i_=NA.degToRad((t["towgs84"][5]||0)/3600);this.y0t_=(t["towgs84"][6]||0)/1e6+1;this._2i_=new V3(this.M2i_)}else{this.O2i_=0;this.W2i_=0;this.z2i_=0;this.X2i_=0;this.j2i_=0;this.Z2i_=0;this.y0t_=1;this._2i_=null}this.$2i_=t["primem"];this.t5i_=OA.Ai_().gn_(t["spheroidunits"]);this.i5i_=t["axis"];t["limits"]=null;t["zone"]!=null&&t["southhemi"]!=null?this.s5i_=new F3(t):t["latitudeoforigin"]!=null&&t["centralmeridian"]!=null&&t["falseeasting"]!=null&&t["falsenorthing"]!=null?t["standartparallel1"]!=null&&t["standartparallel2"]!=null||t["standardparallel1"]!=null&&t["standardparallel2"]!=null?this.s5i_=new d3(t):this.s5i_=new Y3(t):t["name"]===B3.L2i_||t["centralmeridian"]!=null&&t["falseeasting"]!=null&&t["falsenorthing"]!=null?this.s5i_=new D3(t["epsg"]):this.s5i_=new Q3(t["epsg"])}transform(t,i,s){s==null&&(s=new lA);if(this._2i_!=null){const e=this._2i_.transform(!0,t,i),A=(e.x-this.O2i_)/this.y0t_,n=(e.y-this.W2i_)/this.y0t_,h=(e.z-this.z2i_)/this.y0t_,r=A+this.Z2i_*n-this.j2i_*h,o=-this.Z2i_*A+n+this.X2i_*h,l=this.j2i_*A-this.Z2i_*n+h;s=this._2i_.uI_(!1,r,o,l,s)}else s.vs_(t,i);s.x-=this.$2i_;s.x<-180&&(s.x+=360);s.x=O3.wn_(s.x,this.t5i_);s.y=O3.wn_(s.y,this.t5i_);s=this.s5i_.transform(s.x,s.y,s);this.e5i_(s);return s}uI_(t,i,s){s==null&&(s=new lA);s.vs_(t,i);this.e5i_(s);(s=this.s5i_.uI_(s.x,s.y,s)).x=this.t5i_.wn_(s.x,O3);s.y=this.t5i_.wn_(s.y,O3);s.x+=this.$2i_;s.x>180&&(s.x-=360);if(this._2i_!=null){const t=this._2i_.transform(!1,s.x,s.y),i=this.y0t_*(t.x-this.Z2i_*t.y+this.j2i_*t.z)+this.O2i_,e=this.y0t_*(this.Z2i_*t.x+t.y-this.X2i_*t.z)+this.W2i_,A=this.y0t_*(-this.j2i_*t.x+this.X2i_*t.y+t.z)+this.z2i_;s=this._2i_.uI_(!0,i,e,A,s)}return s}A5i_(){return[this.M2i_.p2i_(),1/this.M2i_.D2i_()]}n5i_(){return[this.O2i_,this.W2i_,this.z2i_,this.X2i_,this.j2i_,this.Z2i_,this.y0t_]}h5i_(){return this.$2i_}r5i_(){return this.t5i_}e5i_(t){let i=t.x,s=t.y;switch(this.i5i_[0].toLowerCase()){case c3.sG_:i=-t.x;break;case c3.eG_:i=t.y;break;case c3.nG_:i=-t.y;break}switch(this.i5i_[1].toLowerCase()){case c3.sG_:s=-t.x;break;case c3.AG_:s=t.x;break;case c3.nG_:s=-t.y;break}t.x=i;t.y=s}static parse(t){const s=P3(t);return s?new i(s):null}};s=i=t([_s("geotoolkit.map.coordinatesystems.WKT")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnZlcnNlVHJhbnNmb3JtIjoidUlfIiwiZ2V0U3BoZXJvaWQiOiJBNWlfIiwiZ2V0VG9XR1M4NCI6Im41aV8iLCJnZXRQcmltZU1lcmlkaWFuIjoiaDVpXyIsImdldFNwaGVyb2lkVW5pdHMiOiJyNWlfIn19fSAg");let z3=null;var X3=Ci(function(){var i;let s=i=class t{constructor(){this.o5i_={}}l5i_(t){if(t==null)return null;if(t instanceof g3)return t;if(typeof t=="object")return new W3(t);this.o5i_[t]==null&&(this.o5i_[t]=this.u5i_(t));return this.o5i_[t]}u5i_(t){const i=I3[+t];if(i==null)return typeof t=="string"?new W3(t):null;if(i["name"]!=null&&this.o5i_[i["name"]]!=null)return this.o5i_[i["name"]];i["epsg"]=+t;return new W3(i)}a5i_(t){ki("geotoolkit.map.coordinatesystems.Registry.setDefaultSystem is redundant since 2023 (4.0).");return this}g5i_(t){if(t instanceof g3){t.w2i_()!=null&&(this.o5i_[t.w2i_()]=t);return this}throw new Error("Illegal system")}c5i_(t){if(t instanceof g3){t.w2i_()!=null&&(this.o5i_[t.w2i_()]=t);this.o5i_[t.dn_()]=t;return this}throw new Error("Illegal system")}static sx_(){if(z3==null){z3=new i;z3.c5i_(new Q3);z3.c5i_(new D3);z3.c5i_(new F3(31,!0))}return z3}};s=i=t([_s("geotoolkit.map.coordinatesystems.Registry")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRDb29yZGluYXRlU3lzdGVtIjoibDVpXyIsInNldERlZmF1bHRTeXN0ZW0iOiJhNWlfIiwicmVnaXN0ZXJDb29yZGluYXRlU3lzdGVtIjoiZzVpXyJ9fSwiZ2V0RGVmYXVsdCI6InN4XyIsImdldENsYXNzTmFtZSI6IkRfIn0g");const j3=new lA;var Z3=Ci(function(){let i=class t{constructor(t,i){if(t instanceof g3||typeof t=="string"){this.I5i_=X3.sx_().l5i_(t);this.f5i_=X3.sx_().l5i_(i)}else{this.I5i_=X3.sx_().l5i_(t["initialcoordinatesystem"]);this.f5i_=X3.sx_().l5i_(t["targetcoordinatesystem"])}}transform(t,i){return t instanceof lA?this.transformPoint(t,i):t instanceof mA?this.rn_(t,i):Array.isArray(t["x"])&&Array.isArray(t["y"])?this.C5i_(t,i):t}transformPoint(t,i){i=this.d5i_().uI_(t.x,t.y,i);this.B5i_().transform(i.x,i.y,i);return i}rn_(t,i){j3.vs_(t.getX(),t.getY());this.transformPoint(j3,j3);const s=j3.x,e=j3.y;j3.vs_(t.Qe_(),t.pe_());this.transformPoint(j3,j3);i!=null?i.ce_(s,e,j3.x,j3.y):i=new mA(s,e,j3.x,j3.y);return i}C5i_(t,i){const s=t["x"],e=t["y"];if(!Array.isArray(s)||!Array.isArray(e)||s.length!==e.length)return i;const A=[],n=[];for(let t=0;t<s.length;++t){this.transformPoint(j3.vs_(s[t],e[t]),j3);A.push(j3.x);n.push(j3.y)}if(i==null)return{x:A,y:n};i["x"]=A;i["y"]=n;return i}w5i_(t){this.I5i_=X3.sx_().l5i_(t);return this}d5i_(){return this.I5i_}Q5i_(t){this.f5i_=X3.sx_().l5i_(t);return this}B5i_(){return this.f5i_}};i=t([_s("geotoolkit.map.coordinatesystems.Transformer")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJ0cmFuc2Zvcm1SZWN0Ijoicm5fIiwidHJhbnNmb3JtUG9seWdvbiI6IkM1aV8iLCJzZXRJbml0aWFsQ29vcmRpbmF0ZVN5c3RlbSI6Inc1aV8iLCJnZXRJbml0aWFsQ29vcmRpbmF0ZVN5c3RlbSI6ImQ1aV8iLCJzZXRUYXJnZXRDb29yZGluYXRlU3lzdGVtIjoiUTVpXyIsImdldFRhcmdldENvb3JkaW5hdGVTeXN0ZW0iOiJCNWlfIn19LCJnZXRDbGFzc05hbWUiOiJEXyJ9");var _3=function(){let i=class t extends Z3{constructor(t){super({initialcoordinatesystem:t instanceof g3?t:t["initialcoordinatesystem"],targetcoordinatesystem:X3.sx_().l5i_(B3.U2i_)})}transformPoint(t,i){return this.d5i_().uI_(t.x,t.y,i)}};i=t([_s("geotoolkit.map.coordinatesystems.LatLonTransformer")],i);return i}();var $3=Ci(function(){var t=class{};t.prototype.XC_=Zi;t.prototype.Uui_=Zi;t.prototype.nt_=Zi;return t}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRJZCI6IlhDXyIsImdldEF0dHJpYnV0ZXMiOiJVdWlfIiwiZ2V0R2VvbWV0cnkiOiJudF8ifX19");var t4=Ci(function(){let i=class t{constructor(t){this._id=t&&t["id"]?t["id"]+"":null;this.ui_=t&&t["attributes"]||{};this.qd_=t&&t["geometry"]||null;this.E5i_=null;this.p5i_=null}m5i_(){return Wi(this)}b_(t){this._id=t._id;this.ui_=t.ui_;this.qd_=t.qd_;this.E5i_=t.E5i_;return this}XC_(){return this._id}JC_(t){this._id=t+"";return this}nt_(t){return t&&this.E5i_!=null?this.E5i_:this.qd_}Pd_(t){this.E5i_=t;return this}y5i_(){return this.p5i_||this.nt_(!0)}D5i_(t){this.p5i_=t;return this}M5i_(){this.v5i_=this.v5i_||{};return this.v5i_}Uui_(){return this.ui_}b5i_(t){this.ui_=t;return this}en_(){return!1}N5i_(){return!0}S5i_(){return!1}};i.prototype.G5i_=Zi;i=t([Zs($3),_s("geotoolkit.map.features.AbstractFeature")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzaGFsbG93Q2xvbmUiOiJtNWlfIiwiY29weUNvbnN0cnVjdG9yIjoiYl8iLCJnZXRJZCI6IlhDXyIsImdldEdlb21ldHJ5IjoibnRfIiwiZ2V0QXR0cmlidXRlcyI6IlV1aV8iLCJhcHBseU1hcENTIjoiRzVpXyJ9fSwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");var i4=function(){var t=class{};t.prototype.apply=Zi;return t}();var s4=Ci(function(){let i=class t{static R5i_(t){t.k5i_||(t.k5i_={});t.k5i_.F5i_||(t.k5i_.F5i_=Array.isArray(t["x"])?bn.getBoundingBox(t["x"],t["y"]):new mA(t["x"],t["y"],t["x"],t["y"]));return t.k5i_.F5i_}static x5i_(t){let i=0;const s=t.x,e=t.y;let A=s.length-1;for(let t=0;t<s.length;A=t++)i+=(s[t]-s[A])*(e[t]+e[A]);return i>0}};i=t([_s("geotoolkit.map.util.Geometry")],i);return i}(),2,"eyJnZXRDYWNoZWRHZW9tZXRyeUJvdW5kcyI6IlI1aV8iLCJpc0Nsb2Nrd2lzZSI6Ing1aV8iLCJnZXRDbGFzc05hbWUiOiJEXyJ9");var e4=Ci({L5i_:"Centroid",U5i_:"Incenter",Y5i_:"CentroidOrIncenter",T5i_:"Mixed"},2,"eyJDZW50cm9pZCI6Ikw1aV8iLCJJbmNlbnRlciI6IlU1aV8iLCJDZW50cm9pZE9ySW5jZW50ZXIiOiJZNWlfIiwiTWl4ZWQiOiJUNWlfIn0g");const A4=1024;var n4=function(){var t=class{constructor(t,i,s,e){this.x=t;this.y=i;this.size=s;this.geometry=e;this.K5i_();this.max=this.distance+s*Math.SQRT2}K5i_(){let t=!1,i=1/0;const s=this.geometry.x.length;for(let e=0,A=s-1;e<s;A=e++){this.geometry.y[e]>this.y!=this.geometry.y[A]>this.y&&this.x<this.geometry.x[e]+(this.geometry.x[A]-this.geometry.x[e])*(this.y-this.geometry.y[e])/(this.geometry.y[A]-this.geometry.y[e])&&(t=!t);i=Math.min(i,this.Gs_(this.x,this.y,this.geometry.x[A],this.geometry.y[A],this.geometry.x[e],this.geometry.y[e]))}this.distance=(t?1:-1)*Math.sqrt(i)}split(){const i=this.size/2;return[new t(this.x-i,this.y-i,i,this.geometry),new t(this.x+i,this.y-i,i,this.geometry),new t(this.x-i,this.y+i,i,this.geometry),new t(this.x+i,this.y+i,i,this.geometry)]}Gs_(t,i,s,e,A,n){let h=A-s,r=n-e,o=s,l=e;if(h!==0||r!==0){const u=((t-s)*h+(i-e)*r)/(h*h+r*r);if(u>1){o=A;l=n}else if(u>0){o+=u*h;l+=u*r}}h=t-o;r=i-l;return h*h+r*r}static H5i_(i){let s=0,e=0,A=0;const n=i.x.length;for(let t=0,h=n-1;t<n;h=t++){const n=i.x[t]*i.y[h]-i.x[h]*i.y[t];e+=(i.x[t]+i.x[h])*n;A+=(i.y[t]+i.y[h])*n;s+=3*n}return new t(e/s,A/s,0,i)}static Eji_(t,i){let s=0,e=t.length-1,A;while(s<=e){A=s+e>>1;if(t[A].max>i.max)e=A-1;else{if(!(t[A].max<i.max)){s=A;break}s=A+1}}t.splice(s,0,i)}};return t}(),h4=Ci(function(){let i=class t{constructor(t){this.d4_=t||e4.T5i_}apply(t,i,s){if(t.k5i_&&t.k5i_.anchor)i.gR_(t.k5i_.anchor.x,t.k5i_.anchor.y);else{t.k5i_=t.k5i_||{};switch(t.x.length){case 0:t.k5i_.anchor={x:0,y:0};break;case 1:t.k5i_.anchor={x:t.x[0],y:t.y[0]};break;case 2:case 3:t.k5i_.anchor={x:(t.x[0]+t.x[1])/2,y:(t.y[0]+t.y[1])/2};break;default:let i=n4.H5i_(t);const s=[],e=n4.Eji_.bind(null,s),A=s4.R5i_(t),n=Math.min(A.Ts_(),A.Ie_())/100;let h;if(this.d4_===e4.U5i_||this.d4_===e4.Y5i_&&i.distance<0){h=Math.max(A.Ts_(),A.Ie_())/2;e(new n4(A.ye_(),A.De_(),h,t))}else if(this.d4_===e4.T5i_){h=Math.min(A.Ts_(),A.Ie_())/10+Math.max(0,-i.distance);e(new n4(i.x,i.y,h,t))}if(n>0)while(s.length>0&&s.length<A4){const t=s.pop();t.distance>i.distance&&(i=t);t.max-i.distance>n&&t.split().forEach(e)}t.k5i_.anchor={x:i.x,y:i.y}}i.gR_(t.k5i_.anchor.x,t.k5i_.anchor.y)}}};i=t([Zs(i4),_s("geotoolkit.map.features.adapters.Center")],i);return i}(),2,"eyJnZXRDbGFzc05hbWUiOiJEXyJ9");var r4=function(){var t=class{};t.prototype.apply=Zi;return t}();const o4=new xA;var l4=Ci(function(){let i=class t{constructor(t){this.IK_=5;this.fK_=0;this.setOptions(t)}setOptions(t){if(!t||!t["offset"])return this;t["offset"]["x"]!==void 0&&(this.IK_=t["offset"]["x"]);t["offset"]["y"]!==void 0&&(this.fK_=t["offset"]["y"]);return this}apply(t,i,s){const e=this.IK_,A=this.fK_,n=t.x[0]>t.x[t.x.length-1]?0:t.x.length-1;if(s==null||e===0&&A===0)i.gR_(t.x[n],t.y[n]);else{const h=s instanceof Gn?s:s.Ji_();o4.setSize(e,A);h.cI_(o4,o4);i.gR_(t.x[n]+NA.sign(e)*o4.Ie_(),t.y[n]+NA.sign(A)*o4.Ts_())}}};i=t([Zs(r4),Zs(i4),_s("geotoolkit.map.features.adapters.Edge")],i);return i}(),2,"eyJnZXRDbGFzc05hbWUiOiJEXyJ9");var u4=Ci(function(){let i=class t{apply(t,i,s){i.Qt_(t["x"],t["y"])}};i=t([Zs(r4),_s("geotoolkit.map.features.adapters.LineString")],i);return i}(),2,"eyJnZXRDbGFzc05hbWUiOiJEXyJ9");var a4=Ci(function(){var i;let s=i=class t{apply(t,s,e){s.clear();i.q5i_(t,s)}static q5i_(t,s,e,A,n){let h;const r=t.x,o=t.y;let l=null,u=null,a=n?n.qe_(r[0],o[0]):null,g=!1;s.moveTo(r[0],o[0]);for(h=1;h<r.length;++h){if(!A||!n){s.lineTo(r[h],o[h]);continue}const t=n.qe_(r[h],o[h]);if(a&t){g=!0;continue}a=t;if(g){s.lineTo(r[h-1],o[h-1]);g=!1}const i=(r[h]-n.getX())/A.Ie_()|0,e=(o[h]-n.getY())/A.Ts_()|0;if(i!==l||e!==u){s.lineTo(r[h],o[h]);l=i;u=e}}if(e){g&&s.lineTo(r[r.length-1],o[o.length-1]);s.closePath()}if(t["clip"]!=null){h=t["clip"][0]instanceof mA?1:0;for(;h<t["clip"].length;++h)i.q5i_(t["clip"][h],s,e,A,n)}}};s=i=t([Zs(r4),_s("geotoolkit.map.features.adapters.Path")],s);return s}(),2,"eyJnZXRDbGFzc05hbWUiOiJEXyJ9");const g4=new xA;var c4=Ci(function(){let i=class t{constructor(t){this.IK_=t&&t["offset"]&&t["offset"]["x"]||0;this.fK_=t&&t["offset"]&&t["offset"]["y"]||0}setOptions(t){if(!t||!t["offset"])return this;t["offset"]["x"]!==void 0&&(this.IK_=t["offset"]["x"]);t["offset"]["y"]!==void 0&&(this.fK_=t["offset"]["y"]);return this}apply(t,i,s){if(s){const e=this.IK_+(t.offset?t.offset.x:0),A=this.fK_+(t.offset?t.offset.y:0);if(e!==0||A!==0){g4.setSize(e,A);const n=undefined;(s instanceof Gn?s:s.Ji_()).cI_(g4,g4);i.gR_(t["x"]+NA.sign(e)*g4.Ie_(),t["y"]+NA.sign(A)*g4.Ts_())}else i.gR_(t["x"],t["y"])}else i.gR_(t["x"],t["y"])}};i=t([Zs(r4),Zs(i4),_s("geotoolkit.map.features.adapters.Point")],i);return i}(),2,"eyJnZXRDbGFzc05hbWUiOiJEXyJ9");let I4=null;const f4=new xA,C4=function(t,i){const s=t["x"],e=t["y"],A=Math.min(s.length,e.length);if(A>0){i.moveTo(s[0],e[0]);for(let t=1;t<A;++t)i.lineTo(s[t],e[t]);i.close()}};var d4=Ci(function(){let i=class t{apply(t,i,s){i.Qt_(t["x"],t["y"]);if(t["clip"]==null||s==null)i.xb_(null);else{I4==null?I4=new wh(new TA,!0):I4.nt_().clear();let e=0;const A=I4.nt_();if(t["clip"][0]instanceof mA){const i=s instanceof Gn?s:s.Ji_(),n=t["clip"][0];i.cI_(f4.setSize(1,1),f4);const h=n.x-f4.Ie_(),r=n.Qe_()+f4.Ie_(),o=n.y-f4.Ts_(),l=n.pe_()+f4.Ts_();A.moveTo(h,o);A.lineTo(r,o);A.lineTo(r,l);A.lineTo(h,l);A.lineTo(h,o);A.close();e=1}for(;e<t["clip"].length;++e)C4(t["clip"][e],A);i.xb_(I4)}}};i=t([Zs(r4),_s("geotoolkit.map.features.adapters.Polygon")],i);return i}(),2,"eyJnZXRDbGFzc05hbWUiOiJEXyJ9");const B4=new lA;var w4=Ci(function(){let i=class t extends t4{G5i_(t){const i=this.qd_;B4.vs_(i["x"],i["y"]);t.J5i_(B4,B4);this.E5i_={x:B4.getX(),y:B4.getY()};return this}N5i_(){return!1}};i=t([_s("geotoolkit.map.features.Point")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJhcHBseU1hcENTIjoiRzVpXyJ9fX0g");const Q4=Au.cN_([]),E4=function(t,i){const s=[];for(let t=0;t<i;t++)s[t]=[];let e=0;t.forEach((function(t){s[e].push(t);e=(e+1)%i}));return s};var p4=Ci(function(){var i;let s=i=class t extends w4{constructor(t){super(t);this.bjt_=[];this.P5i_=!1;this.JP_=t&&t.node||null;this.xC_=t&&t.parent||null;this.V5i_=t&&t.O5i_||Q4;this.W5i_=t&&t.arc!=null?t.arc:2*Math.PI;this.jNt_=t&&t.angle!=null?t.angle:Math.PI/2;this.z5i_=t&&t.X5i_||null}j5i_(){return this.V5i_}G5i_(t){this.getParent()||this.V5i_.forEach((function(i){i.G5i_(t)}));return super.G5i_(t)}Z5i_(t){this.V5i_=t;return this}_5i_(t){let i;if(this.$5i_()===t)return this;if(t){let t=0,s=this;while(s.getParent()!=null){s=s.getParent();t++}let e=s.PP_().t3i_(t);const A=s.PP_().xVt_(t);if(this.bjt_.length===0&&+this.XC_()>1){if(this.getParent()==null)e=Math.min(+this.XC_(),e);else{let t=0;const s=this.getParent().YY_();for(i=0;i<s.length;i++){const A=Math.min(+s[i].XC_(),e);t<A&&(t=A)}e=t}this.i3i_(e,A,t)}}else for(i=0;i<this.bjt_.length;i++)this.bjt_[i]._5i_(!1);this.P5i_=t;this.PP_()!=null&&this.PP_()._5i_(t);return this}$5i_(){return this.P5i_}PP_(){return this.JP_}YY_(){return this.bjt_}getParent(){return this.xC_}tGt_(){return this.getParent()==null?0:this.getParent().tGt_()+1}i3i_(t,s,e){const A=this.nt_(!0),n=Math.min(+this.XC_(),t),h=this.W5i_/n;let r=this.jNt_-h*(n-1)/2;const o=s*(e+1),l=E4(this.j5i_(),n);for(let t=0;t<n;t++){this.bjt_.push(new i({O5i_:Au.cN_(l[t]),X5i_:this.z5i_,arc:this.W5i_/n,angle:r,parent:this,id:""+l[t].length,geometry:{x:A.x,y:A.y,offset:{x:Math.cos(r)*o,y:Math.sin(r)*o}},attributes:{}}));r+=h}}s3i_(){return this.z5i_}};s=i=t([_s("geotoolkit.map.features.Aggregation")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRBZ2dyZWdhdGlvbiI6Imo1aV8iLCJhcHBseU1hcENTIjoiRzVpXyIsInNldEV4cGFuZGVkIjoiXzVpXyJ9fX0g");var m4=Ci(function(){let i=class t{constructor(t){t=t?ds(t):{};this.dgt_=t["shape"];this.x0_=t["shapecallback"];this.e3i_=t["geometrytoshape"];this.A3i_=t["geometrytotext"];this._q_=t["textshape"]||new YC({preservereadingorientation:!0,ispointingup:!0});this.n3i_=t["textstrategy"];if(t["textsizeinfo"]){this.h3i_=t["textsizeinfo"];this._q_.PX_(NC.AX_)}this.dgt_!=null&&this.dgt_.fB_()==null&&this.dgt_.rd_(!1);this._q_.rd_(!1)}N_(){return{shape:this.dgt_,geometrytoshape:this.e3i_,geometrytotext:this.A3i_,textshape:this._q_}}dt_(t){if(t==null)return this;t["shape"]!=null&&(this.dgt_=t["shape"]);t["geometrytoshape"]!=null&&(this.e3i_=t["geometrytoshape"]);t["geometrytotext"]!=null&&(this.A3i_=t["geometrytotext"]);t["textshape"]!=null&&(this._q_=t["textshape"]);t["textstrategy"]!==void 0&&(this.n3i_=t["textstrategy"]);t["textsizeinfo"]!=null?this.h3i_=t["textsizeinfo"]:t["textshape"]!=null&&(this.h3i_=null);t["shapecallback"]!==void 0&&this.r3i_(t["shapecallback"]);return this}r3i_(t){this.x0_=t;return this}e7_(){return this.dgt_}o3i_(){return this.e3i_}l3i_(){return this.A3i_}u3i_(t){if(t&&this.h3i_){const i=this.h3i_;let s=NA.clamp(+t.Uui_()[i["field"]],i["mindatavalue"],i["maxdatavalue"]);s=Math.round(i["minsize"]+(i["maxsize"]-i["minsize"])*(s-i["mindatavalue"])/(i["maxdatavalue"]-i["mindatavalue"]));this._q_.Be_(s)}return this._q_}a3i_(){return this.x0_}g3i_(){return this.n3i_}c3i_(){return this.h3i_}};i=t([_s("geotoolkit.map.features.templates.BaseTemplate")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRQcm9wZXJ0aWVzIjoiTl8iLCJzZXRQcm9wZXJ0aWVzIjoiZHRfIiwic2V0U2hhcGVDYWxsYmFjayI6InIzaV8iLCJnZXRTaGFwZSI6ImU3XyIsImdldEdlb21ldHJ5VG9TaGFwZSI6Im8zaV8iLCJnZXRHZW9tZXRyeVRvVGV4dCI6ImwzaV8iLCJnZXRUZXh0U2hhcGUiOiJ1M2lfIiwiZ2V0U2hhcGVDYWxsYmFjayI6ImEzaV8iLCJnZXRUZXh0U3RyYXRlZ3kiOiJnM2lfIn19LCJnZXRDbGFzc05hbWUiOiJEXyJ9");const y4=new ma,D4=function(t,i){return t-i},M4=function(t){return+t.XC_()},v4=function(t){if(typeof t=="function")return t;if(typeof t=="string"){let i;const s=function(s){i+=+s.Uui_()[t]||0};return function(t){i=0;t.j5i_().forEach(s);return i}}return M4};var b4=Ci(function(){let i=class t extends m4{constructor(t){(t=t||{})["shape"]=t["shape"]||new ma(0,0,25,25,dA.ne_,!0,cE,new hl("black"),new wr("white"));t["textshape"]=t["textshape"]||new YC({textstyle:"white",preservereadingorientation:!0,ispointingup:!0});t["geometrytoshape"]=t["geometrytoshape"]||new c4;t["geometrytotext"]=t["geometrytotext"]||t["geometrytoshape"];super(t);this.I3i_=t["expandedshape"]||new ma(0,0,25,25,dA.ne_,!0,cE,new hl("black"),new wr("green"));this.f3i_=t["expandedline"]||new Rd;this.f3i_.zA_({from:new lA,to:new lA});this.Cm_=t["colorprovider"]||null;this.C3i_=this.d3i_(t);this.B3i_=t["expandedcolorprovider"]||new bo({values:[0,1,2],colors:[new nA(255,0,0,255),new nA(0,255,0,255),new nA(0,0,255,255)]});this.r3i_(t["shapecallback"])}dt_(t){if((t=Es(t))==null)return this;super.dt_(t);t["size"]===void 0&&t["color"]===void 0||(this.C3i_=this.d3i_(t));t["expandedshape"]!==void 0&&(this.I3i_=t["expandedshape"]);t["colorprovider"]!==void 0&&(this.Cm_=t["colorprovider"]);t["expandedcolorprovider"]!==void 0&&(this.B3i_=t["expandedcolorprovider"]);t["expandedline"]!==void 0&&(this.f3i_=t["expandedline"]);return this}N_(){const t=super.N_();t["expandedshape"]=this.I3i_;t["colorprovider"]=this.Cm_;t["expandedcolorprovider"]=this.B3i_;t["expandedline"]=this.f3i_;return t}w3i_(){return this.I3i_}Q3i_(t,i,s){this.e3i_.apply(i.y5i_(),y4,s);const e=y4.lR_();this.e3i_.apply(t,y4,s);const A=y4.lR_();return this.f3i_.zA_({from:e,to:A})}r3i_(t){super.r3i_(((i,s,e)=>{if(this.C3i_!=null){const t=e&&!e.tk_();this.C3i_(i,s,t)}t!=null&&t.call(this,i,s,e)}));return this}d3i_(t){if(!t)return null;if(t["size"]&&Array.isArray(t["size"]["range"])&&t["size"]["range"].length>1){const i=t["size"]["range"];this.E3i_=i[0]<i[i.length-1];this.p3i_=v4(t["size"]["field"]);this.m3i_=i.sort(D4)}if(t["color"]&&(Array.isArray(t["color"]["range"])&&t["color"]["range"].length>1||t["color"]["range"]instanceof Mo)){this.y3i_=v4(t["color"]["field"]);this.D3i_=t["color"]["range"]}const i=this.y3i_!=null?(t,i)=>{i.M3i_==null&&(i.M3i_=1/0);i.v3i_==null&&(i.v3i_=-1/0);const s=this.y3i_(t);s<i.M3i_&&(i.M3i_=s);s>i.v3i_&&(i.v3i_=s);t.Uui_()["colorData"]=s}:null,s=t["shape"].getSize();return(t,e,A)=>{const n=t.Uui_();this.b3i_()&&n["size"]!=null?e.setSize(+n["size"],+n["size"]):e.setSize(s);if(!A)return;let h;if(e===this.I3i_)h=this.B3i_.getColor(t.tGt_());else if(this.Cm_!=null)h=this.Cm_.getColor(+t.XC_());else if(i!=null&&t.s3i_()){const s=t.s3i_().pvt_(i);h=Array.isArray(this.D3i_)?this.N3i_(+n["colorData"],this.D3i_,s.M3i_,s.v3i_):this.D3i_.getColor(+n["colorData"])}if(h!=null){const t=e.ct_();t?t.setColor(h):e.iQ_(h)}}}b3i_(){return this.p3i_!=null}S3i_(){return this.m3i_[this.m3i_.length-1]}G3i_(t,i){let s=this.p3i_(t);this.p3i_===M4&&s<i&&(s=i);return this.E3i_?s:-s}R3i_(t,i,s){let e;if(i===s)e=.5;else{if(t>=s)return this.m3i_[this.m3i_.length-1];if(t<=i)return this.m3i_[0];e=(t-i)/(s-i)}const A=e*(this.m3i_.length-1),n=A%1;if(n===0)return this.m3i_[A];const h=A-n,r=h+1;return(1-n)*this.m3i_[h]+n*this.m3i_[r]}N3i_(t,i,s,e){let A;if(s===e)A=.5;else{if(t>=e)return i[i.length-1];if(t<=s)return i[0];A=(t-s)/(e-s)}const n=A*(i.length-1),h=n%1;if(h===0)return i[n];const r=RA.cs_(i[n-h]),o=RA.cs_(i[n-h+1]),l=undefined,u=undefined,a=undefined,g=undefined;return"rgba("+((1-h)*r.Is_()+h*o.Is_())+","+((1-h)*r.Cs_()+h*o.Cs_())+","+((1-h)*r.fs_()+h*o.fs_())+","+((1-h)*r.ds_()+h*o.ds_())/255+")"}};i=t([_s("geotoolkit.map.features.templates.Aggregation")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRQcm9wZXJ0aWVzIjoiZHRfIiwiZ2V0UHJvcGVydGllcyI6Ik5fIiwic2V0U2hhcGVDYWxsYmFjayI6InIzaV8iLCJpc0R5bmFtaWNTaXplIjoiYjNpXyJ9fX0g");var N4=Ci(function(){let i=class t extends $n{constructor(){super(...arguments);this.eut_=[]}k3i_(t){if(this.eut_.length===0){this.eut_=t;return null}for(let i=0;i<t.length;++i)this.eut_.push(t[i]);return null}F3i_(t){const i=t["bbox"],s=t["filter"],e=function(t){return Array.isArray(t.x)||Array.isArray(t.y)?i.$s_(s4.R5i_(t)):i.contains(t.x,t.y)};return this.eut_.filter((function(t){const i=t.nt_(!0);return Array.isArray(i)?i.some(e)&&(!s||s(t)):e(i)&&(!s||s(t))}))}x3i_(t){let i;if(t instanceof Au)t.forEach((t=>{i=this.eut_.indexOf(t);~i&&this.eut_.splice(i,1)}));else{i=this.eut_.indexOf(t);~i&&this.eut_.splice(i,1)}return this}clear(){this.eut_=[];return this}};i=t([_s("geotoolkit.map.features.converters.BaseConverter")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzYXZlQ29udmVydGVkRmVhdHVyZXMiOiJrM2lfIiwiZ2V0RmVhdHVyZXMiOiJGM2lfIiwicmVtb3ZlRmVhdHVyZXMiOiJ4M2lfIn19fSAg");var S4=Ci({L3i_:"FeaturesUpdated"},2,"eyJGZWF0dXJlc1VwZGF0ZWQiOiJMM2lfIn0g");const G4=new p4,R4=function(t,i){return t.size>i.size?1:t.size<i.size?-1:t.Tgt_.x>i.Tgt_.x?1:t.Tgt_.x<i.Tgt_.x?-1:t.Tgt_.y>i.Tgt_.y?1:t.Tgt_.y<i.Tgt_.y?-1:0},k4=function(t,i){return i.U3i_-t.U3i_},F4=function(t,i,s,e){return{x:(t.x*i+s.x*e)/(i+e),y:(t.y*i+s.y*e)/(i+e)}},x4=function(t,i,s){let e=0,A=t.length-1,n;while(e<=A){n=e+A>>1;const h=s(t[n],i);if(h>0)A=n-1;else{if(!(h<0)){e=n;break}e=n+1}}t.splice(e,0,i);return e},L4=function(t,i){if(!t)return;const s=t.indexOf(i);s!==-1&&t.splice(s,1)};var U4=function(){var t;return class{constructor(t){this.fk_=t;this.Y3i_=t*t;this.fNt_={}}remove(t){this.fNt_[t._i][t._j]=null}add(t){t._i=Math.floor(t.Tgt_.x/this.fk_);t._j=Math.floor(t.Tgt_.y/this.fk_);this.fNt_[t._i]=this.fNt_[t._i]||{};if(this.fNt_[t._i][t._j]){const i=this.fNt_[t._i][t._j];this.fNt_[t._i][t._j]=T4.union(i,t);this.fNt_[t._i][t._j]._i=t._i;this.fNt_[t._i][t._j]._j=t._j;return i}this.fNt_[t._i][t._j]=t;return null}T3i_(t,i){let s=null,e=1/0;for(let i=t._i-1;i<=t._i+1;i++)if(this.fNt_[i])for(let A=t._j-1;A<=t._j+1;A++){if(!this.fNt_[i][A]||this.fNt_[i][A]===t)continue;const n=t.Tgt_.x-this.fNt_[i][A].Tgt_.x,h=t.Tgt_.y-this.fNt_[i][A].Tgt_.y,r=n*n+h*h;if(r<e&&r<this.Y3i_){e=r;s=this.fNt_[i][A]}}if(s!=null){this.fNt_[t._i]&&(this.fNt_[t._i][t._j]=null);this.fNt_[s._i][s._j]=null;i&&L4(i,s);const e=T4.union(t,s),A=this.add(e);i&&A&&L4(i,A);return this.T3i_(e,i)||e}return null}forEach(t){const i=this.fNt_,s=Object.keys(i);for(let e=0;e<s.length;++e){const A=Object.keys(i[s[e]]);for(let n=0;n<A.length;++n)i[s[e]][A[n]]&&t(i[s[e]][A[n]])}}}}(),Y4=function(){var t=class{constructor(t,i,s){this.fk_=t.S3i_()/s;this.K3i_=i;this.SSi_=t;this.xm_=s*s*4;this.fNt_={};this.H3i_=null;this.q3i_=null}remove(t){L4(this.fNt_[t._i][t._j],t)}add(t){t._i=Math.floor(t.Tgt_.x/this.fk_);t._j=Math.floor(t.Tgt_.y/this.fk_);t.J3i_(G4);t.U3i_=this.SSi_.G3i_(G4,this.K3i_);this.fNt_[t._i]=this.fNt_[t._i]||{};this.fNt_[t._i][t._j]=this.fNt_[t._i][t._j]||[];this.fNt_[t._i][t._j].push(t);return null}P3i_(t,i){this.H3i_=t;this.q3i_=i;return this}T3i_(t,i,s){const e=s?0:this.SSi_.R3i_(t.U3i_,this.H3i_,this.q3i_);let A=t,n=!1;for(let s=t._i-1;s<=t._i+1;s++)if(this.fNt_[s])for(let h=t._j-1;h<=t._j+1;h++)if(this.fNt_[s][h])for(let r=0;r<this.fNt_[s][h].length;){const o=this.fNt_[s][h][r];if(o===t){r++;continue}const l=this.SSi_.R3i_(o.U3i_,this.H3i_,this.q3i_),u=A.Tgt_.x-o.Tgt_.x,a=A.Tgt_.y-o.Tgt_.y,g=undefined,c=e+l;if((u*u+a*a)*this.xm_<c*c){A=T4.union(A,o);n=!0;i&&L4(i,o);this.fNt_[s][h].splice(r,1)}else r++}if(n){i&&L4(i,t);this.fNt_[t._i]&&L4(this.fNt_[t._i][t._j],t);s&&(A.BQt_=t.BQt_);this.add(A);return A}return null}forEach(t){const i=this.fNt_,s=Object.keys(i);for(let e=0;e<s.length;++e){const A=Object.keys(i[s[e]]);for(let n=0;n<A.length;++n)i[s[e]][A[n]]&&i[s[e]][A[n]].forEach(t)}}};return t}(),T4=function(){var t=class{constructor(t,i){this.elements=[t,i];this.iterator=new lu(t.features,i.features);this.weight=t.features.length+i.features.length;this.Tgt_=F4(t.Tgt_,t.features.length,i.Tgt_,i.features.length);this.X5i_=t.options.X5i_;this._i=null;this._j=null;this.U3i_=null;this.BQt_=null}V3i_(){return!0}_5i_(t){for(let i=0;i<this.elements.length;i++)this.elements[i]._5i_(t)}O3i_(){return this.elements[0].O3i_()}t3i_(t){return this.elements[0].t3i_(t)}xVt_(t){return this.elements[0].xVt_(t)}az_(t){if(t.V3i_()){const i=t;for(let t=0;t<i.elements.length;++t){this.iterator.concat(i.elements[t].features);this.elements.push(i.elements[t])}}else{const i=t;this.elements.push(i);this.iterator.concat(i.features)}this.Tgt_=F4(t.Tgt_,t.ept_(),this.Tgt_,this.weight);this.weight+=t.ept_();return this}J3i_(t){return t?t.JC_(this.ept_()).Pd_(this.Tgt_).Z5i_(this.iterator):new p4({geometry:this.Tgt_,id:this.ept_()+"",attributes:this.BQt_!=null?{size:this.BQt_}:{},O5i_:this.iterator,X5i_:this.X5i_,node:this})}ept_(){return this.weight}static union(i,s){if(i.V3i_()){const t=undefined;return i.az_(s)}if(s.V3i_()){const t=undefined;return s.az_(i)}return new t(i,s)}};return t}(),K4=function(){var i;let s=i=class t{constructor(t,i,s,e,A,n){this.features=Array.isArray(t)?t:[t];const h=this.features[0].nt_(!0);this.Tgt_=s!=null?s:h;this.Bti_=e!=null?e:new mA(this.Tgt_.x,this.Tgt_.y,this.Tgt_.x,this.Tgt_.y);this.parent=A!=null?A:null;this.size=n!=null?n:0;this.options=i;this.left=null;this.right=null;this.W3i_=!1;this._i=null;this._j=null;this.U3i_=null;this.BQt_=null}V3i_(){return!1}_5i_(t){this.W3i_=t}O3i_(){return this.options.z3i_}t3i_(t){if(typeof this.options.X3i_=="number")return this.options.X3i_;t=Math.min(t,this.options.X3i_.length-1);return this.options.X3i_[t]}xVt_(t){if(typeof this.options.radius=="number")return this.options.radius;t=Math.min(t,this.options.radius.length-1);return this.options.radius[t]}ept_(){return this.features.length}J2_(t,i,s,e,A){const n=A["filter"];if(!e)return this.features.filter((function(i){const s=i.nt_(!0);return(!t||t.contains(s.x,s.y))&&(!n||n(i))}));const h=[this];let r=new U4(i);while(h.length>0){const s=h.pop();if(!t||s.Bti_.$s_(t))if(s.size<=i)r.add(s);else{h.push(s.left);h.push(s.right)}}const o=[];r.forEach((function(t){o.push(t)}));o.sort(R4);while(o.length>0)r.T3i_(o.pop(),o);const l=A["layer"],u=l==null||l.Df_()||l.j3i_==null?null:l.j3i_(p4.D_());u instanceof b4&&(r=this.Z3i_(r,u,s,A["scale"]));let a;if(s>2)a=this._3i_(r,s);else{a=[];r.forEach((function(t){a.push(t.J3i_())}))}return n?a.filter(n):a}Z3i_(t,i,s,e){if(!i.b3i_())return t;const A=new Y4(i,s,e),n=[];t.forEach((function(t){A.add(t);n.push(t);t.checked=!1}));if(n.length===0)return t;n.sort(k4);let h=n[n.length-1].U3i_,r=n[0].U3i_;A.P3i_(h,r);for(let t=0;t<n.length;){const i=n[t];if(i.checked){t++;continue}const s=A.T3i_(i,n);if(s){const i=x4(n,s,k4);if(r>n[0].U3i_||h<n[n.length-1].U3i_){for(let t=0;t<n.length;t++)n[t].checked=!1;t=0}else t=Math.min(t,i);r=n[0].U3i_;h=n[n.length-1].U3i_;A.P3i_(h,r)}else{i.checked=!0;t++}}for(let t=0;t<n.length;t++)n[t].BQt_=i.R3i_(n[t].U3i_,h,r);return A}addElement(t){const s=t.nt_(!0);let e=this.$3i_(s);while(e.parent!=null&&e.parent.size<e.t4i_(s))e=e.parent;const A=new i(e.features.slice(),this.options,e.Tgt_,e.Bti_.clone(),e,e.size),n=new i(t,this.options,s,null,e,0);if(e.left!=null){A.left=e.left;A.right=e.right;A.left.parent=A;A.right.parent=A}e.left=A;e.right=n;do{e.u1i_(s);e.Tgt_=F4(e.Tgt_,e.features.length,s,1);e.size=Math.max(e.Bti_.Ts_(),e.Bti_.Ie_());e.features.push(t);e=e.parent}while(e!=null)}J3i_(t){return t!=null?t.JC_(this.ept_()).Pd_(this.Tgt_).Z5i_(Au.cN_(this.features)):this.features.length===1?this.features[0]:new p4({geometry:this.Tgt_,id:this.ept_(),attributes:this.BQt_!=null?{size:this.BQt_}:{},O5i_:Au.cN_(this.features),X5i_:this.options.X5i_,node:this})}_3i_(t,i){const s=[],e=function(i){const e=[i];while(e.length>0)if((i=e.pop()).left!=null){e.push(i.left);e.push(i.right)}else{i._i=Math.floor(i.Tgt_.x/t.fk_);i._j=Math.floor(i.Tgt_.y/t.fk_);s.push(i)}},A=[];t.forEach((function(t){if(t.ept_()<i){if(t.V3i_()){const i=t;for(let t=0;t<i.elements.length;++t)e(i.elements[t])}else e(t);A.push(t)}}));A.forEach((function(i){t.remove(i)}));const n=[];while(s.length>0){const i=s.pop(),e=undefined;if(t.T3i_(i,null,!0)){Array.prototype.push.apply(s,n);n.length=0}else n.push(i)}const h=[],r=function(t){h.push(t.J3i_())};t.forEach(r);n.forEach(r);return h}t4i_(t){const i=Math.min(this.Bti_.x,t.x),s=Math.max(this.Bti_.Qe_(),t.x),e=Math.min(this.Bti_.y,t.y),A=Math.max(this.Bti_.pe_(),t.y);return Math.max(s-i,A-e)}u1i_(t){if(t.x<this.Bti_.we_()){this.Bti_.de_(this.Bti_.Qe_()-t.x);this.Bti_.setX(t.x)}else t.x>this.Bti_.Qe_()&&this.Bti_.de_(t.x-this.Bti_.we_());if(t.y<this.Bti_.Ee_()){this.Bti_.Be_(this.Bti_.pe_()-t.y);this.Bti_.setY(t.y)}else t.y>this.Bti_.pe_()&&this.Bti_.Be_(t.y-this.Bti_.Ee_())}$3i_(t){const i=[this];let s;const e={distance:1/0,node:null};this.distance=this.i4i_(t);while(i.length>0){s=i.pop();if(!(s.distance>=e.distance))if(s.left!=null){s.left.distance=s.left.i4i_(t);s.right.distance=s.right.i4i_(t);if(s.left.distance<s.right.distance){i.push(s.right);i.push(s.left)}else{i.push(s.left);i.push(s.right)}}else{e.distance=s.distance;e.node=s}}return e.node}i4i_(t){const i=Math.max(this.Bti_.x-t.x,t.x-this.Bti_.Qe_(),0),s=Math.max(this.Bti_.y-t.y,t.y-this.Bti_.pe_(),0);return i*i+s*s}};s=i=t([Zs(Node)],s);return s}(),H4=Ci(function(){let i=class t extends N4{constructor(t){super();this.s4i_=1;this.bft_=2;this.xv_=!0;this.VM_=0;this.e4i_=3;this.Xz_=30;this._cache={options:{},response:null};this.A4i_=null;this.n4i_=null;this.h4i_=t=>{this._cache.response=this.r4i_(this._cache.options);this._cache.timeout=null;this.notify(S4.L3i_,this,t)};this.setOptions(t)}k3i_(t){const i=[];let s=!1;for(let e=0;e<t.length;e++){const A=t[e];if(A instanceof w4)if(this.A4i_==null){this.A4i_=new K4(A,{z3i_:this.bft_,radius:this.Xz_,X3i_:this.e4i_,X5i_:this});s=!0}else{this.A4i_.addElement(A);s=!0}else i.push(A)}s&&this._cache.options["bbox"]!=null&&(this._cache.response=this.r4i_(this._cache.options));return i}F3i_(t){if(this._cache.response==null){this._cache.response=this.r4i_(t);this._cache.options=t}else if(!t["bbox"]||!t["bbox"].Ce_(this._cache.options["bbox"])||!NA.equals(t["scale"],this._cache.options["scale"])){this._cache.options=t;if(this.VM_<=0)this.h4i_(!0);else{this._cache.timeout!=null&&clearTimeout(this._cache.timeout);this._cache.timeout=setTimeout(this.h4i_,this.VM_)}}const i=t["filter"];return i!=null&&this._cache.response!=null?this._cache.response.filter(i):this._cache.response}x3i_(t){this.o4i_==null&&(this.o4i_=t=>{if(this.A4i_==null||!(t instanceof w4))return;let i=this.A4i_;while(i.left!=null)i=i.left.features.indexOf(t)>-1?i.left:i.right;if(i.features.length===1&&i.features[0]===t){const s=i.parent;if(s==null)this.A4i_=null;else{const e=s.left===i?s.right:s.left,A=s.parent;if(A===null){this.A4i_.left=null;this.A4i_.right=null;e.parent=null;i.parent=null;this.A4i_=e}else{A.left===s?A.left=e:A.right=e;e.parent=A;i.parent=null;i=A;do{i.Bti_=i.left.Bti_.clone().union(i.right.Bti_);i.Tgt_=F4(i.left.Tgt_,i.left.features.length,i.right.Tgt_,i.right.features.length);i.size=Math.max(i.Bti_.Ts_(),i.Bti_.Ie_());i.features.splice(i.features.indexOf(t),1);i=i.parent}while(i!=null)}}}});t instanceof Au?t.forEach(this.o4i_):this.o4i_(t);this._cache.options!=null&&(this._cache.response=this.r4i_(this._cache.options));return this}JV_(){return Ss({mindistance:this.s4i_,min:this.bft_,enabled:this.xv_,timeout:this.VM_,amountaggregations:this.e4i_,radius:this.Xz_},["amountAggregations"],"Aggregator.getOptions")}setOptions(t){if(!t)return this;(t=ds(t))["mindistance"]!==void 0&&(this.s4i_=t["mindistance"]);t["min"]!==void 0&&(this.bft_=t["min"]);t["enabled"]!==void 0&&(this.xv_=t["enabled"]);t["timeout"]!==void 0&&(this.VM_=t["timeout"]);t["amountaggregations"]!==void 0&&(this.e4i_=t["amountaggregations"]);t["radius"]!==void 0&&(this.Xz_=t["radius"]);this._cache.response=null;return this}r4i_(t){this.n4i_=null;const i=t["bbox"],s=t["scale"],e=this.s4i_/s,A=i?i.clone().Le_(i.Ie_()*.1,i.Ts_()*.1):null;return this.A4i_==null?null:this.A4i_.J2_(A,e,this.bft_,this.xv_,t)}pvt_(t,i){if(this.n4i_==null){this.n4i_={};i=i||this._cache.response||[];for(let s=0;s<i.length;s++){const e=i[s];e instanceof p4&&t(e,this.n4i_)}}return this.n4i_}clear(){super.clear();this._cache.timeout!=null&&clearTimeout(this._cache.timeout);this._cache={options:{},response:null};this.A4i_=null;return this}};i=t([_s("geotoolkit.map.features.converters.Aggregator")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzYXZlQ29udmVydGVkRmVhdHVyZXMiOiJrM2lfIiwiZ2V0RmVhdHVyZXMiOiJGM2lfIiwicmVtb3ZlRmVhdHVyZXMiOiJ4M2lfIiwiZ2V0T3B0aW9ucyI6IkpWXyJ9fX0g");var q4=Ci(function(){let i=class t{constructor(){this.l4i_=[];this.u4i_={}}abort(t){let i,s;if(t==null){for(i=0;i<this.l4i_.length;i++)this.a4i_(this.l4i_[i]);this.l4i_=[];s=Object.keys(this.u4i_)}else{if(!this.u4i_[t])return this;s=[t]}for(i=0;i<s.length;i++){this.a4i_(this.u4i_[s[i]]);delete this.u4i_[s[i]]}return this}a4i_(t){return this}g4i_(t,i){t!=null?this.u4i_[t]=i:this.l4i_.push(i);return this}c4i_(t){return this.u4i_[t]}I4i_(t,i){if(t!=null){this.u4i_[t]&&delete this.u4i_[t];return this}const s=this.l4i_.indexOf(i);s>=0&&this.l4i_.splice(s,1);return this}f4i_(){return this.l4i_.length>0||Object.keys(this.u4i_).length>0}clone(){return Wi(this)}};i.prototype.send=Zi;i=t([_s("geotoolkit.map.sources.connectors.AbstractConnector")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJhYm9ydENvbm5lY3Rpb24iOiJhNGlfIiwiYWRkQ29ubmVjdGlvbiI6Imc0aV8iLCJnZXRDb25uZWN0aW9uIjoiYzRpXyIsInJlbW92ZUNvbm5lY3Rpb24iOiJJNGlfIiwiaXNMb2FkaW5nIjoiZjRpXyJ9fSwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");const J4=6,P4=function(t,i){const s=t[1]["priority"],e=i[1]["priority"];return s===e?0:e-s};var V4=Ci(function(){let i=class t extends q4{constructor(t){super();this.C4i_=[];this.d4i_=[];this.B4i_={};this.ytt_=t&&t["httpservice"]?t["httpservice"]:FB.Ai_().u1_()}send(t,i,s){if(!t){s(new Error(this.D_()+": No url provided"));return}let e;const A=(i=qi(i,{},!0))["key"];if(this.B4i_[A]){e=this.d4i_.indexOf(this.B4i_[A]);this.d4i_.splice(e,1)}if(this.C4i_.length<J4)this.w4i_(t,i,((i,e,A)=>{const n=this.C4i_.indexOf(A);n>=0&&this.C4i_.splice(n,1);if(this.d4i_.length>0){const t=this.d4i_.shift();this.B4i_[t[1]["key"]]&&delete this.B4i_[t[1]["key"]];this.send(t[0],t[1],t[2])}i!=null?CB.qE_(i)||i.code===DB.n1_||s(new Error(this.D_()+": "+(i.message?i.message:"")+"("+t+")"),null):s(i,e)}));else{const n=[t,i,s];if(i["priority"]==null){i["priority"]=-1/0;this.d4i_.push(n)}else{e=NA.findIndex(n,this.d4i_,0,this.d4i_.length-1,P4);if(e>=0){for(e++;e<this.d4i_.length;e++)if(P4(this.d4i_[e],n)!==0){e--;break}}else e=~e;this.d4i_.splice(e,0,n)}A!=null&&(this.B4i_[A]=n)}}w4i_(t,i,s){const e=i["key"];delete this.B4i_[e];const A=i["cancel"]||new CB;this.g4i_(e,A);this.ytt_.request({url:t,method:i["method"]||"get",headers:i["headers"],responsetype:i["responsetype"]?i["responsetype"]:"",cancel:A}).then((i=>{this.I4i_(e,A);return i.status>=200&&i.status<400||i.status===0?s(null,i["data"],A):s(new Error(this.D_()+": "+i.statusText+"("+t+")"),null,A)}),(t=>{this.I4i_(e,A);s(t,null,A)}));this.C4i_.push(A)}abort(t){if(t!=null){let i;const s=this.c4i_(t);if(s){super.abort(t);i=this.C4i_.indexOf(s);this.C4i_.splice(i,1)}else if(this.B4i_[t]){i=this.d4i_.indexOf(this.B4i_[t]);this.d4i_.splice(i,1);delete this.B4i_[t]}}else{super.abort();this.C4i_=[];this.d4i_=[];this.B4i_={}}return this}a4i_(t){t.cancel("aborted");return this}};i=t([_s("geotoolkit.map.sources.connectors.HttpRequest")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJhYm9ydENvbm5lY3Rpb24iOiJhNGlfIn19fSAg");const O4=new lA;var W4=Ci(function(){let i=class t extends t4{G5i_(t){this.E5i_=[];const i=this.qd_,s=this.E5i_;for(let e=0;e<i.length;e++){const A=i[e]["x"],n=i[e]["y"];O4.vs_(A,n);t.J5i_(O4,O4);s.push({x:O4.getX(),y:O4.getY()})}return this}N5i_(){return!1}S5i_(){return!0}};i=t([_s("geotoolkit.map.features.MultiPoint")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJhcHBseU1hcENTIjoiRzVpXyJ9fX0g");const z4=new lA;var X4=Ci(function(){let i=class t extends t4{G5i_(t){const i=this.qd_,s=i["x"],e=i["y"],A=[],n=[];for(let i=0;i<s.length;++i){z4.vs_(s[i],e[i]);t.J5i_(z4,z4);A.push(z4.getX());n.push(z4.getY())}this.E5i_={x:A,y:n};return this}};i=t([_s("geotoolkit.map.features.LineString")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJhcHBseU1hcENTIjoiRzVpXyJ9fX0g");const j4=new lA;var Z4=Ci(function(){let i=class t extends t4{G5i_(t){this.E5i_=[];const i=this.qd_,s=this.E5i_;for(let e=0;e<i.length;e++){const A=i[e]["x"],n=i[e]["y"],h=[],r=[];for(let i=0;i<A.length;++i){j4.vs_(A[i],n[i]);t.J5i_(j4,j4);h.push(j4.getX());r.push(j4.getY())}s.push({x:h,y:r})}return this}S5i_(){return!0}};i=t([_s("geotoolkit.map.features.MultiLineString")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJhcHBseU1hcENTIjoiRzVpXyJ9fX0g");const _4=new lA;var $4=Ci(function(){let i=class t extends t4{G5i_(t){const i=this.qd_,s=i["x"],e=i["y"],A=[],n=[];for(let i=0;i<s.length;++i){_4.vs_(s[i],e[i]);t.J5i_(_4,_4);A.push(_4.getX());n.push(_4.getY())}this.E5i_={x:A,y:n};return this}en_(){return!0}};i=t([_s("geotoolkit.map.features.Polygon")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJhcHBseU1hcENTIjoiRzVpXyJ9fX0g");const t8=new lA;var i8=Ci(function(){let i=class t extends t4{G5i_(t){this.E5i_=[];const i=this.qd_,s=this.E5i_;for(let e=0;e<i.length;e++){const A=i[e]["x"],n=i[e]["y"],h=[],r=[];for(let i=0;i<A.length;++i){t8.vs_(A[i],n[i]);t.J5i_(t8,t8);h.push(t8.getX());r.push(t8.getY())}s.push({x:h,y:r})}return this}en_(){return!0}S5i_(){return!0}};i=t([_s("geotoolkit.map.features.MultiPolygon")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJhcHBseU1hcENTIjoiRzVpXyJ9fX0g");const s8={},e8=new mA;s8[p4.D_()]=0;s8[w4.D_()]=1;s8[W4.D_()]=1;s8[X4.D_()]=2;s8[Z4.D_()]=2;s8[$4.D_()]=3;s8[i8.D_()]=3;const A8=function(t,i,s){if(!(i<0))for(let e=0;e<t.length;++e){if(i<t[e].length){t.splice(e,1,t[e].substr(0,i),s,t[e].substr(i+s.length));return}i-=t[e].length}};var n8=function(){var i;let s=i=class t{static Q4i_(t,i,s){Array.isArray(t[i])||(t[i]=t[i]==null?[]:[t[i]]);const e=t[i];for(let t=0;t<e.length;++t)if(e[t]instanceof s)return e[t];e.push(new s);return e[e.length-1]}static E4i_(t,i){return s8[t.D_()]-s8[i.D_()]}static p4i_(t){let s,e=0;if(Array.isArray(t))for(s=0;s<t.length;++s)e+=i.p4i_(t[s]);else{const A=t["x"],n=t["y"],h=t["clip"];if(Array.isArray(h))for(s=0;s<h.length;++s)e+=i.p4i_(h[s]);if(Array.isArray(A)){const t=n;for(s=0;s<A.length;++s)e+=A[s]+t[s]}else e+=A+n}return e}static m4i_(t,s){let e;if(Array.isArray(t)){const A=t.length;if(!Array.isArray(s)||s.length!==A)return!1;for(e=0;e<A;++e)if(!i.m4i_(t[e],s[e]))return!1;return!0}if(Array.isArray(s))return!1;const A=Array.isArray(t["x"]),n=undefined;if(A!==Array.isArray(s["x"]))return!1;const h=Array.isArray(t["y"]),r=undefined;if(h!==Array.isArray(s["y"]))return!1;const o=t["clip"],l=s["clip"];if(o!=null!=(l!=null))return!1;if(A){const i=t["x"],A=s["x"];for(e=0;e<i.length;++e)if(i[e]!==A[e])return!1}else if(t["x"]!==s["x"])return!1;if(h){const i=t["y"],A=s["y"];for(e=0;e<i.length;++e)if(i[e]!==A[e])return!1}else if(t["y"]!==s["y"])return!1;return o==null||i.m4i_(o,l)}static y4i_(t,s){if(!Array.isArray(s)){const e=t.Uui_(),A=s.Uui_(),n=t.nt_(),h=s.nt_();return JSON.stringify(e)===JSON.stringify(A)&&i.m4i_(n,h)}for(let e=0;e<s.length;++e)if(i.y4i_(t,s[e]))return!0;return!1}static D4i_(t){const i=[];if(t==null)return i;const s=Object.keys(t);for(let e=0;e<s.length;++e){const A=s[e];A!=="connector"&&t[A]!=null&&i.push(A)}return i}static M4i_(t,i){const s=[];for(const t in i)s.push(t+"="+i[t]);if(s.length===0)return t;const e=undefined;return(t.indexOf("?")>=0?t+"&":t+"?")+s.join("&")}static v4i_(t,i){const s=[t];for(let e=0;e<i.length;++e)A8(s,t.indexOf(i[e]),i[e]);return s.filter((function(t){return t!==""}))}static dwt_(t,i){const s=t.Ie_()*i.Ie_(),e=t.Ts_()*i.Ts_(),A=t.uR_(),n=t.aR_();switch(t.GE_()){case dA.ie_:e8.ce_(A,n,A+s,n+e);break;case dA.se_:e8.ce_(A,n,A+s,n-e);break;case dA.ee_:e8.ce_(A,n,A-s,n+e);break;case dA.Ae_:e8.ce_(A,n,A-s,n-e);break;case dA.le_:e8.ce_(A+s/2,n,A-s/2,n+e);break;case dA.re_:e8.ce_(A+s/2,n,A-s/2,n-e);break;case dA.he_:e8.ce_(A,n+e/2,A+s,n-e/2);break;case dA.oe_:e8.ce_(A,n+e/2,A-s,n-e/2);break;default:e8.ce_(A+s/2,n+e/2,A-s/2,n-e/2)}return e8}};s=i=t([_s("geotoolkit.map.util.FeatureUtil")],s);return s}();var h8=Ci(function(){let i=class t extends $n{constructor(t){super();this._i=0;this.b4i_={};this.N4i_={};if(t){this.S4i_=t["connector"]||new V4;const i=n8.D4i_(t);for(let s=0;s<i.length;++s)this.G4i_(i[s],t[i[s]])}else this.S4i_=new V4}B_t_(t){t!=null&&(this.N4i_=t);return this}R4i_(t,i){if(t!=null&&t.startsWith("http"))return t;if((i=i||this.N4i_.url)==null)return null;let s;if(Array.isArray(i)){s=i[this._i];this._i=(this._i+1)%i.length}else s=i;return n8.M4i_(t?s+t:s,this.b4i_)}query(t){const i=(t,i)=>{t?this.onError(t):this.Df_()||this.parse(i)};if(Array.isArray(this.N4i_.url))for(let s=0;s<this.N4i_.url.length;++s)this.S4i_.send(this.R4i_(),t,i);else this.S4i_.send(this.R4i_(),t,i);return this}parse(t){return this}dispose(){this.abort();super.dispose()}onError(t){t&&ki(t)}abort(t){this.S4i_!=null&&this.S4i_.abort(t);return this}f4i_(){return this.S4i_.f4i_()}G4i_(t,i){this.b4i_[t.toLowerCase()]=typeof i=="string"?encodeURI(i):i+"";return this}k4i_(t){if(t==null)return this;for(const i in t.b4i_)t.b4i_.hasOwnProperty(i)&&(this.b4i_[i]=t.b4i_[i]);return this}clone(){return Wi(this)}b_(t,i){this.N4i_=i===!0?Pi(t.N4i_,this.N4i_):qi(t.N4i_,this.N4i_);this.S4i_=t.S4i_.clone();this.b4i_=i===!0?Pi(t.b4i_,this.b4i_):qi(t.b4i_,this.b4i_);return this}fhi_(){return this.S4i_}};i=t([_s("geotoolkit.map.sources.formats.AbstractFormat")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpc0xvYWRpbmciOiJmNGlfIiwic2V0UXVlcnlQYXJhbWV0ZXIiOiJHNGlfIiwiY2xvbmVRdWVyeVBhcmFtZXRlcnMiOiJrNGlfIiwiY29weUNvbnN0cnVjdG9yIjoiYl8iLCJnZXRDb25uZWN0b3IiOiJmaGlfIn19fSAg");var r8=Ci(function(){var t=class{};t.prototype.F4i_=Zi;return t}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRGZWF0dXJlSWQiOiJGNGlfIn19fSAg");var o8=Ci(function(){let i=class t{constructor(t){this.x4i_=t}F4i_(t){const i=t[this.x4i_];return typeof i=="boolean"?+i:i}L4i_(){return this.x4i_}};i=t([Zs(r8),_s("geotoolkit.map.features.strategies.IdByAttribute")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRGZWF0dXJlSWQiOiJGNGlfIiwiZ2V0QXR0cmlidXRlTmFtZSI6Ikw0aV8ifX0sImdldENsYXNzTmFtZSI6IkRfIn0g");let l8=new lA;const u8=function(t){return Math.round(t*100)/100};var a8=Ci(function(){var i;let s=i=class t{static parse(t,s,e,A){s||(s=new o8("name"));A||(A=[0,1]);const n=Array.isArray(t)?t:[t],h=[];for(let t=0;t<n.length;++t)i.U4i_(n[t],s,e,A,h);return h}static U4i_(t,s,e,A,n){if(t["crs"]!=null){const s=i.Y4i_(t["crs"],e);e=s.T4i_;A=s.K4i_||A}switch(t["type"]){case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":i.H4i_(t,e,A,null,{},n);break;case"Feature":const h=t["properties"]||{},r=s.F4i_(h)||t["id"];i.H4i_(t["geometry"],e,A,r,h,n);break;case"FeatureCollection":const o=t["features"];for(let t=0;t<o.length;++t)i.U4i_(o[t],s,e,A,n)}}static H4i_(t,s,e,A,n,h){let r,o,l=null;if(!t){o=new w4({id:A,geometry:{x:NaN,y:NaN},attributes:n});h&&h.push(o);return o}switch(t["type"]){case"Point":r=i.q4i_(t["coordinates"],s,e);l=w4;break;case"LineString":r=i.J4i_(t["coordinates"],s,e);l=X4;break;case"Polygon":r=i.P4i_(t["coordinates"],s,e);l=$4;break;case"MultiPoint":r=i.V4i_(i.q4i_,t["coordinates"],s,e);l=W4;break;case"MultiLineString":r=i.V4i_(i.J4i_,t["coordinates"],s,e);l=Z4;break;case"MultiPolygon":r=i.V4i_(i.P4i_,t["coordinates"],s,e);l=i8;break;case"GeometryCollection":const o=t["geometries"],u=JSON.stringify(n);for(let t=0;t<o.length;++t)i.H4i_(o[t],s,e,A,JSON.parse(u),h);break}if(l!=null){o=new l({id:A,geometry:r,attributes:n});h&&h.push(o);return o}return null}static V4i_(t,i,s,e){const A=[];for(let n=0;n<i.length;n++)A.push(t(i[n],s,e));return A}static P4i_(t,s,e){const A=i.J4i_(t[0],s,e);if(t.length>1){const n=s4.R5i_(A);A["clip"]=[n];for(let n=1;n<t.length;++n)A["clip"].push(i.J4i_(t[n],s,e))}return A}static J4i_(t,i,s){const e=[],A=[];for(let n=0;n<t.length;n++){l8.vs_(t[n][s[0]],t[n][s[1]]);i&&(l8=i(l8,l8));e.push(l8.getX());A.push(l8.getY())}return{x:e,y:A}}static q4i_(t,i,s){l8.vs_(t[s[0]],t[s[1]]);i&&(l8=i(l8,l8));return{x:l8.getX(),y:l8.getY()}}static Y4i_(t,i){const s=t["properties"];let e=null;const A=function(t){const i=t.split(":");if(i.length===7){const t=i[4],s=i[6];if(t==="EPSG")return+s;if(t==="OGC"&&(s==="CRS84"||s==="CRS83"||s==="CRS27"))return 4269}return null};switch(t["type"]){case"EPSG":e=+s["code"];break;case"OGC":e=A(s["urn"]);break;case"name":e=A(s["name"])}const n=X3.sx_();let h=null;switch(e){case 102100:case 3857:h=n.l5i_(B3.L2i_);break;case 4326:case 4269:h=n.l5i_(B3.U2i_)}return{T4i_:h!=null?function(t,s){const e=h.uI_(t.x,t.y,s);return i!=null?i(e):e}:i,K4i_:t["coordinate_order"]||s["coordinate_order"]}}static O4i_(t,s,e){e||(e=[0,1]);const A=[],n=function(t){if(t instanceof p4){const n=t.j5i_();n.reset();while(n.Hs_())A.push(i.W4i_(n.next(),s,e))}else A.push(i.W4i_(t,s,e))};t instanceof Au||Array.isArray(t)?t.forEach(n):n(t);return A.length===1?A[0]:{type:"FeatureCollection",features:A}}static W4i_(t,s,e){const A={type:"Feature",properties:t.Uui_(),geometry:{}},n=t.nt_(!0);if(t instanceof w4){A["geometry"]["type"]="Point";A["geometry"]["coordinates"]=i.z4i_(n,s,e)}else if(t instanceof X4){A["geometry"]["type"]="LineString";A["geometry"]["coordinates"]=i.X4i_(n,s,e)}else if(t instanceof $4){A["geometry"]["type"]="Polygon";A["geometry"]["coordinates"]=i.j4i_(n,s,e)}else if(t instanceof W4){A["geometry"]["type"]="MultiPoint";A["geometry"]["coordinates"]=i.V4i_(i.z4i_,n,s,e)}else if(t instanceof Z4){A["geometry"]["type"]="MultiLineString";A["geometry"]["coordinates"]=i.V4i_(i.X4i_,n,s,e)}else if(t instanceof i8){A["geometry"]["type"]="MultiPolygon";A["geometry"]["coordinates"]=i.V4i_(i.j4i_,n,s,e)}return A}static z4i_(t,i,s){const e=[];l8.vs_(t["x"],t["y"]);i&&(l8=i(l8,l8));e[s[0]]=u8(l8.getX());e[s[1]]=u8(l8.getY());return e}static X4i_(t,i,s){const e=[],A=t["x"],n=t["y"];for(let t=0;t<A.length;++t){e[t]=[];l8.vs_(A[t],n[t]);i&&(l8=i(l8,l8));e[t][s[0]]=u8(l8.getX());e[t][s[1]]=u8(l8.getY())}return e}static j4i_(t,i,s){const e=[];let A;const n=t["x"],h=t["y"];for(A=0;A<n.length;++A){e[A]=[];l8.vs_(n[A],h[A]);i&&(l8=i(l8,l8));e[A][s[0]]=u8(l8.getX());e[A][s[1]]=u8(l8.getY())}const r=[e],o=t["clip"];if(Array.isArray(o))for(let t=0;t<o.length;++t){const e=o[t]["x"],n=o[t]["y"],h=[];for(A=0;A<e.length;++A){h[A]=[];l8.vs_(e[A],n[A]);i&&(l8=i(l8,l8));h[A][s[0]]=u8(l8.getX());h[A][s[1]]=u8(l8.getY())}r.push(h)}return r}};s=i=t([_s("geotoolkit.map.util.GeoJSON")],s);return s}(),2,"eyJ0b0dlb0pTT04iOiJPNGlfIiwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");var g8=Ci({Z4i_:"FeatureAdded",_4i_:"FeatureRemoved",$4i_:"FeaturesCleared",PV_:"ImageLoaded",t8i_:"ImageCleared",i8i_:"TilesUpdated",s8i_:"InfoUpdated"},2,"eyJGZWF0dXJlQWRkZWQiOiJaNGlfIiwiRmVhdHVyZVJlbW92ZWQiOiJfNGlfIiwiRmVhdHVyZXNDbGVhcmVkIjoiJDRpXyIsIkltYWdlTG9hZGVkIjoiUFZfIiwiSW1hZ2VDbGVhcmVkIjoidDhpXyIsIlRpbGVzVXBkYXRlZCI6Imk4aV8iLCJJbmZvVXBkYXRlZCI6InM4aV8ifSAg");var c8=function(){let i=class t extends h8{parse(t){let i;if(typeof t=="string")try{i=JSON.parse(t)}catch(t){this.onError(t);return this}else i=t;const s=this.N4i_.e8i_,e=a8.parse(i,this.N4i_.id,s.transform.bind(s));this.notify(g8.Z4i_,this,e);return this}};i=t([_s("geotoolkit.map.sources.formats.GeoJSON")],i);return i}();var I8=Ci({All:"All",A8i_:"Bbox",n8i_:"Tile",h8i_:"Grid"},2,"eyJCYm94IjoiQThpXyIsIlRpbGUiOiJuOGlfIiwiR3JpZCI6Img4aV8ifSAg");var f8=Ci(function(){let i=class t extends $n{constructor(t){super();t=t||{};this.r8i_=t["ondataloaded"];this.o8i_=t["ondatafailed"];const i=X3.sx_().l5i_(t["system"]||B3.L2i_),s=X3.sx_().l5i_(B3.L2i_);this.N4i_=this.N4i_||{};this.N4i_.e8i_=new Z3(i,s);this.N4i_.l8i_=new Z3(s,i);this.N4i_.data={};this.N4i_.url=null;this.u8i_=null;this.a8i_=null;this.g8i_=null;this.c8i_=null;this.I8i_=null;this.f8i_=null;this.C8i_=null;this.d8i_=!1;const e=t["format"];e!=null&&e.B_t_(this.N4i_);this.B8i_(e);this.w8i_(t["loader"]);const A=t["url"];A!=null&&this.Q8i_(A)}query(t,i){if(this.u8i_==null||t.isEmpty())return this;const s=i.if_().BI_();if(this.a8i_==null||this.a8i_.E8i_()){this.p8i_={Bti_:t,vZi_:i,scale:s};this.u8i_.query(t,i)}else if(this.p8i_==null){this.p8i_={Bti_:t,vZi_:i,scale:s};this.m8i_()}else if(NA.equals(s,this.p8i_.scale)&&i===this.p8i_.vZi_)this.p8i_.Bti_.union(t);else{this.p8i_.Bti_=t;this.p8i_.scale=s;this.p8i_.vZi_=i}this.y8i_(!this.f4i_());return this}Q8i_(t){if(this.N4i_.url===t)return this;if(t==null)this.N4i_.url=t;else{const i=Array.isArray(t)?t:[t];for(let t=0;t<i.length;){const s=i[t],e=s.match(/{(\w+)-(\w+)}/);if(e){i.splice(t,1);const A=!isNaN(+e[1]);let n=A?+e[1]:e[1].charCodeAt(0),h=A?+e[2]:e[2].charCodeAt(0);if(h<n){const t=n;n=h;h=t}for(let t=n;t<=h;t++){const n=s.replace(e[0],A?t+"":String.fromCharCode(t));i.push(n)}}else t++}this.N4i_.url=i.length>1?i:i[0]}this.clear();return this}E8i_(){return this.a8i_==null||this.a8i_.E8i_()}D8i_(){return this.N4i_.url}m8i_(){if(this.g8i_==null)if(this.a8i_==null)this.g8i_=Promise.resolve(this);else{this.g8i_=new Promise(((t,i)=>{this.I8i_=t;this.f8i_=i})).then(this.M8i_.bind(this),this.v8i_.bind(this));this.a8i_.query().then(this.I8i_,this.f8i_)}return this.g8i_}b8i_(){if(this.c8i_==null){this.c8i_=new Promise((t=>{this.C8i_=t}));!this.d8i_&&this.D8i_()||this.y8i_(!0)}return this.c8i_}N8i_(){return this.d8i_}S8i_(){return this.N4i_.data}y8i_(t){this.d8i_=t;if(t&&this.C8i_){this.C8i_(this);this.C8i_=null}else t||!this.c8i_||this.C8i_||(this.c8i_=null);return this}rt_(){return this.N4i_.FMt_}G8i_(t){const i=undefined;if((t=X3.sx_().l5i_(t))!==this.N4i_.l8i_.B5i_()&&t){this.N4i_.l8i_.Q5i_(t);this.N4i_.e8i_.w5i_(t)}return this}l5i_(){return this.N4i_.l8i_.B5i_()}R8i_(t){const i=undefined;if((t=X3.sx_().l5i_(t))!==this.N4i_.e8i_.B5i_()&&t){this.N4i_.e8i_.Q5i_(t);this.N4i_.l8i_.w5i_(t);this.a8i_==null&&(this.N4i_.FMt_=t.E2i_())}return this}k8i_(){return this.N4i_.e8i_.B5i_()}w5i_(t){const i=undefined;if((t=X3.sx_().l5i_(t))!==this.N4i_.e8i_.d5i_()){this.N4i_.e8i_.w5i_(t);this.N4i_.l8i_.Q5i_(t)}return this}d5i_(){return this.N4i_.e8i_.d5i_()}F8i_(){return this.N4i_.e8i_}x8i_(){return this.N4i_.l8i_}w8i_(t){t!=null?t.B_t_(this.N4i_):this.N4i_.FMt_=this.k8i_().E2i_();this.a8i_=t;return this}M8i_(){if(this.Df_())return this;this.I8i_=null;this.f8i_=null;typeof this.r8i_=="function"&&this.r8i_();this.notify(rh.nC_,this,this.N4i_.FMt_);if(this.p8i_!=null){const t=this.p8i_.vZi_;if(t.Df_())return this;NA.equals(this.p8i_.scale,t.if_().BI_())?this.query(this.p8i_.Bti_,t):this.query(t.ot_(),t)}else this.y8i_(!this.f4i_());return this}v8i_(t){this.I8i_=null;this.f8i_=null;typeof this.o8i_=="function"&&this.o8i_(t);this.y8i_(!0);return this}L8i_(t,i){const s=this;typeof s[t]=="function"&&s[t](i);return this}clear(){if(this.u8i_==null)return this;this.y8i_(!1);if(this.a8i_==null){this.update();return this}this.a8i_.clear();if(this.I8i_)this.a8i_.query().then(this.I8i_,this.f8i_);else if(this.g8i_!=null){this.g8i_=null;this.m8i_()}return this}update(){if(this.u8i_==null)return this;this.y8i_(!1);this.u8i_.clear();this.p8i_!=null&&this.query(this.p8i_.Bti_,this.p8i_.vZi_);return this}dispose(){this.r8i_=null;this.o8i_=null;this.c8i_=null;this.C8i_=null;this.g8i_=null;this.I8i_=null;this.f8i_=null;this.a8i_!=null&&this.a8i_.clear();this.u8i_!=null&&this.u8i_.dispose();super.dispose()}f4i_(){return this.a8i_!=null&&!this.a8i_.E8i_()||this.u8i_!=null&&this.u8i_.f4i_()}U8i_(){return this.a8i_!=null?this.a8i_.U8i_():null}Y8i_(){return this.a8i_}G4i_(t,i){if(typeof t=="object"){const i=Object.keys(t);for(let s=0;s<i.length;s++)this.G4i_(i[s],t[i[s]])}else{this.a8i_!=null&&this.a8i_.G4i_(t,i);this.u8i_!=null&&this.u8i_.G4i_(t,i)}return this}T8i_(){this.p8i_=null;return this}dt_(t){if((t=Es(t))==null)return this;t.hasOwnProperty("url")&&this.Q8i_(t["url"]);return this}N_(){return{url:this.N4i_.url}}};i=t([_s("geotoolkit.map.sources.AbstractSource")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRTZXJ2ZXJVUkwiOiJROGlfIiwiaXNEYXRhTG9hZGVkIjoiRThpXyIsImdldFNlcnZlclVSTCI6IkQ4aV8iLCJsb2FkU2VydmVyRGF0YSI6Im04aV8iLCJsb2FkU291cmNlRGF0YSI6ImI4aV8iLCJpc0RhdGFSZWFkeSI6Ik44aV8iLCJnZXRTZXJ2ZXJEYXRhIjoiUzhpXyIsInNldERhdGFSZWFkeSI6Ink4aV8iLCJnZXRNb2RlbExpbWl0cyI6InJ0XyIsInNldE1hcENvb3JkaW5hdGVTeXN0ZW0iOiJSOGlfIiwiZ2V0TWFwQ29vcmRpbmF0ZVN5c3RlbSI6Ims4aV8iLCJzZXRJbml0aWFsQ29vcmRpbmF0ZVN5c3RlbSI6Inc1aV8iLCJnZXRJbml0aWFsQ29vcmRpbmF0ZVN5c3RlbSI6ImQ1aV8iLCJnZXRUcmFuc2Zvcm1lclRvTWFwIjoiRjhpXyIsImdldFRyYW5zZm9ybWVyRnJvbU1hcCI6Ing4aV8iLCJpbml0TG9hZGVyIjoidzhpXyIsImlzTG9hZGluZyI6ImY0aV8iLCJnZXRDb3B5cmlnaHQiOiJVOGlfIiwiZ2V0RGF0YUxvYWRlciI6Ilk4aV8iLCJzZXRRdWVyeVBhcmFtZXRlciI6Ikc0aV8iLCJyZXNldExhc3RRdWVyeVBhcmFtcyI6IlQ4aV8iLCJzZXRQcm9wZXJ0aWVzIjoiZHRfIiwiZ2V0UHJvcGVydGllcyI6Ik5fIn19fSAg");var C8=function(){let i=class t extends $n{constructor(t,i){super();this.jF_=t;this.N4i_=i;t!=null&&this.K8i_()}dispose(){this.clear();this.jF_!=null&&this.jF_.dispose();super.dispose()}clear(){this.abort();return this}abort(){this.jF_!=null&&this.jF_.abort();return this}f4i_(){return this.jF_!=null&&this.jF_.f4i_()}G4i_(t,i){this.jF_!=null&&this.jF_.G4i_(t,i);return this}ix_(){return this.jF_}};i=t([_s("geotoolkit.map.sources.managers.AbstractManager")],i);return i}();const d8=new mA,B8=new mA;var w8=function(){let i=class t extends C8{constructor(t,i){super(t,i);this.H8i_=!1;this.fNt_={};this.q8i_={};this.J8i_=null;this.xm_=1/0;this.P8i_=!1;this.V8i_=null}query(t,i){if(!this.N4i_.url||!this.N4i_.FMt_)return!1;const s=this.N4i_.FMt_;let e=this.N4i_.mode;const A=this.N4i_.O8i_;let n,h;if(t!=null){if(!t.$s_(s))return!1;t=d8.ce_(t).intersect(s)}else{e=I8.All;t=s}const r=i?i.if_():Gn.JI_,o=r.BI_();switch(e){case I8.All:if(!this.W8i_(0,0)){this.P8i_=!0;this.H8i_=!1;this.jF_.abort();this.z8i_(s,r);this.X8i_(0,0,!0);return!0}this.P8i_=!1;return!1;case I8.A8i_:if(this.J8i_!=null&&this.J8i_.Ce_(t)&&NA.equals(this.xm_,o))return!1;this.P8i_=!0;this.H8i_=!1;this.jF_.abort();this.J8i_=this.J8i_?this.J8i_.ce_(t):t.clone();this.xm_=o;this.Gtt_((()=>{this.z8i_(this.J8i_,r)}));return!0;case I8.n8i_:const i=new xA(256,256);r.cI_(i,i);n=i.Ie_();h=i.Ts_();if(!NA.equals(this.xm_,o)){this.P8i_=!0;this.H8i_=!0;this.jF_.abort();this.fNt_={};this.xm_=o}break;case I8.h8i_:this.P8i_=!1;this.H8i_=!0;n=s.Ie_()/A;h=s.Ts_()/A;break;default:return!1}const l=Math.floor((t.we_()-s.we_())/n),u=Math.ceil((t.Qe_()-s.we_())/n),a=Math.floor((t.Ee_()-s.Ee_())/h),g=Math.ceil((t.pe_()-s.Ee_())/h);this.Gtt_((()=>{const t=d8.de_(n).Be_(h);for(let i=l;i<u;i++)for(let e=a;e<g;e++)if(!this.W8i_(i,e)){this.z8i_(t.setX(s.we_()+i*n).setY(s.Ee_()+e*h),r);this.X8i_(i,e,!0)}}));return!0}K8i_(){const t=this.j8i_.bind(this),i=(i,s,e)=>{if(i===g8.Z4i_&&e!=null){if(this.P8i_){this.q8i_={};this.P8i_=!1;this.notify(g8.$4i_,this)}this.H8i_&&(e=e.filter(t))}this.notify(i,this,e)};this.jF_.on(g8.Z4i_,i);this.jF_.on(g8._4i_,i);this.jF_.on(g8.$4i_,i);return this}W8i_(t,i){return this.fNt_[t]&&this.fNt_[t][i]}X8i_(t,i,s){this.fNt_[t]=this.fNt_[t]||{};this.fNt_[t][i]=s;return this}z8i_(t,i){i.rn_(t,B8);this.jF_.query({left:t.we_(),top:t.Ee_(),right:t.Qe_(),bottom:t.pe_(),width:B8.Ie_(),height:B8.Ts_()})}j8i_(t){const i=n8.p4i_(t.nt_());if(this.q8i_[i]==null){this.q8i_[i]=t;return!0}if(!n8.y4i_(t,this.q8i_[i])){const s=this.q8i_[i];Array.isArray(s)?s.push(t):this.q8i_[i]=[s,t];return!0}return!1}Gtt_(t){this.V8i_!=null&&clearTimeout(this.V8i_);this.V8i_=setTimeout((()=>{t.call(this);this.V8i_=null}),this.N4i_.timeout)}abort(){if(this.V8i_!=null){clearTimeout(this.V8i_);this.V8i_=null}return super.abort()}clear(){super.clear();this.fNt_={};this.q8i_={};this.xm_=1/0;this.P8i_=!1;return this}f4i_(){return this.V8i_!=null||super.f4i_()}};i=t([_s("geotoolkit.map.sources.managers.Vector")],i);return i}();let Q8=new lA;const E8=function(t){if(Array.isArray(t.x)){const i=[],s=[],e=t.y;for(let A=0;A<t.x.length;++A){Q8.vs_(t.x[A],e[A]);this.transform(Q8,Q8);i[A]=Q8.x;s[A]=Q8.y}return{x:i,y:s}}Q8.vs_(t.x,t.y);Q8=this.transform(Q8,Q8);return{x:Q8.x,y:Q8.y}};var p8=Ci(function(){let i=class t extends f8{constructor(t){const i=qi(t,{format:new c8,idfield:"name",requestresolution:10,mode:I8.All,timeout:50},!0);super(t);this.eut_=new lu;this.N4i_=this.N4i_||{};this.N4i_.id=new o8(i["idfield"]);this.N4i_.O8i_=i["requestresolution"];this.N4i_.mode=i["mode"];this.N4i_.timeout=i["timeout"]}B8i_(t){this.u8i_=new w8(t,this.N4i_);this.u8i_.on(g8.Z4i_,((t,i,s)=>{this.Z8i_(s,!1);this.u8i_.f4i_()||this.y8i_(!0)}));this.u8i_.on(g8.$4i_,((t,i)=>{this._8i_()}));return this}$8i_(t,i){this.query(t,i);return this}Z8i_(t,i){if(i!==!1){const i=this.F8i_(),s=E8.bind(i);t.forEach((function(t){const i=t.nt_();let e;if(Array.isArray(i)){e=[];for(let t=0;t<i.length;++t)e.push(s(i[t]))}else e=s(i);t.Pd_(e)}))}this.eut_.concat(t);this.notify(g8.Z4i_,this,t);return this}t6i_(t){this.eut_.reset();while(this.eut_.Hs_())if(this.eut_.next()===t){this.notify(g8._4i_,this,t);break}return this}clear(){this._8i_();super.clear();return this}_8i_(){this.notify(g8.$4i_,this,this.eut_);this.eut_=new lu;return this}requestData(t){this.N4i_.url=t;this.u8i_!=null&&this.u8i_.query(null,null)}i6i_(t){this.N4i_.id.L4i_()!==t&&(this.N4i_.id=new o8(t));return this}s6i_(){return this.N4i_.id.L4i_()}e6i_(t){this.N4i_.O8i_=t;return this}A6i_(){return this.N4i_.O8i_}};i=t([_s("geotoolkit.map.sources.Vector")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJxdWVyeUZlYXR1cmVzIjoiJDhpXyIsImFkZEZlYXR1cmVzIjoiWjhpXyIsInJlbW92ZUZlYXR1cmUiOiJ0NmlfIiwiY2xlYXJGZWF0dXJlcyI6Il84aV8iLCJzZXRVbmlxdWVGaWVsZCI6Imk2aV8iLCJnZXRVbmlxdWVGaWVsZCI6InM2aV8iLCJzZXRSZXF1ZXN0UmVzb2x1dGlvbiI6ImU2aV8iLCJnZXRSZXF1ZXN0UmVzb2x1dGlvbiI6IkE2aV8ifX19");var m8=Ci(function(){let i=class t extends p8{constructor(t){super(t=qi(t,{format:null,sources:t instanceof p8||Array.isArray(t)?t:null},!0));this._mt_=[];const i=t["sources"];if(Array.isArray(i))for(let t=0;t<i.length;++t)this.n6i_(i[t]);else this.n6i_(i)}n6i_(t){if(t instanceof p8){this.h6i_||(this.h6i_=this.r6i_.bind(this));const i=undefined;if(this._mt_.indexOf(t)<0){this._mt_.push(t);t.on(g8.Z4i_,this.h6i_);t.on(g8._4i_,this.h6i_);t.on(g8.$4i_,this.h6i_)}}return this}o6i_(t){const i=this._mt_.indexOf(t);if(~i){t._8i_();this._mt_.splice(i,1);t.off(g8.Z4i_,this.h6i_);t.off(g8._4i_,this.h6i_);t.off(g8.$4i_,this.h6i_)}return this}l6i_(){return this._mt_}B8i_(t){return this}query(t,i){for(let s=0;s<this._mt_.length;++s)this._mt_[s].query(t,i);this.y8i_(!this.f4i_());return this}R8i_(t){this.L8i_("setMapCoordinateSystem",t);return this}w5i_(t){this.L8i_("setInitialCoordinateSystem",t);return this}e6i_(t){this.L8i_("setRequestResolution",t);return this}i6i_(t){this.L8i_("setUniqueField",t);return this}clear(){this.L8i_("clear");return this}dispose(){this.L8i_("dispose")}L8i_(t,i){super.L8i_(t,i);for(let s=0;s<this._mt_.length;++s)this._mt_[s].L8i_(t,i);return this}r6i_(t,i,s){this.notify(t,this,s)}f4i_(){for(let t=0;t<this._mt_.length;t++)if(this._mt_[t].f4i_())return!0;return!1}};i=t([_s("geotoolkit.map.sources.CompositeSource")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJhZGRGZWF0dXJlU291cmNlIjoibjZpXyIsInJlbW92ZUZlYXR1cmVTb3VyY2UiOiJvNmlfIiwiZ2V0RmVhdHVyZVNvdXJjZUxpc3QiOiJsNmlfIiwic2V0TWFwQ29vcmRpbmF0ZVN5c3RlbSI6IlI4aV8iLCJzZXRJbml0aWFsQ29vcmRpbmF0ZVN5c3RlbSI6Inc1aV8iLCJzZXRSZXF1ZXN0UmVzb2x1dGlvbiI6ImU2aV8iLCJzZXRVbmlxdWVGaWVsZCI6Imk2aV8iLCJpc0xvYWRpbmciOiJmNGlfIn19fSAg");var y8=Ci(function(){let i=class t extends N4{constructor(t){super();this.u6i_=[];if(Array.isArray(t))for(let i=0;i<t.length;++i)this.a6i_(t[i]);else this.a6i_(t)}a6i_(t){if(t instanceof N4){this.g6i_||(this.g6i_=this.c6i_.bind(this));this.u6i_.push(t);t.on(S4.L3i_,this.g6i_)}return this}I6i_(t){const i=this.u6i_.indexOf(t);if(~i){this.u6i_.splice(i,1);t.off(S4.L3i_,this.g6i_)}return this}k3i_(t){for(let i=this.u6i_.length-1;i>=0&&t!=null;--i)t=this.u6i_[i].k3i_(t);return t}F3i_(t){const i=new lu;let s;for(let e=this.u6i_.length-1;e>=0;--e){s=this.u6i_[e].F3i_(t);s!=null&&i.concat(s)}return i}x3i_(t){for(let i=this.u6i_.length-1;i>=0;--i)this.u6i_[i].x3i_(t);return this}clear(){for(let t=this.u6i_.length-1;t>=0;--t)this.u6i_[t].clear();return this}f6i_(t){if(this.C6i_==null){this.C6i_=(t,i,s)=>{this.k3i_(s);this.notify(S4.L3i_,this,!0)};this.d6i_=(t,i,s)=>{this.x3i_(s);this.notify(S4.L3i_,this)};this.B6i_=(t,i,s)=>{if(i instanceof m8)this.d6i_(g8._4i_,i,s);else{this.clear();this.notify(S4.L3i_,this)}}}t.on(g8.Z4i_,this.C6i_);t.on(g8._4i_,this.d6i_);t.on(g8.$4i_,this.B6i_);return this}w6i_(t){t.off(g8.Z4i_,this.C6i_);t.off(g8._4i_,this.d6i_);t.off(g8.$4i_,this.B6i_);return this}c6i_(t,i,s){this.notify(t,this,s)}};i=t([_s("geotoolkit.map.features.converters.CompositeConverter")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJhZGRGZWF0dXJlQ29udmVydGVyIjoiYTZpXyIsInJlbW92ZUZlYXR1cmVDb252ZXJ0ZXIiOiJJNmlfIiwic2F2ZUNvbnZlcnRlZEZlYXR1cmVzIjoiazNpXyIsImdldEZlYXR1cmVzIjoiRjNpXyIsInJlbW92ZUZlYXR1cmVzIjoieDNpXyJ9fX0g");const D8=function(t){return Array.isArray(t)?t.every(D8):Array.isArray(t.x)},M8=function(t,i,s){let e,A=-1/0,n=-1,h,r=t.x[s]-t.x[i],o=t.y[s]-t.y[i];if(r!==0||o!==0)for(h=i+1;h<s;++h){e=Math.abs((t.x[h]-t.x[i])*o-(t.y[h]-t.y[i])*r);if(e>A){A=e;n=h}}else for(h=i+1;h<s;++h){r=t.x[h]-t.x[i];o=t.y[h]-t.y[i];e=r*r+o*o;if(e>A){A=e;n=h}}return{id:n,distance:A}};var v8=function(){var t=class{constructor(t){const i=t.nt_(!0);this.Q6i_=t;if(Array.isArray(i)){this.E6i_=[];this.p6i_=[];this.Bti_=null;for(let t=0;t<i.length;++t){const s=s4.R5i_(i[t]);this.p6i_.push(this.m6i_(i[t]));this.E6i_.push({x:[i[t].x[0]],y:[i[t].y[0]],k5i_:{F5i_:s}});this.Bti_=this.Bti_!=null?this.Bti_.union(s):s.clone()}}else{this.Bti_=s4.R5i_(i);this.E6i_={x:[i.x[0]],y:[i.y[0]],k5i_:{F5i_:this.Bti_}};this.p6i_=this.m6i_(i)}}m6i_(t){const i=M8(t,0,t.x.length-1);return{geometry:t,y6i_:{value:i.id,scale:i.distance}}}Hm_(t,i,s){let e=0,A=t.geometry.x.length-1,n,h=1,r=t.y6i_;const o=[],l=[];while(r)if(r.scale<s||A-e==1){i.x[h]=t.geometry.x[A];i.y[h++]=t.geometry.y[A];e=A;r=o.pop();A=l.pop()}else{if(!r.left){n=M8(t.geometry,e,r.value);r.left={value:n.id,scale:n.distance}}if(!r.right){n=M8(t.geometry,r.value,A);r.right={value:n.id,scale:n.distance}}o.push(r.right);l.push(A);A=r.value;r=r.left}i.x.length=h;i.y.length=h;if(h<=4&&t.geometry.x.length>=4){r=t.y6i_;const s=t.geometry.x.length-1;if(!r.left){n=M8(t.geometry,0,r.value);r.left={value:n.id,scale:n.distance}}if(!r.right){n=M8(t.geometry,r.value,s);r.right={value:n.id,scale:n.distance}}i.x[0]=t.geometry.x[0];i.y[0]=t.geometry.y[0];if(r.left.scale>r.right.scale){i.x[1]=t.geometry.x[r.left.value];i.y[1]=t.geometry.y[r.left.value];i.x[2]=t.geometry.x[r.value];i.y[2]=t.geometry.y[r.value]}else{i.x[1]=t.geometry.x[r.value];i.y[1]=t.geometry.y[r.value];i.x[2]=t.geometry.x[r.right.value];i.y[2]=t.geometry.y[r.right.value]}i.x[3]=t.geometry.x[s];i.y[3]=t.geometry.y[s];i.x.length=4;i.y.length=4}}getFeature(t){if(Array.isArray(this.p6i_))for(let i=0;i<this.p6i_.length;++i)this.Hm_(this.p6i_[i],this.E6i_[i],t);else this.Hm_(this.p6i_,this.E6i_,t);this.Q6i_.D5i_(this.E6i_);return this.Q6i_}};return t}(),b8=function(){let i=class t extends ru{constructor(t){super(t,(t=>t.Bti_.$s_(this.Bti_)&&(!this.gp_||this.gp_(t.Q6i_))));this.Bti_=null;this.scale=0;this.gp_=null}next(){const t=super.next();return t!=null?t.getFeature(this.scale):null}};i=t([_s(null)],i);return i}(),N8=Ci(function(){let i=class t extends N4{constructor(){super();this.D6i_=[];this.M6i_=new b8(this.D6i_)}k3i_(t){const i=[];for(let s=0;s<t.length;++s){const e=t[s].nt_(!0);D8(e)?this.D6i_.push(new v8(t[s])):i.push(t[s])}return i}F3i_(t){const i=t["scale"];this.M6i_.Bti_=t["bbox"];this.M6i_.gp_=t["filter"];this.M6i_.scale=1/(8*i*i);this.M6i_.reset();return this.M6i_}x3i_(t){if(t instanceof Au)t.forEach((t=>{for(let i=0;i<this.D6i_.length;++i)if(this.D6i_[i].Q6i_===t){this.D6i_.splice(i,1);break}}));else for(let i=0;i<this.D6i_.length;++i)if(this.D6i_[i].Q6i_===t){this.D6i_.splice(i,1);break}return this}clear(){super.clear();this.D6i_=[];this.M6i_=new b8(this.D6i_);return this}};i=t([_s("geotoolkit.map.features.converters.RDP")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzYXZlQ29udmVydGVkRmVhdHVyZXMiOiJrM2lfIiwiZ2V0RmVhdHVyZXMiOiJGM2lfIiwicmVtb3ZlRmVhdHVyZXMiOiJ4M2lfIn19fSAg");var S8=Ci(function(){let i=class t{};i.prototype.v6i_=Zi;i.prototype.reset=Zi;i=t([_s("geotoolkit.map.features.filters.IFilter")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJmaWx0ZXJGZWF0dXJlcyI6InY2aV8ifX0sImdldENsYXNzTmFtZSI6IkRfIn0g");const G8=Au.cN_([]),R8=function(t,i,s,e){const A=s4.R5i_(t);i.apply(t,s);const n=s.getBoundingBox(e);return A.Fe_(n)};var k8=Ci(function(){let i=class t{constructor(t){this.qDt_=t instanceof YC?t:new YC(t)}v6i_(t,i,s){const e=s.b6i_();if(!e)return G8;const A=this.qDt_;return new ou(t,(function(t){const n=e.v4_(t,s);if(!n)return!1;const h=s.l3i_(t);if(!h)return!1;A.a_(n);const r=t.nt_(!0);if(!Array.isArray(r))return R8(r,h,A,i);let o=!1;for(let t=0;t<r.length;++t){const s=r[t];s.k5i_=s.k5i_||{};if(s.k5i_.N6i_!==!1)if(R8(s,h,A,i)){o=!0;s.k5i_.N6i_=!0}else s.k5i_.N6i_=!1}return o}))}reset(){return this}};i=t([Zs(S8),_s("geotoolkit.map.features.filters.AnnotationFit")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJmaWx0ZXJGZWF0dXJlcyI6InY2aV8ifX0sImdldENsYXNzTmFtZSI6IkRfIn0g");const F8=Au.cN_([]);var x8=Ci(function(){let i=class t{v6i_(t,i,s){const e=s.b6i_();return e?new ou(t,(function(t){const i=undefined;if(!e.v4_(t,s))return!1;const A=t.nt_(!0);if(Array.isArray(A)){let t=s4.R5i_(A[0]),i,s=0,e,n;for(e=1;e<A.length;++e){n=A[e];i=s4.R5i_(n);if(i.Ie_()*i.Ts_()>t.Ie_()*t.Ts_()){t=i;s=e}}for(e=0;e<A.length;++e){n=A[e];n.k5i_=n.k5i_||{};if(n.k5i_.N6i_!==!1){n.k5i_.N6i_=e===s;e!==s&&(n.k5i_.S6i_=!0)}}}return!0})):F8}reset(){return this}};i=t([Zs(S8),_s("geotoolkit.map.features.filters.BiggestGeometry")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJmaWx0ZXJGZWF0dXJlcyI6InY2aV8ifX0sImdldENsYXNzTmFtZSI6IkRfIn0g");var L8=Ci(function(){let i=class t{constructor(t){this.G6i_=t}v6i_(t,i,s){return new ou(t,(t=>{if(Array.isArray(this.G6i_)){for(let i=0;i<this.G6i_.length;++i)if(ys(t,this.G6i_[i]))return!0;return!1}return ys(t,this.G6i_)}))}reset(){return this}};i=t([Zs(S8),_s("geotoolkit.map.features.filters.ByType")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJmaWx0ZXJGZWF0dXJlcyI6InY2aV8ifX0sImdldENsYXNzTmFtZSI6IkRfIn0g");const U8=Au.cN_([]);var Y8=Ci(function(){let i=class t{v6i_(t,i,s){const e=s.b6i_();return e?new ou(t,(function(t){const i=undefined;if(!e.v4_(t,s))return!1;const A=t.nt_(!0);if(Array.isArray(A)){let t=!1;for(let i=0;i<A.length;++i){const s=A[i];if(!Array.isArray(s.x)||!Array.isArray(s.y)||s.k5i_&&s.k5i_.N6i_===!1)continue;const e=s.x[0],n=s.y[0];let h=!1;for(let t=0;t<A.length;++t){const s=A[t];if(i!==t&&Array.isArray(s.x)&&Array.isArray(s.y))for(let t=1;t<s.x.length;++t)s.y[t]>n!=s.y[t-1]>n&&e<s.x[t]+(s.x[t-1]-s.x[t])*(n-s.y[t])/(s.y[t-1]-s.y[t])&&(h=!h)}A[i].k5i_=A[i].k5i_||{};if(h){A[i].k5i_.N6i_=!1;A[i].k5i_.S6i_=!0}else{A[i].k5i_.N6i_=!0;t=!0}}return t}return!0})):U8}reset(){return this}};i=t([Zs(S8),_s("geotoolkit.map.features.filters.EvenOddGeometry")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJmaWx0ZXJGZWF0dXJlcyI6InY2aV8ifX0sImdldENsYXNzTmFtZSI6IkRfIn0g");const T8=new xA,K8=20,H8=function(t){const i=t.nt_(!0);let s,e;if(!t.S5i_()){s=s4.R5i_(i);return s.Ie_()*s.Ts_()}const A=i;s=s4.R5i_(A[0]);e=s.Ie_()*s.Ts_();for(let t=1;t<A.length;++t){s=s4.R5i_(A[t]);e=Math.max(e,s.Ie_()*s.Ts_())}return e};var q8=Ci(function(){let i=class t{constructor(t,i){const s=(t=qi(t,{ignoretypes:i||[],weight:H8},!0))["weight"];if(s==null)this.R6i_=null;else if(typeof s=="string"){const t=s.split(",").map((function(t){const i=t.trim(),s=i.toLowerCase();return s.endsWith(" asc")?{k6i_:i.slice(0,-4),order:-1}:{k6i_:s.endsWith(" desc")?i.slice(0,-5):i,order:1}}));this.R6i_=function(i,s){const e=i.Uui_(),A=s.Uui_();for(let i=0;i<t.length;i++){const s=+e[t[i].k6i_],n=+A[t[i].k6i_];if(s!==n)return t[i].order*(n-s)}return 0}}else this.R6i_=function(t,i){return s(i)-s(t)};this.F6i_=t["ignoretypes"];this.x6i_={};this.L6i_=0}v6i_(t,i,s){const e=s.b6i_();i.Ji_().cI_(T8.setSize(1,1),T8);const A=this.R6i_!=null?Au.toArray(t).sort(this.R6i_):t,n=K8*T8.Ts_();return Au.cN_(A.filter((t=>{for(let i=0;i<this.F6i_.length;++i)if(t instanceof this.F6i_[i])return!0;const A=s.U6i_(t);if(!A)return!1;const h=A.g3i_()||e;if(!h)return!1;const r=h.v4_(t,s);if(!r)return!1;const o=A.l3i_();if(!o)return!1;const l=t.nt_(!0),u=A.u3i_(t);u.a_(r);if(!Array.isArray(l)){o.apply(l,u,i);return!this.$s_(n8.dwt_(u,T8),n)}let a=!1;for(let t=0;t<l.length;++t){const s=l[t];s.k5i_=s.k5i_||{};if(s.k5i_.N6i_!==!1){o.apply(s,u,i);if(this.$s_(n8.dwt_(u,T8),n))s.k5i_.N6i_=!1;else{a=!0;s.k5i_.N6i_=!0}}}return a})))}reset(){this.x6i_={};this.L6i_=0;return this}$s_(t,i){const s=Math.floor(t.Ee_()/i);this.L6i_<t.Ts_()&&(this.L6i_=t.Ts_());const e=Math.ceil(this.L6i_/i);for(let i=s-e;i<=s+e;i++)if(this.x6i_[i])for(let s=0;s<this.x6i_[i].length;s++)if(this.x6i_[i][s].$s_(t))return!0;this.x6i_[s]=this.x6i_[s]||[];this.x6i_[s].push(t.clone());return!1}};i=t([Zs(S8),_s("geotoolkit.map.features.filters.NoAnnotationOverlap")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJmaWx0ZXJGZWF0dXJlcyI6InY2aV8ifX0sImdldENsYXNzTmFtZSI6IkRfIn0g");const J8=Au.cN_([]);var P8=Ci(function(){let i=class t{constructor(t,i){this.dgt_=t;this.Y6i_=!1;this.setOptions(i);this.x6i_=[]}setOptions(t){t!=null&&t["nooverlap"]!=null&&(this.Y6i_=t["nooverlap"]);return this}JV_(){return{nooverlap:this.Y6i_}}v6i_(t,i,s){const e=i.Ji_(),A=s.ot_();this.dgt_.gR_(0,0);const n=this.dgt_.dR_(e),h=undefined;if(!(n&&!n.isEmpty()))return J8;const r=n.getX(),o=n.getY();return new ou(t,(t=>{if(!(t instanceof w4))return!1;const i=t.nt_(!0);n.setX(i["x"]+r);n.setY(i["y"]+o);if(!A.$s_(n))return!1;if(!this.Y6i_)return!0;for(let t=0;t<this.x6i_.length;t++)if(n.$s_(this.x6i_[t]))return!1;this.x6i_.push(new mA(n));return!0}))}reset(){this.x6i_=[];return this}};i=t([Zs(S8),_s("geotoolkit.map.features.filters.VisibilityArea")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiZmlsdGVyRmVhdHVyZXMiOiJ2NmlfIn19LCJnZXRDbGFzc05hbWUiOiJEXyJ9");var V8=function(){var t=class{};t.prototype.format=Zi;return t}();const O8="empty_id";var W8=Ci(function(){let i=class t{constructor(t){this.T6i_=t===!0}format(t,i){return i+(t=t||[]).map((t=>{const i=t.XC_()||O8,s=t.Uui_()||{},e=undefined;return(this.T6i_?"<b>&lt;"+i+"&gt;</b><br />":"")+Object.keys(s).map((t=>t+": "+(typeof s[t]=="string"&&s[t]!==""?s[t]:JSON.stringify(s[t])))).join("<br />")})).join("<br />")}};i=t([Zs(V8),_s("geotoolkit.map.features.formatters.List")],i);return i}(),2,"eyJnZXRDbGFzc05hbWUiOiJEXyJ9");const z8=function(t,i){if(t==null)return i.XC_();const s=i.Uui_();return s&&s.hasOwnProperty(t)?s[t]+"":null};var X8=Ci(function(){let i=class t{constructor(t,i,s,e){this.K6i_=typeof t=="string"?t:null;this.H6i_=typeof i=="string"?i:"<br/>";this.q6i_=typeof s=="number"?s:5;this.J6i_=e===!0}format(t,i){const s=[],e=this.K6i_,A=this.J6i_,n=function(t){const i=z8(e,t);A&&s.indexOf(i)!==-1||s.push(i)};t=t||[];for(let i=0;i<t.length;++i){const e=t[i];if(e instanceof p4){const t=e.j5i_(),i=Array.isArray(t)?t:Au.toArray(t);if(i.length>this.q6i_+1){for(let t=0;t<this.q6i_;++t)n(i[t]);s.push("and "+(i.length-this.q6i_)+" more…")}else t.forEach(n)}else n(e)}return i+s.join(this.H6i_)}};i=t([Zs(V8),_s("geotoolkit.map.features.formatters.SingleField")],i);return i}(),2,"eyJnZXRDbGFzc05hbWUiOiJEXyJ9");var j8=Ci(function(){let i=class t{constructor(t,i){this.P6i_=t;this.V6i_=i!==!1}format(t,i){if(!t||t.length===0)return i;let s,e,A,n=this.P6i_;if(n==null){const i={};for(s=0;s<t.length;++s){A=t[s].Uui_();for(const t in A)A.hasOwnProperty(t)&&!i[t]&&(i[t]=!0)}n=Object.keys(i)}i+="<table>";if(this.V6i_)for(s=0;s<n.length;++s){let h="<tr><td>"+n[s]+":</td>";for(e=0;e<t.length;++e){A=t[e].Uui_();h+="<td>"+(A!=null?A[n[s]]:null)+"</td>"}i+=h+"</tr>"}else{i+="<tr>";for(s=0;s<n.length;++s)i+="<th>"+n[s]+"</th>";i+="</tr>";for(e=0;e<t.length;++e){i+="<tr>";for(s=0;s<n.length;++s){A=t[e].Uui_();i+="<td>"+(A!=null?A[n[s]]:null)+"</td>"}i+="</tr>"}}return i+"</table>"}static Wi_(t,i){t=t||{};const s=Object.keys(t);i=i!==!1;return function(e,A){if(e.length===0)return A;A+="<table>";let n,h,r;if(i)for(h=0;h<s.length;++h){let i="<tr><td>"+s[h]+":</td>";for(r=0;r<e.length;++r){n=t[s[h]](e[r]);i+="<td>"+n+"</td>"}A+=i+"</tr>"}else{A+="<tr>";for(h=0;h<s.length;++h)A+="<th>"+s[h]+"</th>";A+="</tr>";for(r=0;r<e.length;++r){A+="<tr>";for(h=0;h<s.length;++h){n=t[s[h]](e[r]);A+="<td>"+n+"</td>"}A+="</tr>"}}return A+"</table>"}}};i=t([Zs(V8),_s("geotoolkit.map.features.formatters.Table")],i);return i}(),2,"eyJmcm9tT2JqZWN0IjoiV2lfIiwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");var Z8=Ci(function(){let i=class t{};i.prototype.v4_=Zi;i=t([_s("geotoolkit.map.features.strategiesIGetAnnotation")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRBbm5vdGF0aW9uIjoidjRfIn19LCJnZXRDbGFzc05hbWUiOiJEXyJ9");var _8=Ci(function(){let i=class t{constructor(t){this.x4i_=t}v4_(t,i){const s=t.Uui_();return s?s[this.x4i_]+"":null}};i=t([Zs(Z8),_s("geotoolkit.map.features.strategies.AnnotationByAttribute")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRBbm5vdGF0aW9uIjoidjRfIn19LCJnZXRDbGFzc05hbWUiOiJEXyJ9");var $8=Ci(function(){let i=class t{v4_(t,i){return t.XC_()}};i=t([Zs(Z8),_s("geotoolkit.map.features.strategies.AnnotationById")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRBbm5vdGF0aW9uIjoidjRfIn19LCJnZXRDbGFzc05hbWUiOiJEXyJ9");const t6=OA.Ai_().gn_("px"),i6=OA.Ai_().gn_("metre");var s6=Ci(function(){let i=class t{constructor(t){const i=qi(t,{expression:t&&t["expression"]||function(t){return t.XC_()},minscale:0,maxscale:1/0,where:null},!0);if(typeof i["expression"]=="string"){const t=i["expression"];this.O6i_=function(i){const s=i.Uui_();return t.replace(/{(.*?)}/g,((t,i)=>s[i]+""))}}else this.O6i_=i["expression"];this.C6_=i["minscale"]===0?0:i6.wn_(i["minscale"],t6);this.f6_=i["maxscale"]===1/0?1/0:i6.wn_(i["maxscale"],t6);this.gp_=i["where"]}v4_(t,i){const s=Math.abs(i.if_().BI_());return s>=this.C6_&&s<=this.f6_&&(!this.gp_||this.gp_(t))?this.O6i_(t):""}};i=t([Zs(Z8),_s("geotoolkit.map.features.strategies.AnnotationByRule")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRBbm5vdGF0aW9uIjoidjRfIn19LCJnZXRDbGFzc05hbWUiOiJEXyJ9");var e6=function(){let i=class t extends m4{constructor(t){(t=t||{})["shape"]=t["shape"]||new ap({linestyle:{color:"black",width:1}});t["shape"]instanceof ap&&t["shape"].O9_(!1);t["geometrytoshape"]=t["geometrytoshape"]||new u4;t["geometrytotext"]=t["geometrytotext"]||new l4;super(t)}};i=t([_s("geotoolkit.map.features.templates.LineString")],i);return i}();var A6=function(){let i=class t extends m4{constructor(t){(t=t||{})["shape"]=t["shape"]||new ma(0,0,8,8,dA.ne_,!0,cE,new hl("black"),new wr("white"));t["geometrytoshape"]=t["geometrytoshape"]||new c4;t["geometrytotext"]=t["geometrytotext"]||t["geometrytoshape"];super(t)}};i=t([_s("geotoolkit.map.features.templates.Point")],i);return i}();var n6=function(){let i=class t extends m4{constructor(t){(t=t||{})["shape"]=t["shape"]||new oE({linestyle:{color:"black",width:1},fillstyle:{color:"white"}});t["geometrytoshape"]=t["geometrytoshape"]||new d4;t["geometrytotext"]=t["geometrytotext"]||new h4;super(t)}};i=t([_s("geotoolkit.map.features.templates.Polygon")],i);return i}();var h6=Ci(function(){let i=class t extends ch{constructor(t){super(t);this._cache=null;this.W6i_=!1;this.z6i_=null;this.X6i_=null;this.UU_={};this.Utt_=null;this.j6i_=null;t=Pi(t,{system:B3.L2i_,limits:null,source:null,alpha:1,layerfilter:null},!0);this.Z6i_=X3.sx_().l5i_(t["system"]);this.setOptions(t);this.rvt_(t["source"]);const i=t["url"];i!==void 0&&this.Q8i_(i)}sd_(){return this.It_()}ot_(t){const i=this.getParent(),s=this.rt_();let e=null;if(i!=null&&i.rt_()!=null){const s=this.if_();e=s==null?new mA(i.lt_(t)):s.gI_(i.lt_(t))}if(s==null||e==null)return s;t||e.intersect(s);return e}rt_(){if(this.WH_!=null)return this.WH_.clone();if(this.Utt_!=null){const t=this.Utt_.rt_();if(t!=null)return t}this._6i_||(this._6i_=this.$6i_());return this._6i_?this._6i_.clone():null}Lq_(t){this.WH_=t?t.clone():null;this.notify(rh.nC_,this,this.WH_);return this}E2i_(){return this._6i_!=null?this._6i_.clone():null}$6i_(t){return this.X6i_!=null?this.X6i_.E2i_():null}t9i_(){return this.i9i_}s9i_(t){if(this.i9i_!==t){this.i9i_=t;this.UU_["alpha"]=t;this.td_()}return this}JV_(){return Pi(this.UU_,{})}setOptions(t){Pi(t,this.UU_);t&&t.hasOwnProperty("limits")&&this.Lq_(t["limits"]);this.z6i_=this.UU_["layerfilter"];this.i9i_=this.UU_["alpha"];return this}G8i_(t){this.Z6i_=X3.sx_().l5i_(t);this.Utt_!=null&&this.Utt_.G8i_(this.Z6i_);return this}l5i_(){return this.Z6i_}render(t){!this.$C_()||this.z6i_&&!this.z6i_.filter(this,t)||(this._cache&&!t.tk_()?this._cache.render(t):this.zY_(t))}ad_(t,i){if(this.$C_()&&(!this.z6i_||this.z6i_.filter(this,t))){if(!this._cache||t.tk_()){this.OY_(t,i);return}this._cache.render(t)}i()}OY_(t,i){const s=this.ot_(!0);this.Cvt_().query(s,this);this.Cvt_().b8i_().then((()=>{this.zY_(t);i()}),i)}load(){return this.Utt_!=null?this.Utt_.b8i_().then((()=>this),(()=>this)):Promise.resolve(this)}f4i_(){return this.Utt_!=null&&!this.Utt_.N8i_()}It_(){const t=this.getParent();return t!=null?t.It_():null}gk_(t){if(this._cache===t)return this;this._cache&&this._cache.VT_(null);t&&t.OT_()&&t.VT_(null);this._cache=t;if(this._cache){this._cache.VT_(this);this._cache.WT_(this.zY_.bind(this))}return this}td_(t,i){this._cache&&(t?this._cache.td_(t):this._cache.zT_());super.td_(t,i);return this}yq_(){return this._cache}iD_(){if(this._cache){this._cache.VT_(null);this._cache.WT_(null)}this._cache=null;return this}N_(){let t=super.N_();t["url"]=this.D8i_();t=Pi(t,this.JV_());return t}dt_(t){if((t=Es(t))==null)return this;super.dt_(t);t["source"]!==void 0&&this.rvt_(t["source"]);this.setOptions(t);return this}k8i_(){return this.X6i_}R8i_(t){this.X6i_=X3.sx_().l5i_(t);this.Utt_!=null&&this.Utt_.R8i_(this.X6i_);return this}transformPoint(t,i,s,e){const A=i instanceof g3?i:X3.sx_().l5i_(i),n=s instanceof g3?s:X3.sx_().l5i_(s);if(A!=null&&n!=null){this.j6i_!=null&&this.j6i_.d5i_()===A&&this.j6i_.B5i_()===n||(this.j6i_=new Z3(A,n));return this.j6i_.transformPoint(t,e)}return null}J5i_(t,i){const s=this.l5i_(),e=this.k8i_();return this.transformPoint(t,s,e,i)}e9i_(t,i){const s=this.l5i_(),e=this.k8i_();return this.transformPoint(t,e,s,i)}Q8i_(t){this.Utt_!=null&&this.Utt_.Q8i_(t);return this}D8i_(){return this.Utt_!=null?this.Utt_.D8i_():null}dispose(){this.Utt_!=null&&this.Utt_.dispose();this._cache&&this.gk_(null);super.dispose()}Cvt_(){return this.Utt_}$X_(t,i){return[]}A9i_(){return this.UU_["tooltip"]!=null&&this.UU_["tooltip"]["visible"]===!0?this.UU_["tooltip"]["formatter"]:null}n9i_(t){this.W6i_=t;const i=this.yq_();i instanceof zQ&&i.freeze(t);return this}h9i_(){return this.W6i_}b_(t,i){this.UU_=i===!0?Pi(t.UU_,this.UU_):qi(t.UU_,this.UU_);return this}};i.prototype.zY_=Zi;i=t([_s("geotoolkit.map.layers.AbstractLayer")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRXb3JsZFRyYW5zZm9ybSI6InNkXyIsImdldFZpc2libGVNb2RlbExpbWl0cyI6Im90XyIsImdldE1vZGVsTGltaXRzIjoicnRfIiwic2V0TW9kZWxMaW1pdHMiOiJMcV8iLCJnZXREZWZhdWx0TW9kZWxMaW1pdHMiOiJFMmlfIiwiY2FsY3VsYXRlRGVmYXVsdE1vZGVsTGltaXRzIjoiJDZpXyIsImdldExheWVyQWxwaGEiOiJ0OWlfIiwic2V0TGF5ZXJBbHBoYSI6InM5aV8iLCJnZXRPcHRpb25zIjoiSlZfIiwiZ2V0Q29vcmRpbmF0ZVN5c3RlbSI6Imw1aV8iLCJyZW5kZXJBc3luYyI6ImFkXyIsInJlbmRlckNvbnRlbnQiOiJ6WV8iLCJyZW5kZXJDb250ZW50QXN5bmMiOiJPWV8iLCJpc0xvYWRpbmciOiJmNGlfIiwic2V0Q2FjaGUiOiJna18iLCJpbnZhbGlkYXRlIjoidGRfIiwiZ2V0Q2FjaGUiOiJ5cV8iLCJjbGVhckNhY2hlIjoiaURfIiwiZ2V0UHJvcGVydGllcyI6Ik5fIiwic2V0UHJvcGVydGllcyI6ImR0XyIsImdldE1hcENvb3JkaW5hdGVTeXN0ZW0iOiJrOGlfIiwic2V0TWFwQ29vcmRpbmF0ZVN5c3RlbSI6IlI4aV8iLCJ0cmFuc2Zvcm1Ub01hcCI6Iko1aV8iLCJ0cmFuc2Zvcm1Gcm9tTWFwIjoiZTlpXyIsInNldFNlcnZlclVSTCI6IlE4aV8iLCJnZXRTZXJ2ZXJVUkwiOiJEOGlfIiwiZ2V0RGF0YVNvdXJjZSI6IkN2dF8iLCJoaXRUZXN0IjoiJFhfIiwiZ2V0VG9vbHRpcEZvcm1hdHRlciI6IkE5aV8iLCJjb3B5Q29uc3RydWN0b3IiOiJiXyJ9fX0g");var r6=Ci(function(){let i=class t{constructor(t){t=t||{};this.qd_=t["geometry"]||null;this.YC_=t["properties"]||null;this.ov_=t["name"]||null;this.gp_=t["filter"]||null}Pd_(t){this.qd_=t;return this}dt_(t){if((t=Es(t))==null)return this;if(t["properties"]!==void 0){this.YC_=t["properties"];t["geometry"]!==void 0&&(this.qd_=t["geometry"]);t["filter"]!==void 0&&(this.gp_=t["filter"]);t["name"]!==void 0&&(this.ov_=t["name"])}else this.YC_=t;return this}HC_(t){this.ov_=t;return this}dn_(){return this.ov_}nt_(){return this.qd_}N_(){return Pi(this.YC_,{properties:this.YC_,filter:this.gp_,geometry:this.qd_,name:this.ov_})}setFilter(t){this.gp_=t;return this}getFilter(){return this.gp_}};i=t([_s("geotoolkit.map.util.Query")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRHZW9tZXRyeSI6IlBkXyIsInNldFByb3BlcnRpZXMiOiJkdF8iLCJzZXROYW1lIjoiSENfIiwiZ2V0TmFtZSI6ImRuXyIsImdldEdlb21ldHJ5IjoibnRfIiwiZ2V0UHJvcGVydGllcyI6Ik5fIn19LCJnZXRDbGFzc05hbWUiOiJEXyJ9");var o6=Ci(function(){let i=class t{constructor(t){this.r9i_=null;this.b4i_={};this.N4i_={};this.o9i_=!1;this.l9i_=null;this.u9i_=null;this.S4i_=t&&t["connector"]||new V4;const i=n8.D4i_(t);for(let s=0;s<i.length;++s)this.G4i_(i[s],t[i[s]])}B_t_(t){t!=null&&(this.N4i_=t);return this}query(){if(this.u9i_==null){this.o9i_=!1;this.u9i_=new Promise(((t,i)=>{const s=this.a9i_();if(s==null){this.o9i_=!0;t(this);return}const e=n8.M4i_(s,this.b4i_);this.S4i_.send(e,this.g9i_(),((s,e)=>{if(s){this.o9i_=!0;ki(s);i(s)}else try{this.parse(e,(i=>{this.o9i_=!0;t(i)}))}catch(t){this.o9i_=!0;ki(t);i(t)}}))}))}return this.u9i_}E8i_(){return this.o9i_}loaded(t){this.l9i_=setTimeout((()=>{this.l9i_=null;t(this)}),0)}clear(){this.S4i_.abort();if(this.l9i_!=null){clearTimeout(this.l9i_);this.l9i_=null}this.u9i_=null;this.o9i_=!1;return this}g9i_(){return null}fhi_(){return this.S4i_}G4i_(t,i){this.b4i_[t.toLowerCase()]=typeof i=="string"?encodeURI(i):i+"";return this}k4i_(t){if(t==null)return this;for(const i in t.b4i_)t.b4i_.hasOwnProperty(i)&&(this.b4i_[i]=t.b4i_[i]);return this}U8i_(){return this.r9i_}clone(){return Wi(this)}b_(t,i){this.N4i_=i===!0?Pi(t.N4i_,this.N4i_):qi(t.N4i_,this.N4i_);this.S4i_=t.S4i_.clone();this.b4i_=i===!0?Pi(t.b4i_,this.b4i_):qi(t.b4i_,this.b4i_);return this}};i.prototype.parse=Zi;i.prototype.a9i_=Zi;i=t([_s("geotoolkit.map.sources.loaders.AbstractLoader")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRTZXR0aW5nc1VybCI6ImE5aV8iLCJnZXRSZXF1ZXN0T3B0aW9ucyI6Imc5aV8iLCJnZXRDb25uZWN0b3IiOiJmaGlfIiwic2V0UXVlcnlQYXJhbWV0ZXIiOiJHNGlfIiwiY2xvbmVRdWVyeVBhcmFtZXRlcnMiOiJrNGlfIiwiZ2V0Q29weXJpZ2h0IjoiVThpXyIsImNvcHlDb25zdHJ1Y3RvciI6ImJfIn19LCJnZXRDbGFzc05hbWUiOiJEXyJ9");let l6;const u6=new lA,a6=undefined,g6=X3.sx_().l5i_(B3.L2i_).E2i_();var c6=function(){let i=class t extends c4{constructor(t){super(t);this.qd_={x:0,y:0}}apply(t,i,s){this.qd_.x=Array.isArray(t.x)?t.x[0]:t.x;this.qd_.y=Array.isArray(t.y)?t.y[0]:t.y;super.apply(this.qd_,i,s)}};i=t([_s("MapboxPointAdapter")],i);return i}();const I6=function(t,i,s){switch(t){case 1:i.id=s.c9i_();break;case 2:const t=s.c9i_()+s.pos;while(s.pos<t){const t=i.I9i_[s.c9i_()],e=i.pi_[s.c9i_()];i.properties[t]=e}break;case 3:i.type=s.c9i_();break;case 4:i.qd_=s.pos;break}},f6={Z3t_:1,f9i_:2,XXt_:3},C6=g6.Ie_()/360,d6=g6.Ts_()/360,B6=function(t,i,s,e,A){u6.vs_(t*s,-i*e);A&&A(u6,u6);return u6};var w6=function(){var t=class{constructor(t,i,s,e,A){this.properties={};this.GEt_=s;this.type=0;this.C9i_=t;this.qd_=-1;this.I9i_=e;this.pi_=A;t.d9i_(I6,this,i)}B9i_(t,i,s,e){const A=s*C6,n=s*d6,h=this.C9i_;h.pos=this.qd_;const r=h.c9i_()+h.pos;let o=0,l=1;const u=180/s;let a=t-u,g=i-u;const c=[];let I;while(h.pos<r){if(o<=0){const t=h.c9i_();l=t&7;o=t>>3}o--;if(l===1||l===2){a+=h.w9i_();g+=h.w9i_();if(l===1){I&&c.push(I);I=this.type===f6.Z3t_?{x:0,y:0}:{x:[],y:[]}}if(!I)throw new Error("Pbf wrong data found: wrong geometry found");const t=B6(a,g,A,n,e);if(this.type===f6.Z3t_){I.x=t.x;I.y=t.y}else{I.x.push(t.x);I.y.push(t.y)}}else{if(l!==7)throw new Error("Pbf wrong data found: unknown command "+l);if(I&&this.type===f6.XXt_){const t=I.x,i=I.y,s=t.length-1;if(t[0]!==t[s]||i[0]!==i[s]){t.push(t[0]);i.push(i[0])}}}}I&&c.push(I);return c}Q9i_(t,i,s,e,A){const n=360/(this.GEt_*s),h=this.GEt_*t,r=this.GEt_*i,o=this.B9i_(h,r,n,A);let l;const u=this.id||e.F4i_(this.properties)||this.properties["id"];if(o.length===0)return null;switch(this.type){case f6.Z3t_:l=o.length===1?w4:W4;break;case f6.f9i_:l=o.length===1?X4:Z4;break;case f6.XXt_:if(o.length>1){let t=null;for(let i=0;i<o.length;){const s=undefined;if(s4.x5i_(o[i]))t=o[i++];else{if(t){const s=t;s["clip"]=s["clip"]||[s4.R5i_(t)];s["clip"].push(o[i])}o.splice(i,1)}}l=o.length===1?$4:i8}else l=$4;break;default:return null}return new l({id:typeof u=="boolean"?+u:u,attributes:this.properties,geometry:o.length===1?o[0]:o})}};return t}();const Q6=function(t,i,s){switch(t){case 15:i.version=s.c9i_();break;case 1:i.name=s.U6t_();break;case 5:i.GEt_=s.c9i_();break;case 2:i.eut_.push(s.pos);break;case 3:i.I9i_.push(s.U6t_());break;case 4:let t=null;const e=s.c9i_()+s.pos;while(s.pos<e){const i=s.c9i_()>>3;t=i===1?s.U6t_():i===2?s.E9i_():i===3?s.p9i_():i===4?s.m9i_():i===5?s.c9i_():i===6?s.w9i_():i===7?s.y9i_():null}i.pi_.push(t)}};var E6=function(){var t;return class{constructor(t,i){this.version=1;this.name=null;this.GEt_=4096;this.length=0;this.C9i_=t;this.I9i_=[];this.pi_=[];this.eut_=[];t.d9i_(Q6,this,i);this.length=this.eut_.length}Q6i_(t){this.C9i_.pos=this.eut_[t];const i=this.C9i_.c9i_()+this.C9i_.pos;return new w6(this.C9i_,i,this.GEt_,this.I9i_,this.pi_)}}}();const p6=function(t,i,s){if(t===3){const t=new E6(s,s.c9i_()+s.pos);t.length&&(i[t.name]=t)}},m6=function(t,i,s,e,A){let n,h;const r=A*8-e-1,o=(1<<r)-1,l=o>>1;let u=-7,a=s?A-1:0;const g=s?-1:1;let c=t[i+a];a+=g;n=c&(1<<-u)-1;c>>=-u;u+=r;for(;u>0;u-=8){n=n*256+t[i+a];a+=g}h=n&(1<<-u)-1;n>>=-u;u+=e;for(;u>0;u-=8){h=h*256+t[i+a];a+=g}if(n===0)n=1-l;else{if(n===o)return h?NaN:c?-1/0:1/0;h+=Math.pow(2,e);n-=l}return(c?-1:1)*h*Math.pow(2,n-e)},y6=function(t,i,s){return s?i*4294967296+(t>>>0):(i>>>0)*4294967296+(t>>>0)};var D6=function(){var t=class{constructor(t){this.buf=new Uint8Array(t);this.pos=0;this.type=0;this.length=this.buf.length}D9i_(){this.buf=null}d9i_(t,i,s){s=s||this.length;while(this.pos<s){const s=this.c9i_(),e=s>>3,A=this.pos;this.type=s&7;t(e,i,this);this.pos===A&&this.M9i_(s)}return i}E9i_(){const t=m6(this.buf,this.pos,!0,23,4);this.pos+=4;return t}p9i_(){const t=m6(this.buf,this.pos,!0,52,8);this.pos+=8;return t}c9i_(t){const i=this.buf;let s,e,A;e=i[this.pos++];s=e&127;if(e<128)return s;e=i[this.pos++];s|=(e&127)<<7;if(e<128)return s;e=i[this.pos++];s|=(e&127)<<14;if(e<128)return s;e=i[this.pos++];s|=(e&127)<<21;if(e<128)return s;e=i[this.pos];s|=(e&15)<<28;e=i[this.pos++];A=(e&112)>>4;if(e<128)return y6(s,A,t);e=i[this.pos++];A|=(e&127)<<3;if(e<128)return y6(s,A,t);e=i[this.pos++];A|=(e&127)<<10;if(e<128)return y6(s,A,t);e=i[this.pos++];A|=(e&127)<<17;if(e<128)return y6(s,A,t);e=i[this.pos++];A|=(e&127)<<24;if(e<128)return y6(s,A,t);e=i[this.pos++];A|=(e&1)<<31;if(e<128)return y6(s,A,t);throw new Error("Pbf wrong data found: expected varint not more than 10 bytes")}m9i_(){return this.c9i_(!0)}w9i_(){const t=this.c9i_();return t%2==1?(t+1)/-2:t/2}y9i_(){return Boolean(this.c9i_())}U6t_(){const t=this.c9i_()+this.pos;let i="",s=this.pos;const e=this.buf;while(s<t){const A=e[s];let n=null,h=A>239&&4||A>223&&3||A>191&&2||1,r,o,l;if(s+h>t)break;if(h===1)A<128&&(n=A);else if(h===2){r=e[s+1];if((r&192)==128){n=(A&31)<<6|r&63;n<=127&&(n=null)}}else if(h===3){r=e[s+1];o=e[s+2];if((r&192)==128&&(o&192)==128){n=(A&15)<<12|(r&63)<<6|o&63;(n<=2047||n>=55296&&n<=57343)&&(n=null)}}else if(h===4){r=e[s+1];o=e[s+2];l=e[s+3];if((r&192)==128&&(o&192)==128&&(l&192)==128){n=(A&15)<<18|(r&63)<<12|(o&63)<<6|l&63;(n<=65535||n>=1114112)&&(n=null)}}if(n===null){n=65533;h=1}else if(n>65535){n-=65536;i+=String.fromCharCode(n>>>10&1023|55296);n=56320|n&1023}i+=String.fromCharCode(n);s+=h}this.pos=t;return i}M9i_(i){const s=i&7;if(s===t.v9i_)while(this.buf[this.pos++]>127);else if(s===t.b9i_)this.pos=this.c9i_()+this.pos;else if(s===t.N9i_)this.pos+=4;else{if(s!==t.S9i_)throw new Error("Pbf wrong data found: unknown type: "+s);this.pos+=8}}};t.v9i_=0;t.S9i_=1;t.b9i_=2;t.N9i_=5;return t}();const M6="background_layer",v6=16,b6=function(){return!0},N6=function(t){return t instanceof w4||t instanceof W4?"Point":t instanceof X4||t instanceof Z4?"LineString":"Polygon"},S6=function(t){return t.XC_()},G6=function(t){return t.Uui_()[this]};var R6=function(){var i;let s=i=class t{static G9i_(){return this}static parse(t,s,e,A,n,h,r){n=n||new o8("name");r=r||{};const o=Object.keys(r).length===0||Object.keys(r).length===1&&r.layers!=null,l=1<<A,u=g6.width/l,a=g6.height/l,g=g6.x+u*s,c=g6.y+a*(l-e-1),I=new D6(t),f=I.d9i_(p6,{}),C={},d=Object.keys(f);for(let t=0;t<d.length;t++){const u=d[t];if(o){r.layers=r.layers||[];r.layers.indexOf(u)<0&&r.layers.push(u)}else if(!r[u])continue;for(let t=0;t<f[u].length;++t){let a=f[u].Q6i_(t).Q9i_(s,e,l,n,h);if(!a)continue;if(o){C[u]=C[u]||[];C[u].push(a);continue}const g=i.R9i_(a,A,r[u]);let c=!1;for(let t=0;t<g.length;t++){const i=g[t].id,s=g[t].k9i_;t>0&&(a=a.m5i_());C[i]=C[i]||[];C[i].push(a);a.k9i_=s;if(s.u3i_()!==l6){c&&a.b5i_({});c=!0}}}}I.D9i_();if(r[M6]){const t=r[M6];for(let i=0;i<t.length;i++){const s=new $4({geometry:{x:[g,g+u,g+u,g],y:[c,c,c+a,c+a]}});t[i].setZ(A);s.k9i_=t[i].k9i_;C[t[i].id]=[s]}}return C}static F9i_(t,s,e){const A=t["layers"],n={layers:[],x9i_:{},sprite:e,spacing:{},fonts:[],L9i_:s};for(let t=0;t<A.length;++t)i.U9i_(A[t],n);return n}static R9i_(t,i,s){const e=[];if(!s)return e;for(let A=0;A<s.length;A++)s[A].filter(t,i)&&e.push(s[A]);return e}static U9i_(t,s){const e=qi(t["layout"],t["paint"]);if(!e||e["visibility"]==="none")return;let A=t["source-layer"];const n=t["minzoom"]!=null?t["minzoom"]:0,h=t["maxzoom"]!=null?t["maxzoom"]:1/0,r=i.Y9i_(t["filter"]),o={id:t["id"],zoom:null,setZ:function(t){o.zoom=t},T9i_:this.G9i_,filter:function(t,i){return i>=n&&i<=h&&r(t)}};l6=l6||new YC({visible:!1});switch(t["type"]){case"background":A=M6;const n=e["background-pattern"]?i.K9i_(e["background-pattern"],e["background-opacity"],s):i.H9i_(e["background-color"],e["background-opacity"],o,wr);if(!n)return;o.k9i_=new n6({shape:new oE({fillstyle:n})});break;case"fill":if(e["fill-pattern"]){const t=i.K9i_(e["fill-pattern"],e["fill-opacity"],s);if(!t)return;o.k9i_=new n6({shape:new oE({fillstyle:t}),textshape:l6})}else o.k9i_=new n6({shape:new oE({fillstyle:i.H9i_(e["fill-color"],e["fill-opacity"],o,wr),linestyle:i.H9i_(e["fill-outline-color"],e["fill-opacity"],o,hl)}),textshape:l6});break;case"line":o.k9i_=new e6({shape:new ap({linestyle:i.q9i_(e,o)}),textshape:l6});break;case"symbol":const h=i.J9i_(e,s,o),r=i.P9i_(e,s,o);let l,u=null,a=null;if(e["symbol-placement"]==="line"){l=e6;u=new l4({offset:{x:h.offset[0],y:h.offset[1]}});a=new l4({offset:{x:r.offset[0],y:r.offset[1]}})}else if(e["symbol-placement"]==="line-center")l=n6;else{l=A6;u=new c6({offset:{x:h.offset[0],y:h.offset[1]}});a=new c6({offset:{x:r.offset[0],y:r.offset[1]}})}e["icon-allow-overlap"]!==!0&&(s.spacing[t["id"]]=e["symbol-spacing"]||250);o.k9i_=new l({shape:h.shape,geometrytoshape:u,textshape:r.shape,geometrytotext:a,textstrategy:r.V9i_,textsizeinfo:r.O9i_});break;case"circle":const g=e["circle-stroke-width"]||0,c=(e["circle-radius"]||5)+g/2,I=i.H9i_(e["circle-color"],e["circle-opacity"],o,wr);let f=null;if(g>0){f=i.H9i_(e["circle-stroke-color"]||"#000000",e["circle-stroke-opacity"],o,hl);f.de_(g)}o.k9i_=new A6({shape:new ma({painter:cE,width:2*c,height:2*c,fillstyle:e["circle-blur"]>0&&I!=null?new xo({innerradius:1-e["circle-blur"],startcolor:I.getColor(),endcolor:"transparent"}):I,linestyle:f}),textshape:l6});break;case"fill-extrusion":case"heatmap":case"raster":case"hillshade":default:ki('VectorTile: "'+t["type"]+'" type is not supported');return}o.T9i_!==this.G9i_&&o.k9i_.dt_({shapecallback:o.T9i_});s.layers.push(t["id"]);s.x9i_[t["id"]]=o;s[A]=s[A]||[];s[A].push(o)}static P9i_(t,s,e){if(!t||!t["text-field"])return{shape:l6,offset:[0,0]};let A,n=t["text"],h=0;switch(t["text-anchor"]){case"left":A=dA.he_;n=2;break;case"right":A=dA.oe_;n=-2;break;case"top":A=dA.re_;h=-2;break;case"bottom":A=dA.le_;h=2;break;case"top-left":A=dA.se_;n=2;h=-2;break;case"top-right":A=dA.Ae_;n=-2;h=-2;break;case"bottom-left":A=dA.ie_;n=2;h=2;break;case"bottom-right":A=dA.ee_;n=-2;h=2;break;default:A=dA.ne_}const r=t["text-transform"]==="uppercase"&&String.prototype.toUpperCase||t["text-transform"]==="lowercase"&&String.prototype.toLowerCase||null,o=NA.degToRad(t["text-rotate"])||0,l=i.W9i_(t,s,e),u=t["text-field"],a=new YC({textstyle:l?l.style:null,rotationangle:o,preservereadingorientation:!0,ispointingup:!0,width:t["text-max-width"]>0&&l?l.size*t["text-max-width"]:0,alignment:A});if(t["text-max-width"]>0&&l){l.style.bF_(Fa.ne_);a.setSize(l.size*t["text-max-width"],0).PX_(NC.hX_)}let g;const c=function(t,i){return g[i]||""};return{shape:a,O9i_:l.O9i_,V9i_:new s6({expression:function(t){g=t.Uui_();let i=u;if(typeof u!="string"){const t=u["stops"]||[];i=t[t.length-1]&&t[t.length-1][1]||"";for(let s=0;s<t.length;s++)if(e.zoom<=t[s][0]){i=t[s][1];break}}const s=i.replace(/{(.*?)}/g,c);return r?r.call(s):s}}),offset:[n,h]}}static J9i_(t,i,s){if(!(t&&t["icon-image"]&&i.sprite&&i.L9i_))return{shape:l6,offset:[0,0]};const e=t["icon-image"],A=t["icon-size"]||1,n=i.sprite,h=NA.degToRad(t["icon-rotate"])||0,r=t.hasOwnProperty("icon-opacity")?t["icon-opacity"]:1;if(e.indexOf("{")<0){if(!n[e])return{shape:l6,offset:[0,0]};const s=t["icon-offset"]||[0,0];return{shape:new df({url:i.L9i_,rotationangle:h,opacity:r,crossorigin:"anonymous",sizeisindevicespace:!0,alignment:dA.ne_,width:n[e]["width"]*A,height:n[e]["height"]*A,sprite:new mA(n[e])}),offset:[n[e]["width"]*A*s[0],n[e]["height"]*A*s[1]]}}const o=s.T9i_;s.T9i_=function(t,i){const s=t.Uui_(),h=e.replace(/{(.*?)}/g,(function(t,i){return s[i]}));n[h]?i.setSize(n[h]["width"]*A,n[h]["height"]*A).$V_(new mA(n[h])).nf_(!0):i.nf_(!1);o(t,i)};return{shape:new df({url:i.L9i_,rotationangle:h,alignment:dA.ne_,opacity:r,crossorigin:"anonymous",sizeisindevicespace:!0}),offset:[0,0]}}static W9i_(t,s,e){if(!t["text-font"]&&!t["text-size"]&&!t["text-color"])return null;const A=i.H9i_(t["text-color"],t["text-opacity"],e,qa)||new qa;let n=typeof t["text-font"]=="string"?t["text-font"]:Array.isArray(t["text-font"])&&t["text-font"][0];n?s.fonts.indexOf(n)<0&&s.fonts.push(n):n="sans-serif";let h,r=null;const o=t["text-size"]||v6;if(typeof o!="number"){const t=i.z9i_(o);if(t.length<2){const i=e.setZ;e.setZ=function(s){const e=Math.round(t(s));A.nF_(e+"px "+n);i(s)}}else{const t=o["stops"].length-1;r={field:o["property"],mindatavalue:o["stops"][0][0],maxdatavalue:o["stops"][t][0],minsize:o["stops"][0][1],maxsize:o["stops"][t][1]}}h=v6}else h=o;A.nF_(h+"px "+n);typeof t["text-halo-color"]=="string"&&t["text-halo-width"]>0&&A.setShadow({color:t["text-halo-color"],blur:2*t["text-halo-width"],enable:!0});return{style:A,O9i_:r,size:h}}static K9i_(t,i,s){if(!s.sprite||!s.L9i_||!s.sprite[t])return null;const e=new wr("transparent"),A=new mA(s.sprite[t]),n=new df({url:s.L9i_,alignment:dA.ie_,ax:0,ay:0,width:A.Ie_(),height:A.Ts_(),opacity:typeof i=="number"?i:1,crossorigin:"anonymous",sprite:A});n.CM_((function(){const t=fr.zw_(A.Ie_(),A.Ts_(),!0),i=t.tQ_();n.render(i);t.gM_();e.IQ_(Nl.Ai_().createPattern(t.SM_()))}));return e}static q9i_(t,s){if(!t["line-color"]&&!t["line-width"])return null;const e=i.H9i_(t["line-color"]||"#000000",t["line-opacity"],s,hl);let A=t.hasOwnProperty("line-width")?t["line-width"]:1,n=t["line-dasharray"];const h=function(t,i){return Array.isArray(t)?t.map((function(t){return t*i})):null};if(typeof A!="number"||n&&n["stops"]){const t=i.z9i_(A),r=i.z9i_(n);if(t.length<2&&r.length<2){const i=s.setZ;s.setZ=function(s){const A=t(s),n=r(s);e.de_(A).IQ_(h(n,A));i(s)}}else{const i=s.T9i_;s.T9i_=function(A,n){const o=t.length<2?t(s.zoom):t(A,n),l=r.length<2?r(s.zoom):r(A,n);e.de_(o).IQ_(h(l,o));i(A,n)}}A=1;n=null}e.de_(A).VD_(t["line-cap"]||nl.SD_).JD_(t["line-join"]||Al.bD_).IQ_(h(n,A));return e}static H9i_(t,s,e,A){if(t==null)return null;if(typeof t=="string"){if(s==null||s===1)return new A({color:t});if(typeof s=="number")return new A({color:RA.setAlpha(t,s*255)})}const n=i.z9i_(t),h=i.z9i_(s),r=e.setZ,o=new A;if(n.length<2&&h.length<2)e.setZ=function(t){const i=n(t),s=h(t);i.setAlpha(s);o.setColor(i);r(t)};else{const t=e.T9i_;e.T9i_=function(i,s){const A=n.length<2?n(e.zoom):n(i,s),r=h.length<2?h(e.zoom):h(i,s);A.setAlpha(r);o.setColor(A);t(i,s)}}return o}static z9i_(t){if(typeof t!="object"||!Array.isArray(t["stops"])){typeof t=="string"&&(t=new nA(t));return function(){return t}}const i=t["stops"],s=t["base"]||1;let e;const A=typeof i[0][1]=="string";A&&(e=new bo({values:i.map((function(t){return t[0]})),colors:i.map((function(t){return t[1]}))}));const n=function(t){let n;if(typeof t!="number"){for(n=0;n<i.length;n++)if(i[n][0]===t)return i[n][1];return i[0][0]}if(t<i[0][0])return i[0][1];for(n=1;n<i.length;n++){if(i[n][0]<t)continue;const h=t-i[n-1][0],r=i[n][0]-i[n-1][0],o=s===1?h/r:(Math.pow(s,h)-1)/(Math.pow(s,r)-1);return A?e.getColor(i[n-1][0]+o*(i[n][0]-i[n-1][0])):i[n-1][1]+o*(i[n][1]-i[n-1][1])}return i[i.length-1][1]};return t["property"]?function(i){const s=n(i.Uui_()[t["property"]]);return A&&typeof s=="string"?new nA(s):s}:function(t){const i=n(t);return A&&typeof i=="string"?new nA(i):i}}static Y9i_(t){if(!Array.isArray(t)||t.length===0)return b6;let s,e;const A=t[1],n=t[2],h=A==="$type"&&N6||A==="$id"&&S6||G6;switch(t[0]){case"has":return function(t){return h.call(A,t)!==void 0};case"!has":return function(t){return h.call(A,t)===void 0};case"==":return function(t){return h.call(A,t)===n};case"!=":return function(t){return h.call(A,t)!==n};case">":return function(t){return h.call(A,t)>n};case">=":return function(t){return h.call(A,t)>=n};case"<":return function(t){return h.call(A,t)<n};case"<=":return function(t){return h.call(A,t)<=n};case"in":case"!in":const r=t.slice(2);e=t[0]==="!in";return function(t){return r.indexOf(h.call(A,t))===-1===e};case"all":const o=[];for(s=1;s<t.length;++s)o.push(i.Y9i_(t[s]));return function(t){return o.every((function(i){return i(t)}))};case"any":case"none":const l=[];for(s=1;s<t.length;++s)l.push(i.Y9i_(t[s]));e=t[0]==="any";return function(t){return l.some((function(i){return i(t)}))===e}}return b6}};s=i=t([_s("geotoolkit.map.util.Mapbox")],s);return s}();const k6=function(t,i){return t?new Promise((function(s){i.send(t,null,(function(t,i){let e;if(t||typeof i!="string")e=null;else try{e=JSON.parse(i)}catch(i){t=i}t&&ki(t);s(e)}))})):Promise.resolve(null)};var F6=Ci(function(){var i;let s=i=class t extends o6{constructor(t){super(t);this.N4i_={}}parse(t,s){const e=typeof t=="string"?JSON.parse(t):t;this.N4i_.data=e;this.N4i_.FMt_=this.N4i_.e8i_.B5i_().E2i_();let A;if(e["tiles"]!=null&&e["tiles"].length>0){A=e["tiles"][0][0]==="/"?"":"/";const t=n8.v4i_(A+e["tiles"][0],["{x}","{y}","{z}"]);this.N4i_.X9i_=function(i,s,e){let A="";for(let n=0;n<t.length;++n)switch(t[n]){case"{x}":A+=e;break;case"{y}":A+=s;break;case"{z}":A+=i;break;default:A+=t[n]}return A}}const n=Array.isArray(this.N4i_.url)?this.N4i_.url[0]:this.N4i_.url;if(e["tileMap"]){A=e["tileMap"][0]==="/"||n[n.length-1]==="/"?"":"/";const t=n8.M4i_(n+A+e["tileMap"],this.b4i_);this.S4i_.send(t,null,((t,i)=>{if(t)return;let s;if(typeof i=="string")try{s=JSON.parse(i)}catch(t){return}else s=i;this.N4i_.j9i_=s["index"]}))}this.N4i_.LBi_={};if(this.N4i_.Z9i_||e["defaultStyles"]){A=e["defaultStyles"][0]==="/"||n[n.length-1]==="/"?"":"/";let t=this.N4i_.Z9i_||n+A+e["defaultStyles"];t=n8.M4i_(t,this.b4i_);k6(t,this.S4i_).then((e=>{if(!e){s(this);return}const A=i._9i_(e,t);k6(A.metadata,this.S4i_).then((t=>{this.N4i_.layers=[];this.N4i_.LBi_=t?R6.F9i_(e,A.image,t):{};A.image?fl.CM_({image:A.image},(()=>{s(this)})):s(this)}),(()=>{s(this)}))}),(()=>{s(this)}))}else this.loaded(s)}a9i_(){const t=Array.isArray(this.N4i_.url)?this.N4i_.url[0]:this.N4i_.url;return t?t+"?f=json":null}static $9i_(t){let i;if(typeof t=="string")try{i=JSON.parse(t)}catch(t){return null}else i=t;const s=i["sources"];if(!s)return null;for(const t in s){const i=s[t];if(i!=null&&typeof i["type"]=="string"&&i["type"].toLowerCase()==="vector"&&typeof i["url"]=="string")return i["url"]}return null}static _9i_(t,i){if(!t["sprite"])return{image:"",metadata:""};const s=t["sprite"],e=OA.Ai_().th_()>96?"@2x":"";let A=i.indexOf("?");const n=A<0?"":i.substr(A),h="mapbox://styles";if(s.startsWith(h))return{image:i.replace(/\/mapbox.+(?=\?)/,s.substr(h.length)+"/sprite"+e+".png"),metadata:i.replace(/\/mapbox.+(?=\?)/,s.substr(h.length)+"/sprite"+e+".json")};if(/(:|\/\/|^[a-z]+\.)/.test(s))return{image:s+e+".png"+n,metadata:s+e+".json"+n};const r=s[0]!=="/"?"/":"";A=/\/[^.]+($|\?)/.test(i)?i.lastIndexOf("?"):i.lastIndexOf("/");const o=A<0?i:i.substr(0,A);return{image:o+r+s+e+".png"+n,metadata:o+r+s+e+".json"+n}}};s=i=t([_s("geotoolkit.map.sources.loaders.VectorTile")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRTZXR0aW5nc1VybCI6ImE5aV8ifX19");var x6=Ci(function(){let i=class t extends q4{send(t,i,s){if(!t){s(new Error("geotoolkit.map.sources.connectors.DOMImage: No url provided"));return}const e={url:t,lazyloading:!0,crossorigin:"anonymous"},A=i&&i["dst"]?i["dst"].dt_(e):new df(e),n=i&&i["key"],h={image:A,onload:()=>{A.off(ff.PV_,h.onload);this.I4i_(n,h);s(null,A)}};A.on(ff.PV_,h.onload);this.g4i_(n,h);A.CM_()}a4i_(t){t.image.off(ff.PV_,t.onload);return this}};i=t([_s("geotoolkit.map.sources.connectors.DOMImage")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJhYm9ydENvbm5lY3Rpb24iOiJhNGlfIn19fSAg");var L6=Ci(function(){let i=class t extends x6{constructor(t){super();this.t7i_=new V4(t)}send(t,i,s){if(!t){s(new Error("geotoolkit.map.sources.connectors.PreloadedImage: No url provided"));return}const e={lazyloading:!0,crossorigin:"anonymous"},A=i&&i["dst"]?i["dst"].dt_(e):new df(e),n=i&&i["key"],h={image:A,onload:()=>{A.off(ff.PV_,h.onload);this.I4i_(n,h);s(null,A)}};this.t7i_.send(t,{responsetype:"blob",key:n,priority:i&&i["priority"]},((t,i)=>{if(t)s(t);else{A.on(ff.PV_,h.onload);A.dt_({url:Mi.URL.createObjectURL(i)});this.g4i_(n,h);A.CM_()}}))}abort(t){this.t7i_.abort(t);super.abort(t);return this}f4i_(){return this.t7i_.f4i_()||super.f4i_()}};i=t([_s("geotoolkit.map.sources.connectors.PreloadedImage")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpc0xvYWRpbmciOiJmNGlfIn19fSAg");var U6=Ci(function(){let i=class t extends h8{constructor(t){(t=t?Es(t):{})["connector"]==null&&(t["connector"]=new L6);const i=t["formatterfunction"];t["formatterfunction"]=null;super(t);this.N4i_={};this.ZF_=i}query(t){const i=t["z"],s=t["x"],e=t["y"],A=this.ZF_||this.N4i_.X9i_;let n=this.R4i_(A?A(i,e,s):null);n!=null&&(n=n.replace("{x}",""+s).replace("{y}",""+e).replace("{z}",""+i));this.S4i_.send(n,{dst:t["dst"],key:t["key"],priority:t["priority"]},((t,i)=>{t?this.onError(t):this.Df_()||this.notify(ff.PV_,i,i._V_())}));return this}i7i_(){return this.ZF_}s7i_(t){this.ZF_=t;return this}};i=t([_s("geotoolkit.map.sources.formats.Tile")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRGb3JtYXR0ZXIiOiJpN2lfIiwic2V0Rm9ybWF0dGVyIjoiczdpXyJ9fX0g");var Y6=function(){let i=class t extends U6{constructor(t){super(t=qi(t,{connector:new V4}));this.N4i_={};this.N4i_=this.N4i_||{};this.N4i_.LBi_={}}query(t){const i=t["z"],s=t["x"],e=t["y"],A=this.ZF_||this.N4i_.X9i_,n=A?A(i,e,s):null,h=t["dst"];this.S4i_.send(this.R4i_(n),{responsetype:"arraybuffer",key:t["key"]},((t,A)=>{if(t)this.onError(t);else if(!this.Df_()){const t=this.N4i_.e8i_,n=this.N4i_.e8i_.d5i_()!==this.N4i_.e8i_.B5i_()?t.transformPoint.bind(t):null;h["tile"]=R6.parse(A,s,e,i,this.N4i_.id,n,this.N4i_.LBi_);this.notify(g8.Z4i_,this,h)}}));return this}};i=t([_s("geotoolkit.map.sources.formats.VectorTile")],i);return i}();const T6=OA.Ai_().gn_("px"),K6=OA.Ai_().gn_("metre"),H6=function(t){const i=Math.sin(t*Math.PI/180),s=Math.log((1+i)/(1-i))/2;return Math.max(Math.min(s,Math.PI),-Math.PI)/2},q6=function(t,i,s){return Math.round(Math.log(t/i/s)/Math.LN2)};var J6=function(){let i=class t extends C8{constructor(t,i){super(t,i);this.e7i_=[];this.A7i_=0;this.uH_={};this.n7i_=-1;this._z=-1;this.h7i_={}}query(t,i){const s=i.if_();if(this.N4i_.FMt_==null||t.isEmpty()||!this.N4i_.FMt_.$s_(t)||!s)return!1;const e=this.N4i_.r7i_,A=T6.wn_(s.BI_(),K6);if(A!=null&&e!=null&&(e[0]!=null&&e[0]>A||e[1]!=null&&e[1]<A)){this.n7i_=-1;return!1}const n=this.o7i_(t.clone().intersect(this.N4i_.FMt_),s),h=n.z;if(h<0)return!1;this.l7i_(h,n.u7i_);this._z=h;this.a7i_();const r=this.n7i_;if(r===-1)this.n7i_=h;else if(r!==h){const t=this.g7i_();t>=this.N4i_.c7i_&&(this.n7i_=t)}let o;const l=this.rpt_(h),u=Date.now();o=this.I7i_(h,n.u7i_,l,u);o=this.I7i_(h,n.f7i_,l,u)||o;return o}K8i_(){this.jF_.on(ff.PV_,((t,i)=>{this.h7i_[i.KL_+"x"+i.cK_]=null;this.uH_[i.KL_][i.cK_]=i;this._z===i.KL_&&this.C7i_()&&this.notify(g8.i8i_,this)}));this.jF_.on(ff.VV_,((t,i)=>{this.h7i_[i.KL_+"x"+i.cK_]="N/A";this.A7i_--}));return this}o7i_(t,i){const s=i.rn_(t),e=this.N4i_.e8i_.B5i_(),A=e.uI_(t.we_(),t.Ee_()),n=e.uI_(t.Qe_(),t.pe_()),h=(H6(n.y)-H6(A.y))/Math.PI,r=n.x-A.x,o=(r<0?r+360:r)/360,l=q6(s.Ts_(),this.N4i_.d7i_,h),u=q6(s.Ie_(),this.N4i_.B7i_,o);let a=Math.min(l,u);if(!isFinite(a))return{z:-1};a=NA.clamp(a,this.N4i_.c7i_,this.N4i_.w7i_);const g=i.rn_(e.E2i_()),c=this.rpt_(a),I=g.Ie_()/c.Ie_(),f=g.Ts_()/c.Ts_(),C=this.rpt_(),d=g.Ie_()/C.Ie_(),B=g.Ts_()/C.Ts_(),w=function(t,i,s,e){const A=Math.floor((t.we_()-g.we_())/i),n=Math.ceil((t.Qe_()-g.we_())/i)-1,h=Math.floor((t.Ee_()-g.Ee_())/s),r=Math.ceil((t.pe_()-g.Ee_())/s)-1;return{Q7i_:Math.max(A,0),E7i_:Math.min(n,e.Ie_()-1),p7i_:Math.max(h,0),m7i_:Math.min(r,e.Ts_()-1)}},Q=i.rn_(this.N4i_.FMt_);return{z:a,u7i_:w(s,I,f,c),y7i_:w(s,d,B,C),f7i_:w(s.Le_(s.Ie_()/10,s.Ts_()/10).intersect(Q),I,f,c)}}g7i_(){if(this.C7i_())return this._z;if(this.n7i_>this._z)return this.n7i_;let t=this._z;for(let i=0;i<this.e7i_.length;i++)for(let s=this.e7i_[i].Q7i_;s<=this.e7i_[i].E7i_;s++)for(let e=this.e7i_[i].p7i_;e<=this.e7i_[i].m7i_;e++){let i,A=s,n=e;for(i=this._z;i>this.n7i_;i--){if(this.uH_[i]&&this.uH_[i][A+"x"+n])break;A=Math.floor(A/2);n=Math.floor(n/2)}t=Math.min(t,i)}return t}I7i_(t,i,s,e){this.uH_[t]=this.uH_[t]||{};let A=Math.floor((i.Q7i_+i.E7i_)/2),n=Math.floor((i.p7i_+i.m7i_)/2),h=0;const r=(i.E7i_-i.Q7i_+1)*(i.m7i_-i.p7i_+1);let o=1,l=0,u=1,a=0,g=!1;while(h<r){if(A>=i.Q7i_&&A<=i.E7i_&&n>=i.p7i_&&n<=i.m7i_){g=this.D7i_(t,A,n,s,e)||g;h++}A+=o;n+=l;if(++a===u){a=0;if(o===0){o=-l;l=0;u++}else{l=o;o=0}}}return g}D7i_(t,i,s,e,A){const n=i+"x"+s,h=t+"x"+n,r=this.uH_[t][n]||this.h7i_[h];if(r!=null){r!=="N/A"&&(r.timestamp=A);return!1}const o=this.M7i_();o._i=i;o._j=s;o.KL_=t;o.cK_=n;o.loaded=!1;o.timestamp=A;this.h7i_[h]=o;this.jF_.query({z:t,x:i,y:s,grid:e,dst:o,key:h,priority:A});return!0}a7i_(){const t=Object.keys(this.h7i_);for(let i=0;i<t.length;i++){const s=this.h7i_[t[i]];if(s&&s!=="N/A"&&!this.v7i_(s)){this.jF_.abort(t[i]);this.h7i_[t[i]]=null;if(s instanceof df){s.dispose();this.A7i_--}}}return this}v7i_(t,i){if(t.KL_!==this._z)return!1;i==null&&(i=1);for(let s=0;s<this.e7i_.length;s++)if(t._i>=this.e7i_[s].Q7i_-i&&t._i<=this.e7i_[s].E7i_+i&&t._j>=this.e7i_[s].p7i_-i&&t._j<=this.e7i_[s].m7i_+i)return!0;return!1}b7i_(){return new df({lazyloading:!0,crossorigin:"anonymous"})}M7i_(){if(this.A7i_>this.N4i_.N7i_&&this.N4i_.N7i_>0){let t=null,i=1/0;for(let s=this.N4i_.c7i_;s<this.N4i_.w7i_;++s)if(this.uH_[s]&&(s!==this.n7i_||s===this._z))for(const e in this.uH_[s]){const A=this.uH_[s][e];if(A&&i>A.timestamp&&!this.v7i_(A)){t=A;i=t.timestamp}}if(t!=null){this.uH_[t.KL_][t.cK_]=null;return t}}this.A7i_++;return this.b7i_()}C7i_(){if(!this.uH_[this._z])return!1;for(let t=0;t<this.e7i_.length;t++)for(let i=this.e7i_[t].Q7i_;i<=this.e7i_[t].E7i_;i++)for(let s=this.e7i_[t].p7i_;s<=this.e7i_[t].m7i_;s++)if(!this.uH_[this._z][i+"x"+s])return!1;return!0}l7i_(t,i){let s=null;const e=this.rpt_(t).Ie_()-1;if(t>this._z||this.e7i_.length===0||i.Q7i_!==0&&i.E7i_!==e)this.e7i_=[i];else if(this.e7i_.length===2)if(i.Q7i_===0){this.e7i_[0]=i;s=this.e7i_[1]}else{this.e7i_[1]=i;s=this.e7i_[0]}else{const A=t===this._z?e:this.rpt_(this._z).Ie_()-1;if(this.e7i_[0].Q7i_===0&&i.E7i_===e){s=this.e7i_[0];this.e7i_.push(i)}else if(this.e7i_[0].E7i_===A&&i.Q7i_===0){s=this.e7i_[0];this.e7i_.unshift(i)}else this.e7i_=[i]}if(s!=null)for(let i=t;i<this._z;i++){s.Q7i_=Math.floor(s.Q7i_/2);s.E7i_=Math.floor(s.E7i_/2);s.p7i_=Math.floor(s.p7i_/2);s.m7i_=Math.floor(s.m7i_/2)}this.e7i_.length===2&&this.e7i_[0].E7i_>=this.e7i_[1].Q7i_&&(this.e7i_=[{Q7i_:Math.min(this.e7i_[0].Q7i_,this.e7i_[1].Q7i_),E7i_:Math.max(this.e7i_[0].E7i_,this.e7i_[1].E7i_),p7i_:this.e7i_[0].p7i_,m7i_:this.e7i_[0].m7i_}])}clear(){super.clear();for(const t in this.uH_)for(const i in this.uH_[t]){const s=this.uH_[t][i];s instanceof df&&s.dispose()}this.e7i_=[];this.A7i_=0;this.uH_={};this.n7i_=-1;return this}abort(){super.abort();for(const t in this.h7i_){const i=this.h7i_[t];if(i instanceof df){i.dispose();this.A7i_--}}this.h7i_={};return this}HKi_(){return this.uH_[this.n7i_]||{}}rpt_(t,i){t==null&&(t=this.n7i_);const s=t>0?1<<t:1,e=this.N4i_.e8i_.d5i_().E2i_();if(!e||e.Ie_()===e.Ts_())return i?i.setSize(s,s):new xA(s,s);let A;if(e.Ie_()>e.Ts_()){A=Math.round(e.Ie_()/e.Ts_());return i?i.setSize(s*A,s):new xA(s*A,s)}A=Math.round(e.Ts_()/e.Ie_());return i?i.setSize(s,s*A):new xA(s,s*A)}V$_(){return this._z===-1?this.N4i_.c7i_:this._z}i7i_(){return this.jF_ instanceof U6?this.jF_.i7i_():null}s7i_(t){this.jF_ instanceof U6&&this.jF_.s7i_(t);return this}};i=t([_s("geotoolkit.map.sources.managers.Tile")],i);return i}();const P6=new xA,V6=new xA,O6=new mA,W6=function(t,i,s,e){const A=Math.floor(t/P6.Ie_()),n=Math.floor(i/P6.Ts_()),h=(A+n)*(A+n+1)/2+A;if(s.S7i_[h])return!1;for(let A=0;A<s.xx.length;A++)if(lA.Gs_(s.xx[A],s.yy[A],t,i)<e)return!1;s.S7i_[h]=!0;s.xx.push(t);s.yy.push(i);return!0};var z6=function(){let i=class t extends J6{constructor(t,i){super(t,i);this.G7i_=0;this.R7i_=0;this.N4i_=this.N4i_||{};this.N4i_.LBi_=this.N4i_.LBi_||{}}K8i_(){const t=[];this.jF_.on(g8.Z4i_,((i,s,e)=>{this.h7i_[e.KL_+"x"+e.cK_]=null;this.uH_[e.KL_][e.cK_]=e;let A=e.KL_===this._z;if(e.k7i_){for(let t=0;t<e.k7i_.length;t++){const i=e.k7i_[t];this.h7i_[i.KL_+"x"+i.cK_]=null;this.uH_[i.KL_][i.cK_]=i;i["tile"]=e["tile"];A=A||i.KL_===this._z}e.k7i_=null}if(A)if(this.C7i_())if(this.v7i_(e,0))if(this._z===this.n7i_){const i=this.F7i_(e).clone();for(let s=0;s<t.length;s++)if(this.v7i_(t[s],0)){const e=this.F7i_(t[s]);i.union(e)}t.length=0;this.notify(g8.i8i_,this,i)}else{t.length=0;this.notify(g8.i8i_,this,null)}else this.notify(g8.i8i_,this,this.F7i_(e));else t.push(e)}));return this}b7i_(){return{}}x7i_(t,i,s){const e=new lu,A=this.uH_[this.n7i_];if(!A)return e;const n=1<<this.n7i_;let h=0,r=0,o=n-1,l=n-1;if(t!=null){const i=this.N4i_.e8i_.B5i_().E2i_(),s=i.Ie_()/n,e=i.Ts_()/n;h=Math.max(h,Math.floor((t.we_()-i.we_())/s));r=Math.max(r,Math.floor((i.pe_()-t.pe_())/e));o=Math.min(o,Math.ceil((t.Qe_()-i.we_())/s)-1);l=Math.min(l,Math.ceil((i.pe_()-t.Ee_())/e)-1)}const u=[];for(const t in A)A[t]&&A[t]._i>=h&&A[t]._i<=o&&A[t]._j>=r&&A[t]._j<=l&&u.push(A[t]["tile"]);i?i.cI_(P6.setSize(1,1),P6):P6.setSize(0,0);const a=this.N4i_.LBi_.layers||[];this.N4i_.LBi_.layers==null&&u.reduce((function(t,i){for(const t in i)a.indexOf(t)<0&&a.push(t);return t}),e);const g={S7i_:{},xx:[],yy:[]};for(let t=0;t<a.length;++t){const i=a[t];let s=this.N4i_.LBi_.spacing?this.N4i_.LBi_.spacing[i]:0;s>0&&(s=Math.pow(s*P6.Ie_(),2));for(let t=0;t<u.length;++t)if(u[t][i]){this.N4i_.LBi_.x9i_!=null&&this.N4i_.LBi_.x9i_[i].zoom!==this.n7i_&&this.N4i_.LBi_.x9i_[i].setZ(this.n7i_);s>0?e.concat(this.L7i_(u[t][i],g,s)):e.concat(u[t][i])}g.xx.length=0;g.yy.length=0}return typeof s=="function"?new ou(e,s):e}L7i_(t,i,s){return t.filter((function(t){const e=t.k9i_;if(!e)return!1;const A=e.e7_();if(!A.$C_())return!0;const n=e.o3i_(),h=t.y5i_();if(Array.isArray(h)){let t=!1;for(let e=0;e<h.length;e++){h[e].k5i_=h[e].k5i_||{};n.apply(h[e],A);if(W6(A.uR_(),A.aR_(),i,s)){h[e].k5i_.U7i_=!1;h[e].k5i_.S6i_=!1;h[e].k5i_.N6i_=!0;t=!0}else{h[e].k5i_.U7i_=!0;h[e].k5i_.S6i_=!0;h[e].k5i_.N6i_=!1}}return t}n.apply(h,A);return!!W6(A.uR_(),A.aR_(),i,s)}))}clear(){for(const t in this.uH_)for(const i in this.uH_[t])this.uH_[t][i]=null;this.uH_={};super.clear();return this}abort(){for(const t in this.h7i_)this.h7i_[t]!=null&&this.A7i_--;this.h7i_={};super.abort();return this}rpt_(t,i){t==null&&(t=this.n7i_);const s=t>0?1<<t:1;return i?i.setSize(s,s):new xA(s,s)}D7i_(t,i,s,e,A){const n=i+"x"+s,h=t+"x"+n,r=this.uH_[t][n]||this.h7i_[h];if(r!=null){r!=="N/A"&&(r.timestamp=A);return!1}if(Array.isArray(this.N4i_.j9i_)&&t>0){let r=1<<t-1,o=0,l=0,u=0,a=this.N4i_.j9i_;while(r>0){const g=(r&i)>0?1:0,c=(r&s)>0?1:0,I=(c<<1)+g;l=(l<<1)+g;u=(u<<1)+c;o++;if(!Array.isArray(a[I])&&(l!==i||u!==s||o!==t)){const r=l+"x"+u,a=o+"x"+r,g=this.M7i_();g._i=i;g._j=s;g.KL_=t;g.cK_=n;g.timestamp=A;if(this.uH_[o]&&this.uH_[o][r]){g["tile"]=this.uH_[o][r]["tile"];this.uH_[t][n]=g;return!1}if(!this.h7i_[a]){this.uH_[o]=this.uH_[o]||{};super.D7i_(o,l,u,e,A)}const c=this.h7i_[a];if(c!=="N/A"){c.k7i_=c.k7i_||[];c.k7i_.push(g)}this.h7i_[h]=g;return!0}a=a[I];r>>=1}}return super.D7i_(t,i,s,e,A)}v7i_(t,i){if(super.v7i_(t,i))return!0;if(!t.k7i_)return!1;for(let s=0;s<t.k7i_.length;s++)if(super.v7i_(t.k7i_[s],i))return!0;return!1}query(t,i){const s=i.yq_();if(s!=null&&(s instanceof zQ||s instanceof tI)){this.R7i_=s.mH_()/Is();this.G7i_=s.yH_()/Is()}return super.query(t,i)}o7i_(t,i){const s=super.o7i_(t,i);if(this.R7i_===0&&this.G7i_===0)return s;const e=i.rn_(t),A=this.N4i_.e8i_.B5i_(),n=i.rn_(A.E2i_()),h=i.rn_(this.N4i_.FMt_);e.Le_(this.R7i_,this.G7i_).intersect(h);const r=this.rpt_(s.z),o=n.Ie_()/r.Ie_(),l=n.Ts_()/r.Ts_(),u=Math.floor((e.we_()-n.we_())/o),a=Math.ceil((e.Qe_()-n.we_())/o)-1,g=Math.floor((e.Ee_()-n.Ee_())/l),c=Math.ceil((e.pe_()-n.Ee_())/l)-1;s.u7i_={Q7i_:Math.max(u,0),E7i_:Math.min(a,r.Ie_()-1),p7i_:Math.max(g,0),m7i_:Math.min(c,r.Ts_()-1)};s.f7i_=s.u7i_;return s}V$_(){return this._z}Y7i_(){return this.n7i_}F7i_(t){const i=this.N4i_.e8i_.B5i_().E2i_(),s=this.rpt_(t.KL_,V6),e=i.Ie_()/s.Ie_(),A=i.Ts_()/s.Ts_(),n=i.we_()+e*t._i,h=i.pe_()-A*t._j;return O6.ce_(n,h,n+e,h-A)}};i=t([_s("geotoolkit.map.sources.managers.VectorTile")],i);return i}();var X6=Ci(function(){let i=class t extends p8{constructor(t){const i=qi(t,{styleurl:null,format:null,loader:t&&t.hasOwnProperty("loader")?t["loader"]:new F6,tilewidth:256,tileheight:256,imagepool:400,minlod:0,maxlod:15},!0);i["format"]=i["format"]||new Y6({formatterfunction:i["formatterfunction"]});i["formatterfunction"]==null||t&&t["loader"]||(i["loader"]=null);super(i);this.N4i_=this.N4i_||{};this.N4i_.B7i_=i["tilewidth"];this.N4i_.d7i_=i["tileheight"];this.N4i_.c7i_=i["minlod"];this.N4i_.w7i_=i["maxlod"];this.N4i_.N7i_=i["imagepool"];this.N4i_.Z9i_=i["styleurl"]}T7i_(){return this.N4i_.LBi_&&this.N4i_.LBi_.fonts||[]}B8i_(t){this.u8i_=new z6(t,this.N4i_);this.u8i_.on(g8.i8i_,((t,i,s)=>{this.notify(g8.i8i_,this,s);this.y8i_(!0)}));return this}HKi_(t,i,s){return this.u8i_!=null?this.u8i_.x7i_(t,i,s):Au.cN_([])}V$_(){return this.u8i_!=null?this.u8i_.V$_():0}Y7i_(){return this.u8i_!=null?this.u8i_.Y7i_():0}C7i_(){return this.u8i_==null||this.u8i_.C7i_()}};i=t([_s("geotoolkit.map.sources.VectorTile")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRGb250cyI6IlQ3aV8ifX19");const j6=function(t,i){if(!t||!i)return!1;for(const s in i)if(t[s]!==i[s])return!1;return!0},Z6=function(t){t.k5i_&&t.k5i_.S6i_!==!0&&t.k5i_.N6i_===!1&&(t.k5i_.N6i_=!0)};var _6=Ci(function(){let i=class t extends h6{constructor(t){super(t=Pi(t,{source:null,converters:t&&t.hasOwnProperty("converters")?t["converters"]:new N8,features:{filter:null},annotations:{visible:!1,strategy:new $8},tooltip:{visible:!1,formatter:new X8}}));this.K7i_(t["annotations"]["text"])}K7i_(t){if(t instanceof YC)this.H7i_=t;else{const i=Pi(t,{preservereadingorientation:!0,ispointingup:!0});this.H7i_=new YC(i)}return this}F3i_(t){const i=this.getParent();if(!i)return Au.cN_([]);let s=null;if(t instanceof r6){s=t.nt_();t=t.getFilter()}const e=s instanceof mA?s:i.rt_();return this.Utt_ instanceof X6?this.Utt_.HKi_(e,this.if_(),t):this.u6i_.F3i_({bbox:e,layer:this,filter:t||null,scale:Math.abs(this.if_().BI_())})}q7i_(t){const i=Au.IN_(this.F3i_());let s;while(i.Hs_()){s=i.next();if(s.XC_()===t)return s}return null}$8i_(t){let i;t instanceof r6||typeof t!="function"||(t=new r6({filter:t}));const s=t.nt_();if(s==null){const t=this.F3i_();i=Array.isArray(t)?t:Au.toArray(t)}else{let t;t=s instanceof mA?bC.select(this,s):s instanceof lA?bC.select(this,new lA(s.getX(),s.getY()),1):bC.select(this,new lA(s["x"],s["y"]),1);i=t.filter((t=>t instanceof t4))}if(!i||i.length<1)return[];const e=t.N_()["properties"],A=t.getFilter();return i.filter((function(t){return!(e!=null&&!j6(t.Uui_(),e))&&(A==null||A(t))}))}J7i_(t,i){}P7i_(t,i){const s=this.UU_["geometrytotext"];if(!s)return;const e=this.UU_["annotations"];if(!e)return;const A=e["strategy"];if(!A)return;const n=this.H7i_;t.forEach((t=>{const e=A.v4_(t,this);if(!e)return;const h=t.nt_(!0);if(Array.isArray(h)){let t;for(let A=0;A<h.length;++A){t=h[A];if(!t.k5i_||t.k5i_.N6i_!==!1){s.apply(t,n,i);n.a_(e);n.render(i)}}}else{s.apply(h,n,i);n.a_(e);n.render(i)}}))}V7i_(t,i,s){t.reset();if(!i)return t;Array.isArray(i)||(i=[i]);const e=this;i.forEach((function(i){if(!ys(i,S8))throw new Error("Not a geotoolkit.map.features.filters.IFilter instance");i.reset();t=i.v6i_(t,s,e)}));return t}O7i_(t){t.forEach((function(t){const i=t.nt_(!0);Array.isArray(i)&&i.forEach(Z6)}))}zY_(t){const i=t.OR_();t.tN_(this.i9i_);const s=t.tk_()?new r6({geometry:this.ot_()}):new r6({geometry:t.rS_()}),e=this.F3i_(s);let A=Array.isArray(e)?Au.cN_(e):e;const n=this.UU_["features"]["filter"];n&&(A=this.V7i_(A,n,t));this.J7i_(A,t);if(this.UU_["annotations"]["visible"]&&!t.tk_()){const i=this.UU_["annotations"]["filter"];if(i){this.O7i_(A);A=this.V7i_(A,i,t)}this.P7i_(A,t)}t.tN_(i)}R8i_(t){super.R8i_(t);if(t=this.k8i_()){this.Utt_!=null&&this.Utt_.R8i_(t);this.uvt_()}return this}W7i_(t){if(this.H7i_.FE_()!==t){this.H7i_.g_(t);this.td_()}return this}rvt_(t){t==null&&(t=new p8);if(this.Utt_===t)return this;this.z7i_||(this.z7i_=this.c6i_.bind(this));this.iit_||(this.iit_=this.X7i_.bind(this));if(this.Utt_!=null){this.Utt_.off(rh.nC_,this.z7i_);this.Utt_.off(g8.Z4i_,this.z7i_);this.Utt_.off(g8._4i_,this.z7i_);this.Utt_.off(g8.i8i_,this.iit_);this.u6i_.w6i_(this.Utt_)}this.Utt_=t;if(this.Utt_!=null){this.Utt_.w5i_(this.Z6i_);this.Utt_.on(rh.nC_,this.z7i_);this.Utt_.on(g8.Z4i_,this.z7i_);this.Utt_.on(g8._4i_,this.z7i_);this.Utt_.on(g8.i8i_,this.iit_);this.u6i_.f6i_(this.Utt_);const t=this.UU_["url"];t!=null&&this.Utt_.D8i_()==null&&this.Utt_.Q8i_(t)}return this}N_(){const t=super.N_();t["annotations"]=this.UU_["annotations"];t["tooltip"]=this.UU_["tooltip"];t["features"]=this.UU_["features"];return t}dt_(t){if((t=Es(t))==null)return this;super.dt_(t);t["annotations"]&&t["annotations"]["text"]&&this.K7i_(t["annotations"]["text"]);t["features"]!==void 0&&(this.UU_["features"]=t["features"]);return this}setOptions(t){if(t==null)return this;let i=null;Array.isArray(t["converters"])?i=[new N4].concat(t["converters"]):t["converters"]!=null?i=[new N4,t["converters"]]:this.u6i_==null&&(i=new N4);if(i!=null){this.u6i_!=null&&this.u6i_.dispose();this.u6i_=new y8(i).on(S4.L3i_,((t,i,s)=>{s||this.td_();this.notify(S4.L3i_,this)}));this.Cvt_()!=null&&this.Cvt_().update()}t["annotations"]&&t["annotations"]["text"]&&t["annotations"]["text"]["textstyle"]&&this.W7i_(t["annotations"]["text"]["textstyle"]);super.setOptions(t);return this}uvt_(t){if(!this.WH_){t instanceof t4&&(t=[t]);this._6i_=this.$6i_(t);this.notify(rh.nC_,this,this._6i_)}}O4i_(){const t=this.F3i_(),i=new _3({initialcoordinatesystem:this.k8i_()});return a8.O4i_(t,i.transform.bind(i))}j7i_(t){const i=new _3({initialcoordinatesystem:this.k8i_()}),s=[["lat","lon"]],e=new lA,A=function(n){if(n.N5i_())return;if(n instanceof p4){n.j5i_().forEach(A);return}const h=n.nt_(!0);let r,o;const l=n.S5i_()?h:[h],u=Object.keys(n.Uui_());for(r=0;r<u.length;r++)if(s[0].indexOf(u[r])===-1){s[0].push(u[r]);for(o=1;o<s.length;o++)s[o].push("")}for(r=0;r<l.length;r++){e.x=l[r].x;e.y=l[r].y;i.transformPoint(e,e);const A=[NA.round(e.y,t)+"",NA.round(e.x,t)+""];for(o=2;o<s[0].length;o++){const t=s[0][o];n.Uui_()[t]!==void 0?A.push(n.Uui_()[t]+""):A.push("")}s.push(A)}};this.F3i_().forEach(A);return s}c6i_(t,i,s){this.uvt_(t===g8.Z4i_?s:null)}X7i_(t,i,s){this.td_(s)}dispose(){this.u6i_!=null&&this.u6i_.dispose();super.dispose()}b6i_(){return this.UU_["annotations"]?this.UU_["annotations"]["strategy"]:null}};i.prototype.l3i_=Zi;i=t([_s("geotoolkit.map.layers.AbstractFeatureLayer")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRGZWF0dXJlcyI6IkYzaV8iLCJnZXRHZW9tZXRyeVRvVGV4dCI6ImwzaV8iLCJnZXRGZWF0dXJlQnlJZCI6InE3aV8iLCJxdWVyeUZlYXR1cmVzIjoiJDhpXyIsInJlbmRlckZlYXR1cmVzIjoiSjdpXyIsInJlbmRlckFubm90YXRpb25zIjoiUDdpXyIsInJlbmRlckNvbnRlbnQiOiJ6WV8iLCJzZXRNYXBDb29yZGluYXRlU3lzdGVtIjoiUjhpXyIsImdldFByb3BlcnRpZXMiOiJOXyIsInNldFByb3BlcnRpZXMiOiJkdF8iLCJ0b0dlb0pTT04iOiJPNGlfIiwidG9DU1YiOiJqN2lfIn19fSAg");const $6={};var t9=Ci(function(){let i=class t extends q4{constructor(t){super();this.S4i_=t&&t["connector"]||new V4(t);this.Z7i_=t&&t["tokenconnector"]||new V4(t)}send(t,i,s){if(!t)return this.S4i_.send(t,i,s);i=i||{};const e=t.split(/(\/FeatureServer|\/MapServer|\/StreamServer|\/ImageServer|\?)/,2).join("");(i["token"]||$6[e])&&(t+=(t.indexOf("?")>=0?"&":"?")+"token="+(i["token"]||$6[e]));this.S4i_.send(t,i,((A,n)=>{if(A||typeof n!="string")return s(A,n);let h;try{h=JSON.parse(n)}catch(t){return s(null,n)}if(typeof h["status"]=="string"&&h["status"].toLowerCase()==="error")return s(new Error("ArcGIS error: "+h["messages"]),n);if(!h["error"]||h["error"]["code"]!==Ms.k_&&h["error"]["code"]!==Ms.F_)return s(null,n);if(!i["token"])return s(new Error(this.D_()+": Authorization token should be specified"));const r=t.indexOf("/rest/");if(r<0)return s(new Error(this.D_()+": Can't find info url"));const o=t.substr(0,r)+"/rest/info?f=json";this.Z7i_.send(o,i,((A,n)=>{if(A||typeof n!="string")return s(A);let h;try{h=JSON.parse(n)}catch(t){return s(t,n)}if(!h||!h["authInfo"]||!h["authInfo"]["isTokenBasedSecurity"])return s(new Error(this.D_()+": Not a token based security"));if(!h["authInfo"]["tokenServicesUrl"])return s(new Error(this.D_()+": Can't find a token service url"));const r=h["authInfo"]["tokenServicesUrl"]+"?f=json&serverUrl="+e+"&token="+i["token"];this.Z7i_.send(r,i,((A,n)=>{if(A||typeof n!="string")return s(A);let h;try{h=JSON.parse(n)}catch(t){return s(t,n)}if(!h||!h["token"])return s(null,h);$6[e]=h["token"];this.send(t,i,s);return null}));return null}));return null}));return null}abort(t){this.Z7i_.abort(t);this.S4i_.abort(t);return this}f4i_(){return this.S4i_.f4i_()||this.Z7i_.f4i_()}};i=t([_s("geotoolkit.map.sources.connectors.ArcGISToken")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpc0xvYWRpbmciOiJmNGlfIn19fSAg");const i9=function(t,i){switch(t){case"-":return-i;case"+":return i;case"!":return!i;case"~":return~i}return 0},s9=function(t,i,s){switch(t){case"+":return i+s;case"-":return i-s;case"*":return i*s;case"/":return i/s;case"%":return i%s;case"==":return i==s;case"!=":return i!=s;case"===":return i===s;case"!==":return i!==s;case">":return i>s;case">=":return i>=s;case"<":return i<s;case"<=":return i<=s;case"&":return i&s;case"|":return i|s;case"^":return i^s;case"<<":return i<<s;case">>":return i>>s;case">>>":return i>>>s;case"&&":return i&&s;case"||":return i||s}return 0},e9=function(t){return t[0].toUpperCase()+t.substr(1)},A9=function(t,i){let s;const e=i.length;switch(t){case"array":const A=[],n=e>1?i[1]:null;for(s=0;s<i[0];s++)A.push(n);return A;case"back":return i[0][i[0].length-1];case"count":return typeof i[0]=="string"||Array.isArray(i[0])?i[0].length:Object.keys(i[0]).length;case"dictionary":if(e===1)return JSON.parse(i[0]);const h={};for(s=0;s<e;s+=2)h[i[s]]=i[s+1];return h;case"distinct":return(i=A9("splice",i)).filter((function(t,s){return i.indexOf(t)===s}));case"erase":return i[0].splice(i[1],1);case"first":return i[0][0];case"haskey":return i[0].hasOwnProperty(i[1]);case"includes":return i[0].indexOf(i[1])>=0;case"indexof":return i[0].indexOf(i[1]);case"insert":return i[0].splice(i[1],0,i[2]);case"isnan":return isNaN(i[0]);case"number":return+i[0];case"push":return i[0].push(i[1]);case"pop":return i[0].pop();case"resize":const r=i[0];r.length=Math.min(r.length,i[1]);for(s=r.length;s<i[1];s++)r.push(e>2?i[2]:null);return r;case"reverse":return i[0].reverse();case"slice":return i[0].slice(i[1],i[2]);case"sort":return i[1].sort();case"splice":return Array.prototype.concat.apply([],i);case"text":return""+i[0];case"top":return i[0].slice(0,i[1]);case"typeof":const o=typeof i[0];return o==="string"?"Text":o==="boolean"||o==="number"||o==="function"?e9(o):Array.isArray(i[0])?"Array":o;case"boolean":const l=i[0];return typeof l!="string"?!!l:l==="true";case"decode":for(s=1;s<e-1;s+=2)if(i[0]===i[s])return i[s+1];return i[e-1];case"defaultvalue":return i[0]==null||i[0]===""?i[1]:i[0];case"iif":return i[0]?i[1]:i[2];case"isempty":return i[0]==null||i[0]==="";case"when":for(s=0;s<e-1;s+=2)if(i[s])return i[s+1];return i[e-1];case"abs":case"acos":case"asin":case"atan":case"atan2":case"cos":case"sin":case"tan":case"sqrt":case"exp":case"log":case"pow":case"random":return Math[t].apply(null,i);case"mean":case"average":if(typeof i[1]=="string")return 0;i=A9("splice",i);return A9("sum",i)/i.length;case"ceil":case"floor":case"round":const u=Math.pow(10,i[1]||0);return Math[t](i[0]*u)/u;case"constrain":return NA.clamp(i[0],i[1],i[2]);case"min":case"max":if(typeof i[1]=="string")return 0;i=A9("splice",i);return Math[t].apply(null,i);case"variance":if(typeof i[1]=="string")return 0;const a=A9("mean",i);return A9("mean",i.map((function(t){return(t-a)*(t-a)})));case"stdev":const g=A9("variance",i);return Math.sqrt(g);case"sum":return typeof i[1]=="string"?0:i.reduce((function(t,i){return t+i}));case"concatenate":return i[0].join(i[1]||"");case"find":return i[1].indexOf(i[0],i[2]);case"left":return i[0].substr(0,i[1]);case"mid":return i[0].substr(i[1],i[2]);case"right":return i[0].substr(-i[1]);case"lower":return i[0].toLowerCase();case"upper":return i[0].toUpperCase();case"proper":return i[1]==="firstword"?e9(i[0]):i[0].split(" ").map(e9).join(" ");case"replace":const c=i[3]===!1?i[1]:new RegExp(i[1],"g");return i[0].replace(c,i[2]);case"split":const I=i[0].split(i[1]);i[2]>0&&(I.length=i[2]);return i[3]?I.filter((function(t){return t!==""})):I;case"trim":return i[0].trim();case"urlencode":if(typeof i[0]=="string")return encodeURI(i[0]);const f=i[0];return Object.keys(f).map((function(t){return t+"="+f[t]})).join("&")}return 0};var n9=function(){var t=class{constructor(t){const i=new Im(t);this.A4i_=null;try{this.A4i_=i.aot_()}catch(i){ki("Arcade code is not supported: "+t)}}getValue(i){return t.Pct_(this.A4i_,{$feature:i,$view:{scale:1e4},Infinity:1/0,PI:Math.PI,TextFormatting:{BackwardSlash:"\\",DoubleQuote:'"',ForwardSlash:"/",NewLine:"\n",SingleQuote:"'"}},{})}static Pct_(i,s,e){if(!i||e.iyi_||e.continue)return null;let A,n,h,r,o;switch(i.type){case Im.Rnt_.kB_:return e.Omt_?[i.name]:s[i.name];case Im.Rnt_.Mst_:return i.value;case Im.Rnt_.Ist_:return t.Pct_(i.dht_,s,e);case Im.Rnt_.kst_:o={};for(A=0;A<i.properties.length;A++){r=i.properties[A];const n=undefined;o[t.Pct_(r.key,s,{Omt_:!0})]=t.Pct_(r.value,s,e)}return o;case Im.Rnt_._st_:for(A=0;A<i.wp_.length;A++)t.Pct_(i.wp_[A],s,e);return null;case Im.Rnt_.$st_:h=t.Pct_(i.id,s,{Omt_:!0});o=e.init!=null?e.init:t.Pct_(i.init,s,e);s[h[0]]=o;return o;case Im.Rnt_.xst_:case Im.Rnt_.Zit_:let l=null;for(A=0;A<i.body.length;A++)l=t.Pct_(i.body[A],s,e);return l;case Im.Rnt_.Nst_:const u=t.Pct_(i.object,s,e);let a=t.Pct_(i.dp_,s,{Omt_:!i.Mht_});Array.isArray(a)&&(a=a[0]);return e.Omt_?[].concat(u,a):u[a];case Im.Rnt_.Vit_:h=t.Pct_(i.left,s,{Omt_:!0});o=t.Pct_(i.right,s,e);r=s;for(A=0,n=h.length-1;A<n;A++)r=r[h[A]];i.operator.length>1&&(o=s9(i.operator.slice(0,-1),r[h[n]],o));r[h[n]]=o;return o;case Im.Rnt_._it_:case Im.Rnt_.bst_:const g=t.Pct_(i.left,s,e),c=t.Pct_(i.right,s,e);return s9(i.operator,g,c);case Im.Rnt_.jst_:o=t.Pct_(i.oht_,s,e);return i9(i.operator,o);case Im.Rnt_.Zst_:h=t.Pct_(i.oht_,s,{Omt_:!0});r=s;for(A=0,n=h.length-1;A<n;A++)r=r[h[A]];o=r[h[n]];r[h[n]]=i.operator==="--"?o-1:o+1;return i.prefix?r[h[n]]:o;case Im.Rnt_.tst_:const I=i.arguments.map((function(i){return t.Pct_(i,s,e)})),f=t.Pct_(i.Tht_,s,{Omt_:!0})[0];return typeof s[f]=="function"?s[f](I):A9(f.toLowerCase(),I);case Im.Rnt_.Qst_:case Im.Rnt_.nst_:const C=t.Pct_(i.test,s,e)?i._ht_:i.alternate;return t.Pct_(C,s,e);case Im.Rnt_.Wit_:return i.elements.map((function(i){return t.Pct_(i,s,e)}));case Im.Rnt_.Yst_:return t.Pct_(i.oht_,s,e);case Im.Rnt_.Bst_:case Im.Rnt_.wst_:h=i.params.map((function(i){return t.Pct_(i,s,{Omt_:!0})[0]}));const d=function(e){const n=qi(s,{});for(A=0;A<h.length;A++)n[h[A]]=e[A];return t.Pct_(i.body,n,{})},B=t.Pct_(i.id,s,{Omt_:!0});B!=null&&(s[B[0]]=d);return d;case Im.Rnt_.fst_:t.Pct_(i.init,s,e);e={};while(t.Pct_(i.test,s,e)){t.Pct_(i.body,s,e);e.continue=!1;if(e.iyi_)break;t.Pct_(i.update,s,e)}return null;case Im.Rnt_.dst_:o=t.Pct_(i.right,s,{});e={};const w=Object.keys(o);for(A=0;A<w.length;A++){t.Pct_(i.left,s,{init:w[A]});t.Pct_(i.body,s,e);if(e.iyi_)break;e.continue=!1}return null;case Im.Rnt_.$it_:e.iyi_=!0;return null;case Im.Rnt_.hst_:e.continue=!0;return null;default:return null}}};return t}();let h9=null,r9=null,o9=null;const l9=OA.Ai_().gn_("pt"),u9=new nA(0,0,0,0),a9=new lA;var g9=function(){var t=class{constructor(t){this._7i_=t==null||t;this.I9i_=[];this.pi_=[]}$7i_(t,i){if(this._7i_)if(typeof i=="string"){const t=i.substr(-2),s=parseFloat(i);i=t==="pt"?l9.wn_(s,"px"):s}else i=l9.wn_(i,"px");for(let s=0;s<this.I9i_.length;++s)if(t<this.I9i_[s]){this.I9i_.splice(s,0,t);this.pi_.splice(s,0,+i);return}this.I9i_.push(t);this.pi_.push(+i)}getValue(t){if(this.I9i_.length<=1||this.I9i_[0]>=t)return this.pi_[0]||0;for(let i=1;i<this.I9i_.length;++i)if(this.I9i_[i]>=t){const s=(t-this.I9i_[i-1])/(this.I9i_[i]-this.I9i_[i-1]);return this.pi_[i-1]+s*(this.pi_[i]-this.pi_[i-1])}return this.pi_[this.pi_.length-1]}uM_(){return this.I9i_.length>0}};return t}(),c9=function(){var i;let s=i=class t{static parse(t,s,e){let A;const n=undefined,h=(t["drawingInfo"]||{})["renderer"];let r={S3_:h,type:i.tts_(t["geometryType"])};if(!h)return r;const o=i.its_(h);switch(h["type"]){case"simple":r.Dn_={$f_:o,sts_:i.ets_(h["symbol"],s,e)};break;case"uniqueValue":const t=h["uniqueValueInfos"];for(A=0;A<t.length;A++)r[t[A]["value"]]={$f_:o,sts_:i.ets_(t[A]["symbol"],s,e)};h["defaultSymbol"]!=null&&(r.Ats_={$f_:o,label:h["defaultLabel"],sts_:i.ets_(h["defaultSymbol"],s,e)});break;case"classBreaks":r.nts_=[];r.hts_=[];const n=h["classBreakInfos"];for(A=0;A<n.length;A++){r.nts_[A]={$f_:o,label:n[A]["label"],sts_:i.ets_(n[A]["symbol"],s,e)};r.hts_[A]={bft_:n[A]["classMinValue"],Nft_:n[A]["classMaxValue"]}}h["defaultSymbol"]!=null&&(r.Ats_={$f_:o,label:h["defaultLabel"],sts_:i.ets_(h["defaultSymbol"],s,e)});break;case"vectorField":r=i.rts_(h,r,o);break;default:ki("This renderer type is not supported!")}h["valueExpression"]!=null&&(h.ots_=i.lts_(h["valueExpression"]));return r}static ets_(t,s,e){if(t==null)return null;const A=i.uts_(t,s);switch(t["type"]){case"esriSMS":r9==null&&(r9={esriSMSSquare:tp,esriSMSCircle:cE,esriSMSCross:IE,esriSMSDiamond:fE,esriSMSTriangle:da,esriSMSX:IE,default:cE});const s=i.ats_(t["outline"]),n=s!=null?2*s.Ie_():0,h={painter:r9[t["style"]]!=null?r9[t["style"]]:r9["default"],width:t["size"]+n,height:t["size"]+n,sizeisindevicespace:!0,ax:t["xoffset"],ay:t["yoffset"],fillstyle:i.cs_(t["color"]),linestyle:s};return new A6({shape:new ma(h),textshape:e});case"esriPMS":return new A6({shape:new df({ax:t["xoffset"],ay:t["yoffset"],width:t["width"],height:t["height"],alignment:dA.ne_,ispointingup:!0,sizeisindevicespace:!0,url:A}),textshape:e});case"esriSFS":return new n6({shape:new oE({fillstyle:i.Kyi_(t),linestyle:i.ats_(t["outline"])}),textshape:e});case"esriPFS":return new n6({shape:new oE({fillstyle:new wr({pattern:Nl.Ai_().createPattern(A)}),linestyle:i.ats_(t["outline"])}),textshape:e});case"esriSLS":return new e6({shape:new ap({linestyle:i.ats_(t)}),textshape:e})}return null}static uts_(t,i){if(t["imageData"]!=null){const i=undefined;return"data:"+(t["contentType"]||"image/png")+";base64,"+t["imageData"]}return t["url"]!=null?i+t["url"]:null}static cs_(t){return Array.isArray(t)?new nA(t[0],t[1],t[2],t[3]):t}static ats_(t){if(t==null)return null;h9==null&&(h9={esriSLSDash:el.pD_,esriSLSDashDot:el.mD_,esriSLSDashDotDot:el.MD_,esriSLSDot:el.Dot,esriSLSSolid:el.ED_,default:el.ED_});return new hl({color:i.cs_(t["color"]),width:t["width"]!=null?t["width"]:1,pattern:h9[t["style"]]!=null?h9[t["style"]]:h9["default"]})}static Oy_(t){if(t==null)return null;const i=t["size"]!=null?t["size"]+"pt ":"12px ",s=t["family"]!=null?t["family"]:"sans-serif",e=t["style"]!=null?t["style"]+" ":"",A=undefined;return(t["weight"]!=null?t["weight"]+" ":"")+e+i+s}static Crt_(t){if(t==null)return null;o9==null&&(o9={esriSFSSolid:null,esriSFSNull:Nl.Ai_().createPattern("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScx"+"MCcgaGVpZ2h0PScxMCc+ICA8cmVjdCB3aWR0aD0nMTAnIGhlaWdodD0nMTAnIGZpbGw9J25vbmUnLz48L3N2Zz4="),esriSFSHollow:Nl.Ai_().createPattern("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScx"+"MCcgaGVpZ2h0PScxMCc+ICA8cmVjdCB3aWR0aD0nMTAnIGhlaWdodD0nMTAnIGZpbGw9J25vbmUnLz48L3N2Zz4="),esriSFSHorizontal:Nl.Ai_().createPattern("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScx"+"MCcgaGVpZ2h0PScxMCc+ICA8cmVjdCB3aWR0aD0nMTAnIGhlaWdodD0nMTAnIGZpbGw9J25vbmUnIC8+ICA8cmVjdCB4PScwJ"+"yB5PScwJyB3aWR0aD0nMTAnIGhlaWdodD0nMScgZmlsbD0nYmxhY2snIC8+PC9zdmc+"),esriSFSVertical:Nl.Ai_().createPattern("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScx"+"MCcgaGVpZ2h0PScxMCc+ICA8cmVjdCB3aWR0aD0nMTAnIGhlaWdodD0nMTAnIGZpbGw9J25vbmUnIC8+ICA8cmVjdCB4PScwJ"+"yB5PScwJyB3aWR0aD0nMScgaGVpZ2h0PScxMCcgZmlsbD0nYmxhY2snIC8+PC9zdmc+"),esriSFSForwardDiagonal:Nl.Ai_().createPattern("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScx"+"MCcgaGVpZ2h0PScxMCc+ICA8cmVjdCB3aWR0aD0nMTAnIGhlaWdodD0nMTAnIGZpbGw9J25vbmUnLz4gIDxwYXRoIGQ9J00wL"+"DAgbDEwLDEwJyBzdHJva2U9J2JsYWNrJyBzdHJva2Utd2lkdGg9JzEnLz48L3N2Zz4="),esriSFSBackwardDiagonal:Nl.Ai_().createPattern("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScx"+"MCcgaGVpZ2h0PScxMCc+ICA8cmVjdCB3aWR0aD0nMTAnIGhlaWdodD0nMTAnIGZpbGw9J25vbmUnLz4gIDxwYXRoIGQ9J00tM"+"SwxIGwyLC0yICAgICAgICAgICBNMCwxMCBsMTAsLTEwICAgICAgICAgICBNOSwxMSBsMiwtMicgc3Ryb2tlPSdibGFjaycgc3"+"Ryb2tlLXdpZHRoPScxJy8+PC9zdmc+"),esriSFSCross:Nl.Ai_().createPattern("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScx"+"MCcgaGVpZ2h0PScxMCc+ICA8cmVjdCB3aWR0aD0nMTAnIGhlaWdodD0nMTAnIGZpbGw9J25vbmUnLz4gIDxwYXRoIGQ9J001L"+"DAgbDAsMTAgICAgICAgICAgIE0wLDUgbDEwLDAnIHN0cm9rZT0nYmxhY2snIHN0cm9rZS13aWR0aD0nMScvPjwvc3ZnPg=="),esriSFSDiagonalCross:Nl.Ai_().createPattern("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScx"+"MCcgaGVpZ2h0PScxMCc+ICA8cmVjdCB3aWR0aD0nMTAnIGhlaWdodD0nMTAnIGZpbGw9J25vbmUnLz4gIDxwYXRoIGQ9J00wL"+"DAgbDEwLDEwICAgICAgICAgICBNMTAsMCBsLTEwLDEwJyBzdHJva2U9J2JsYWNrJyBzdHJva2Utd2lkdGg9JzEnLz48L3N2Zz4=")});return o9[t]}static Kyi_(t){const s=i.Crt_(t["style"]),e=i.cs_(t["color"]);return new wr(s!=null?{color:u9,pattern:s,foreground:e}:{color:e})}static gts_(t,i){const s=[];if(!Array.isArray(t)){a9.vs_(t["x"],t["y"]);i&&i.transform(a9,a9);return[{x:a9.x,y:a9.y}]}const e=t.length>0&&Array.isArray(t[0][0]);for(let A=0;A<t.length;A++)if(e){const e=[],n=[];for(let s=0;s<t[A].length;s++){const h=t[A][s];a9.vs_(h[0],h[1]);i&&i.transform(a9,a9);e.push(a9.x);n.push(a9.y)}s.push({x:e,y:n})}else{a9.vs_(t[A][0],t[A][1]);i&&i.transform(a9,a9);s.push({x:a9.x,y:a9.y})}return s}static cts_(t){return Array.isArray(t)&&t.length!==0?i.Its_(t[0]["symbol"]):null}static Its_(t){if(t==null)return null;const s=i.cs_(t["backgroundColor"]),e=i.cs_(t["borderLineColor"]),A=t["borderLineSize"]!=null?t["borderLineSize"]:1,n=i.fts_(t["labelPlacement"]),h=t["haloColor"]==null?null:new hl({color:i.cs_(t["haloColor"]),width:t["haloSize"]==null?1:t["haloSize"]/.75});return new YC({textstyle:new qa({color:i.cs_(t["color"]),font:i.Oy_(t["font"]),alignment:Fa.ne_,outline:h}),ispointingup:!0,fillstyle:s?new wr(s):null,linestyle:e?new hl(e,A):null,alignment:n})}static fts_(t){if(typeof t!="string")return dA.ne_;const i=t.indexOf("Left")>-1,s=!i&&t.indexOf("Right")>-1;return t.indexOf("Above")>-1?i&&dA.ie_||s&&dA.ee_||dA.le_:t.indexOf("Below")>-1?i&&dA.se_||s&&dA.Ae_||dA.re_:i&&dA.he_||s&&dA.oe_||dA.ne_}static Cts_(t,s){if(!s||!s.S3_)return null;let e;const A=s.S3_;switch(A["type"]){case"simple":return i.dts_(s.Dn_,t);case"uniqueValue":e=A.ots_!=null?A.ots_(t):["field","field1","field2","field3"].reduce(((i,s)=>{if(A[s]==null)return i;const e=t[A[s]]+"";return i?i+A["fieldDelimiter"]+e:e}),null);if(s[e]!=null)return i.dts_(s[e],t);break;case"classBreaks":e=A.ots_?A.ots_(t):+t[A["field"]];for(let n=0;n<s.nts_.length;n++){const h=undefined;if(e>=(s.hts_[n].bft_||(n>0?s.hts_[n-1].Nft_:A["minValue"]))&&e<=s.hts_[n].Nft_)return i.dts_(s.nts_[n],t)}break;case"vectorField":const n=s.Bts_;let h=A["attributeField"];if(!t.hasOwnProperty(h)){h=h.toLowerCase();for(const i in t)if(i.toLowerCase()===h){A["attributeField"]=i;break}}e=t[A["attributeField"]];if(!n||e==null)return i.dts_(s.Ats_,t);for(let A=1;A<n.length-1;++A)if(+e<n[A])return i.dts_(s.wts_[A-1],t);return i.dts_(s.wts_[s.wts_.length-1],t)}return i.dts_(s.Ats_,t)}static tts_(t){switch(t){case"esriGeometryPoint":return[w4,W4,null];case"esriGeometryMultipoint":return[w4,W4,"points"];case"esriGeometryPath":case"esriGeometryLine":case"esriGeometryPolyline":return[X4,Z4,"paths"];case"esriGeometryRing":case"esriGeometryPolygon":default:return[$4,i8,"rings"]}}static warn(t){if(t==null)return;const i=t["code"],s=t["details"],e=t["message"];ki("ArcGIS layer returned error ("+i+"):\n"+(Array.isArray(s)&&s.length>0?s.join("\n"):e))}static rts_(t,s,e){const A=new hl("black",1.5),n=i.Qts_("M15 32 15 16 10 23 16 3 22 23 17 16 17 32");let h;switch(t["style"].toLowerCase()){case"wind_speed":h=i.Ets_(.5,.3,A);const t=[h,h],r=["M25 0 25 40 M25 35 17.5 37.5","M25 0 25 40 10 45 25 40","M25 0 25 40 10 45 25 40 M25 35 17.5 37.5","M25 0 25 40 10 45 25 40 M25 35 10 40","M25 0 25 40 10 45 25 40 M25 35 10 40 25 35 M25 30 17.5 32.5","M25 0 25 40 10 45 25 40 M25 35 10 40 25 35 M25 30 10 35","M25 0 25 40 10 45 25 40 M25 35 10 40 25 35 M25 30 10 35 25 30 M25 25 17.5 27.5","M25 0 25 40 10 45 25 40 M25 35 10 40 25 35 M25 30 10 35 25 30 M25 25 10 30","M25 0 25 40 10 45 25 40 M25 35 10 40 25 35 M25 30 10 35 25 30 M25 25 10 30 25 25 M25 20 17.5 22.5","M25 0 25 40 10 40 25 35","M25 0 25 40 10 40 25 35 M25 30 17.5 32.5","M25 0 25 40 10 40 25 35 M25 30 10 35","M25 0 25 40 10 40 25 35 M25 30 10 35 25 30 M25 25 17.5 27.5","M25 0 25 40 10 40 25 35 M25 30 10 35 25 30 M25 25 10 30","M25 0 25 40 10 40 25 35 M25 30 10 35 25 30 M25 25 10 30 25 25 M25 20 17.5 22.5","M25 0 25 40 10 40 25 35 M25 30 10 35 25 30 M25 25 10 30 25 25 M25 20 10 25","M25 0 25 40 10 40 25 35 M25 30 10 35 25 30 M25 25 10 30 25 25 M25 20 10 25 25 20 M25 15 17.5 17.5","M25 0 25 40 10 40 25 35 M25 30 10 35 25 30 M25 25 10 30 25 25 M25 20 10 25 25 20 M25 15 10 20","M25 0 25 40 10 40 25 35 M25 30 10 35 25 30 M25 25 10 30 25 25 M25 20 10 25 25 20 M25 15 10 20 25 15 M25 10 17.5 12.5","M25 0 25 40 10 40 25 35 10 35 25 30","M25 0 25 40 10 40 25 35 10 35 25 30 M25 25 17.5 27.5","M25 0 25 40 10 40 25 35 10 35 25 30 M25 25 10 30","M25 0 25 40 10 40 25 35 10 35 25 30 M25 25 10 30 M25 25 M25 20 17.5 22.5","M25 0 25 40 10 40 25 35 10 35 25 30 M25 25 10 30 M25 25 M25 20 10 25","M25 0 25 40 10 40 25 35 10 35 25 30 M25 25 10 30 M25 25 M25 20 10 25 M25 20 M25 15 17.5 17.5","M25 0 25 40 10 40 25 35 10 35 25 30 M25 25 10 30 M25 25 M25 20 10 25 M25 20 M25 15 10 20","M25 0 25 40 10 40 25 35 10 35 25 30 M25 25 10 30 M25 25 M25 20 10 25 M25 20 M25 15 10 20 M25 15 M25 10 17.5 12.5","M25 0 25 40 10 40 25 35 10 35 25 30 M25 25 10 30 M25 25 M25 20 10 25 M25 20 M25 15 10 20 M25 15 M25 10 10 15","M25 0 25 40 10 40 25 35 10 35 25 30 M25 25 10 30 M25 25 M25 20 10 25 M25 20 M25 15 10 20 M25 15 M25 10 10 15 M25 10 M25 5 17.5 7.5"];s.Bts_=[0,5];for(let e=0,n=10;n<=150;e++,n+=5){s.Bts_.push(n);t.push(i.Qts_(r[e]).rB_(A))}s.wts_=i.pts_(t,e);break;case"single_arrow":h=n.iQ_("#005ce6");break;case"classified_arrow":h=n.iQ_("#38a800");s.Bts_=[0,1e-6,3.5,7,10.5,14];s.wts_=i.pts_(n,e,["#38a800","#8b3500","#ffff00","#ff8000","#ff0000"]);break;case"beaufort_m":h=n.iQ_("#d62f27");s.Bts_=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];s.wts_=i.pts_(n,e,["#4575b5","#6589b8","#849eba","#a2b4bd","#c0ccbe","#dee3bf","#ffffbf","#ffdca1","#fab984","#f59869","#ed7551","#e81515"]);break;case"beaufort_km":h=n.iQ_("#d62f27");s.Bts_=[0,.72,6.48,11.88,19.44,30.6,39.6,50.76,61.92,74.88,87.84,102.96,117.72];s.wts_=i.pts_(n,e,["#4575b5","#6589b8","#849eba","#a2b4bd","#c0ccbe","#dee3bf","#ffffbf","#ffdca1","#fab984","#f59869","#ed7551","#e81515"]);break;case"beaufort_ft":h=n.iQ_("#d62f27");s.Bts_=[0,.656168,5.905512,10.826772,17.716536,27.88714,36.08924,46.259844,56.430448,68.241472,80.052496,93.832024,107.283468];s.wts_=i.pts_(n,e,["#4575b5","#6589b8","#849eba","#a2b4bd","#c0ccbe","#dee3bf","#ffffbf","#ffdca1","#fab984","#f59869","#ed7551","#e81515"]);break;case"beaufort_mi":h=n.iQ_("#d62f27");s.Bts_=[0,.447388,4.026492,7.381902,12.079476,19.01399,24.60634,31.540854,38.475368,46.528352,54.581336,63.976484,73.147938];s.wts_=i.pts_(n,e,["#4575b5","#6589b8","#849eba","#a2b4bd","#c0ccbe","#dee3bf","#ffffbf","#ffdca1","#fab984","#f59869","#ed7551","#e81515"]);break;case"beaufort_kn":h=n.iQ_("#d62f27");s.Bts_=[0,1,3,6,10,16,21,27,33,40,47,55,63];s.wts_=i.pts_(n,e,["#2892c7","#59a2ba","#81b3ab","#a0c29b","#bfd48a","#dae677","#fafa64","#fcd553","#fcb366","#fa8d34","#f76e2a","#f0471d"]);break;case"ocean_current_m":h=n.iQ_("#b1b1b1");s.Bts_=[0,.5,1,1.5,2];s.wts_=i.pts_(n,e,["#4e1a99","#b31b1a","#ca801a","#b1b1b1"]);break;case"ocean_current_kn":h=n.iQ_("#b1b1b1");s.Bts_=[0,.25,.5,1,1.5,2,2.5,3,3.5,4];s.wts_=i.pts_(n,e,["#000000","#002564","#4e1a99","#970064","#b31b1a","#b14e1a","#ca801a","#b1b334","#b1b1b1"]);break;case"simple_scalar":const o=new Yu({fillstyle:"black",linestyle:null}).moveTo(.4,.4).lineTo(.4,.6).lineTo(.6,.6).lineTo(.6,.4);h=(t,i,s)=>{s.rB_(A);cE.call(this,t,i,s);o.render(s)};break}s.Ats_={sts_:new A6({shape:new ma({width:40,height:40,sizeisindevicespace:!0,painter:h})})};return s}static Ets_(t,i,s){const e=new mA(.5-t,.5-t,.5+t,.5+t),A=new mA(.5-i,.5-i,.5+i,.5+i);return(t,i,n)=>{n.rB_(s);cE.call(this,t,e,n);cE.call(this,t,A,n)}}static Qts_(t){const s=new Yu({linestyle:null}),e=t.split(" ");for(let t=0;t<e.length;)switch(e[t][0]){case"M":s.moveTo(+e[t++].substr(1),+e[t++]);break;case"L":s.lineTo(+e[t++].substr(1),+e[t++]);break;default:s.lineTo(+e[t++],+e[t++]);break}return i.mts_(s)}static pts_(t,i,s){const e=[],A=new c4,n=Array.isArray(t),h=Array.isArray(s);let r;const o=n?t.length:s.length;let l,u;for(r=0;r<o;++r){u=h?s[r]:s;l=n?t[r]:t.clone();typeof l!="function"&&u!=null&&l.iQ_(u).rB_(u);e.push({$f_:i,sts_:new A6({shape:new ma({sizeisindevicespace:!0,painter:l}),geometrytoshape:A})})}return e}static mts_(t){const i=t.getBounds(),s=Math.max(i.Ie_(),i.Ts_()),e=s/2,A=e-i.ye_(),n=e-i.De_(),h=1/s;t.at_(new Gn(h,0,0,h,A*h,n*h));return t}static yts_(t){if(!t||!Array.isArray(t["visualVariables"]))return[];let s;const e=[];for(let A=0;A<t["visualVariables"].length;++A){const n=t["visualVariables"][A];switch(n["type"]){case"colorInfo":s=i.Dts_(n);break;case"sizeInfo":s=i.Mts_(n);break;case"transparencyInfo":s=i.vts_(n);break;case"rotationInfo":n["rotationExpression"]=n["valueExpression"]||n["field"]&&"["+n["field"]+"]";s=i.bts_(n);break;default:s=null}s&&e.push(s)}return e}static pp_(t,i,s,e){let A=0;if(i!=null){if(t.hasOwnProperty(i))A=+t[i];else{const s=i.toLowerCase();for(const i in t)if(i.toLowerCase()===s){A=+t[i];break}}return e?A/+t[e]:A}if(s==null)return 0;A=s(t);return e?A/+t[e]:A}static vts_(t){if(!Array.isArray(t["stops"]))return null;const s=t["field"],e=t["normalizationField"],A=t["stops"];let n;if(!s){n=i.lts_(t["valueExpression"]);if(!n)return null}const h=new g9(!1);for(let t=0;t<A.length;++t)h.$7i_(A[t]["value"],1-A[t]["transparency"]/100);return h.uM_()?function(t,A){const r=i.pp_(t,s,n,e);A.JIi_=+h.getValue(r).toFixed(2);A.name=A.name!=null?A.name+"x"+A.JIi_:A.JIi_+""}:null}static lts_(t){if(!t)return null;const i=new n9(t);return function(t){return+i.getValue(t)}}static Mts_(t){const s=new g9,e=t["field"],A=t["normalizationField"],n=t["stops"];let h;if(!e){h=i.lts_(t["valueExpression"]);if(!h)return null}t["minSize"]!=null&&t["minDataValue"]!=null&&s.$7i_(t["minDataValue"],t["minSize"]);t["maxSize"]!=null&&t["maxDataValue"]!=null&&s.$7i_(t["maxDataValue"],t["maxSize"]);if(Array.isArray(n))for(let t=0;t<n.length;++t)s.$7i_(n[t]["value"],n[t]["size"]);return s.uM_()?function(t,n){const r=i.pp_(t,e,h,A);n.size=s.getValue(r);n.name=n.name!=null?n.name+"x"+n.size:n.size+""}:null}static Dts_(t){if(!Array.isArray(t["stops"]))return null;const s=[],e=[],A=t["field"],n=t["normalizationField"],h=t["stops"];let r;if(!A){r=i.lts_(t["valueExpression"]);if(!r)return null}for(let t=0;t<h.length;++t){e.push(h[t]["value"]);s.push(i.cs_(h[t]["color"]))}const o=new bo({values:e,colors:s});return function(t,s){const e=i.pp_(t,A,r,n);s.color=o.getColor(e);s.name=s.name!=null?s.name+"x"+s.color.Es_():s.color.Es_()}}static bts_(t){const s=t["rotationType"],e=i.lts_(t["rotationExpression"]);let A=null;const n=t["normalizationField"];if(!e){if(t["type"]!=="vectorField")return null;A="Direction"}let h,r;if(s&&s.toLowerCase()==="arithmetic"){h=1;r=-Math.PI/2}else{h=-1;r=0}let o=!0;const l=Math.PI*2;return function(t,s){const u=i.pp_(t,A,e,n);if(o&&(u<-l||u>l)){r=NA.radToDeg(r);o=!1}s.angle=r+h*u;o&&(s.angle=NA.radToDeg(s.angle));s.angle=1.8*Math.round(s.angle/1.8);s.angle=NA.degToRad(s.angle);s.name=s.name!=null?s.name+"x"+s.angle:s.angle+""}}static its_(t){const s=i.yts_(t),e=i.bts_(t);e&&s.push(e);return s.length===0?null:function(t){const i={};for(let e=0;e<s.length;++e)s[e](t,i);return i}}static dts_(t,i){if(!t||!t.sts_)return null;const s=t.sts_,e=t.$f_;if(e==null)return s;t.Nts_=t.Nts_||{};const A=t.Nts_;let n=s.e7_();const h=e(i);if(A[h.name]!=null)return A[h.name];n=n.clone();const r=n.gt_();if(r!=null){h.color!=null&&r.setColor(h.color);h.JIi_!=null&&r.setColor(RA.setAlpha(r.getColor(),h.JIi_))}const o=n.ct_();if(o!=null){h.color!=null&&o.setColor(h.color);h.JIi_!=null&&o.setColor(RA.setAlpha(o.getColor(),h.JIi_))}if(n instanceof Ca){h.size!=null&&n.setSize(h.size,h.size);if(h.angle!=null){n.tR_(!1);n.c_(h.angle)}}h.JIi_!=null&&n instanceof df&&n._I_(h.JIi_);const l=new m4({shape:n,geometrytoshape:s.o3i_(),geometrytotext:s.l3i_(),textshape:s.u3i_()});A[h.name]=l;return l}static Sts_(t,s){if(!t||t["error"]||!Array.isArray(t["layers"]))return null;const e=t["layers"],A=[];for(let t=0;t<e.length;++t){const n=[];e[t]["legend"]=e[t]["legend"]||[];for(let A=0;A<e[t]["legend"].length;A++){const h=e[t]["legend"][A];n.push({label:h["label"],image:i.uts_(h,s),width:h["width"],height:h["height"],values:h["values"]})}A.push({layerId:e[t]["layerId"],layerName:e[t]["layerName"],layerType:e[t]["layerType"],minScale:e[t]["minScale"],maxScale:e[t]["maxScale"],legend:n})}return A}static Gts_(t,s){const e=t["displayFieldName"],A=!t.hasOwnProperty("geometryType");let n=!A&&i.tts_(t["geometryType"]);const h=[];for(let r=0;r<t["features"].length;r++){const o=t["features"][r];let l,u=o["geometry"];if(u){A&&(n=i.tts_(o["geometryType"]));u=i.gts_(u[n[2]]||u);if(u.length>1)l=n[1];else{if(u.length!==1)continue;l=n[0];u=u[0]}}else{u={x:NaN,y:NaN};l=w4}const a=o["attributes"]||{};a["layerId"]=o.hasOwnProperty("layerId")?o["layerId"]:s;h.push(new l({attributes:a,id:o.hasOwnProperty("value")?o["value"]:a[e],geometry:u}))}return h}static Rts_(t){if(!t)return[];const s=t.S3_||{};let e;const A=[];switch(s["type"]){case"simple":A.push(i.r2t_(t.Dn_.sts_,s["label"]));break;case"uniqueValue":const n=s["uniqueValueInfos"]||[];for(e=0;e<n.length;e++)A.push(i.r2t_(t[n[e]["value"]].sts_,n[e]["label"]));break;case"classBreaks":const h=t.nts_||[];for(e=0;e<h.length;e++)A.push(i.r2t_(h[e].sts_,h[e].label));break;case"vectorField":const r=t.wts_||[];for(e=0;e<r.length;e++)A.push(i.r2t_(r[e].sts_))}t.Ats_&&A.push(i.r2t_(t.Ats_.sts_,t.Ats_.label));return A.filter((function(t){return t!=null}))}static r2t_(t,i){if(!t)return null;const s=t.e7_();let e=20,A=20;if(s instanceof df){e=s.Ie_();A=s.Ts_();return{width:e,height:A,label:i||"",image:s.N_()["url"]}}const n=new mA(0,0,e,A),h=fr.zw_(e,A),r=h.tQ_();if(s instanceof Ca)if(s.WG_()){s.gR_(Ca.VG_(n,s.GE_()));s.render(r)}else{e=s.Ie_();A=s.Ts_();e<=A?s.setSize(e*n.Ts_()/A,n.Ts_()):s.setSize(n.Ie_(),A*n.Ie_()/e);s.render(r);s.setSize(e,A)}else{r.rB_(s.gt_(),n);r.iQ_(s.ct_(),n);s instanceof ap?r.mR_([n.we_(),n.Qe_()],[n.De_(),n.De_()]):r.ER_([n.we_(),n.we_(),n.Qe_(),n.Qe_()],[n.Ee_(),n.pe_(),n.pe_(),n.De_()])}h.gM_();return{width:h.Ie_(),height:h.Ts_(),label:i||"",image:h.SM_()}}};s=i=t([_s("geotoolkit.map.util.ArcGIS")],s);return s}();const I9=1e3,f9=new lA,C9=function(t){return Array.isArray(t)&&t.length>0?"&outFields="+t.join("%2C"):""};var d9=function(){let i=class t extends h8{constructor(t){(t=t||{})["connector"]=t["connector"]||new t9;super(t);this.kts_=null;this.Fts_=!0;this.N4i_={};this.xts_=new Map;this.Lts_=this.Uts_.bind(this)}query(t){const i=this.N4i_.l8i_;i.transformPoint(f9.vs_(t["left"],t["top"]),f9);const s=f9.getX(),e=f9.getY();i.transformPoint(f9.vs_(t["right"],t["bottom"]),f9);const A=f9.getX(),n=f9.getY(),h=C9(this.N4i_.Yts_),r=i.d5i_().w2i_(),o="&returnExceededLimitFeatures="+(this.N4i_.resultType==="standard"),l="&resultType="+this.N4i_.resultType,u="&geometryPrecision="+this.N4i_.Tts_,a=this.Fts_?"&outSR="+r:"",g=i.B5i_().w2i_(),c=g!=null?"&inSR="+g:"",I=JSON.stringify({xmin:s,ymin:e,xmax:A,ymax:n}),f="/query?geometryType=esriGeometryEnvelope&geometry="+encodeURIComponent(I)+"&spatialRel=esriSpatialRelIntersects"+h+o+u+l+c+a+"&returnDistinctValues=false&f=json";let C=0;const d=(i,s)=>{const e=this.Kts_(i,s,t);if(e!=null){if(e["exceededTransferLimit"]===!0){if(!this.N4i_.Hts_){const i=(t["left"]+t["right"])/2,s=(t["top"]+t["bottom"])/2;this.query({left:t["left"],top:t["top"],right:i,bottom:s,key:t["key"]});this.query({left:t["left"],top:s,right:i,bottom:t["bottom"],key:t["key"]});this.query({left:i,top:t["top"],right:t["right"],bottom:s,key:t["key"]});this.query({left:i,top:s,right:t["right"],bottom:t["bottom"],key:t["key"]});return}C===0&&this.S4i_.send(this.R4i_(f+"&returnCountOnly=true"),{token:this.N4i_.qts_,key:t["key"]},((i,s)=>{const e=this.Kts_(i,s);if(e!=null){C=this.N4i_.Jts_;for(let i=C;i<e["count"];i+=C)this.S4i_.send(this.R4i_(f+"&resultOffset="+i),{token:this.N4i_.qts_,key:t["key"]},d)}}))}if(Array.isArray(e["features"])){this.Pts_(e["features"]);if(this.S4i_.f4i_())this.kts_==null&&(this.kts_=setTimeout(this.Lts_,I9));else{this.kts_!=null&&clearTimeout(this.kts_);this.Uts_()}}}};this.S4i_.send(this.R4i_(f),{token:this.N4i_.qts_,key:t["key"]},d);return this}Pts_(t){if(this.Df_())return;const i=this.Fts_?null:this.N4i_.e8i_,s=this.N4i_.id.L4i_();for(let e=0;e<t.length;e++){const A=t[e],n=A["geometry"],h=A["attributes"],r=A["symbol"],o=c9.ets_(r)||c9.Cts_(h,this.N4i_.Vts_);if(o==null||n==null)continue;const l=n[this.N4i_.Vts_.type[2]]||n;let u,a=c9.gts_(l,i);if(a.length>1)u=this.N4i_.Vts_.type[1];else{if(a.length!==1)continue;u=this.N4i_.Vts_.type[0];a=a[0]}const g=new u({id:h[s],geometry:a,attributes:h});g.k9i_=o;this.xts_.has(o)?this.xts_.get(o).push(g):this.xts_.set(o,[g])}}abort(t){super.abort(t);if(this.kts_!=null){clearTimeout(this.kts_);this.kts_=null}this.xts_.clear();return this}Uts_(){if(!this.Df_()){let t=null;this.xts_.forEach((function(i){if(t==null)t=i;else for(let s=0;s<i.length;s++)t.push(i[s])}));t!=null&&this.notify(g8.Z4i_,this,t)}this.xts_.clear();this.kts_=null}Kts_(t,i,s){if(t){this.onError(t);return null}let e;if(typeof i=="string")try{e=JSON.parse(i)}catch(t){this.onError(t);return null}else e=i;if(e["error"]!=null){const t=e["error"]["details"]||[];if(this.Fts_&&t.join("").indexOf("outSR")>=0){this.Fts_=!1;s&&this.query(s);return null}c9.warn(e["error"]);return null}return e}};i=t([_s("geotoolkit.map.sources.formats.ArcGISFeature")],i);return i}();const B9=function(t){return t["type"]==="esriFieldTypeOID"};var w9=Ci(function(){let i=class t extends o6{constructor(t){super(t=qi(t,{connector:new t9}));this.N4i_={}}parse(t,i){const s=typeof t=="string"?JSON.parse(t):t;this.N4i_.data=s;if(s["error"]!=null){c9.warn(s["error"]);throw new Error("ArcGISFeature server returned error!")}const e=s["drawingInfo"]||{},A=s["spatialReference"]||s["sourceSpatialReference"];this.N4i_.Hts_=this.N4i_.Hts_&&(!s["advancedQueryCapabilities"]||s["advancedQueryCapabilities"]["supportsPagination"]);const n=s["maxRecordCountFactor"]||1,h=this.N4i_.Hts_?"standard":"tile";this.N4i_.resultType=h;this.N4i_.Jts_=s[h+"MaxRecordCount"]*n||s["maxRecordCount"];this.N4i_.r7i_||!s["minScale"]&&!s["maxScale"]||(this.N4i_.r7i_=[s["minScale"]>0?1/s["minScale"]:null,s["maxScale"]>0?1/s["maxScale"]:null]);if(Array.isArray(s["layers"])){this.N4i_.layers=this.Ots_(s["layers"],s["type"]);this.N4i_.alpha=1;this.Wts_(s["fullExtent"],A)}else{const t=Array.isArray(this.N4i_.url)?this.N4i_.url[0]:this.N4i_.url;this.N4i_.id=this.zts_(s["fields"],s["displayField"]);this.N4i_.Yts_=this.Xts_(s);this.N4i_.PZi_=c9.cts_(e["labelingInfo"]);this.N4i_.Vts_=c9.parse(s,t,this.N4i_.PZi_);this.N4i_.layers=[];this.N4i_.alpha=e["transparency"]>0?(100-e["transparency"])/100:1;this.N4i_.jts_=s["id"];this.N4i_.Zts_=s["name"];this.N4i_._ts_=s["type"];this.Wts_(s["extent"],A)}this.N4i_.$ts_=this.tis_(s["initialExtent"],A);this.r9i_=s["copyrightText"];this.loaded(i)}a9i_(){const t=Array.isArray(this.N4i_.url)?this.N4i_.url[0]:this.N4i_.url;return t?t+"?f=pjson":null}g9i_(){return{token:this.N4i_.qts_}}Wts_(t,i){const s=this.N4i_.e8i_;if(t==null)this.N4i_.FMt_=s.B5i_().E2i_();else{this.iis_(t["spatialReference"]||i);const e=new lA(parseFloat(t["xmin"]),parseFloat(t["ymin"])),A=new lA(parseFloat(t["xmax"]),parseFloat(t["ymax"]));s.transform(e,e);s.transform(A,A);this.N4i_.FMt_=new mA(e.x,e.y,A.x,A.y)}return this}tis_(t,i){if(!t)return this.N4i_.FMt_;const s=typeof(i=t["spatialReference"]||i)=="number"?i:i["wkid"]||i["wkt"],e=undefined;let A;if(this.N4i_.e8i_.d5i_().w2i_()===s)A=this.N4i_.e8i_;else{const t=X3.sx_().l5i_(s);if(!t)return this.N4i_.FMt_;A=new Z3({initialcoordinatesystem:t,targetcoordinatesystem:this.N4i_.e8i_.B5i_()})}const n=new lA(parseFloat(t["xmin"]),parseFloat(t["ymin"])),h=new lA(parseFloat(t["xmax"]),parseFloat(t["ymax"]));A.transform(n,n);A.transform(h,h);return new mA(n.x,n.y,h.x,h.y)}iis_(t){const i=typeof t=="number"?t:t["wkid"]||t["wkt"],s=undefined;if(this.N4i_.e8i_.d5i_().w2i_()===i)return this;const e=X3.sx_().l5i_(i);if(!e)throw new Error("ArcGISFeature: coordinate system ("+i+") is not supported, "+"use geotoolkit.map.coordinatesystems.Registry to register it manually.");this.N4i_.l8i_.Q5i_(e);this.N4i_.e8i_.w5i_(e);return this}Ots_(t,i){const s=Array.isArray(this.N4i_.url)?this.N4i_.url[0]:this.N4i_.url,e=i==="Group Layer"?s.substr(0,s.lastIndexOf("/"))+"/":s+"/";for(let i=0;i<t.length;++i){const s=t[i],A=t[s["parentLayerId"]];if(A!=null){A["minScale"]>0&&(s["minScale"]=s["minScale"]>0?Math.min(s["minScale"],A["minScale"]):A["minScale"]);A["maxScale"]>0&&(s["maxScale"]=s["maxScale"]>0?Math.max(s["maxScale"],A["maxScale"]):A["maxScale"])}s["url"]=e+s["id"];s["id"]=""+s["id"]}return t.reverse()}zts_(t,i){let s=this.N4i_.id instanceof o8?this.N4i_.id.L4i_():this.N4i_.id;if(Array.isArray(t)&&t.length>0&&t.every((function(t){return t["name"]!==s})))if(typeof i=="string")s=i;else{const i=t.filter(B9);s=i.length>0?i[0]["name"]:t[0]["name"]}return this.N4i_.id instanceof o8&&this.N4i_.id.L4i_()===s?this.N4i_.id:new o8(s)}Xts_(t){if(!Array.isArray(t["fields"]))return null;let i=null;const s=t["fields"].map((function(t){t["type"]==="esriFieldTypeOID"&&(i=t["name"]);return t["name"]}));this.N4i_.sis_=i;if(this.N4i_.Yts_==="*")return s;const e=t["drawingInfo"]&&t["drawingInfo"]["renderer"]||{};let A=[this.N4i_.id.L4i_(),t["displayField"],e["field"],e["field1"],e["field2"],e["field3"]];const n=[];Array.isArray(this.N4i_.Yts_)&&(A=A.concat(this.N4i_.Yts_));if(Array.isArray(e["visualVariables"])){const t=e["visualVariables"],i=s.filter((function(i){for(let s=0;s<t.length;++s){const e=t[s];if(e["field"]===i)return!0;if(e["valueExpression"]!=null&&e["valueExpression"].indexOf(i)>-1)return!0}return!1}));A=A.concat(i)}for(let t=0;t<A.length;++t){const i=A[t];i!=null&&s.indexOf(i)>-1&&n.indexOf(i)===-1&&n.push(i)}return n.length>0?n:s}};i=t([_s("geotoolkit.map.sources.loaders.ArcGISFeature")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRTZXR0aW5nc1VybCI6ImE5aV8iLCJnZXRSZXF1ZXN0T3B0aW9ucyI6Imc5aV8ifX19");const Q9=OA.Ai_().gn_("px"),E9=OA.Ai_().gn_("metre");var p9=Ci(function(){var i;let s=i=class t extends p8{constructor(t){const i=qi(t=t||{},{layer:null,format:t["format"]||new d9,loader:t.hasOwnProperty("loader")?t["loader"]:new w9,idfield:t["idfield"]||(t["getfeatureid"]instanceof o8?t["getfeatureid"].L4i_():"name"),offsetsupport:!0,requestfields:null,geometryprecision:3,token:null,scalerange:null,layerid:null},!0);super(i);this._mt_={};this.N4i_=this.N4i_||{};this.N4i_.qts_=i["token"];this.N4i_.r7i_=i["scalerange"];this.N4i_.Yts_=i["requestfields"];this.N4i_.layers=[];this.N4i_.alpha=1;this.N4i_.PZi_=null;this.N4i_.jts_=i["layerid"];this.N4i_.Hts_=i["offsetsupport"];this.N4i_.Tts_=i["geometryprecision"];this.eis_=i["layer"]==null||Array.isArray(i["layer"])?i["layer"]:[i["layer"]];this.Ais_=null;this.nis_=[];this.Qni_=null}his_(t){this.N4i_.qts_=t;for(let i=0;i<this.nis_.length;i++)this.nis_[i].his_(t);return this}fw_(){return this.N4i_.qts_}ris_(t){this.N4i_.Yts_=t;return this}ois_(){return this.N4i_.Yts_}lis_(t){this.N4i_.Tts_=t;return this}uis_(){return this.N4i_.Tts_}getLayers(){return this.N4i_.layers}ais_(t){if(this._mt_[t]==null){const s=this.N4i_.layers;for(let e=0;e<s.length;++e){const A=s[e];if(A["id"]===t){const s=A["minScale"]>0||A["maxScale"]>0?[A["minScale"]>0?1/A["minScale"]:null,A["maxScale"]>0?1/A["maxScale"]:null]:null;this._mt_[t]=new i({system:this.d5i_(),idfield:this.s6i_(),scalerange:s,url:A["url"],mode:this.N4i_.mode,offsetsupport:this.N4i_.Hts_,requestresolution:this.N4i_.O8i_,requestfields:this.N4i_.Yts_,token:this.N4i_.qts_,layerid:t});this.Y8i_()==null?this._mt_[t].w8i_(null):this._mt_[t].Y8i_().k4i_(this.Y8i_());const e=undefined;this._mt_[t].u8i_.ix_().k4i_(this.u8i_.ix_());this._mt_[t].R8i_(this.k8i_());break}}}return this._mt_[t]}gis_(){return this.N4i_.layers.length>0}OR_(){return this.N4i_.alpha}cis_(){return this.N4i_.r7i_}bHi_(){return this.N4i_.PZi_}Iis_(t){if(t==null)this.eis_=null;else{const i=Array.isArray(t)?t:[t];this.eis_=i.map((t=>typeof t=="string"?t:t+""))}this.update();return this}fis_(){return this.N4i_.$ts_}Cis_(){return this.eis_}M8i_(){if(this.Df_())return this;if(this.gis_()){const t=[],i=Array.isArray(this.eis_);for(let s=0;s<this.N4i_.layers.length;++s){const e=this.N4i_.layers[s],A=e["id"],n=undefined;(i?this.eis_.indexOf(A)>=0:e["defaultVisibility"])&&t.push(A)}this.eis_==null&&(this.eis_=t);this.dis_()}super.M8i_();return this}query(t,i){const s=this.N4i_.r7i_;if(s!=null){const t=i.if_(),e=t?Q9.wn_(t.BI_(),E9):null;if(e!=null&&(s[0]!=null&&s[0]>e||s[1]!=null&&s[1]<e)){this.y8i_(!0);return this}}if(this.gis_()){for(let s=0;s<this.nis_.length;++s)this.nis_[s].query(t,i);this.y8i_(!this.f4i_())}else super.query(t,i);return this}dispose(){if(this.Ais_!=null)for(let t=0;t<this.nis_.length;++t)this.nis_[t].off(g8.Z4i_,this.Ais_).off(g8._4i_,this.Ais_).off(g8.$4i_,this.Ais_);this._mt_=null;super.dispose()}Bis_(t){this.Y8i_()?this.Qni_?t(null,this.Qni_):this.m8i_().then((()=>{if(this.gis_())Promise.all(this.N4i_.layers.map((t=>this.ais_(t["id"]).m8i_()))).then((()=>{const i=[];this.N4i_.layers.reverse().forEach((t=>{this.ais_(t["id"]).Bis_(((t,s)=>{t||i.push(s)}))}));this.Qni_=i;t(null,this.Qni_)}),ki);else{const i=this.N4i_.r7i_;this.Qni_={layerId:this.N4i_.jts_,layerName:this.N4i_.Zts_,layerType:this.N4i_._ts_,minScale:i&&i[0]?1/i[0]:null,maxScale:i&&i[1]?1/i[1]:null,legend:c9.Rts_(this.N4i_.Vts_)};t(null,this.Qni_)}}),ki):t(new Error("Cannot query ArcGIS legend, no loader provided!"))}f4i_(){if(super.f4i_())return!0;if(this.gis_())for(let t=0;t<this.nis_.length;t++)if(this.nis_[t].f4i_())return!0;return!1}dis_(){if(!this.gis_())return this;this.Ais_=this.Ais_||((t,i,s)=>{if(t===g8.Z4i_){for(const t in this._mt_)if(this._mt_[t]===i){for(let i=0;i<s.length;i++)s[i].M5i_().jts_=+t;break}}else t===g8.$4i_&&(t=g8._4i_);this.notify(t,i,s)});let t;for(t=0;t<this.nis_.length;t++)this.nis_[t].off(g8.Z4i_,this.Ais_).off(g8._4i_,this.Ais_).off(g8.$4i_,this.Ais_);const i=[],s=this.Cis_();for(t=0;t<s.length;t++){const e=this.ais_(s[t]);if(e!=null){e.on(g8.Z4i_,this.Ais_).on(g8._4i_,this.Ais_).on(g8.$4i_,this.Ais_);i.push(e)}}this.nis_=i;return this}update(){if(this.gis_()){for(let t=0;t<this.nis_.length;t++){this.nis_[t].T8i_();this.nis_[t].update()}this.dis_()}return super.update()}};s=i=t([_s("geotoolkit.map.sources.ArcGISFeature")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRUb2tlbiI6Imhpc18iLCJnZXRUb2tlbiI6ImZ3XyIsInNldFJlcXVlc3RGaWVsZHMiOiJyaXNfIiwiZ2V0UmVxdWVzdEZpZWxkcyI6Im9pc18iLCJzZXRHZW9tZXRyeVByZWNpc2lvbiI6Imxpc18iLCJnZXRHZW9tZXRyeVByZWNpc2lvbiI6InVpc18iLCJnZXRMYXllclNvdXJjZSI6ImFpc18iLCJpc011bHRpbGF5ZXJTb3VyY2UiOiJnaXNfIiwiZ2V0R2xvYmFsQWxwaGEiOiJPUl8iLCJnZXRTY2FsZVJhbmdlIjoiY2lzXyIsImdldEFubm90YXRpb25TaGFwZSI6ImJIaV8iLCJzaG93TGF5ZXJzIjoiSWlzXyIsImdldEluaXRpYWxNb2RlbExpbWl0cyI6ImZpc18iLCJnZXRWaXNpYmxlTGF5ZXJzIjoiQ2lzXyIsInF1ZXJ5TGVnZW5kIjoiQmlzXyIsImlzTG9hZGluZyI6ImY0aV8ifX19");const m9=new m4,y9=new lA,D9=new mA,M9=new mA,v9=new xA,b9=function(t){return t instanceof p4};var N9=Ci(function(){let i=class t extends _6{constructor(t){super(t=Pi(t,{templates:[]},!0));this.P5i_=null;this.wis_=null;this.Qis_=!1;this.Eis_={};this.pis_=[];this.mis_=null;this.yis_=null;this.Dis_=[];this.Mis_(t["templates"]);this.gk_(new zQ)}dt_(t){if((t=Es(t))==null)return this;super.dt_(t);this.Mis_(t["templates"]);return this}Mis_(t){if(t==null)return this;const i=undefined;(Array.isArray(t)?t:[t]).forEach((t=>{const i=Array.isArray(t["featureclassname"])?t["featureclassname"]:[t["featureclassname"]];for(let s=0;s<i.length;++s)this.Eis_[i[s]]=t["template"]}));return this}vis_(t,i){if(t)ys(t,t4)&&(t=[t]);else{t=this.F3i_();this.pis_=[]}t.forEach((function(t){t.k9i_=null}));i||this.td_();return this}j3i_(t){return this.Eis_[t]}U6i_(t){const i=this.Eis_[t.D_()];if(!t.k9i_)return i;if(!i)return t.k9i_;const s=t.k9i_.a3i_()===void 0?i.a3i_():t.k9i_.a3i_();m9.dt_({shape:t.k9i_.e7_()||i.e7_(),geometrytoshape:t.k9i_.o3i_()||i.o3i_(),geometrytotext:t.k9i_.l3i_()||i.l3i_(),textshape:t.k9i_.u3i_(t)||i.u3i_(t),textstrategy:t.k9i_.g3i_()||i.g3i_(),textsizeinfo:t.k9i_.c3i_()||i.c3i_(),shapecallback:s});return m9}Cts_(t){return typeof t=="string"?this.j3i_(t):t instanceof t4?t.k9i_?t.k9i_:this.j3i_(t.D_()):null}AGi_(t,i,s){if(typeof t=="string")this.Eis_[t]=i;else{ys(t,t4)&&(t=[t]);this.pis_.indexOf(i)<0&&this.pis_.push(i);t.forEach((function(t){t.k9i_=i}))}s||this.td_();return this}bis_(){let t=0;for(const i in this.Eis_)this.Eis_.hasOwnProperty(i)&&++t;return t}Nis_(){for(const t in this.Eis_)if(this.Eis_.hasOwnProperty(t))return this.Eis_[t];return null}$6i_(t){if(!t){const t=this.F3i_();this._6i_=null;return t.Hs_()?this.$6i_(t):null}const i=this.Sis_(t);i!=null&&(this._6i_?this._6i_.union(i):this._6i_=i);return this._6i_}Sis_(t){let i,s,e,A,n,h,r,o=null;const l=this.getParent();let u,a;const g=this.k8i_();if(g!=null&&l!=null){a=g.E2i_();const t=l.lt_();t&&a&&(u=Gn.xI_(a,t))}u=u||this.if_()||Gn.JI_;const c=[];u.cI_(v9.setSize(1,1),v9);const I=function(t,i){Array.isArray(t.x)?c.push({x:t.x.map((t=>t+i)),y:t.y.slice()}):c.push({x:t.x+i,y:t.y})},f=t=>{A.apply(t,i,u);let h;if(i instanceof Ca&&i.WG_()){const t=i.gt_(),s=t?2*t.Ie_():0;h=i.BR_(u,i.uR_(),i.aR_(),i.Ie_()+s,i.Ts_()+s);o=o!=null?o.union(h):h}else{if(!(ie(i)&&i.getBounds()instanceof mA))throw new Error("Wrong or unexpected type of templates shape");h=i.getBounds();o=o!=null?o.union(h):h.clone()}this.UU_["annotations"]["visible"]&&n.apply(t,e,u);this.Gis_(r,s,t,h,a,I)},C=t=>{s=this.U6i_(t);if(s!=null){i=s.e7_();e=s.u3i_(t);A=s.o3i_();n=s.l3i_();r=t;h=t.nt_(!0);Array.isArray(h)?h.forEach(f):f(h);if(c.length>0){if(t.S5i_())t.Pd_(c.concat(h).reverse());else{const i=[];for(let s=0;s<c.length;s++){const e=t.m5i_().Pd_(c[s]);e.M5i_().Ris_=!0;i.push(e)}this.u6i_.k3i_(i)}c.length=0}}};t.forEach(C);return o}Gis_(t,i,s,e,A,n){if(!A||t.M5i_().Ris_)return;t.M5i_().Ris_=!0;D9.ce_(A).translate(A.Ie_(),0);M9.ce_(A).translate(-A.Ie_(),0);let h=!1,r=!1;if(mA.Te_(D9,e)){h=!0;n(s,-A.Ie_())}if(mA.Te_(M9,e)){r=!0;n(s,A.Ie_())}const o=i.g3i_()||this.UU_["annotations"]["strategy"];if(o&&this.UU_["annotations"]["visible"]){const e=o.v4_(t,this);if(e){const o=i.u3i_(t);o.a_(e);const l=n8.dwt_(o,v9);!h&&mA.Te_(D9,l)&&n(s,-A.Ie_());!r&&mA.Te_(M9,l)&&n(s,A.Ie_())}}}vW_(t,i){t.qd_=i;const s=undefined;this.k8i_()&&typeof t.G5i_=="function"&&t.G5i_(this);this._6i_=this.$6i_();this.td_();return this}kis_(t){if(t==null)return this;Array.isArray(t)||(t=[t]);t.forEach((t=>{t.G5i_(this)}));this.Utt_.Z8i_(t,!1);if(!this.WH_){this._6i_=this.$6i_(Au.IN_(t));this.notify(rh.nC_,this,this._6i_)}this.td_();return this}t6i_(t){if(t==null)return this;this.u6i_.x3i_(t);if(!this.WH_){this._6i_=this.$6i_();this.notify(rh.nC_,this,this._6i_)}this.td_();return this}_8i_(){this.Utt_._8i_();return this}W7i_(t){for(const i in this.Eis_)this.Eis_.hasOwnProperty(i)&&this.Eis_[i].u3i_().g_(t);this.td_();return this}render(t){if(this.$C_()&&(!this.z6i_||this.z6i_.filter(this,t))){this.Utt_==null||this.h9i_()&&this.yis_||this.Utt_.$8i_(this.ot_(),this);this.Dis_=[];this._cache&&!t.tk_()?this._cache.render(t):this.zY_(t);this.Fis_(t);this.xis_(t);if(t.tk_()&&this.Dis_.length>0){t.mO_(this);t.mO_(new jf(this,this.Dis_))}}}ad_(t,i){if(this.$C_()&&(!this.z6i_||this.z6i_.filter(this,t))){this.Utt_==null||this.h9i_()&&this.yis_||this.Utt_.$8i_(this.ot_(),this);if(!this._cache||t.tk_()){this.OY_(t,(()=>{this.xis_(t);i()}));return}this._cache.render(t);this.xis_(t)}i()}zY_(t){const i=t.OR_();t.tN_(this.i9i_);this.Lis_(t);this.J7i_(this.yis_,t);this.Uis_(t);this.UU_["annotations"]["visible"]&&!t.tk_()&&this.P7i_(this.h9i_()?this.Yis_:this.mis_,t);t.tN_(i)}J7i_(t,i){let s;t.forEach((t=>{s=this.U6i_(t);if(!s)return;i.tk_()&&i.YR_(t);const e=t.y5i_();if(t.S5i_()){const A=e;for(let e=0;e<A.length;++e){this.Tis_(t,A[e],s,i);if(this.Dis_[this.Dis_.length-1]===t)return}}else this.Tis_(t,e,s,i)}))}Lis_(t){const i=t.Ji_(),s=i.BI_();i.cI_(v9.setSize(1,1),v9);this.Kis_={His_:{},XQ_:null,fillStyle:null};const e=!NA.equals(this.qis_,s);if(this.yis_==null||this.Qis_||this.Jis_()&&e){e&&this.Pis_(null);this.Utt_.$8i_(this.ot_(),this);this.qis_=s;this.Qis_=!1;let i=this.F3i_();const A=this.UU_["features"]["filter"];A&&(i=this.V7i_(i,A,t));this.yis_=Au.toArray(i);if(this.UU_["annotations"]["visible"]){const i=this.UU_["annotations"]["filter"];if(i){const s=new nu(this.yis_);this.O7i_(s);const e=this.V7i_(s,i,t);this.mis_=Au.toArray(e)}else this.mis_=this.yis_;this.Yis_=this.UU_["annotations"]["visibleonzoom"]?this.mis_:this.mis_.filter(b9)}}}Uis_(t){this.drawPath(t);this.Kis_=null}Tis_(t,i,s,e){const A=s.e7_(),n=s.o3i_(),h=s.a3i_();if(!h&&!A.$C_())return;const r=e.rS_(),o=s4.R5i_(i);if(t.N5i_()||e.tk_()){if(!mA.Te_(r,o))return;if(e.tk_()){n.apply(i,A,e);h&&h(t,A,e);e.pO_(A,(()=>{this.Dis_.indexOf(t)<0&&this.Dis_.push(t)}));return}if(!h){const s=A.gt_(),n=A.ct_();if(this.Kis_.XQ_===s&&this.Kis_.fillStyle===n)a4.q5i_(i,e,t.en_(),v9,r);else{this.drawPath(e);this.Kis_.XQ_=s;this.Kis_.fillStyle=n;e.rB_(s);e.iQ_(n);e.beginPath();a4.q5i_(i,e,t.en_(),v9,r)}return}n.apply(i,A,e);h(t,A,e)}else{const s=A,l=s.Ie_(),u=s.Ts_();if(h){n.apply(i,s,e);h(t,s,e)}let a=s.Ie_(),g=s.Ts_();if(s.WG_&&s.WG_()){a*=v9.Ie_();g*=v9.Ts_()}s.wR_(i.x,i.y,a,g,Gn.JI_,o);if(!mA.Te_(r,o))return;if(l===s.Ie_()&&u===s.Ts_()&&!this.Vis_(s,i,r))return;h||n.apply(i,s,e)}this.drawPath(e);this.Kis_.XQ_=null;this.Kis_.fillStyle=null;A.render(e)}drawPath(t){if(this.Kis_.fillStyle){t.sQ_();this.Kis_.fillStyle=null}if(this.Kis_.XQ_){t.stroke();this.Kis_.XQ_=null}}Vis_(t,i,s){const e=Math.floor((i.x-s.x)/v9.Ie_()),A=Math.floor((i.y-s.y)/v9.Ts_()),n=(e+A)*(e+A+1)/2+e;if(!this.Kis_.His_[n]){this.Kis_.His_[n]=t;return!0}if(this.Kis_.His_[n]===t)return!1;const h=this.Kis_.His_[n];if(!Array.isArray(h)){this.Kis_.His_[n]=[h,t];return!0}if(h.indexOf(t)===-1){h.push(t);return!0}return!1}Jis_(){return!this.h9i_()}rt_(){if(this.WH_!=null)return this.WH_;const t=this.Utt_?this.Utt_.rt_():null;this._6i_||(this._6i_=this.$6i_());t!=null&&this._6i_!=null&&this._6i_.union(t);if(this._6i_){t!=null&&this._6i_.union(t);return this._6i_}return t!=null?t:this.X6i_?this.X6i_.E2i_():null}l3i_(t){let i=this.Cts_(t);i||(i=this.Nis_());return i.l3i_()}P7i_(t,i){const s=this.UU_["annotations"]&&this.UU_["annotations"]["strategy"];let e,A,n,h,r;t.forEach((t=>{e=this.U6i_(t);if(!e)return;A=e.g3i_()||s;if(!A)return;r=A.v4_(t,this);if(!r)return;h=e.u3i_(t);n=e.l3i_();if(!h.$C_())return;const o=t.nt_(!0);if(Array.isArray(o)){for(let t=0;t<o.length;++t)if(!o[t].k5i_||o[t].k5i_.N6i_!==!1){h.a_(r);n.apply(o[t],h,i);mA.Te_(i.rS_(),n8.dwt_(h,v9))&&h.render(i)}}else{if(o.k5i_&&o.k5i_.N6i_===!1)return;h.a_(r);n.apply(o,h,i);if(!mA.Te_(i.rS_(),n8.dwt_(h,v9)))return;h.render(i)}}))}$X_(t,i){const s=this.k8i_();if(!s)return[];const e=this.if_();t=e.aI_(t,y9);const A=s.E2i_();t.getX()<A.getX()?t.x+=A.Ie_():t.getX()>A.Qe_()&&(t.x-=A.Ie_());const n=this.rt_();if(!this.yis_||!n||!n.contains(t))return[];e.cI_(v9.setSize(1,1),v9);i=(i||2)*v9.Ie_();const h=[];let r;const o=M9.ce_(t.x-i,t.y-i,t.x+i,t.y+i),l=function(s,e,A){const n=A;if(!su.gN_(n.getBounds(),A.ut_(),o))return!1;if(s instanceof X4||s instanceof Z4){const s=undefined;return new en(t,i,r).fc_(e.x,e.y,!1)}const h=undefined;return new nn(t,i).fc_(e.x,e.y,!0)},u=undefined;new lu(this.yis_,this.P5i_).forEach((t=>{const i=this.U6i_(t);if(!i)return;const s=i.e7_(),A=i.o3i_();let n=t.nt_(!0);const u=i.a3i_();if(s.$C_()&&n){r=s.gt_()!=null?s.gt_().Ie_()*v9.Ie_():v9.Ie_();Array.isArray(n)||(n=[n]);for(let i=0;i<n.length;++i){A.apply(n[i],s,e);if(Array.isArray(n[i].x)){u&&u(t,s);if(l(t,n[i],s)){h.push(t);return}}else{u&&u(t,s);const i=s;let e=i.Ie_(),A=i.Ts_();if(i.WG_&&i.WG_()){e*=v9.Ie_();A*=v9.Ts_()}const n=i.uR_(),r=i.aR_();i.wR_(n,r,e,A,Gn.JI_,D9);if(mA.Te_(o,D9)){h.push(t);return}}}}}));return h.reverse()}R8i_(t){super.R8i_(t);if(t){this.F3i_().forEach((t=>{t.G5i_(this)}));const i=this.yq_();if(i instanceof zQ){t=this.k8i_();i.I6_(t.E2i_())}}return this}c6i_(t,i,s){t!==g8.Z4i_&&t!==g8._4i_||Au.IN_(s).forEach((t=>{if(t.N5i_())return;const i=this.U6i_(t);if(!i)return;const s=i.e7_();if(s instanceof df&&!s.loaded){const t=()=>{s.off(ff.PV_,t);this.td_()};s.on(ff.PV_,t)}}));if(t===g8.Z4i_){const t=this.Sis_(s);if(!this.WH_&&t!=null){this._6i_=this._6i_!=null?this._6i_.union(t):t;this.notify(rh.nC_,this,this._6i_)}this.td_(t)}else super.c6i_(t,i,s)}Pis_(t){this.P5i_=t;return this}Ois_(){return this.P5i_}xis_(t){if(!this.P5i_)return this;const i=this.UU_["annotations"]&&this.UU_["annotations"]["strategy"];let s,e,A,n,h;const r=t.tk_();let o,l,u,a,g;r&&t.YR_(null);this.P5i_.forEach((c=>{o=this.U6i_(c);if(!(o instanceof b4))return;u=o.w3i_();e=o.u3i_();a=o.o3i_();s=o.l3i_();g=o.a3i_();l=o.g3i_()||i;if(!u.$C_())return;let I=c.y5i_();Array.isArray(I)||(I=[I]);n=c.getParent();if(l){A=l.v4_(c,this);e.a_(A)}for(let i=0;i<I.length;++i){a.apply(I[i],u,t);s.apply(I[i],e,t);g&&g(c,u,t);if(n){h=o.Q3i_(I[i],n,t);h.render(t)}r?t.pO_(u,(()=>{this.Dis_.indexOf(c)<0&&this.Dis_.push(c)})):u.render(t);r&&t.YR_(null);l&&e.$C_()&&e.render(t)}}));return this}Fis_(t){if(this.wis_==null||this.h9i_()||t.tk_())return;const i=this.wis_,s=Rl.__,e=this.U6i_(i);if(!e)return;const A=e.e7_(),n=e.o3i_(),h=e.a3i_();A.Bd_(s);this.notify(rh.IC_,A,s);h&&h(i,A,t);const r=i.y5i_(),o=i.S5i_()?r:[r];for(let i=0;i<o.length;++i){n.apply(o[i],A,t);A.render(t)}A.Qd_(s);this.notify(rh.IC_,A,s);this.UU_["annotations"]["visible"]&&this.mis_.indexOf(this.wis_)>=0&&this.P7i_([this.wis_],t)}td_(t,i){this.Qis_=!0;return super.td_(t,i)}notify(t,i,s){switch(t){case Hs.__:const t=this.if_().aI_(s.fOt_(),y9),i=s.getSelection().filter(Zf);let e=1/0,A=null;for(let s=0;s<i.length;s++){if(i[s].GO_()!==this)break;const n=i[s].getData();for(let i=0;i<n.length;i++){const s=n[i],h=this.U6i_(s);if(!h)continue;const r=h.e7_();r.Bd_(Rl.__);const o=this.Wis_(r);r.Qd_(Rl.__);if(o)if(s.N5i_()||s.S5i_())A=s;else{const i=s.nt_(!0),n=lA.Gs_(t.getX(),t.getY(),i.x,i.y);if(n<=e){A=s;e=n}}}}if(this.wis_!==A){this.wis_=A;this.notify(g8.s8i_,this,this.wis_);this.zf_()}break;case Hs.Z_:if(this.wis_!=null){this.wis_=null;this.notify(g8.s8i_,this,null);this.zf_()}}return super.notify(t,i,s)}Wis_(t){if(t.aN_()!=null&&t.aN_().match(t))return!0;let i=this.getParent();while(i!=null){if(i.aN_()!=null&&i.aN_().match(t))return!0;i=i.getParent()}return!1}};i=t([_s("geotoolkit.map.layers.Template")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRQcm9wZXJ0aWVzIjoiZHRfIiwicmVzZXRGZWF0dXJlVGVtcGxhdGVzIjoidmlzXyIsImdldFRlbXBsYXRlIjoiQ3RzXyIsInNldFRlbXBsYXRlIjoiQUdpXyIsImNhbGN1bGF0ZURlZmF1bHRNb2RlbExpbWl0cyI6IiQ2aV8iLCJ1cGRhdGVHZW9tZXRyeSI6InZXXyIsImFkZEZlYXR1cmUiOiJraXNfIiwicmVtb3ZlRmVhdHVyZSI6InQ2aV8iLCJjbGVhckZlYXR1cmVzIjoiXzhpXyIsInJlbmRlckFzeW5jIjoiYWRfIiwicmVuZGVyQ29udGVudCI6InpZXyIsInJlbmRlckZlYXR1cmVzIjoiSjdpXyIsImdldE1vZGVsTGltaXRzIjoicnRfIiwiZ2V0R2VvbWV0cnlUb1RleHQiOiJsM2lfIiwicmVuZGVyQW5ub3RhdGlvbnMiOiJQN2lfIiwiaGl0VGVzdCI6IiRYXyIsInNldE1hcENvb3JkaW5hdGVTeXN0ZW0iOiJSOGlfIiwiaW52YWxpZGF0ZSI6InRkXyJ9fX0g");var S9=Ci(function(){let i=class t extends N9{constructor(t){(t=qi(t,{source:t&&t["source"]||new p8}))["templates"]==null&&(t["templates"]=[]);super(t);t["idfield"]!=null&&this.Utt_.i6i_(t["idfield"]);const i=[$4.D_(),i8.D_(),X4.D_(),Z4.D_(),w4.D_(),W4.D_(),p4.D_()];for(let t=0;t<i.length;++t)if(this.j3i_(i[t])==null){const s=this.zis_(i[t]);s!=null&&this.AGi_(i[t],s,!0)}}i6i_(t){this.Utt_.i6i_(t);return this}zis_(t){switch(t){case $4.D_():case i8.D_():return new n6;case X4.D_():case Z4.D_():return new e6;case w4.D_():case W4.D_():return new A6;case p4.D_():return new b4}return null}N_(){const t=super.N_();t["idfield"]=this.Utt_.s6i_();return t}dt_(t){if((t=Es(t))==null)return this;typeof t["idfield"]=="string"&&this.Utt_.i6i_(t["idfield"]);super.dt_(t);return this}};i=t([_s("geotoolkit.map.layers.Vector")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRVbmlxdWVGaWVsZCI6Imk2aV8iLCJnZXRQcm9wZXJ0aWVzIjoiTl8iLCJzZXRQcm9wZXJ0aWVzIjoiZHRfIn19fSAg");const G9=OA.Ai_().gn_("px"),R9=OA.Ai_().gn_("metre");var k9=Ci(function(){let i=class t extends S9{constructor(t){t=qi(t,{source:t&&t["source"]||new p9,token:null,templates:[],annotations:{}},!0);n8.Q4i_(t["annotations"],"filter",Y8);const i=t["source"];t["requestresolution"]!=null&&i.e6i_(t["requestresolution"]);t["idfield"]!=null&&i.i6i_(t["idfield"]);t["requestfields"]!=null&&i.L8i_("setRequestFields",t["requestfields"]);t["token"]!=null&&i.L8i_("setToken",t["token"]);t["source"]=i;super(t);t["layer"]!=null&&this.Utt_ instanceof p9&&this.Utt_.Iis_(t["layer"])}ois_(){return this.Utt_.ois_()}N_(){const t=super.N_();t["requestresolution"]=this.Utt_.A6i_();return t}dt_(t){if((t=Es(t))==null)return this;super.dt_(t);t["requestresolution"]!==void 0&&this.Utt_.e6i_(t["requestresolution"]);t["requestfields"]!==void 0&&this.Utt_.L8i_("setRequestFields",t["requestfields"]);t["token"]!==void 0&&this.Utt_.L8i_("setToken",t["token"]);t["layer"]!==void 0&&this.Utt_ instanceof p9&&this.Utt_.Iis_(t["layer"]);return this}Iis_(t){this.Utt_!=null&&this.Utt_.Iis_(t);return this}Cis_(){return this.Utt_!=null?this.Utt_.Cis_():null}c6i_(t,i,s){super.c6i_(t,i,s);if(t===rh.nC_){this.i9i_===1&&(this.i9i_=i.OR_());const t=Au.IN_(this.UU_["annotations"]["filter"]).toArray();t.push(new q8);this.UU_["annotations"]["filter"]=t;const s=i.cis_();this.z6i_==null&&s!=null&&(this.z6i_=new yQ({minscale:R9.wn_(s[0],G9),minscaleinclusive:!1,maxscale:R9.wn_(s[1],G9),maxscaleinclusive:!1}))}}J7i_(t,i){const s=[];let e=[];if(this.Utt_!=null&&this.Utt_.gis_()){const i=this.Cis_();t.forEach((function(t){const A=t.M5i_().jts_;if(A==null)e.push(t);else{if(i!=null&&i.indexOf(A+"")===-1)return;s[+A]=s[+A]||[];s[+A].push(t)}}));s.reverse()}else e=t instanceof Au?t.toArray():t;e.length>0&&s.push(e);const A=G9.wn_(i.Ji_().BI_(),R9),n=i.OR_();s.forEach((t=>{if(t.length===0)return;const s=t[0].M5i_(),n=t!==e?this.Utt_.ais_(s.jts_+""):null,h=n?n.cis_():null;if(h!=null&&(h[0]!=null&&h[0]>A||h[1]!=null&&h[1]<A))return;const r=n?n.OR_():1;i.tN_(this.i9i_*r);super.J7i_(t,i);super.drawPath(i)}));i.tN_(n)}Bis_(t){const i=this.Utt_;i instanceof p9?i.Bis_(t):t(new Error("ArcGISFeature source should be used to query a legend"));return this}};i=t([_s("geotoolkit.map.layers.ArcGISFeature")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRSZXF1ZXN0RmllbGRzIjoib2lzXyIsImdldFByb3BlcnRpZXMiOiJOXyIsInNldFByb3BlcnRpZXMiOiJkdF8iLCJzaG93TGF5ZXJzIjoiSWlzXyIsImdldFZpc2libGVMYXllcnMiOiJDaXNfIiwicmVuZGVyRmVhdHVyZXMiOiJKN2lfIiwicXVlcnlMZWdlbmQiOiJCaXNfIn19fSAg");const F9=function(t){let i="&layers=show:"+t[0];for(let s=1;s<t.length;s++)i+=","+t[s];return i};var x9=Ci(function(){let i=class t extends h8{constructor(t){super(t=qi(t,{connector:new t9({connector:new x6}),transparent:!0}));this.N4i_={};this.Xis_=t["geometryconnector"]||new V4}query(t){const i=t["left"],s=t["right"],e=t["top"],A=t["bottom"],n=t["width"],h=t["height"],r=this.N4i_.url;if(!r||typeof r!="string")return this;const o=r.endsWith("/")?"":"/";let l=F9(this.N4i_.jis_),u="export";const a=new df({lazyloading:!0,ax:(i+s)/2,ay:(e+A)/2,width:s-i,height:A-e,ispointingup:!0,alignment:dA.ne_,crossorigin:"anonymous"});if((r+o).endsWith("ImageServer/")){u="exportImage";l=""}else if(this.N4i_.jis_.length===0){this.notify(ff.PV_,a,null);return this}const g=this.N4i_.e8i_.B5i_().w2i_(),c=undefined,I=o+u+("?bbox="+i+"%2C"+e+"%2C"+s+"%2C"+A+"&size="+n+"%2C"+h)+l+"&imageSR="+g+"&bboxSR="+g+"&f=image";this.S4i_.send(this.R4i_(I),{token:this.N4i_.qts_,dst:a,key:t["key"]},((t,i)=>{t?this.onError(t):this.Df_()||this.notify(ff.PV_,i,i._V_())}));return this}Zis_(t){if(!this.N4i_.url||typeof this.N4i_.url!="string")return this;const i=t["geometry"],s=this.N4i_.url.endsWith("/")?"":"/",e=t["layer"]!=null?t["layer"]+"/":"",A=this.N4i_.e8i_.B5i_(),n=A.E2i_(),h=A.w2i_();let r,o;if(i instanceof lA){r="esriGeometryPoint";o=i.getX()+","+i.getY()}else if(i instanceof mA){r="esriGeometryEnvelope";o=i.we_()+","+i.Ee_()+","+i.Qe_()+","+i.pe_()}else{if(!(i instanceof In))return this;{const t=i.Bt_(),s=i.wt_();r="esriGeometryPolygon";o=encodeURI('{"rings":[[');for(let i=0;i<t.length;i++){const e=undefined;o+="["+(n.we_()+(t[i]+n.Ie_()-n.we_())%n.Ie_())+","+s[i]+"]";o+=i+1!==t.length?",":encodeURI("]]}")}}}const l=s+e+"query?geometryType="+r+"&geometry="+o+"&inSR="+h+"&outFields=*&f=json";this.Xis_.send(this.R4i_(l),{key:t["key"]},((i,s)=>{if(typeof s=="string")try{s=JSON.parse(s)}catch(t){s={}}this.notify(g8.s8i_,this,{layer:t["layer"],data:s})}));return this}_is_(t){this.Xis_.abort(t);return this}$is_(t){if(!this.N4i_.url||typeof this.N4i_.url!="string")return this;const i=t["left"],s=t["right"],e=t["top"],A=t["bottom"],n=t["width"],h=t["height"],r=this.N4i_.url.endsWith("/")?"":"/",o=this.N4i_.e8i_.B5i_(),l=o.E2i_(),u=o.w2i_();let a,g;const c=t["geometry"];if(c instanceof lA){a="esriGeometryPoint";g=c.getX()+","+c.getY()}else if(c instanceof mA){a="esriGeometryPolygon";g='{"rings":[[';g+="["+c.we_()+","+c.Ee_()+"],";g+="["+c.Qe_()+","+c.Ee_()+"],";g+="["+c.Qe_()+","+c.pe_()+"],";g+="["+c.we_()+","+c.pe_()+"],";g+="["+c.we_()+","+c.Ee_()+"]";g+="]]}"}else{if(!(c instanceof In))return this;{const t=c.Bt_(),i=c.wt_();a="esriGeometryPolygon";g='{"rings":[[';for(let s=0;s<t.length;s++){const e=undefined;g+="["+(l.we_()+(t[s]+l.Ie_()-l.we_())%l.Ie_())+","+i[s]+"]";g+=s+1!==t.length?",":"]]}"}}}let I=r+"identify?f=json&geometryType="+a+"&geometry="+g;if((this.N4i_.url+r).endsWith("ImageServer/")){I+="&inSR="+u;I+="&pixelSize={x:"+Math.abs(s-i)/n+",y:"+Math.abs(e-A)/h+"}"}else{I+="&mapExtent="+i+","+e+","+s+","+A;I+="&imageDisplay="+n+","+h;I+="&sr="+u;t["layers"]!=null&&(I+="&layers="+t["layers"]);I+="&tolerance=0"}I=encodeURI(I);this.Xis_.send(this.R4i_(I),{key:t["key"]},((t,i)=>{let s;if(typeof i=="string")try{s=JSON.parse(i);s["results"]&&!s["features"]&&(s["features"]=s["results"])}catch(t){s={}}else s=i;this.notify(g8.s8i_,this,{layer:-1,data:s})}));return this}};i=t([_s("geotoolkit.map.sources.formats.ArcGISImage")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJxdWVyeUdlb21ldHJ5IjoiWmlzXyIsImFib3J0R2VvbWV0cnlRdWVyaWVzIjoiX2lzXyIsImlkZW50aWZ5IjoiJGlzXyJ9fX0g");var L9=Ci(function(){let i=class t extends o6{constructor(t){super(t=qi(t,{connector:new t9}));this.N4i_={}}parse(t,i){const s=typeof t=="string"?JSON.parse(t):t;this.N4i_.data=s;if(s["error"]!=null){c9.warn(s["error"]);throw new Error("ArcGISImage server returned error!")}const e=s["spatialReference"]||s["sourceSpatialReference"];this.N4i_.jis_=this.N4i_.jis_||[];if(Array.isArray(s["layers"])){if(this.N4i_.jis_.length===0)for(let t=0;t<s["layers"].length;++t){const i=s["layers"][t];i["defaultVisibility"]!==!0||i["subLayerIds"]||this.N4i_.jis_.push(i["id"])}this.N4i_.layers=this.Ots_(s["layers"],s["type"]);this.Wts_(s["fullExtent"],e)}else{this.N4i_.layers=null;this.Wts_(s["extent"],e)}this.N4i_.$ts_=this.tis_(s["initialExtent"],e);this.r9i_=s["copyrightText"];this.loaded(i)}clear(){this.N4i_.layers=[];super.clear();return this}a9i_(){const t=Array.isArray(this.N4i_.url)?this.N4i_.url[0]:this.N4i_.url;return t?t+"?f=pjson":null}g9i_(){return{token:this.N4i_.qts_}}Wts_(t,i){this.iis_(t["spatialReference"]||i);const s=this.N4i_.e8i_,e=new lA(parseFloat(t["xmin"]),parseFloat(t["ymin"])),A=new lA(parseFloat(t["xmax"]),parseFloat(t["ymax"]));s.transform(e,e);s.transform(A,A);this.N4i_.FMt_=new mA(e.x,e.y,A.x,A.y);return this}tis_(t,i){if(!t)return this.N4i_.FMt_;const s=typeof(i=t["spatialReference"]||i)=="number"?i:i["wkid"]||i["wkt"],e=undefined;let A;if(this.N4i_.e8i_.d5i_().w2i_()===s)A=this.N4i_.e8i_;else{const t=X3.sx_().l5i_(s);if(!t)return this.N4i_.FMt_;A=new Z3({initialcoordinatesystem:t,targetcoordinatesystem:this.N4i_.e8i_.B5i_()})}const n=new lA(parseFloat(t["xmin"]),parseFloat(t["ymin"])),h=new lA(parseFloat(t["xmax"]),parseFloat(t["ymax"]));A.transform(n,n);A.transform(h,h);return new mA(n.x,n.y,h.x,h.y)}iis_(t){const i=typeof t=="number"?t:t["wkid"]||t["wkt"],s=undefined;if(this.N4i_.e8i_.d5i_().w2i_()===i)return this;const e=X3.sx_().l5i_(i);if(!e)throw new Error("ArcGISImage: coordinate system ("+i+") is not supported, "+"use geotoolkit.map.coordinatesystems.Registry to register it manually.");this.N4i_.l8i_.Q5i_(e);this.N4i_.e8i_.w5i_(e);return this}Bis_(t){const i=Array.isArray(this.N4i_.url)?this.N4i_.url[0]:this.N4i_.url;if(!i){t(new Error("Cannot load ArcGIS legend: no server provided"));return}if(this.N4i_.tss_){this.N4i_.tss_.data?t(null,this.N4i_.tss_.data):this.N4i_.tss_.error?t(this.N4i_.tss_.error):this.N4i_.tss_.iss_.push(t);return}this.N4i_.tss_={iss_:[t]};const s=i.endsWith("/")?"":"/",e=n8.M4i_(i+s+"legend?f=json",this.b4i_);this.S4i_.send(e,null,((t,s)=>{if(t){this.sss_(t);return}let e;if(typeof s=="string")try{e=JSON.parse(s)}catch(t){this.sss_(t);return}else e=s;const A=c9.Sts_(e,i);A?this.sss_(null,A):this.sss_(new Error(e&&e["error"]||"Wrong Legend received"))}))}sss_(t,i){this.N4i_.tss_.error=t;this.N4i_.tss_.data=i;for(let s=0;s<this.N4i_.tss_.iss_.length;++s)this.N4i_.tss_.iss_[s](t,i);this.N4i_.tss_.iss_=[]}Ots_(t,i){const s=Array.isArray(this.N4i_.url)?this.N4i_.url[0]:this.N4i_.url,e=i==="Group Layer"?s.substr(0,s.lastIndexOf("/"))+"/":s+"/";for(let i=0;i<t.length;++i){const s=t[i],A=t[s["parentLayerId"]];if(A!=null){A["minScale"]>0&&(s["minScale"]=s["minScale"]>0?Math.min(s["minScale"],A["minScale"]):A["minScale"]);A["maxScale"]>0&&(s["maxScale"]=s["maxScale"]>0?Math.max(s["maxScale"],A["maxScale"]):A["maxScale"])}s["url"]=e+s["id"]}return t}};i=t([_s("geotoolkit.map.sources.loaders.ArcGISImage")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRTZXR0aW5nc1VybCI6ImE5aV8iLCJnZXRSZXF1ZXN0T3B0aW9ucyI6Imc5aV8ifX19");const U9=.001,Y9=function(t,i){const s=1e-5;return i.we_()>=t.we_()-s&&i.Qe_()<=t.Qe_()+s&&i.Ee_()>=t.Ee_()-s&&i.pe_()<=t.pe_()+s},T9=function(t,i,s){const e=t.rn_(i);let A=Math.floor(e.we_()),n=Math.ceil(e.Qe_());if(A<s.we_()){n+=s.we_()-A;n=Math.min(n,s.Qe_());A=s.we_()}else if(n>s.Qe_()){A+=s.Qe_()-n;A=Math.max(A,s.we_());n=s.Qe_()}let h=Math.floor(e.Ee_()),r=Math.ceil(e.pe_());if(h<s.Ee_()){r+=s.Ee_()-h;r=Math.min(r,s.pe_());h=s.Ee_()}else if(r>s.pe_()){h+=s.pe_()-r;h=Math.max(h,s.Ee_());r=s.pe_()}return e.ce_(A,h,n,r)};var K9=function(){let i=class t extends C8{constructor(t,i){super(t,i);this.ess_=[]}query(t,i){this.N4i_.Ass_||(t=i.ot_(!0));const s=i.if_(),e=s.BI_(),A=undefined;if(!this.Wj_(t,e))return!1;if(this.V8i_!=null){clearTimeout(this.V8i_);this.V8i_=null}this.V8i_=setTimeout((()=>{const t=s.rn_(this.N4i_.Ass_?this.N4i_.FMt_:this.N4i_.e8i_.B5i_().E2i_());for(let i=0;i<this.ess_.length;++i){const e=this.ess_[i];if(!this.ess_[i].nss_){const i=T9(s,e.bounds,t);s.gI_(i,e.bounds);const A=Math.round(i.Ie_()),n=Math.round(i.Ts_());this.jF_.query({left:e.bounds.getX(),top:e.bounds.Ee_(),right:e.bounds.Qe_(),bottom:e.bounds.pe_(),width:Math.max(A,1),height:Math.max(n,1)});e.nss_=!0}}this.V8i_=null}),this.N4i_.timeout);return!0}Wj_(t,i){const s=this.N4i_.e8i_.B5i_().E2i_(),e=[];if(s.Fe_(t)){this.N4i_.Ass_&&t.intersect(this.N4i_.FMt_);t.isEmpty()||e.push(t)}else{const i=t.clone().intersect(s);this.N4i_.Ass_&&i.intersect(this.N4i_.FMt_);i.isEmpty()||e.push(i);const A=t.getX()>s.getX()?s.Ie_():-s.Ie_(),n=s.clone().intersect(t.translate(-A,0));this.N4i_.Ass_&&n.intersect(this.N4i_.FMt_);n.isEmpty()||e.push(n)}let A,n;const h=this.N4i_.Le_*t.Ie_(),r=this.N4i_.Le_*t.Ts_(),o=this.N4i_.Ass_?this.N4i_.FMt_:s;if(!NA.equals(this.xm_,i)||e.length===0){this.xm_=i;this.ess_=[];for(A=0;A<e.length;++A)this.ess_.push({bounds:e[A].Le_(h,r).intersect(o),nss_:!1});return!0}const l=[];let u=!1;for(A=0;A<e.length;A++){for(n=0;n<this.ess_.length;n++)if(Y9(this.ess_[n].bounds,e[A]))break;if(n===this.ess_.length){l.push({bounds:e[A].Le_(h,r).intersect(o),nss_:!1});u=!0}else{if(!this.ess_[n].nss_){e[A].Le_(h,r).intersect(o);u=u||this.ess_[n].bounds.Fe_(e[A]);this.ess_[n].bounds.union(e[A])}l.indexOf(this.ess_[n])<0&&l.push(this.ess_[n])}}this.ess_=l;return u}K8i_(){this.jF_.on(ff.PV_,((t,i)=>{let s=!0;for(let t=0;t<this.ess_.length;++t)this.ess_[t].bounds.Ce_(i.getBounds(),U9)?this.ess_[t].img=i:this.ess_[t].img||(s=!1);if(s){const t=this.ess_.map((function(t){return t.img}));this.notify(g8.PV_,this,t)}}));return this}abort(){if(this.V8i_!=null){clearTimeout(this.V8i_);this.V8i_=null}return super.abort()}clear(){super.clear();this.ess_=[];this.xm_=null;return this}f4i_(){return this.V8i_!=null||super.f4i_()}};i=t([_s("geotoolkit.map.sources.managers.Image")],i);return i}();var H9=Ci(function(){let i=class t extends f8{constructor(t){super(t=t||{});this.N4i_=this.N4i_||{};this.N4i_.Le_=t.hasOwnProperty("inflate")?t["inflate"]:.2;this.N4i_.timeout=t.hasOwnProperty("timeout")?t["timeout"]:50;this.N4i_.Ass_=!!t.hasOwnProperty("uselayerlimits")&&t["uselayerlimits"];this.N4i_.jis_=[]}B8i_(t){this.u8i_=new K9(t,this.N4i_);this.u8i_.on(g8.PV_,((t,i,s)=>{this.notify(g8.PV_,this,s);this.y8i_(!0)}));return this}clear(){this.notify(g8.t8i_,this,null);super.clear();return this}hss_(t){this.N4i_.Le_=t;return this}rss_(){return this.N4i_.Le_}oss_(t){this.N4i_.timeout=t;return this}lss_(){return this.N4i_.timeout}Iis_(t){this.N4i_.jis_=t?Array.isArray(t)?t:[t]:[];this.update();return this}uss_(t){const i=[];if(t!=null)for(let s=0;s<this.N4i_.jis_.length;++s){const e=this.N4i_.jis_[s];(Array.isArray(t)?t.indexOf(e)===-1:e!==t)&&i.push(e)}this.N4i_.jis_=i;this.update();return this}Cis_(){return this.N4i_.jis_}getLayers(){const t=this.N4i_;return t.layers?t.layers:null}};i=t([_s("geotoolkit.map.sources.Image")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRJbmZsYXRlUmF0aW8iOiJoc3NfIiwiZ2V0SW5mbGF0ZVJhdGlvIjoicnNzXyIsInNldFNvdXJjZVRpbWVvdXQiOiJvc3NfIiwiZ2V0U291cmNlVGltZW91dCI6Imxzc18iLCJzaG93TGF5ZXJzIjoiSWlzXyIsImhpZGVMYXllcnMiOiJ1c3NfIiwiZ2V0VmlzaWJsZUxheWVycyI6IkNpc18ifX19");var q9=function(){let i=class t extends K9{constructor(){super(...arguments);this.qd_=null;this.ass_={}}Zis_(t){let i,s=[];const e=[],A=this.N4i_.gss_||this.N4i_.jis_;if(this.css_(t))for(i=0;i<A.length;++i){const t=A[i];this.ass_.hasOwnProperty(t)?e.push.apply(e,this.ass_[t]):s.push(t)}else{s=A;this.qd_=t;this.ass_={};this.jF_._is_()}for(i=0;i<s.length;++i){this.jF_.Zis_({geometry:t,layer:s[i]});this.ass_[s[i]]=null}return s.length===0||e.length>0?e:null}$is_(t,i){if(this.css_(t)){const t=[];for(const i in this.ass_)this.ass_.hasOwnProperty(i)&&t.push.apply(t,this.ass_[i]);return t}this.ass_={};this.qd_=t;const s=this.N4i_.gss_||this.N4i_.jis_,e=i.ot_(),A=undefined,n=i.if_().rn_(e).round();this.jF_.$is_({geometry:t,left:e.we_(),right:e.Qe_(),top:e.Ee_(),bottom:e.pe_(),width:n.Ie_(),height:n.Ts_(),layers:"all:"+s.join(",")});return null}css_(t){if(t===this.qd_)return!0;if(t instanceof mA&&this.qd_ instanceof mA)return t.Ce_(this.qd_);if(t instanceof lA&&this.qd_ instanceof lA)return t.bs_(this.qd_);if(t instanceof In&&this.qd_ instanceof In){if(t.getSize()!==this.qd_.getSize())return!1;const i=t.getSize(),s=t.Bt_(),e=t.wt_(),A=this.qd_.Bt_(),n=this.qd_.wt_();for(let t=0;t<i;t++)if(s[t]!==A[t]||e[t]!==n[t])return!1;return!0}return!1}K8i_(){super.K8i_();this.jF_.on(g8.s8i_,((t,i,s)=>{const e=s["layer"],A=s["data"];if(Array.isArray(A["features"])&&A["features"].length>0){this.ass_[e]=c9.Gts_(A,e);this.notify(g8.s8i_,this,s)}else{this.ass_[e]=[];for(const t in this.ass_)if(!this.ass_[t]||this.ass_[t].length>0)return;this.notify(g8.s8i_,this,s)}}));return this}_is_(){this.jF_._is_();return this}};i=t([_s("geotoolkit.map.sources.managers.ArcGISImage")],i);return i}();var J9=Ci(function(){let i=class t extends H9{constructor(t){super(t=qi(t,{format:new x9,loader:new L9},!0));this.N4i_=this.N4i_||{};this.N4i_.qts_=t["token"];this.N4i_.gss_=null;this.Iss_(t["dpi"]);this.setTime(t["time"]);this.fss_(t["transparent"]);this.Css_(t["dynamiclayers"])}B8i_(t){this.u8i_=new q9(t,this.N4i_);const i=(t,i,s)=>{this.notify(t,this,s);this.y8i_(!0)};this.u8i_.on(g8.PV_,i);this.u8i_.on(g8.s8i_,i);this.jF_=t;return this}Bis_(t){this.a8i_?this.a8i_.Bis_(t):t(new Error("Cannot query ArcGIS legend, no loader provided!"))}Zis_(t){return this.E8i_()?this.u8i_.Zis_(t):[]}_is_(){this.u8i_._is_();return this}$is_(t,i){return this.E8i_()?this.u8i_.$is_(t,i):[]}fis_(){return this.N4i_.$ts_}dss_(t){this.N4i_.gss_=t==null?null:Array.isArray(t)?t:[t];return this}Iss_(t){if(this.jF_==null||t==null)return this;this.jF_.G4i_("dpi",t);this.update();return this}setTime(t){if(this.jF_==null||t==null)return this;const i=t instanceof fA?t.Xs_()+", "+t.zs_():t+"";this.jF_.G4i_("time",i);this.update();return this}fss_(t){if(this.jF_==null||t==null)return this;this.jF_.G4i_("transparent",t);this.update();return this}Css_(t){if(this.jF_==null||t==null)return this;this.jF_.G4i_("dynamicLayers",typeof t!="string"?JSON.stringify(t):t);this.update();return this}his_(t){this.N4i_.qts_=t;return this}fw_(){return this.N4i_.qts_}};i=t([_s("geotoolkit.map.sources.ArcGISImage")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJxdWVyeUxlZ2VuZCI6IkJpc18iLCJxdWVyeUdlb21ldHJ5IjoiWmlzXyIsImFib3J0R2VvbWV0cnlRdWVyaWVzIjoiX2lzXyIsImlkZW50aWZ5IjoiJGlzXyIsImdldEluaXRpYWxNb2RlbExpbWl0cyI6ImZpc18iLCJzZXRUb29sdGlwTGF5ZXJzIjoiZHNzXyIsInNldERQSSI6Iklzc18iLCJzZXRUcmFuc3BhcmVudCI6ImZzc18iLCJzZXREeW5hbWljTGF5ZXJzIjoiQ3NzXyIsInNldFRva2VuIjoiaGlzXyIsImdldFRva2VuIjoiZndfIn19fSAg");const P9=new mA,V9=new mA;var O9=Ci(function(){let i=class t extends h6{constructor(t){super(t);if(t&&t["showlayers"]){this.uss_();this.Iis_(t["showlayers"])}this.fO_=null}render(t){if(!this.$C_()||this.z6i_!=null&&!this.z6i_.filter(this,t))return;if(t.tk_()){if(this.OC_()){t.iQ_(wr.EQ_);t.pR_(this.rt_())}return}const i=this.ot_(!0);if(i!=null){this.Cvt_().query(i,this);this.zY_(t)}}ad_(t,i){if(!this.$C_()||this.z6i_!=null&&!this.z6i_.filter(this,t)){i();return}const s=t;if(s.tk_()){if(this.OC_()){s.iQ_(wr.EQ_);s.pR_(this.rt_())}i();return}const e=this.ot_(!0);if(e!=null){this.Cvt_().query(e,this);this.OY_(s,i)}else i()}zY_(t){if(this.fO_==null)return;const i=t.OR_(),s=t.Ji_(),e=t.VR_(),A=this.l5i_().E2i_(),n=s.rn_(A,P9),h=t.cR_();t.aS_({RK_:!0});t.tN_(this.i9i_);t.dI_(Gn.JI_);const r=n.Qe_()>h.getX()-1&&n.Qe_()<h.Qe_()+1,o=n.getX()>h.getX()-1&&n.getX()<h.Qe_()+1;for(let i=0;i<this.fO_.length;i++){const A=this.fO_[i];let l=!1,u,a;const g=s.rn_(A.getBounds(),V9);if(r){l=NA.equals(n.Qe_(),g.Qe_(),1);a=Math.round(Math.round(n.Qe_())*e);u=Math.round(a-g.Ie_()*e)}else if(o){l=NA.equals(n.we_(),g.we_(),1);u=Math.round(Math.round(n.we_())*e);a=Math.round(u+g.Ie_()*e)}if(!l){l=g.$s_(h);u=Math.round(Math.round(g.we_())*e);a=Math.round(u+g.Ie_()*e)}if(l&&A.fM_()!=null){const i=A.fM_();t.drawImage(i,0,0,i.width,i.height,u,g.Ee_()*e,a-u,g.Ts_()*e)}}t.dI_(s);t.tN_(i);t.cS_()}getLayers(){return this.Utt_!=null?this.Utt_.getLayers():null}Cis_(){return this.Utt_!=null?this.Utt_.Cis_():null}Iis_(t){this.Utt_!=null&&this.Utt_.Iis_(t);return this}uss_(t){this.Utt_!=null&&this.Utt_.uss_(t);return this}rvt_(t){if(this.Utt_===t)return this;this.z7i_||(this.z7i_=(t,i,s)=>{this.notify(rh.nC_,this,s)});this.Bss_||(this.Bss_=(t,i,s)=>{this.fO_=s;this.td_()});if(this.Utt_!=null){this.Utt_.off(rh.nC_,this.z7i_);this.Utt_.off(g8.PV_,this.Bss_);this.Utt_.off(g8.t8i_,this.Bss_)}this.Utt_=t;if(this.Utt_!=null){this.Utt_.on(rh.nC_,this.z7i_);this.Utt_.on(g8.PV_,this.Bss_);this.Utt_.on(g8.t8i_,this.Bss_);const t=this.UU_["url"];t!=null&&this.Utt_.D8i_()==null&&this.Utt_.Q8i_(t)}return this}N_(){const t=super.N_();t["showlayers"]=this.Cis_();return t}dt_(t){if((t=Es(t))==null)return this;if(t["showlayers"]!==void 0){this.uss_();this.Iis_(t["showlayers"])}super.dt_(t);return this}};i=t([_s("geotoolkit.map.layers.Image")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJyZW5kZXJBc3luYyI6ImFkXyIsInJlbmRlckNvbnRlbnQiOiJ6WV8iLCJnZXRWaXNpYmxlTGF5ZXJzIjoiQ2lzXyIsInNob3dMYXllcnMiOiJJaXNfIiwiaGlkZUxheWVycyI6InVzc18iLCJnZXRQcm9wZXJ0aWVzIjoiTl8iLCJzZXRQcm9wZXJ0aWVzIjoiZHRfIn19fSAg");const W9=new lA,z9=new xA;var X9=Ci(function(){let i=class t extends O9{constructor(t){super(t=Pi(t,{source:t&&t["source"]||new J9,token:null,tooltip:{visible:!1,formatter:new X8(null,null,1/0,!0)}}));t["tooltip"]["layers"]!=null&&this.Utt_.dss_(t["tooltip"]["layers"]);t["token"]!=null&&this.Utt_.L8i_("setToken",t["token"])}Bis_(t){const i=this.Cvt_();i instanceof J9?i.Bis_(t):t(new Error("ArcGISImage source should be used to query a legend"));return this}$X_(t,i){const s=this.k8i_();if(!s)return[];const e=s.E2i_(),A=this.if_();(t=A.aI_(t,W9)).getX()<e.getX()?t.x+=e.Ie_():t.getX()>e.Qe_()&&(t.x-=e.Ie_());const n=this.rt_();if(!n||!n.contains(t))return[];i=i==null?2:i;A.cI_(z9.setSize(i,i),z9);return this.Utt_.$is_(new mA(t.getX()-z9.Ie_(),t.getY()-z9.Ts_(),t.getX()+z9.Ie_(),t.getY()+z9.Ts_()),this)}rvt_(t){if(this.Utt_===t)return this;this.wss_||(this.wss_=(t,i,s)=>{this.notify(g8.s8i_,this,s)});this.Utt_!=null&&this.Utt_.off(g8.s8i_,this.wss_);super.rvt_(t);this.Utt_!=null&&this.Utt_.on(g8.s8i_,this.wss_);return this}};i=t([_s("geotoolkit.map.layers.ArcGISImage")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJxdWVyeUxlZ2VuZCI6IkJpc18iLCJoaXRUZXN0IjoiJFhfIn19fSAg");var j9=Ci(function(){let i=class t extends f8{constructor(t){const i=qi(t,{tilewidth:256,tileheight:256,imagepool:400,token:null,minlod:0,maxlod:15},!0);i["format"]=i["format"]||new U6({formatterfunction:i["formatterfunction"],token:i["token"]});super(i);this.N4i_=this.N4i_||{};this.N4i_.qts_=i["token"];this.N4i_.B7i_=i["tilewidth"];this.N4i_.d7i_=i["tileheight"];this.N4i_.c7i_=i["minlod"];this.N4i_.w7i_=i["maxlod"];this.N4i_.N7i_=i["imagepool"];this.N4i_.r7i_=[null,null]}B8i_(t){this.u8i_=new J6(t,this.N4i_);this.u8i_.on(g8.i8i_,((t,i,s)=>{this.notify(g8.i8i_,this,s);this.y8i_(!0)}));return this}clear(){this.u8i_!=null&&this.u8i_.clear();super.clear();return this}HKi_(){return this.u8i_!=null?this.u8i_.HKi_():{}}rpt_(){return this.u8i_!=null?this.u8i_.rpt_():new xA(1,1)}Qss_(){return this.N4i_.c7i_}Ess_(){return this.N4i_.w7i_}mH_(){return this.N4i_.B7i_}yH_(){return this.N4i_.d7i_}dt_(t){if((t=Es(t))==null)return this;super.dt_(t);t["formatterfunction"]!==void 0&&this.u8i_.s7i_(t["formatterfunction"]);t["tilewidth"]!==void 0&&(this.N4i_.B7i_=t["tilewidth"]);t["tileheight"]!==void 0&&(this.N4i_.d7i_=t["tileheight"]);t["minlod"]!==void 0&&(this.N4i_.c7i_=t["minlod"]);t["maxlod"]!==void 0&&(this.N4i_.w7i_=t["maxlod"]);t["imagepool"]!==void 0&&(this.N4i_.N7i_=t["imagepool"]);t["token"]!==void 0&&(this.N4i_.qts_=t["token"]);this.u8i_.ix_().B_t_(this.N4i_);return this}N_(){const t=super.N_();t["tilewidth"]=this.N4i_.B7i_;t["tileheight"]=this.N4i_.d7i_;t["minlod"]=this.N4i_.c7i_;t["maxlod"]=this.N4i_.w7i_;t["imagepool"]=this.N4i_.N7i_;t["token"]=this.N4i_.qts_;return t}i7i_(){return this.u8i_?this.u8i_.i7i_():null}s7i_(t){this.u8i_&&this.u8i_.s7i_(t);return this}V$_(){return this.u8i_!=null?this.u8i_.V$_():this.N4i_.c7i_}};i=t([_s("geotoolkit.map.sources.Tile")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRQcm9wZXJ0aWVzIjoiZHRfIiwiZ2V0UHJvcGVydGllcyI6Ik5fIn19fSAg");var Z9=function(){let i=class t extends L9{constructor(t){super(t);this.N4i_={}}parse(t,i){const s=typeof t=="string"?JSON.parse(t):t;this.N4i_.data=s;if(s["error"]!=null){c9.warn(s["error"]);throw new Error("ArcGISTile server returned error!")}const e=s["spatialReference"]||s["sourceSpatialReference"];this.Wts_(Array.isArray(s["layers"])?s["fullExtent"]:s["extent"],e);s["minLOD"]!=null&&(this.N4i_.c7i_=Math.max(this.N4i_.c7i_,+s["minLOD"]));s["maxLOD"]!=null&&(this.N4i_.w7i_=Math.min(this.N4i_.w7i_,+s["maxLOD"]));const A=s["tileInfo"],n=A?A["lods"]:null;if(Array.isArray(n)&&n.length>0){let t=1/0,i=-1/0;for(let s=0;s<n.length;++s){const e=n[s]["level"];if(e!=null){t=Math.min(t,e);i=Math.max(i,e)}}this.N4i_.c7i_=Math.max(this.N4i_.c7i_,t);this.N4i_.w7i_=Math.min(this.N4i_.w7i_,i)}this.N4i_.r7i_=[s["minScale"]>0?1/s["minScale"]:null,s["maxScale"]>0?1/s["maxScale"]:null];this.N4i_.X9i_=function(t,i,s){return"/tile/"+t+"/"+i+"/"+s};this.r9i_=s["copyrightText"];this.loaded(i)}};i=t([_s("geotoolkit.map.sources.loaders.ArcGISTile")],i);return i}();const _9=new mA;var $9=Ci(function(){let i=class t extends h6{constructor(t){const i=qi(t,{tilewidth:256,tileheight:256,minlod:0,maxlod:15,imagepool:400,source:null,format:t&&t["formatterfunction"]?new U6({formatterfunction:t["formatterfunction"]}):null,url:null},!0);i["source"]=i["source"]||new j9(i);super(i)}render(t){if(this.$C_()&&(!this.z6i_||this.z6i_.filter(this,t)))if(t.tk_()){t.iQ_(wr.EQ_);t.pR_(this.rt_())}else this.zY_(t)}ad_(t,i){if(this.$C_()&&(!this.z6i_||this.z6i_.filter(this,t))){if(!t.tk_()){this.OY_(t,i);return}t.iQ_(wr.EQ_);t.pR_(this.rt_())}i()}zY_(t){if(this.D8i_()==null||this.k8i_()==null)return;const i=this.ot_();this.Cvt_().query(i,this);const s=t.VR_(),e=t.Ji_(),A=t.cR_(),n=this.pss_(),h=e.rn_(n,_9);let r,o=h.Ee_()*s;r=h.Qe_()>A.getX()-1&&h.Qe_()<A.Qe_()+1?Math.round(Math.round(h.Qe_())*s)-h.Ie_()*s:h.getX()>A.getX()-1&&h.getX()<A.Qe_()+1?Math.round(Math.round(h.getX())*s):h.getX()*s;const l=this.Utt_.rpt_(),u={width:s*h.Ie_()/l.Ie_(),height:s*h.Ts_()/l.Ts_()},a=e.rn_(i,_9),g={Q7i_:Math.floor((s*a.we_()-r)/u.width),E7i_:Math.ceil((s*a.Qe_()-r)/u.width),p7i_:Math.floor((s*a.Ee_()-o)/u.height),m7i_:Math.ceil((s*a.pe_()-o)/u.height)},c=this.Utt_.HKi_();r+=g.Q7i_*u.width;o+=g.p7i_*u.height;const I=t.OR_();t.aS_({RK_:!0});t.dI_(Gn.JI_);t.tN_(this.i9i_);for(const i in c)c[i]instanceof df&&this.mss_(c[i],t,g,r,o,u);t.tN_(I);t.dI_(e);t.cS_()}mss_(t,i,s,e,A,n){const h=t._i,r=t._j;if(t.fM_()==null||h<s.Q7i_||h>s.E7i_||r<s.p7i_||r>s.m7i_)return this;const o=t.fM_(),l=Math.round(e+(h-s.Q7i_)*n.width),u=Math.round(A+(r-s.p7i_)*n.height),a=Math.round(e+(h-s.Q7i_+1)*n.width),g=Math.round(A+(r-s.p7i_+1)*n.height);i.drawImage(o,0,0,t.Ie_(),t.Ts_(),l,u,a-l,g-u);return this}Qss_(){return this.Utt_.Qss_()}Ess_(){return this.Utt_.Ess_()}yss_(){return new xA(this.Utt_.mH_(),this.Utt_.yH_())}Dss_(t){this.Utt_.s7i_(t);return this}Mss_(){return this.Utt_.i7i_()}rvt_(t){if(this.Utt_===t)return this;this.z7i_||(this.z7i_=(t,i,s)=>{this.notify(rh.nC_,this,s)});this.iit_||(this.iit_=(t,i,s)=>{this.td_(s)});if(this.Utt_!=null){this.Utt_.off(rh.nC_,this.z7i_);this.Utt_.off(g8.i8i_,this.iit_)}this.Utt_=t;if(this.Utt_!=null){this.Utt_.on(rh.nC_,this.z7i_);this.Utt_.on(g8.i8i_,this.iit_);const t=this.UU_["url"];t!=null&&this.Utt_.D8i_()==null&&this.Utt_.Q8i_(t)}return this}N_(){let t=super.N_();t=Pi(this.Cvt_().N_(),t);t["formatterfunction"]=this.Utt_.i7i_();return t}dt_(t){if((t=Es(t))==null)return this;super.dt_(t);this.Utt_.dt_(t);return this}vss_(t,i){this.Utt_.dt_({minlod:t,maxlod:i});return this}V$_(){return this.Utt_.V$_()}bss_(t,i){this.Utt_.dt_({tilewidth:t,tileheight:i});return this}pss_(){return this.k8i_().E2i_()}};i=t([_s("geotoolkit.map.layers.Tile")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJyZW5kZXJBc3luYyI6ImFkXyIsInJlbmRlckNvbnRlbnQiOiJ6WV8iLCJnZXRNaW5Mb2QiOiJRc3NfIiwiZ2V0TWF4TG9kIjoiRXNzXyIsImdldFRpbGVSZXNvbHV0aW9uIjoieXNzXyIsInNldEltYWdlRm9ybWF0dGVyIjoiRHNzXyIsImdldEltYWdlRm9ybWF0dGVyIjoiTXNzXyIsImdldFByb3BlcnRpZXMiOiJOXyIsInNldFByb3BlcnRpZXMiOiJkdF8iLCJzZXRMb2RzIjoidnNzXyIsImdldFpvb21MZXZlbCI6IlYkXyIsInNldFRpbGVSZXNvbHV0aW9uIjoiYnNzXyJ9fX0g");var t7=function(){let i=class t extends $9{constructor(t){super(t=qi(t,{source:t&&t["source"]||new j9({loader:new Z9})}))}};i=t([_s("geotoolkit.map.layers.ArcGISTile")],i);return i}();const i7="{quadkey}",s7="{tileId}",e7="{zoom}",A7="{subdomain}",n7="{culture}";var h7=Ci(function(){let i=class t extends o6{constructor(t){super(t);this.N4i_={}}parse(t,i){const s=typeof t=="string"?JSON.parse(t):t;this.N4i_.data=s;if(s["statusCode"]!==200){const t=s["errorDetails"];ki("BingMap server returned error ("+s["statusCode"]+"): "+(Array.isArray(t)&&t.length>0?t.join("\n"):s["statusDescription"]));throw new Error("BingMap server returned error!")}const e=this.Nss_(s),A=e["imageUrl"].replace(n7,this.N4i_.Sss_),n=A.indexOf(A7),h=A.indexOf(i7),r=A.indexOf(s7),o=A.indexOf(e7),l=Math.min.apply(null,[h,r,o,A.length].filter((function(t){return t!==-1}))),u=A.substr(0,l),a=n8.v4i_(A.substr(l),[i7,s7,e7]);this.N4i_.url=n<0?u:e["imageUrlSubdomains"].map((function(t){return u.replace(A7,t)}));typeof e["imageWidth"]=="number"&&(this.N4i_.B7i_=e["imageWidth"]);typeof e["imageHeight"]=="number"&&(this.N4i_.d7i_=e["imageHeight"]);typeof e["zoomMax"]=="number"&&(this.N4i_.w7i_=e["zoomMax"]);typeof e["zoomMin"]=="number"&&(this.N4i_.c7i_=e["zoomMin"]);if(typeof e["tilesX"]=="number"&&typeof e["tilesY"]=="number"){let t=e["tilesX"],i=e["tilesY"];this.N4i_.Gss_=t;this.N4i_.Rss_=i;this.N4i_.kss_={};for(let s=this.N4i_.w7i_;s>=this.N4i_.c7i_;--s){this.N4i_.kss_[s]={E7i_:t-1,m7i_:i-1,scale:1<<s};t=Math.ceil(t/2);i=Math.ceil(i/2)}const s=X3.sx_().l5i_(B3.L2i_),A=s.E2i_(),n=s.transform(this.N4i_.Fss_.x,this.N4i_.Fss_.y),h=A.Ie_()/this.N4i_.kss_[this.N4i_.w7i_].scale,r=A.Ts_()/this.N4i_.kss_[this.N4i_.w7i_].scale,o=e["tilesX"]*h/2,l=e["tilesY"]*r/2,u=new mA(n.x-o,n.y-l,n.x+o,n.y+l);if(this.N4i_.e8i_.B5i_()!==s){const t=undefined;new Z3(s,this.N4i_.e8i_.B5i_()).rn_(u,u)}this.N4i_.FMt_=u}else this.N4i_.FMt_=this.N4i_.e8i_.B5i_().E2i_();this.N4i_.X9i_=(t,i,s)=>{let e="";for(let A=0;A<a.length;++A)switch(a[A]){case i7:e+=this.xss_(t,i,s);break;case s7:e+=this.Lss_(t,i,s);break;case e7:e+=t;break;default:e+=a[A]}return e};this.loaded(i)}a9i_(){let t=this.N4i_.Uss_+"://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.N4i_.Yss_+"?c="+this.N4i_.Sss_+"&uriScheme="+this.N4i_.Uss_;this.N4i_.key!=null&&(t+="&key="+this.N4i_.key);if(this.N4i_.Fss_!=null)t+="&centerPoint="+this.N4i_.Fss_.y+","+this.N4i_.Fss_.x;else if(this.N4i_.Yss_===a3.l2i_||this.N4i_.Yss_===a3.u2i_||this.N4i_.Yss_===a3.a2i_)throw new Error("Bing Maps Birdseye imagery requires centerPoint parameter!");return t}Nss_(t){if(!Array.isArray(t["resourceSets"]))return null;for(let i=0;i<t["resourceSets"].length;++i){const s=t["resourceSets"][i];if(s&&Array.isArray(s["resources"]))for(let t=0;t<s["resources"].length;++t){const i=s["resources"][t];if(i&&i["imageUrl"])return i}}return null}xss_(t,i,s){let e="";for(let A=1<<t-1;A>0;A>>=1){let t=0;(s&A)!=0&&t++;(i&A)!=0&&(t+=2);e+=t}return e}Lss_(t,i,s){const e=undefined;return(this.N4i_.kss_&&this.N4i_.kss_[t]?this.N4i_.kss_[t].E7i_+1:1<<t)*i+s}};i=t([_s("geotoolkit.map.sources.loaders.Bing")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRTZXR0aW5nc1VybCI6ImE5aV8ifX19");var r7=function(){let i=class t extends J6{o7i_(t,i){const s=super.o7i_(t,i);if(this.N4i_.kss_==null)return s;const e=this.N4i_.kss_[s.z],A=this.N4i_.e8i_.B5i_(),n=i.rn_(t),h=i.rn_(this.N4i_.FMt_),r=i.rn_(A.E2i_()),o=h.Ie_()/(e.E7i_+1),l=h.Ts_()/(e.m7i_+1),u=this.N4i_.kss_[this.n7i_]||e,a=r.Ie_()/u.scale,g=r.Ts_()/u.scale,c=function(t,i,s,e){const A=Math.floor((t.we_()-h.we_())/i),n=Math.ceil((t.Qe_()-h.we_())/i)-1,r=Math.floor((t.Ee_()-h.Ee_())/s),o=Math.ceil((t.pe_()-h.Ee_())/s)-1;return{Q7i_:Math.max(A,0),E7i_:Math.min(n,e.E7i_),p7i_:Math.max(r,0),m7i_:Math.min(o,e.m7i_)}};return{z:s.z,u7i_:c(n,o,l,e),y7i_:c(n,a,g,u),f7i_:c(n.Le_(n.Ie_()/10,n.Ts_()/10).intersect(h),o,l,e)}}rpt_(t,i){t==null&&(t=this.n7i_);if(t>=0&&this.N4i_.kss_&&this.N4i_.kss_[this.N4i_.w7i_]){const i=this.N4i_.kss_[this.N4i_.w7i_],s=1<<this.N4i_.w7i_-t;return new xA((i.E7i_+1)/s,(i.m7i_+1)/s)}return super.rpt_(t)}};i=t([_s("geotoolkit.map.sources.managers.Bing")],i);return i}();var o7=Ci(function(){let i=class t extends j9{constructor(t){const i=qi(t,{loader:t&&t["loader"]||new h7,format:t&&t["format"]||new U6,key:null,culture:"en-US",urischeme:"http",centerpoint:null,imageryset:a3.r2i_},!0);super(i);this.N4i_=this.N4i_||{};this.N4i_.Yss_=i["imageryset"];this.N4i_.Sss_=i["culture"];this.N4i_.Uss_=i["urischeme"];this.N4i_.key=i["key"];this.N4i_.Fss_=i["centerpoint"]}B8i_(t){this.u8i_=new r7(t,this.N4i_);this.u8i_.on(g8.i8i_,((t,i,s)=>{this.notify(g8.i8i_,this,s);this.y8i_(!0)}));return this}Tss_(t){if(this.N4i_.Yss_!==t){this.N4i_.Yss_=t;this.clear()}return this}Kss_(){return this.N4i_.Yss_}Hss_(t){this.N4i_.key=t;return this}getKey(){return this.N4i_.key}qss_(t){this.N4i_.Sss_=t;return this}Jss_(){return this.N4i_.Sss_}Pss_(t){this.N4i_.Uss_=t;return this}Vss_(){return this.N4i_.Uss_}e0i_(t){this.N4i_.Fss_=t;return this}Oss_(){return this.N4i_.Fss_}D8i_(){return this.N4i_.url?this.N4i_.url:this.N4i_.Uss_+"://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.N4i_.Yss_}};i=t([_s("geotoolkit.map.sources.Bing")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRJbWFnZXJ5U2V0IjoiVHNzXyIsImdldEltYWdlcnlTZXQiOiJLc3NfIiwic2V0S2V5IjoiSHNzXyIsInNldEN1bHR1cmUiOiJxc3NfIiwiZ2V0Q3VsdHVyZSI6Ikpzc18iLCJzZXRVcmlTY2hlbWUiOiJQc3NfIiwiZ2V0VXJpU2NoZW1lIjoiVnNzXyIsInNldENlbnRlclBvaW50IjoiZTBpXyIsImdldENlbnRlclBvaW50IjoiT3NzXyIsImdldFNlcnZlclVSTCI6IkQ4aV8ifX19");var l7=function(){let i=class t extends $9{constructor(t){const i=qi(t,{source:t&&t["source"]||new o7},!0);i["key"]!=null&&i["source"].Hss_(i["key"]);i["culture"]!=null&&i["source"].qss_(i["culture"]);i["centerpoint"]!=null&&i["source"].e0i_(i["centerpoint"]);i["imageryset"]!=null&&i["source"].Tss_(i["imageryset"]);i["urischeme"]!=null&&i["source"].Pss_(i["urischeme"]);super(i)}pss_(){switch(this.Utt_.Kss_()){case a3.l2i_:case a3.a2i_:case a3.u2i_:return this.rt_();default:return super.pss_()}}};i=t([_s("geotoolkit.map.layers.Bing")],i);return i}();const u7=new lA,a7=function(t,i){if(Array.isArray(i)){for(let s=0;s<i.length;++s)if(t.indexOf(i[s].toUpperCase())>=0)return i[s]}else if(t.indexOf(i)>=0)return i;return null},g7=function(t){return Array.isArray(t)?t.map((t=>t.toUpperCase())):t.toUpperCase()};let c7=",";var I7=Ci(function(){let i=class t extends h8{constructor(){super(...arguments);this.N4i_={}}static Wss_(t){c7=t}parse(t){const i=typeof t=="string"?wq.chi_(t,this.N4i_.zss_||c7):t;if(i.length<2)return this;const s=i[0].map((t=>t.toUpperCase())),e=s.length,A=a7(s,g7(this.N4i_.Xss_)),n=a7(s,g7(this.N4i_.jss_));if(A==null||n==null)return this;const h=[];for(let t=1,r=i[t];t<i.length;r=i[++t]){if(r.length!==e)continue;const t={},o={x:0,y:0};for(let h=0;h<e;++h){t[i[0][h]]=r[h];if(s[h]===A){if(r[h]==null)continue;o.x=Q3.Y2i_(r[h])}else if(s[h]===n){if(r[h]==null)continue;o.y=Q3.Y2i_(r[h])}}this.N4i_.e8i_.B5i_().transform(o.x,o.y,u7);const l=c9.Cts_(t,this.N4i_.Vts_),u=new w4({id:this.N4i_.id.F4i_(t),attributes:t,geometry:{x:u7.x,y:u7.y}});l!=null&&(u.k9i_=l);h.push(u)}this.notify(g8.Z4i_,this,h);return this}};i=t([_s("geotoolkit.map.sources.formats.CSV")],i);return i}(),2,"eyJzZXREZWxpbWl0ZXIiOiJXc3NfIn0g");var f7=Ci(function(){let i=class t extends p8{constructor(t){const i=qi(t,{system:B3.U2i_,format:t&&t["format"]||new I7,delimiter:",",latitudefield:["latitude","lat"],longitudefield:["longitude","lon"]},!0);super(i);this.N4i_=this.N4i_||{};this.N4i_.zss_=i["delimiter"];this.N4i_.Xss_=i["longitudefield"];this.N4i_.jss_=i["latitudefield"]}Zss_(t){(typeof t=="string"||Array.isArray(t))&&(this.N4i_.jss_=t);return this}_ss_(){return this.N4i_.jss_}$ss_(t){(typeof t=="string"||Array.isArray(t))&&(this.N4i_.Xss_=t);return this}tes_(){return this.N4i_.Xss_}Wss_(t){typeof t=="string"&&(this.N4i_.zss_=t);return this}ies_(){return this.N4i_.zss_}};i=t([_s("geotoolkit.map.sources.CSV")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRMYXRpdHVkZUZpZWxkIjoiWnNzXyIsImdldExhdGl0dWRlRmllbGQiOiJfc3NfIiwic2V0TG9uZ2l0dWRlRmllbGQiOiIkc3NfIiwiZ2V0TG9uZ2l0dWRlRmllbGQiOiJ0ZXNfIiwic2V0RGVsaW1pdGVyIjoiV3NzXyIsImdldERlbGltaXRlciI6Imllc18ifX19");var C7=Ci(function(){let i=class t extends S9{constructor(t){const i=qi(t,{source:t&&t["source"]||new f7,system:B3.U2i_,latitudefield:null,longitudefield:null,delimiter:null},!0);super(i);const s=this.Utt_;i["latitudefield"]!=null&&s.Zss_(i["latitudefield"]);i["longitudefield"]!=null&&s.$ss_(i["longitudefield"]);i["delimiter"]!=null&&s.Wss_(i["delimiter"])}N_(){const t=super.N_(),i=this.Utt_;t["latitudefield"]=i._ss_();t["longitudefield"]=i.tes_();t["delimiter"]=i.ies_();return t}dt_(t){if((t=Es(t))==null)return this;const i=this.Utt_;t["latitudefield"]!=null&&i.Zss_(t["latitudefield"]);t["longitudefield"]!=null&&i.$ss_(t["longitudefield"]);t["delimiter"]!=null&&i.Wss_(t["delimiter"]);super.dt_(t);return this}};i=t([_s("geotoolkit.map.layers.CSV")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRQcm9wZXJ0aWVzIjoiTl8iLCJzZXRQcm9wZXJ0aWVzIjoiZHRfIn19fSAg");var d7=function(){let i=class t extends p8{constructor(t){super(t=qi(t,{format:new c8}))}};i=t([_s("geotoolkit.map.sources.GeoJSON")],i);return i}();var B7=function(){let i=class t extends S9{constructor(t){super(t=qi(t,{source:t&&t["source"]||new d7}))}};i=t([_s("geotoolkit.map.layers.GeoJSON")],i);return i}();let w7;var Q7=function(){var i;let s=i=class t{static parse(t){w7=w7||new Mi.DOMParser;const i=w7.parseFromString(t,"text/xml");if(i.nodeName==="parsererror"||i.getElementsByTagName("parsererror").length>0){Gi("Wrong XML received!");return null}return i}static ses_(t,i,s){if(!t)return s?[]:null;const e=i.split(", ");if(!je.Xi_()&&!je.ji_()){const i=undefined,A=e.map((function(t){return":scope > "+t})).join(", ");return s?t.querySelectorAll(A):t.querySelector(A)}const A=t.nodeName==="#document"?t.children:[t],n=[];for(let t=0;t<A.length;++t){const i=A[t].children;for(let t=0;t<i.length;++t)if(e.indexOf(i[t].nodeName)>=0){if(!s)return i[t];n.push(i[t])}}return s?n:null}static YY_(t){const i=t;if(i.children)return i.children;const s=[],e=t.children;for(let t=0;t<e.length;++t)e[t].nodeName!=="#text"&&e[t].nodeName!=="#comment"&&s.push(e[t]);return s}static ees_(t){const s=i.YY_(t);if(s.length===0)return t.textContent;const e={};for(let t=0;t<s.length;++t){const A=s[t].nodeName.toLowerCase(),n=i.ees_(s[t]);if(n==null)continue;const h=e[A];h==null?e[A]=n:Array.isArray(h)?h.push(n):e[A]=[h,n]}return e}};s=i=t([_s("geotoolkit.map.util.XML")],s);return s}();let E7=new lA;const p7={Aes_:["MultiGeometry"],nes_:["MultiPoint"],Curve:["MultiCurve","Curve"],XXt_:["MultiSurface, MultiSolid","Polygon, Solid, Surface, PolyhedralSurface, TriangulatedSurface"],Z3t_:["Point"],f9i_:["LineString"],ZXt_:["Envelope"]},m7=function(t,i,s){let e;for(e=0;e<s.length;++e){const A=undefined;if(s[e].split(",").indexOf(i)>-1)return t}for(e=0;e<s.length;++e){const i=t.querySelector(s[e]);if(i)return i}return null};var y7=function(){var i;let s=i=class t{static parse(t,s,e,A,n){n=n||t;A=A||[];let h,r;const o=t.nodeName.lastIndexOf(":"),l=o===-1?t.nodeName:t.nodeName.substr(o+1);if(h=m7(t,l,p7.Aes_)){let t=h.querySelectorAll("geometryMember");if(t.length===0){const i=h.querySelector("geometryMember");t=i&&i.children||[]}for(r=0;r<t.length;++r)i.parse(t[r],s,e,A,n);return A}let u;const a=[];if(h=m7(t,l,p7.nes_)){const t=Q7.ses_(h,"pointMembers, pointMember",!0);for(r=0;r<t.length;++r){const s=Q7.ses_(t[r],"Point",!0);for(let t=0;t<s.length;++t){u=i.q4i_(s[r],e);u&&a.push(u)}}i.kis_(a,s,n,w4,W4,A)}else if(h=m7(t,l,p7.Curve)){const t=h.querySelectorAll("LineString, LineStringSegment");for(r=0;r<t.length;++r){u=i.hes_(t[r],e);u&&a.push(u)}i.kis_(a,s,n,X4,Z4,A)}else if(h=m7(t,l,p7.XXt_)){const t=h.querySelectorAll("exterior");for(r=0;r<t.length;++r){u=i.P4i_(t[r],e);u&&a.push(u)}i.kis_(a,s,n,$4,i8,A)}else if(h=m7(t,l,p7.Z3t_)){u=i.q4i_(h,e);u&&a.push(u);i.kis_(a,s,n,w4,W4,A)}else if(h=m7(t,l,p7.f9i_)){u=i.hes_(h,e);u&&a.push(u);i.kis_(a,s,n,X4,Z4,A)}else if(h=m7(t,l,p7.ZXt_)){u=i.res_(h,e);u&&a.push(u);i.kis_(a,s,n,$4,i8,A)}return A}static q4i_(t,s){if(!t)return null;const e=Q7.ses_(t,"pos, coordinates",!1);return e&&e.textContent?i.oes_(e.textContent,s):null}static res_(t,s){if(!t)return null;const e=Q7.ses_(t,"lowerCorner, upperCorner",!0);if(e.length===2&&e[0].textContent&&e[1].textContent){const t=i.oes_(e[0].textContent,s),A=i.oes_(e[1].textContent,s);return{x:[t.x,t.x,A.x,A.x],y:[t.y,A.y,A.y,t.y]}}return i.hes_(t,s)}static oes_(t,i){const s=t.trim().split(/,\s*|\s+/);E7.vs_(+s[1]||0,+s[0]||0);i&&(E7=i(E7,E7));return{x:E7.x,y:E7.y}}static hes_(t,i){if(!t)return null;let s,e;const A=[],n=[],h=t.childElementCount>0?Q7.ses_(t,"posList, coordinates",!1):t;if(h&&h.textContent){const t=+h.getAttribute("srsDimension")||2;e=h.textContent.trim().split(/,\s*|\s+/);for(s=0;s<e.length;s+=t){E7.vs_(+e[s+1]||0,+e[s]||0);i&&(E7=i(E7,E7));A.push(E7.x);n.push(E7.y)}}else{const h=t.querySelectorAll("pos, coordinates");for(s=0;s<h.length;++s)if(h[s].textContent){e=h[s].textContent.trim().split(/,\s*|\s+/);E7.vs_(+e[1]||0,+e[0]||0);i&&(E7=i(E7,E7));A.push(E7.x);n.push(E7.y)}}return A.length<=2?null:{x:A,y:n}}static P4i_(t,s){if(!t)return null;const e=i.les_(t,s),A=t.parentNode,n=A&&A.querySelectorAll("interior");if(!n||n.length===0||!e)return e;const h=s4.R5i_(e);e["clip"]=[h];for(let t=0;t<n.length;++t){const A=i.les_(n[t],s);A&&e["clip"].push(A)}return e}static les_(t,s){const e=Q7.ses_(t,"LinearRing",!1)||t.querySelector("LineString, LineStringSegment");return i.hes_(e,s)}static kis_(t,i,s,e,A,n){if(t.length===0)return;const h=Q7.ees_(s);t.length===1?n.push(new e({id:i.F4i_(h),attributes:h,geometry:t[0]})):n.push(new A({id:i.F4i_(h),attributes:h,geometry:t}))}};s=i=t([_s("geotoolkit.map.util.GML")],s);return s}();const D7={point:w4,line:X4,polygon:$4};let M7=new lA;var v7=function(){var i;let s=i=class t{static parse(t,s,e){const A=[];i.ues_(t.querySelectorAll("entry"),s,e,A);i.ues_(t.querySelectorAll("channel > item"),s,e,A);const n=Q7.ses_(t,"entry, channel",!0),h=n.length>0&&n[0].parentElement||t;for(let t=0;t<n.length;++t)h.removeChild(n[t]);i.JCi_(h,s,e,A);return A}static ues_(t,s,e,A){for(let n=0;n<t.length;++n)i.JCi_(t[n],s,e,A);return A}static JCi_(t,s,e,A){const n=i.aes_(t,s,e)||i.ges_(t,s,e);n?A.push(n):y7.parse(t,s,e,A)}static aes_(t,s,e){const A=Object.keys(D7);for(let n=0;n<A.length;++n){const h=Q7.ses_(t,A[n],!1);if(h&&h.textContent){const r=Q7.ees_(t),o=undefined;return new(0,D7[A[n]])({id:s.F4i_(r),attributes:r,geometry:i.gts_(h.textContent,e)})}}const n=Q7.ses_(t,"box",!1);if(n&&n.textContent){const A=i.gts_(n.textContent,e);if(A.x.length!==2)return null;const h=Q7.ees_(t);return new $4({id:s.F4i_(h),attributes:h,geometry:{x:[A.x[0],A.x[0],A.x[1],A.x[1]],y:[A.y[0],A.y[1],A.y[1],A.y[0]]}})}return null}static gts_(t,i){const s=t.trim().split(/,\s*|\s+/),e=[],A=[];for(let t=0;t<s.length;t+=2){M7.vs_(+s[t+1]||0,+s[t]||0);i&&(M7=i(M7,M7));e.push(M7.x);A.push(M7.y)}return e.length>1?{x:e,y:A}:{x:e[0]||0,y:A[0]||0}}static ges_(t,i,s){let e,A,n,h;const r=t.querySelector("based_near");if(r){e=r.attributes;for(let t=0;t<e.length;++t){const i=e[t].name,s=i.substr(i.lastIndexOf(":")+1).toLowerCase();s==="lat"?n=e[t].value:s==="long"&&(h=e[t].value)}t=r.parentElement||t}else if((A=t.querySelector("lat_long"))&&A.textContent){const t=A.textContent.trim().split(/,\s*|\s+/);h=t[1];n=t[0]}else{const i=t.querySelector("lat");n=i&&i.textContent;const s=t.querySelector("long");h=s&&s.textContent}if(n!=null&&h!=null){const e=Q7.ees_(t);M7.vs_(+h||0,+n||0);s&&(M7=s(M7,M7));return new w4({id:i.F4i_(e),attributes:e,geometry:{x:M7.x,y:M7.y}})}return null}};s=i=t([_s("geotoolkit.map.util.GeoRSS")],s);return s}();var b7=function(){let i=class t extends h8{parse(t){let i;if(typeof t=="string"){i=Q7.parse(t);if(i==null)return this}else i=t;const s=this.N4i_.e8i_,e=v7.parse(i,this.N4i_.id,s.transform.bind(s));this.notify(g8.Z4i_,this,e);return this}};i=t([_s("geotoolkit.map.sources.formats.GeoRSS")],i);return i}();var N7=function(){let i=class t extends p8{constructor(t){super(t=qi(t,{format:new b7}))}};i=t([_s("geotoolkit.map.sources.GeoRSS")],i);return i}();var S7=function(){let i=class t extends S9{constructor(t){super(t=qi(t,{system:B3.U2i_,source:t&&t["source"]||new N7}))}};i=t([_s("geotoolkit.map.layers.GeoRSS")],i);return i}();const G7=new lA,R7=new mA,k7=new Gn,F7=10,x7=10;var L7=function(){let i=class t extends K9{constructor(t,i){super(t,i);this.IH_=new Tc;this.V8i_=null;this.xs_={scale:null,rect:null}}query(t,i){const s=this.N4i_.node?this.N4i_.node.getBounds():null,e=this.N4i_.FMt_;if(s==null||s.isEmpty()||e==null)return!1;const A=t.clone().Le_(this.N4i_.Le_*t.Ie_(),this.N4i_.Le_*t.Ts_()).intersect(e),n=i.if_();if(A.isEmpty()||this.xs_.rect!=null&&this.xs_.rect.Fe_(A)&&NA.equals(this.xs_.scale,n.BI_()))return!1;this.xs_.rect=A;this.xs_.scale=n.BI_();this.V8i_!=null&&clearTimeout(this.V8i_);this.V8i_=setTimeout((()=>{this.V8i_=null;let t,i=1/0,h=-1/0,r=1/0,o=-1/0;const l=[],u=[];this.ces_(A,e,((s,e)=>{t=this.hI_(s,e);if(!isNaN(t.getX())&&!isNaN(t.getY())){i=Math.min(i,t.getX());h=Math.max(h,t.getX());r=Math.min(r,t.getY());o=Math.max(o,t.getY());l.push((s-A.getX())/A.Ie_());u.push((e-A.getY())/A.Ts_())}}));i=Math.max(Math.floor(i),s.we_());h=Math.min(Math.ceil(h),s.Qe_());r=Math.max(Math.floor(r),s.Ee_());o=Math.min(Math.ceil(o),s.pe_());const a=n.sI_()>0?new mA(i,r,h,o):new mA(i,s.pe_()-o,h,s.pe_()-r),g=n.rn_(e);let c=Math.ceil(a.Ie_()*g.Ie_()/s.Ie_()),I=Math.ceil(a.Ts_()*g.Ts_()/s.Ts_());a.de_(c*s.Ie_()/g.Ie_()).Be_(I*s.Ts_()/g.Ts_());const f=new mA(0,0,c,I),C=new Oc(0,0,c,I),d=this.IH_.uK_(C,c,I,!1);if(!d){ki("geotoolkit.map.layers.Projection: Memory limit is too low. Use .getResourceManager().setMemoryLimit() to fix it");return}d.clear();Gn.xI_(a,f,!1,!1,!1,k7);const B=d.tQ_(k7)._R_(f);this.N4i_.node.render(B);d.gM_();const w=[],Q=[],E=this.rn_(R7.ce_(i,r,h,o)),p=n.rn_(E,R7);c=Math.ceil(p.Ie_());I=Math.ceil(p.Ts_());for(let t=0;t<l.length;t++){const i=l[t],e=u[t],A=this.nI_(a.getX()+i*a.Ie_(),s.Ts_()-(a.getY()+e*a.Ts_()));w.push((A.getX()-E.getX())*c/E.Ie_());Q.push((A.getY()-E.getY())*I/E.Ts_())}const m=rP.lsi_(d.getCanvas(),{width:c,height:I,source:{x:w,y:Q},destination:{x:l,y:u}});this.IH_.release(d);this.notify(g8.PV_,this,{image:m,bounds:E})}),this.N4i_.timeout);return!0}K8i_(){return this}XT_(){return this.IH_}nI_(t,i){return this.N4i_.e8i_.transformPoint(this.N4i_.Ies_.nI_(t,i),G7)}hI_(t,i){G7.vs_(t,i);this.N4i_.l8i_.transformPoint(G7,G7);this.N4i_.Ies_.aI_(G7,G7);return G7}rn_(t){let i=1/0,s=-1/0,e=1/0,A=-1/0;this.ces_(t,this.N4i_.node.getBounds(),((n,h)=>{if(n!==t.getX()&&n!==t.Qe_()&&h!==t.Ee_()&&h!==t.pe_())return;const r=this.nI_(n,h);if(!isNaN(r.getX())&&!isNaN(r.getY())){i=Math.min(i,r.getX());e=Math.min(e,r.getY());s=Math.max(s,r.getX());A=Math.max(A,r.getY())}}));return new mA(i,e,s,A)}ces_(t,i,s){const e=2<<Math.log2(F7*i.Ie_()/t.Ie_()),A=2<<Math.log2(x7*i.Ts_()/t.Ts_()),n=i.Ie_()/e,h=i.Ts_()/A,r=Math.floor((t.getX()-i.getX())/n),o=Math.ceil((t.Qe_()-i.getX())/n),l=Math.floor((t.getY()-i.getY())/h),u=Math.ceil((t.pe_()-i.getY())/h);for(let e=r;e<=o;e++){const A=NA.clamp(i.getX()+e*n,t.getX(),t.Qe_());for(let e=l;e<=u;e++){const n=NA.clamp(i.getY()+e*h,t.getY(),t.pe_());s.call(this,A,n)}}}clear(){this.xs_={scale:null,rect:null};return super.clear()}};i=t([_s("geotoolkit.map.sources.managers.Projection")],i);return i}();var U7=Ci(function(){let i=class t extends H9{constructor(t){super(t=qi(t,{loader:null,projection:Gn.JI_,node:null}));this.N4i_=this.N4i_||{};this.N4i_.Ies_=t["projection"];this.fes_=this.Ces_.bind(this);this.des_(t["node"])}B8i_(t){this.u8i_=new L7(t,this.N4i_);this.u8i_.on(g8.PV_,((t,i,s)=>{this.notify(g8.PV_,this,s);this.y8i_(!0)}));return this}des_(t){if(this.N4i_.node===t)return this;this.N4i_.node!=null&&this.N4i_.node.off(rh.sC_,this.fes_);this.N4i_.node=t;this.N4i_.node!=null&&this.N4i_.node.on(rh.sC_,this.fes_);this.Ces_();return this}Bes_(){return this.N4i_.node}XT_(){return this.u8i_.XT_()}dispose(){this.T8i_();this.des_(null);super.dispose()}Ces_(){const t=this.N4i_.node?this.N4i_.node.getBounds():null;if(t==null||t.isEmpty()){this.N4i_.bounds=null;this.N4i_.FMt_=null}else if(!t.Ce_(this.N4i_.bounds)){this.N4i_.bounds=t;this.N4i_.FMt_=this.u8i_.rn_(t)}this.update()}};i=t([_s("geotoolkit.map.sources.Projection")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRDb250ZW50Tm9kZSI6ImRlc18iLCJnZXRDb250ZW50Tm9kZSI6IkJlc18iLCJnZXRSZXNvdXJjZU1hbmFnZXIiOiJYVF8ifX19");var Y7=function(){let i=class t extends L7{constructor(t,i){super(null,i);this.wes_=t}Qes_(t){this.wes_.query(t);return this}ix_(){return this.wes_}};i=t([_s("geotoolkit.map.sources.managers.GeoTile")],i);return i}();var T7=Ci(function(){var i;let s=i=class t extends U7{constructor(t){if(t==null||t["loader"]==null||t["format"]==null)throw new Error("GeoTile source needs GeoTile loader and GeoTile format");super(t);this.N4i_.Ees_=t["tiledshape"];this.r8i_=this.r8i_||(()=>{this.notify(g8.s8i_,this,{epsg:this.N4i_.pes_});this.N4i_.Ies_=Gn.UI_(this.N4i_.mes_.Me_(),this.N4i_.mes_.Ne_(),this.N4i_.mes_.ve_(),this.N4i_.yes_[0],this.N4i_.yes_[1],this.N4i_.yes_[2]);const t=qi(this.N4i_.Ees_,{modelarea:this.N4i_.mes_.clone(),formatter:t=>t,imageloader:(t,i)=>{const s=t;s["callback"]=i;this.u8i_.Qes_(s)},loadertype:Mp.w7_});if(typeof t["loadertype"]=="number"){ki("loadertype as number is deprecated since 4.0, use LoaderType type instead");t["loadertype"]=vp[t["loadertype"]]}const i=new om(t),s=(new sI).GY_([i]).Lq_(this.N4i_.mes_.clone()).ht_(this.N4i_.mes_.clone());this.des_(s)})}B8i_(t){this.u8i_=new Y7(t,this.N4i_);this.u8i_.on(g8.PV_,((t,i,s)=>{this.notify(g8.PV_,this,s);this.y8i_(!0)}));return this}clone(){const t=new i({loader:this.a8i_.clone(),format:this.u8i_.ix_().clone()});return Wi(this,t)}b_(t,i){this.N4i_=i===!0?Pi(t.N4i_,this.N4i_):qi(t.N4i_,this.N4i_);return this}};s=i=t([_s("geotoolkit.map.sources.GeoTile")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJjb3B5Q29uc3RydWN0b3IiOiJiXyJ9fX0g");var K7=Ci(function(){let i=class t extends h6{constructor(t){super(t=qi(t,{source:t==null||t["source"]==null?new U7(t):t["source"]}));this.oJ_=null;this.SDt_=null}des_(t){this.Utt_.des_(t);return this}Bes_(){return this.Utt_.Bes_()}XT_(){return this.Utt_.XT_()}rvt_(t){if(this.Utt_===t)return this;this.Bss_||(this.Bss_=(t,i,s)=>{this.SDt_=this.SDt_||fr.zw_();this.oJ_=this.oJ_||new df({image:this.SDt_.getCanvas()});this.oJ_.ht_(s["bounds"]);this.SDt_.setSize(s["image"].width,s["image"].height);this.SDt_.drawImage(s["image"],0,0);this.td_()});if(this.Utt_!=null){this.Utt_.off(g8.PV_,this.Bss_);this.Utt_.off(g8.t8i_,this.Bss_)}this.Utt_=t;if(this.Utt_!=null){this.Utt_.on(g8.PV_,this.Bss_);this.Utt_.on(g8.t8i_,this.Bss_)}return this}render(t){if(!this.$C_()||this.z6i_!=null&&!this.z6i_.filter(this,t))return;if(t.tk_()){if(this.OC_()){t.iQ_(wr.EQ_);t.pR_(this.rt_())}return}const i=this.ot_(!0);this.Utt_.query(i,this);this.zY_(t)}zY_(t){this.oJ_!=null&&this.oJ_.render(t)}};i=t([_s("geotoolkit.map.layers.Projection")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRDb250ZW50Tm9kZSI6ImRlc18iLCJnZXRDb250ZW50Tm9kZSI6IkJlc18iLCJnZXRSZXNvdXJjZU1hbmFnZXIiOiJYVF8iLCJyZW5kZXJDb250ZW50IjoiellfIn19fSAg");var H7=function(){var i;let s=i=class t extends K7{constructor(t){t["source"]=t["source"]||new T7(t);super(t);this.Utt_.on(g8.s8i_,((t,i,s)=>{let e;e=ys(s["epsg"],g3)?s["epsg"]:typeof s["epsg"]!="number"||isNaN(+s["epsg"])?new W3(s["epsg"]):X3.sx_().l5i_(s["epsg"]);this.G8i_(e);this.td_()}))}clone(){const t=new i({source:this.Utt_.clone()});return Wi(this,t)}};s=i=t([_s("geotoolkit.map.layers.GeoTile")],s);return s}();let q7=new lA;var J7=function(){var i;let s=i=class t{static parse(t,s,e){s||(s=new o8("name"));const A=[],n=t.querySelectorAll("wpt, rte, trk");for(let t=0;t<n.length;t++){const h=n[t],r=Q7.ees_(h),o=s.F4i_(r);switch(h.tagName){case"wpt":A.push(new w4({id:o,attributes:r,geometry:i.q4i_(h,e).N_()}));break;case"rte":A.push(new X4({id:o,attributes:r,geometry:i.J4i_(h,e,"rtept")}));break;case"trk":const t=h.querySelectorAll("trkseg"),s=[];for(let A=0;A<t.length;A++)s.push(i.J4i_(t[A],e,"trkpt"));A.push(new Z4({id:o,attributes:r,geometry:s}))}}return A}static q4i_(t,i){const s=+t.getAttribute("lon"),e=+t.getAttribute("lat");q7.vs_(s,e);i&&(q7=i(q7,q7));return q7}static J4i_(t,s,e){const A=t.querySelectorAll(e),n=[],h=[];for(let t=0;t<A.length;t++){const e=i.q4i_(A[t],s);n.push(e.getX());h.push(e.getY())}return{x:n,y:h}}};s=i=t([_s("geotoolkit.map.util.GPX")],s);return s}();var P7=function(){let i=class t extends h8{parse(t){let i;if(typeof t=="string"){i=Q7.parse(t);if(i==null)return this}else i=t;const s=this.N4i_.e8i_,e=s.B5i_()instanceof Q3?null:s.transform.bind(s),A=J7.parse(i,this.N4i_.id,e);this.notify(g8.Z4i_,this,A);return this}};i=t([_s("geotoolkit.map.sources.formats.GPX")],i);return i}();var V7=function(){let i=class t extends p8{constructor(t){super(t=qi(t,{format:new P7}))}};i=t([_s("geotoolkit.map.sources.GPX")],i);return i}();var O7=function(){let i=class t extends S9{constructor(t){super(t=qi(t,{system:B3.U2i_,source:t&&t["source"]||new V7}))}};i=t([_s("geotoolkit.map.layers.GPX")],i);return i}();var W7=Ci({Dt_:"Linear",Des_:"Quad",Mes_:"Cubic",Exp:"Exp"},2,"eyJMaW5lYXIiOiJEdF8iLCJRdWFkIjoiRGVzXyIsIkN1YmljIjoiTWVzXyJ9");const z7=800,X7=100,j7=new xA,Z7=new mA;var _7=Ci(function(){let i=class t extends _6{constructor(t){super(t=qi(t,{source:new p8,weight:null,radius:10,maxintensity:0,colorprovider:new bo({scale:po.HSV}),mode:W7.Exp},!0));this.qis_=null;this.Qis_=!1;this.Nft_=0;this.ves_={};this.yis_=null;this.HGt_=[];this.bes_=t["maxintensity"];this.Nes_=t["weight"];this.d4_=t["mode"];this.Cm_=t["colorprovider"];this.Xz_=t["radius"];this.SDt_=fr.zw_({width:1,height:1,contextattributes:{willReadFrequently:!0}});this.Ses_(this.Xz_,this.d4_);this.gk_(new zQ)}setRadius(t){if(this.Xz_===t)return this;this.Ses_(t,this.d4_);this.Xz_=t;this.td_();return this}xVt_(){return this.Xz_}Ges_(t){if(this.bes_===t)return this;this.bes_=t;this.td_();return this}Res_(){return this.bes_||this.kes_()}TZt_(t){if(this.d4_===t)return this;this.Ses_(this.Xz_,t);this.d4_=t;this.td_();return this}KZt_(){return this.d4_}UBt_(t){if(this.Cm_===t)return this;this.Cm_=t;this.td_();return this}Swt_(){return this.Cm_}Fes_(t){if(this.Nes_===t)return this;this.Nes_=t;this.td_();return this}xes_(){return this.Nes_}zY_(t){this.Lis_(t);this.J7i_(this.yis_,t);this.Uis_(t)}Lis_(t){const i=undefined,s=t.Ji_().BI_(),e=!NA.equals(this.qis_,s);if(this.yis_==null||this.Qis_||this.Jis_()&&e){this.Utt_.$8i_(this.ot_(),this);this.qis_=s;this.Qis_=!1;let i=this.F3i_();this.ves_={};const e=this.UU_["features"]["filter"];e&&(i=this.V7i_(i,e,t));this.yis_=i.toArray();typeof this.Xz_=="function"&&this.Ses_(Math.round(this.Xz_()),this.d4_)}}J7i_(t,i){const s=i.Ji_();s.cI_(j7.setSize(1,1),j7);const e=i.FR_(),A=e.we_(),n=e.Ee_(),h=e.Ie_(),r=e.Ts_(),o=this.Nes_,l=typeof o=="function",u=this.HGt_,a=Math.floor(u.length/2),g=Z7.ce_(i.rS_()).Le_(a*j7.Ie_(),a*j7.Ts_()),c={},I=[];t.forEach((t=>{if(t.N5i_()||t.S5i_())return;const e=t.y5i_();if(!g.contains(e.x,e.y))return;if(i.tk_()){I.push(t);return}const f=s.nI_(e.x,e.y),C=Math.round(f.getX()*i.VR_()-A),d=Math.round(f.getY()*i.VR_()-n),B=l?o(t):+t.Uui_()[o]||1,w=Math.min(2*a,h+a-C),Q=Math.min(2*a,r+a-d);for(let t=Math.max(a-d,0);t<Q;t++){let i=Math.max(a-C,0),s=4*(i+C-a+(t+d-a)*h);for(;i<w;i++,s+=4){const e=B*u[i][t];e&&(c[s]?c[s]+=e:c[s]=e)}}}));if(i.tk_()&&I.length>0){i.mO_(this);i.mO_(new jf(this,I))}this.ves_=c}Uis_(t){if(t.tk_())return;const i=t.FR_(),s=this.SDt_.setSize(i.Ie_(),i.Ts_()),e=s.eQ_(0,0,i.Ie_(),i.Ts_()),A=e.getImageData(),n=typeof this.bes_=="function"?this.bes_():this.bes_||this.kes_();for(const t in this.ves_){const i=this.Cm_.getColor(this.ves_[t]/n),s=+t;A.data[s]=i.Is_();A.data[s+1]=i.Cs_();A.data[s+2]=i.fs_();A.data[s+3]=i.ds_()*this.i9i_}s.km_(e,0,0);t.aS_({RK_:!0});t.drawImage(s,i.getX(),i.getY());t.cS_()}Jis_(){return!this.h9i_()}td_(t,i){this.Qis_=!0;return super.td_(t,i)}kes_(){if(this.Nft_!==0)return this.Nft_;let t=1/0,i=-1/0,s=1/0,e=-1/0;const A=this.Qis_||this.yis_==null?this.F3i_():this.yis_;A.forEach((function(A){if(A.N5i_()||A.S5i_())return;const n=A.y5i_();t=Math.min(t,n.x);i=Math.max(i,n.x);s=Math.min(s,n.y);e=Math.max(e,n.y)}));const n=this.Nes_,h=typeof n=="function",r=i>t?z7/(i-t):1,o=e>s?z7/(e-s):1;let l=0;const u={};A.forEach((function(i){if(i.N5i_()||i.S5i_())return;const e=i.y5i_(),A=Math.floor((e.x-t)*r),a=undefined,g=Math.floor((e.y-s)*o)*z7+A;u[g]=u[g]||0;u[g]+=h?n(i):+i.Uui_()[n]||1;l=Math.max(l,u[g])}));this.Nft_=l;return l}c6i_(t,i,s){this.Nft_=0;super.c6i_(t,i,s);t!==g8.Z4i_&&t!==g8._4i_||this.td_()}Ses_(t,i){if(typeof t=="function")return;t>X7&&(t=X7);this.HGt_=[];let s=0;const e=t*t;let A;for(let n=-t;n<=t;n++){const h=[];for(let r=-t;r<=t;r++){const o=n*n+r*r;if(o>e)A=0;else if(i===W7.Dt_)A=1-Math.sqrt(o)/t;else if(i===W7.Des_)A=1-o/e;else if(i===W7.Mes_){s=s||e*t;A=1-Math.pow(o,1.5)/s}else{s=s||-e/4.5;A=Math.exp(o/s)}h.push(A)}this.HGt_.push(h)}}l3i_(t){return null}dt_(t){if((t=Es(t))==null)return this;super.dt_(t);t["weight"]!==void 0&&this.Fes_(t["weight"]);t["radius"]!==void 0&&this.setRadius(t["radius"]);t["maxintensity"]!==void 0&&this.Ges_(t["maxintensity"]);t["colorprovider"]!==void 0&&this.UBt_(t["colorprovider"]);t["mode"]!==void 0&&this.TZt_(t["mode"]);return this}N_(){const t=super.N_();t["weight"]=this.xes_();t["radius"]=this.xVt_();t["maxintensity"]=this.bes_;t["colorprovider"]=this.Swt_();t["mode"]=this.KZt_();return t}};i=t([_s("geotoolkit.map.layers.Heatmap")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRSYWRpdXMiOiJ4VnRfIiwic2V0TWF4SW50ZW5zaXR5IjoiR2VzXyIsImdldE1heEludGVuc2l0eSI6IlJlc18iLCJzZXRNb2RlIjoiVFp0XyIsImdldE1vZGUiOiJLWnRfIiwic2V0Q29sb3JQcm92aWRlciI6IlVCdF8iLCJnZXRDb2xvclByb3ZpZGVyIjoiU3d0XyIsInNldFdlaWdodEZpZWxkIjoiRmVzXyIsImdldFdlaWdodEZpZWxkIjoieGVzXyIsInJlbmRlckNvbnRlbnQiOiJ6WV8iLCJyZW5kZXJGZWF0dXJlcyI6Iko3aV8iLCJpbnZhbGlkYXRlIjoidGRfIiwiZ2V0R2VvbWV0cnlUb1RleHQiOiJsM2lfIiwic2V0UHJvcGVydGllcyI6ImR0XyIsImdldFByb3BlcnRpZXMiOiJOXyJ9fX0g");let $7=new lA;const ttt={Point:[w4,W4],LineString:[X4,Z4],"LinearRing, Polygon":[$4,i8]},itt=function(t,i,s){t.on(ff.PV_,(function(){if(i!=null&&i!==1){const s=t.fM_();t.setSize(i*s.width,i*s.height)}s!=null&&s()}));return t};var stt=Ci(function(){var i;let s=i=class t{static parse(t,s,e,A,n,h){let r;h=h||[];switch(t.nodeName){case"Document":case"#document":const o=Q7.ses_(t,"Style, StyleMap",!0);n=i.F9i_(o,n,A);case"kml":case"Folder":const l=Q7.ses_(t,"Document, kml, Folder, Placemark",!0);for(let t=0;t<l.length;++t)i.parse(l[t],s,e,A,n,h);return h;case"Placemark":r=i.Les_(t,s,e);if(r.length===0)return h;break;default:return h}const o=i.Ues_(t,"styleUrl");for(let t=0;t<r.length;++t){o&&n&&n[o]&&n[o][r[t].D_()]&&(r[t].k9i_=n[o][r[t].D_()]);h.push(r[t])}return h}static F9i_(t,s,e){if(t.length===0)return s;s=Pi(s,{});for(let A=0;A<t.length;++A){let n,h,r=t[A];const o=r.getAttribute("id")||"";if(r.tagName==="StyleMap"){const t=r.querySelectorAll("Pair");let e=!1;for(let A=0;A<t.length;++A)if(i.Ues_(t[A],"key")==="normal"){let n;if(n=i.Ues_(t[A],"styleUrl"))s["#"+o]=s[n];else{r=i.Yes_(t[A],"Style");e=!0}break}if(!e)continue}let l=null,u=null,a=null,g=null,c=null;const I=r.querySelectorAll("IconStyle, LineStyle, PolyStyle");for(let t=0;t<I.length;++t){const s=I[t];let e;switch(s.tagName){case"IconStyle":g=i.Yes_(s,"Icon");a=i.Ues_(g,"href");c=+i.Ues_(s,"scale");break;case"LineStyle":e=i.Ues_(s,"color");l=new hl({color:i.cs_(e)||"black",width:i.Ues_(s,"width")||1});break;case"PolyStyle":e=i.Ues_(s,"color");u=new wr({color:i.cs_(e)});break;default:}}if(a!=null){n=new A6({shape:itt(new df({url:a,alignment:dA.ne_,sizeisindevicespace:!0,ispointingup:!0,linestyle:null}),c,e)});h={};h[w4.D_()]=n;h[W4.D_()]=n}else{if(l==null)continue;n=new e6({shape:new ap({linestyle:l})});h={};h[X4.D_()]=n;h[Z4.D_()]=n;if(u!=null){n=new n6({shape:new oE({linestyle:l,fillstyle:u})});h[$4.D_()]=n;h[i8.D_()]=n}}s["#"+o]=h}return s}static Yes_(t,i){return Q7.ses_(t,i,!1)}static Ues_(t,s){const e=i.Yes_(t,s);return e?e.textContent:null}static cs_(t){if(t==null)return null;const i=(parseInt(t.substr(0,2),16)/256).toFixed(2),s=parseInt(t.substr(2,2),16),e=parseInt(t.substr(4,2),16),A=undefined;return"rgba("+parseInt(t.substr(6,2),16)+","+e+","+s+","+i+")"}static Les_(t,s,e){if(t==null)return null;const A=s instanceof o8?s.L4i_():"name",n=i.Ues_(t,A),h=Q7.ees_(t),r=i.Yes_(t,"MultiGeometry")||t,o=[];for(const t in ttt)if(ttt.hasOwnProperty(t)){const s=Q7.ses_(r,t,!0),A=[];for(let t=0;t<s.length;++t)A.push(i.gts_(s[t],e));if(A.length===0)continue;o.push(new(ttt[t][Math.sign(A.length-1)])({id:n,attributes:h,geometry:A.length===1?A[0]:A}))}return o}static gts_(t,s){switch(t.nodeName){case"Point":return i.q4i_(t,s);case"LineString":case"LinearRing":return i.J4i_(t,s);case"Polygon":const e=i.Yes_(t,"outerBoundaryIs"),A=t.getElementsByTagName("innerBoundaryIs"),n=i.J4i_(i.Yes_(e,"LinearRing"),s);if(A.length>0){const t=s4.R5i_(n);n["clip"]=[t];for(let t=0;t<A.length;++t){const e=i.Yes_(A[t],"LinearRing");n["clip"].push(i.J4i_(e,s))}}return n}return null}static q4i_(t,s){if(t==null)return null;const e=i.Ues_(t,"coordinates"),A=e?e.split(","):[NaN,NaN];$7.vs_(+A[0],+A[1]);s&&($7=s($7,$7));return{x:$7.getX(),y:$7.getY()}}static J4i_(t,s){const e=t&&i.Ues_(t,"coordinates");if(e==null)return null;const A=e.split(" "),n=[],h=[];for(let t=0;t<A.length;++t){const i=A[t].split(",");if(!(i.length<2)){$7.vs_(+i[0],+i[1]);s&&($7=s($7,$7));n.push($7.getX());h.push($7.getY())}}return{x:n,y:h}}};s=i=t([_s("geotoolkit.map.util.KML")],s);return s}(),2,"eyJnZXRDbGFzc05hbWUiOiJEXyJ9");var ett=function(){let i=class t extends h8{parse(t){let i;if(typeof t=="string"){i=Q7.parse(t);if(i==null)return this}else i=t;const s=this.N4i_.e8i_,e=()=>{this.notify(g8.Z4i_,this,null)},A=stt.parse(i,this.N4i_.id,s.transform.bind(s),e);this.notify(g8.Z4i_,this,A);return this}};i=t([_s("geotoolkit.map.sources.formats.KML")],i);return i}();var Att=function(){let i=class t extends p8{constructor(t){super(t=qi(t,{format:new ett}))}};i=t([_s("geotoolkit.map.sources.KML")],i);return i}();var ntt=function(){let i=class t extends S9{constructor(t){super(t=qi(t,{source:t&&t["source"]||new Att}))}};i=t([_s("geotoolkit.map.layers.KML")],i);return i}();var htt=Ci(function(){let i=class t{v6i_(t,i,s){return new ou(t,(function(t){const i=s.U6i_(t);return i!=null&&i.g3i_()!=null}))}reset(){return this}};i=t([Zs(S8),_s("geotoolkit.map.layers.MapboxAnnotation")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJmaWx0ZXJGZWF0dXJlcyI6InY2aV8ifX19");const rtt=new lA;var ott=Ci(function(){let i=class t extends h6{constructor(t){super(t);this.z9_=new gm({clipchild:!1});this.xM_=(t,i,s)=>{this.td_(s.getBounds(),s.Sf_())};this.z9_.jC_(this);this.z9_.on(rh.sC_,this.xM_);this.z9_.Lq_(this.Z6i_.E2i_());this.z9_.ht_(this.z9_.rt_());this.gk_(new zQ)}$6i_(){return this.z9_.rt_()}R8i_(t){super.R8i_(t);if(t=this.k8i_()){this.z9_.Lq_(t.E2i_());this.z9_.ht_(this.z9_.rt_())}return this}ovi_(t){return this.z9_.YY_(t)}addShape(t){if(t==null)return this;Au.IN_(t).forEach((t=>{this.z9_.GY_(t);this.z9_.qit_(t,!0)}));if(!this.WH_){this._6i_=this.$6i_();this.notify(rh.nC_,this,this._6i_)}this.td_();return this}Tes_(t,i){if(t==null)return this;let s=!1,e;if(t instanceof iu)e=[t];else if(Array.isArray(t))e=t;else{if(!(t instanceof Au))throw new Error("Wrong parameter type");e=Au.toArray(t)}let A=this.z9_.qY_();e.forEach((t=>{this.z9_.removeChild(t);this.z9_.qit_(t,!1);if(A!==this.z9_.qY_()){this.notify(rh.AC_,this,t);i&&typeof t.dispose=="function"&&t.dispose();s=!0;A--}}));if(s){if(!this.WH_){this._6i_=this.$6i_();this.notify(rh.nC_,this,this._6i_)}this.td_()}return this}Kes_(t){const i=this.z9_.YY_();this.z9_.KY_(t);this.notify(rh.AC_,this,i);if(!this.WH_){this._6i_=this.$6i_();this.notify(rh.nC_,this,this._6i_)}return this}zY_(t){const i=t.OR_();t.tN_(this.i9i_);if(t.tk_()){const i=[];t.pO_(this.z9_,(t=>{t.getParent()===this.z9_&&t instanceof iu&&i.indexOf(t)<0&&i.push(t)}));if(i.length>0){t.mO_(this);t.mO_(new jf(this,i))}}else this.z9_.render(t);t.tN_(i)}OY_(t,i){const s=t.OR_();t.tN_(this.i9i_);this.z9_.ad_(t,(function(){t.tN_(s);i()}))}rvt_(t){return this}$X_(t,i){const s=this.k8i_();if(!s)return[];const e=this.if_();t=e.aI_(t,rtt);const A=s.E2i_();t.getX()<A.getX()?t.x+=A.Ie_():t.getX()>A.Qe_()&&(t.x-=A.Ie_());const n=this.rt_(),h=this.z9_.qY_();if(!h||!n||!n.contains(t))return[];i=(i||2)/e.BI_();const r=new mA(t.x-i,t.y-i,t.x+i,t.y+i),o=[];for(let t=0;t<h;++t){const i=this.z9_.HY_(t);if(!i.$C_())continue;const s=i,e=s.getBounds&&s.getBounds();su.gN_(e,i.ut_(),r)&&o.push(i)}return o}vn_(t,i){super.vn_(t,i);this.z9_.vn_(t,i);return this}dispose(){if(!this.Df_()){this.z9_.off(rh.sC_,this.xM_);this.z9_.dispose();super.dispose()}}};i=t([_s("geotoolkit.map.layers.Shape")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJjYWxjdWxhdGVEZWZhdWx0TW9kZWxMaW1pdHMiOiIkNmlfIiwic2V0TWFwQ29vcmRpbmF0ZVN5c3RlbSI6IlI4aV8iLCJnZXRTaGFwZXMiOiJvdmlfIiwicmVtb3ZlU2hhcGUiOiJUZXNfIiwiY2xlYXJTaGFwZXMiOiJLZXNfIiwicmVuZGVyQ29udGVudCI6InpZXyIsInJlbmRlckNvbnRlbnRBc3luYyI6Ik9ZXyIsImhpdFRlc3QiOiIkWF8iLCJ1cGRhdGVTdGF0ZSI6InZuXyJ9fX0g");const ltt="Abort from client";var utt=Ci(function(){let i=class t extends q4{send(t,i,s){if(!t){s(new Error(this.D_()+": No url provided"));return}const e=new Mi.WebSocket(t),A=i&&i["key"];e.onerror=function(t){s(new Error("WebSocket error: "+t.message))};e.onclose=t=>{this.I4i_(A,e);t.reason!==ltt&&s(new Error("WebSocket error: "+t.reason))};e.onmessage=function(t){s(null,t.data)};this.g4i_(A,e)}a4i_(t){t["readyState"]===t["OPEN"]&&t.close(1e3,ltt);return this}};i=t([_s("geotoolkit.map.sources.connectors.WebSocket")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJhYm9ydENvbm5lY3Rpb24iOiJhNGlfIn19fSAg");var att=function(){let i=class t extends h8{constructor(t){super(t=qi(t,{connector:new t9({connector:new utt})}));this.N4i_={}}parse(t){let i;if(typeof t=="string")try{i=JSON.parse(t)}catch(t){this.onError(t);return this}else i=t;const s=this.N4i_.e8i_,e=this.N4i_.id.L4i_(),A=i["attributes"],n=i["geometry"];if(this.N4i_.Vts_!=null){let t,i;if(n){const e=n[this.N4i_.Vts_.type[2]]||n,A=c9.gts_(e,s);if(A.length>1){t=this.N4i_.Vts_.type[1];i=A}else{if(A.length!==1)return this;t=this.N4i_.Vts_.type[0];i=A[0]}}else{t=w4;i={x:NaN,y:NaN}}const h=new t({id:A[e],geometry:i,attributes:A}),r=c9.Cts_(A,this.N4i_.Vts_);r!=null&&(h.k9i_=r);this.notify(g8.Z4i_,this,[h])}return this}onError(t){t&&!t.wasClean&&super.onError(t)}R4i_(t,i){return super.R4i_(t,i||this.N4i_.Hes_)}query(t){this.N4i_.qts_!=null&&(t["token"]=this.N4i_.qts_);return super.query(t)}};i=t([_s("geotoolkit.map.sources.formats.Stream")],i);return i}();var gtt=function(){let i=class t extends w9{constructor(){super(...arguments);this.N4i_={}}parse(t,i){const s=typeof t=="string"?JSON.parse(t):t;this.N4i_.data=s;if(s["error"]!=null){c9.warn(s["error"]);throw new Error("ArcGIS Stream server returned error!")}const e=Array.isArray(this.N4i_.url)?this.N4i_.url[0]:this.N4i_.url,A=s["drawingInfo"],n=s["spatialReference"]||s["sourceSpatialReference"];this.N4i_.id=this.zts_(s["fields"],s["displayField"]);this.N4i_.Yts_=this.Xts_(s);this.N4i_.PZi_=c9.cts_(A["labelingInfo"]);this.N4i_.Vts_=c9.parse(s,e,this.N4i_.PZi_);this.N4i_.alpha=A["transparency"]>0?(100-A["transparency"])/100:1;this.Wts_(s["extent"],n);const h=s["streamUrls"];this.N4i_.Hes_=[];const r=this.N4i_.e8i_.d5i_().w2i_();for(let t=0;t<h.length;++t){const i=h[t],s=i["token"]!=null?"token="+i["token"]+"&":"",e=i["urls"];for(let t=0;t<e.length;++t)this.N4i_.Hes_.push(e[t]+"/subscribe?"+s+"outSR="+r)}this.loaded(i)}};i=t([_s("geotoolkit.map.sources.loaders.Stream")],i);return i}();var ctt=Ci(function(){let i=class t extends p8{constructor(t){super(t=qi(t,{format:new att,loader:new gtt,token:null}));this.N4i_=this.N4i_||{};this.N4i_.qts_=t["token"]}b8i_(){return this.m8i_()}N8i_(){return this.E8i_()}his_(t){this.N4i_.qts_=t;return this}fw_(){return this.N4i_.qts_}};i=t([_s("geotoolkit.map.sources.Stream")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJsb2FkU291cmNlRGF0YSI6ImI4aV8iLCJpc0RhdGFSZWFkeSI6Ik44aV8iLCJzZXRUb2tlbiI6Imhpc18iLCJnZXRUb2tlbiI6ImZ3XyJ9fX0g");var Itt=function(){let i=class t extends S9{constructor(t){if((t=qi(t,{source:new ctt}))["token"]!=null){const i=t["source"];i.L8i_("setToken",t["token"]);t["source"]=i}super(t)}};i=t([_s("geotoolkit.map.layers.Stream")],i);return i}();var ftt=Ci(function(){let i=class t extends S9{constructor(t){super(t=Pi(t,{source:t&&t["source"]||new X6(t),converters:null,annotations:{strategy:null,visible:!0,filter:new q8({weight:null})}}))}setOptions(t){if(t&&t["annotations"]&&t["annotations"].hasOwnProperty("filter")){const i=t["annotations"],s=[new htt];i["filter"]=i["filter"]?s.concat(i["filter"]):s}return super.setOptions(t)}P7i_(t,i){!this.UU_["annotations"]["visibleonzoom"]&&this.Utt_.Y7i_()>this.Utt_.V$_()||super.P7i_(t,i)}F3i_(t){const i=this.getParent();if(!i)return Au.cN_([]);let s=null;if(t instanceof r6){s=t.nt_();t=t.getFilter()}const e=s!=null?s:i.rt_();return this.Utt_.HKi_(e,this.if_(),t)}X7i_(t,i,s){this.yis_=null;super.X7i_(t,i,s)}T7i_(){return this.Utt_.T7i_()}Tis_(t,i,s,e){i.k5i_&&i.k5i_.U7i_===!0||super.Tis_(t,i,s,e)}U6i_(t){return t.k9i_||super.U6i_(t)}Jis_(){const t=this.Utt_;return super.Jis_()&&(t.Y7i_()===t.V$_()||t.C7i_())}};i=t([_s("geotoolkit.map.layers.VectorTile")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJyZW5kZXJBbm5vdGF0aW9ucyI6IlA3aV8iLCJnZXRGZWF0dXJlcyI6IkYzaV8iLCJnZXRGb250cyI6IlQ3aV8ifX19");const Ctt=new lA;var dtt=function(){let i=class t extends h8{constructor(t){const i=(t=qi(t,{format:"json",parser:new c8}))["format"],s=t["parser"];t["format"]=null;t["parser"]=null;super(t);this.N4i_={};this.jF_=i;this.yw_=s;this.qes_=(t,i,s)=>{this.notify(g8.Z4i_,this,s)};this.yw_.on(g8.Z4i_,this.qes_)}B_t_(t){if(t!=null){super.B_t_(t);this.yw_.B_t_(t)}return this}query(t){const i=this.N4i_.l8i_;i.transformPoint(Ctt.vs_(t["left"],t["top"]),Ctt);const s=Ctt.getX(),e=Ctt.getY();i.transformPoint(Ctt.vs_(t["right"],t["bottom"]),Ctt);const A=Ctt.getX(),n=Ctt.getY();let h;const r=this.N4i_.Jes_;h=Array.isArray(r)?"typeNames=("+r.join(")(")+")":this.N4i_.version<="1.1.0"?"typeName="+r:"typeNames=("+r+")";const o=this.N4i_.version>="1.1.0"&&i.B5i_().w2i_()===4326?e+","+s+","+n+","+A:s+","+e+","+A+","+n,l="?service=WFS&request=GetFeature&outputFormat="+this.jF_+"&"+h+"&bbox="+o+"&version="+this.N4i_.version;this.S4i_.send(this.R4i_(l),{key:t["key"]},((t,i)=>{t?this.onError(t):this.Df_()||this.yw_.parse(i)}));return this}dispose(){this.yw_.off(g8.Z4i_,this.qes_);this.yw_.dispose();super.dispose()}};i=t([_s("geotoolkit.map.sources.formats.WFS")],i);return i}();let Btt,wtt;const Qtt=function(t,i){Btt=Btt||new lA;const s=typeof t=="number"?[t,i]:t.textContent.split(" ");return Btt.vs_(+s[0],+s[1])};var Ett=Ci(function(){let i=class t extends o6{constructor(t){super(t);this.N4i_={}}parse(t,i){const s=typeof t=="string"?Q7.parse(t):t;if(s==null)return;this.N4i_.data=s;if(s.querySelector("ExceptionReport"))throw new Error("Wrong GetCapabilities info!");wtt=wtt||new mA;let e=null;const A=this.Pes_(s.querySelectorAll("FeatureTypeList > FeatureType"));for(let t=0;t<A.length;++t)e=this.Ves_(A[t],e);if(e!=null){const t=this.N4i_.e8i_.B5i_(),i=e.Me_(),s=e.be_();t.transform(i.x,i.y,i);t.transform(s.x,s.y,s);this.N4i_.FMt_=e.ce_(i.x,i.y,s.x,s.y)}else this.N4i_.FMt_=this.N4i_.e8i_.B5i_().E2i_();this.loaded(i)}a9i_(){const t=Array.isArray(this.N4i_.url)?this.N4i_.url[0]:this.N4i_.url;return t?t+"?service=WFS&version="+this.N4i_.version+"&request=GetCapabilities":null}Ves_(t,i){const s=t.querySelector("DefaultSRS, DefaultCRS"),e=this.N4i_.e8i_.d5i_();let A;if(s&&s.textContent){const t=s.textContent.match(/\d+$/);if(t!=null&&e.w2i_()!==+t[0]){A=X3.sx_().l5i_(t[0]);if(A){this.N4i_.e8i_.w5i_(A);this.N4i_.l8i_.Q5i_(A)}else ki("WFS: coordinate system ("+t[0]+") is not supported, "+"use geotoolkit.map.coordinatesystems.Registry to register it manually.")}}let n,h=t.querySelector("LatLongBoundingBox");if(h){n=Qtt(+h.getAttribute("minx"),+h.getAttribute("miny"));i=i?i.fe_(n.x,n.y):wtt.ce_(n.x,n.y,n.x,n.y);n=Qtt(+h.getAttribute("maxx"),+h.getAttribute("maxy"));i.fe_(n.x,n.y);return i}h=t.querySelector("WGS84BoundingBox")||t.querySelector("BoundingBox");if(h){n=Qtt(h.querySelector("LowerCorner"));i=i?i.fe_(n.x,n.y):wtt.ce_(n.x,n.y,n.x,n.y);n=Qtt(h.querySelector("UpperCorner"));i.fe_(n.x,n.y)}return i}Pes_(t){const i=[];let s=null;for(let e=0;e<t.length;++e){const A=t[e].querySelector("Name");if(A){s=s===null?e:s;(Array.isArray(this.N4i_.Jes_)&&this.N4i_.Jes_.indexOf(A.textContent)>=0||this.N4i_.Jes_===A.textContent)&&i.push(t[e])}}if(i.length===0&&s!==null){this.N4i_.Jes_=t[s].querySelector("Name").textContent;i.push(t[s])}return i}};i=t([_s("geotoolkit.map.sources.loaders.WFS")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRTZXR0aW5nc1VybCI6ImE5aV8ifX19");var ptt=Ci(function(){let i=class t extends p8{constructor(t){super(t=qi(t,{format:new dtt,loader:new Ett},!0));this.N4i_=this.N4i_||{};this.N4i_.version=t["version"]||"1.1.0";this.N4i_.Jes_=t["featuretypes"]||null}Oes_(t){this.N4i_.Jes_=t;return this}Wes_(){return this.N4i_.Jes_}};i=t([_s("geotoolkit.map.sources.WFS")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRGZWF0dXJlVHlwZXMiOiJPZXNfIiwiZ2V0RmVhdHVyZVR5cGVzIjoiV2VzXyJ9fX0g");var mtt=Ci(function(){let i=class t extends S9{constructor(t){super(t=qi(t,{source:t&&t["source"]||new ptt,templates:[],server:null},!0));t["featuretypes"]!=null&&this.Utt_.Oes_(t["featuretypes"])}N_(){const t=super.N_();t["featuretypes"]=this.Utt_ instanceof ptt?this.Utt_.Wes_():null;return t}dt_(t){if((t=Es(t))==null)return this;t["featuretypes"]!=null&&this.Utt_ instanceof ptt&&this.Utt_.Oes_(t["featuretypes"]);super.dt_(t);return this}};i=t([_s("geotoolkit.map.layers.WFS")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRQcm9wZXJ0aWVzIjoiTl8iLCJzZXRQcm9wZXJ0aWVzIjoiZHRfIn19fSAg");const ytt=function(t){let i="&layers="+t[0];for(let s=1;s<t.length;++s)i+=","+t[s];return i};var Dtt=Ci(function(){let i=class t extends h8{constructor(t){super(t=qi(t,{connector:new x6,geometryconnector:new V4}));this.N4i_={};this.Xis_=t["geometryconnector"]}query(t){const i=t["left"],s=t["right"],e=t["top"],A=t["bottom"],n=t["width"],h=t["height"],r=this.N4i_.e8i_.B5i_().w2i_(),o=new df({lazyloading:!0,ax:(i+s)/2,ay:(e+A)/2,width:s-i,height:A-e,ispointingup:!0,alignment:dA.ne_,crossorigin:"anonymous"});if(this.N4i_.jis_.length===0){this.notify(ff.PV_,o,null);return this}const l=ytt(this.N4i_.jis_),u="?service=WMS&request=GetMap&version="+this.N4i_.version+l+"&styles="+"&crs=EPSG:"+r+"&bbox="+i+"%2C"+e+"%2C"+s+"%2C"+A+"&width="+n+"&height="+h+"&format="+this.N4i_.format+"&transparent="+this.N4i_.transparent;this.S4i_.send(this.R4i_(u),{dst:o,key:t["key"]},((t,n)=>{if(t)this.onError(t);else if(!this.Df_()){n.SE_(dA.ne_);n.gR_((i+s)/2,(e+A)/2);n.tR_(!0);n.setSize(s-i,A-e);this.notify(ff.PV_,n,n._V_())}}));return this}zes_(t){const i=NA.clamp(Math.round(t["x"]),0,t["width"]),s=NA.clamp(Math.round(t["y"]),0,t["height"]),e=(this.N4i_.version==="1.0.0"?"&wmtver=":"&version=")+this.N4i_.version,A="&request="+(this.N4i_.version==="1.0.0"?"feature_info":"GetFeatureInfo"),n=(this.N4i_.version==="1.3.0"?"&i=":"&x=")+i,h=(this.N4i_.version==="1.3.0"?"&j=":"&y=")+s,r=this.N4i_.e8i_.B5i_().w2i_(),o=(this.N4i_.version==="1.3.0"?"&crs":"&srs")+"=epsg:"+r,l="?service=WMS"+e+A+"&query_layers="+t["layers"]+"&layers="+t["layers"]+"&info_format=application/json&bbox="+t["left"]+","+t["top"]+","+t["right"]+","+t["bottom"]+"&width="+t["width"]+"&height="+t["height"]+n+h+o;this.Xis_.send(this.R4i_(l),{key:t["key"]},((t,i)=>{let s;if(t)s=[];else try{const t=typeof i=="string"?JSON.parse(i):i;s=a8.parse(t)}catch(t){s=[]}this.notify(g8.s8i_,this,s)}));return this}_is_(t){this.Xis_.abort(t);return this}};i=t([_s("geotoolkit.map.sources.formats.WMS")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRGZWF0dXJlSW5mbyI6Inplc18iLCJhYm9ydEdlb21ldHJ5UXVlcmllcyI6Il9pc18ifX19");const Mtt=function(t){return t.map((function(t){return'BoundingBox[CRS="EPSG:'+t+'"]'})).join(", ")};var vtt=Ci(function(){let i=class t extends o6{constructor(t){super(t);this.N4i_={}}parse(t,i){const s=typeof t=="string"?Q7.parse(t):t;if(s==null)return;this.N4i_.data=s;const e=s.querySelectorAll("GetMap > Format");this.Xes_(e);const A=s.querySelectorAll('Layer[queryable="1"] > Name');let n=[];for(let t=0;t<A.length;++t){const i=A[t].firstChild?A[t].firstChild.nodeValue:null;if(i!=null){if(this.N4i_.jis_.length===0){this.N4i_.jis_.push(i);n=[A[t].parentNode];break}this.N4i_.jis_.indexOf(i)>=0&&n.push(A[t].parentNode)}}const h=this.N4i_.e8i_.B5i_(),r=[h.w2i_()],o=Mtt(r);let l=null;const u=this.N4i_.version>"1.1.0"&&h.w2i_()===4326;for(let t=0;t<n.length;++t){const i=n[t].querySelector(o);if(i!=null){const t=+i.getAttribute(u?"miny":"minx"),s=+i.getAttribute(u?"minx":"miny"),e=+i.getAttribute(u?"maxy":"maxx"),A=+i.getAttribute(u?"maxx":"maxy");if(l){l.fe_(t,s);l.fe_(e,A)}else l=new mA(t,s,e,A)}}this.N4i_.FMt_=l!=null?l.intersect(h.E2i_()):h.E2i_();this.loaded(i)}a9i_(){const t=Array.isArray(this.N4i_.url)?this.N4i_.url[0]:this.N4i_.url;return t?t+"?service=WMS&version="+this.N4i_.version+"&request=GetCapabilities":null}Xes_(t){const i=this.N4i_.format;if(i!=null)for(let s=0;s<t.length;++s)if(t[s].firstChild&&t[s].firstChild.nodeValue===i)return this;if(!(t.length>0&&t[0].firstChild))throw new Error("No formats available");this.N4i_.format=t[0].firstChild.nodeValue;return this}};i=t([_s("geotoolkit.map.sources.loaders.WMS")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRTZXR0aW5nc1VybCI6ImE5aV8ifX19");const btt=new xA;var Ntt=function(){let i=class t extends K9{constructor(t,i){super(t,i);this.qd_=null;this.ass_=[]}zes_(t,i){const s=i.if_();s.cI_(btt.setSize(1,1),btt);if(this.qd_!=null&&Math.abs(this.qd_.getX()-t.getX())<btt.Ie_()&&Math.abs(this.qd_.getY()-t.getY())<btt.Ts_())return this.ass_;this.ass_=[];this.qd_=t;const e=this.N4i_.gss_||this.N4i_.jis_,A=i.ot_(),n=s.rn_(A).round();this.jF_._is_();this.jF_.zes_({x:s.SI_(t.getX(),t.getY()),y:s.GI_(t.getX(),t.getY()),left:A.we_(),right:A.Qe_(),top:A.Ee_(),bottom:A.pe_(),width:n.Ie_(),height:n.Ts_(),layers:e.join(",")});return null}K8i_(){super.K8i_();this.jF_.on(g8.s8i_,((t,i,s)=>{this.ass_=s;this.notify(g8.s8i_,this,s)}));return this}_is_(){this.jF_._is_();return this}};i=t([_s("geotoolkit.map.sources.managers.WMS")],i);return i}();var Stt=Ci(function(){let i=class t extends H9{constructor(t){super(t=qi(t,{format:new Dtt,loader:new vtt,system:B3.U2i_}));this.N4i_=this.N4i_||{};this.N4i_.version=t.hasOwnProperty("version")?t["version"]:"1.3.0";this.N4i_.transparent=!t.hasOwnProperty("transparent")||t["transparent"];this.N4i_.format=t["imageformat"]||null;this.N4i_.gss_=null}B8i_(t){this.u8i_=new Ntt(t,this.N4i_);this.u8i_.on(g8.PV_,((t,i,s)=>{this.notify(g8.PV_,this,s);this.y8i_(!0)}));this.u8i_.on(g8.s8i_,((t,i,s)=>{this.notify(g8.s8i_,this,s)}));return this}jes_(t){this.N4i_.format=t;return this}Zes_(){return this.N4i_.format}fss_(t){this.N4i_.transparent=t;return this}_es_(){return this.N4i_.transparent}setVersion(t){this.N4i_.version=t;return this}ns_(){return this.N4i_.version}zes_(t,i){return this.E8i_()?this.u8i_.zes_(t,i):[]}dss_(t){this.N4i_.gss_=t==null?null:Array.isArray(t)?t:[t];return this}_is_(){this.u8i_._is_();return this}};i=t([_s("geotoolkit.map.sources.WMS")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRJbWFnZUZvcm1hdCI6Implc18iLCJnZXRJbWFnZUZvcm1hdCI6Ilplc18iLCJzZXRUcmFuc3BhcmVudCI6ImZzc18iLCJnZXRUcmFuc3BhcmVudCI6Il9lc18iLCJnZXRWZXJzaW9uIjoibnNfIiwiZ2V0RmVhdHVyZUluZm8iOiJ6ZXNfIiwic2V0VG9vbHRpcExheWVycyI6ImRzc18iLCJhYm9ydEdlb21ldHJ5UXVlcmllcyI6Il9pc18ifX19");var Gtt=Ci(function(){let i=class t extends O9{constructor(t){const i=Pi(t,{imageformat:null,layers:null,version:"1.3.0",transparent:!0,inflate:.2,timeout:50,tooltip:{formatter:new W8,visible:!1}},!0),s=i["source"]||new Stt(i);i["imageformat"]!=null&&s.jes_(i["imageformat"]);i["layers"]!=null&&s.Iis_(i["layers"]);i["source"]=s;super(i)}rvt_(t){if(this.Utt_===t)return this;this.wss_||(this.wss_=(t,i,s)=>{this.notify(g8.s8i_,this,s)});this.Utt_!=null&&this.Utt_.off(g8.s8i_,this.wss_);super.rvt_(t);this.Utt_!=null&&this.Utt_.on(g8.s8i_,this.wss_);return this}jes_(t){this.Utt_ instanceof Stt&&this.Utt_.jes_(t);return this}Zes_(){return this.Utt_ instanceof Stt?this.Utt_.Zes_():null}fss_(t){this.Utt_ instanceof Stt&&this.Utt_.fss_(t);return this}_es_(){return this.Utt_ instanceof Stt?this.Utt_._es_():null}setVersion(t){this.Utt_ instanceof Stt&&this.Utt_.setVersion(t);return this}ns_(){return this.Utt_ instanceof Stt?this.Utt_.ns_():null}N_(){const t=super.N_();t["imageformat"]=this.Zes_();t["version"]=this.ns_();t["inflate"]=this.Utt_ instanceof Stt?this.Utt_.rss_():null;t["transparent"]=this._es_();t["timeout"]=this.Utt_ instanceof Stt?this.Utt_.lss_():null;t["layers"]=this.Utt_ instanceof Stt?this.Utt_.Cis_():null;return t}dt_(t){if((t=Es(t))==null)return this;if(this.Utt_ instanceof Stt){t["imageformat"]!==void 0&&this.Utt_.jes_(t["imageformat"]);t["layers"]!==void 0&&this.Utt_.Iis_(t["layers"]);t["version"]!==void 0&&this.Utt_.setVersion(t["version"]);t["inflate"]!==void 0&&this.Utt_.hss_(t["inflate"]);t["transparent"]!==void 0&&this.Utt_.fss_(t["transparent"]);t["timeout"]!==void 0&&this.Utt_.oss_(t["timeout"])}super.dt_(t);return this}$X_(t,i){const s=this.k8i_();if(!s)return[];const e=s.E2i_(),A=undefined;(t=this.if_().aI_(t)).getX()<e.getX()?t.translate(e.Ie_(),0):t.getX()>e.Qe_()&&t.translate(-e.Ie_(),0);const n=this.rt_();return n&&n.contains(t)?this.Utt_.zes_(t,this):[]}};i=t([_s("geotoolkit.map.layers.WMS")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRJbWFnZUZvcm1hdCI6Implc18iLCJnZXRJbWFnZUZvcm1hdCI6Ilplc18iLCJzZXRUcmFuc3BhcmVudCI6ImZzc18iLCJnZXRUcmFuc3BhcmVudCI6Il9lc18iLCJnZXRWZXJzaW9uIjoibnNfIiwiZ2V0UHJvcGVydGllcyI6Ik5fIiwic2V0UHJvcGVydGllcyI6ImR0XyIsImhpdFRlc3QiOiIkWF8ifX19");const Rtt=function(t){let i="&layers="+t[0];for(let s=1;s<t.length;++s)i+=","+t[s];return i};var ktt=function(){let i=class t extends U6{constructor(){super(...arguments);this.N4i_={}}query(t){const i=this.N4i_.l8i_.B5i_(),s=i.E2i_(),e=Rtt(this.N4i_.jis_),A=s.Ie_()/t["grid"].Ie_(),n=s.Ts_()/t["grid"].Ts_(),h=s.we_()+A*t["x"],r=s.pe_()-n*(t["y"]+1),o=s.we_()+A*(t["x"]+1),l=s.pe_()-n*t["y"],u=this.N4i_.version>"1.1.0"&&i.w2i_()===4326?r+","+h+","+l+","+o:h+","+r+","+o+","+l,a="&crs=EPSG:"+i.w2i_()+"&srs=EPSG:"+i.w2i_(),g="?service=WMS&request=GetMap&version="+this.N4i_.version+e+"&styles="+a+"&bbox="+u+"&width="+this.N4i_.B7i_+"&height="+this.N4i_.d7i_+"&format="+this.N4i_.format+"&transparent="+this.N4i_.transparent;this.S4i_.send(this.R4i_(g),{dst:t["dst"],key:t["key"],priority:t["priority"]},((t,i)=>{this.Df_()||(t?this.onError(t):this.notify(ff.PV_,i,i._V_()))}));return this}};i=t([_s("geotoolkit.map.sources.formats.WMSTile")],i);return i}();var Ftt=Ci(function(){let i=class t extends j9{constructor(t){super(t=qi(t,{format:new ktt,loader:new vtt,system:B3.L2i_}));this.N4i_=this.N4i_||{};this.N4i_.version=t.hasOwnProperty("version")?t["version"]:"1.3.0";this.N4i_.transparent=!t.hasOwnProperty("transparent")||t["transparent"];this.N4i_.format=t["imageformat"]||null;this.N4i_.jis_=[];this.N4i_.layers=null}jes_(t){this.N4i_.format=t;return this}Zes_(){return this.N4i_.format}fss_(t){this.N4i_.transparent=t;return this}_es_(){return this.N4i_.transparent}setVersion(t){this.N4i_.version=t;return this}ns_(){return this.N4i_.version}Iis_(t){this.N4i_.jis_=t!=null?Array.isArray(t)?t:[t]:[];this.update();return this}uss_(t){this.N4i_.jis_=this.N4i_.jis_.filter((function(i){return Array.isArray(t)?t.indexOf(i)<0:i!==t}));this.update();return this}Cis_(){return this.N4i_.jis_.slice()}getLayers(){return this.N4i_.layers}};i=t([_s("geotoolkit.map.sources.WMSTile")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRJbWFnZUZvcm1hdCI6Implc18iLCJnZXRJbWFnZUZvcm1hdCI6Ilplc18iLCJzZXRUcmFuc3BhcmVudCI6ImZzc18iLCJnZXRUcmFuc3BhcmVudCI6Il9lc18iLCJnZXRWZXJzaW9uIjoibnNfIiwic2hvd0xheWVycyI6Iklpc18iLCJoaWRlTGF5ZXJzIjoidXNzXyIsImdldFZpc2libGVMYXllcnMiOiJDaXNfIn19fSAg");var xtt=Ci(function(){let i=class t extends $9{constructor(t){super(t=qi(t,{source:t&&t["source"]||new Ftt}))}jes_(t){this.Utt_ instanceof Ftt&&this.Utt_.jes_(t);return this}Zes_(){return this.Cvt_()instanceof Ftt?this.Utt_.Zes_():null}fss_(t){this.Utt_ instanceof Ftt&&this.Utt_.fss_(t);return this}_es_(){return this.Utt_ instanceof Ftt?this.Utt_._es_():null}setVersion(t){this.Utt_ instanceof Ftt&&this.Utt_.setVersion(t);return this}ns_(){return this.Utt_ instanceof Ftt?this.Utt_.ns_():null}getLayers(){return this.Utt_ instanceof Ftt?this.Utt_.getLayers():null}Cis_(){return this.Utt_ instanceof Ftt?this.Utt_.Cis_():null}Iis_(t){this.Utt_ instanceof Ftt&&this.Utt_.Iis_(t);return this}uss_(t){this.Utt_ instanceof Ftt&&this.Utt_.uss_(t);return this}N_(){const t=super.N_();t["format"]=this.Zes_();t["version"]=this.ns_();t["transparent"]=this._es_();t["showlayers"]=this.Cis_();return t}dt_(t){if((t=Es(t))==null)return this;super.dt_(t);return this}setOptions(t){super.setOptions(t);t["format"]!=null&&this.jes_(t["format"]);t["version"]!=null&&this.setVersion(t["version"]);t["transparent"]!=null&&this.fss_(t["transparent"]);if(t["showlayers"]!=null){this.uss_();this.Iis_(t["showlayers"])}return this}};i=t([_s("geotoolkit.map.layers.WMSTile")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRJbWFnZUZvcm1hdCI6Implc18iLCJnZXRJbWFnZUZvcm1hdCI6Ilplc18iLCJzZXRUcmFuc3BhcmVudCI6ImZzc18iLCJnZXRUcmFuc3BhcmVudCI6Il9lc18iLCJnZXRWZXJzaW9uIjoibnNfIiwiZ2V0VmlzaWJsZUxheWVycyI6IkNpc18iLCJzaG93TGF5ZXJzIjoiSWlzXyIsImhpZGVMYXllcnMiOiJ1c3NfIiwiZ2V0UHJvcGVydGllcyI6Ik5fIiwic2V0UHJvcGVydGllcyI6ImR0XyJ9fX0g");var Ltt=function(){let i=class t extends q4{constructor(t){super();this.Us_=t&&t["data"]||null}send(t,i,s){return s(null,this.Us_)}abort(t){return this}};i=t([_s("geotoolkit.map.sources.connectors.Stub")],i);return i}();const Utt=12;var Ytt=function(){var t=class{static $es_(t){return{tAs_:t.tAs_,iAs_:t.iAs_,sAs_:t.sAs_,height:t.height,width:t.width,eAs_:t.eAs_,AAs_:t.AAs_,mask:t.mask?{nAs_:t.mask.nAs_,hAs_:t.mask.hAs_,rAs_:t.mask.rAs_,maxValue:t.mask.maxValue}:null,S7i_:{nAs_:t.S7i_.nAs_,hAs_:t.S7i_.hAs_,rAs_:t.S7i_.rAs_,maxValue:t.S7i_.maxValue,oAs_:t.oAs_}}}static lAs_(t){const i=t.S7i_.nAs_*t.S7i_.hAs_,s={};for(let e=0;e<i;e++){const i=t.S7i_.uAs_[e];i.encoding===0?s.float32=!0:i.encoding===1?s[i.aAs_]=!0:s[0]=!0}return Object.keys(s)}static gAs_(t,i,s,e,A,n,h){const r=(1<<i)-1;let o=0,l,u=0,a,g;const c=Math.ceil((h-e)/A),I=t.length*4-Math.ceil(i*s/8);t[t.length-1]<<=8*I;for(l=0;l<s;l++){if(u===0){g=t[o++];u=32}if(u>=i){a=g>>>u-i&r;u-=i}else{const s=i-u;a=(g&r)<<s&r;g=t[o++];u=32-s;a+=g>>>u}n[l]=a<c?e+a*A:h}return n}static cAs_(i,s,e,A,n){let h=0;const r=i.S7i_.nAs_,o=i.S7i_.hAs_,l=Math.floor(i.width/r),u=Math.floor(i.height/o),a=2*i.eAs_;let g=Number.MAX_VALUE,c,I;e=e||(i.mask?i.mask.IAs_:null);const f=new s(i.width*i.height);n&&e&&(I=new Uint8Array(i.width*i.height));const C=new Float32Array(l*u);let d,B;for(let s=0;s<=o;s++){const n=s!==o?u:i.height%o;if(n!==0)for(let o=0;o<=r;o++){const w=o!==r?l:i.width%r;if(w===0)continue;let Q=s*i.width*u+o*l;const E=i.width-w,p=i.S7i_.uAs_[h];let m=new Float32Array,y=0,D=0,M;if(p.encoding<2){if(p.encoding===0)m=p.fti_;else{t.gAs_(p.fAs_,p.aAs_,p.CAs_,p.offset,a,C,i.S7i_.maxValue);m=C}y=0}else D=p.encoding===2?0:p.offset;if(e)for(B=0;B<n;B++){if(Q&7){M=e[Q>>3];M<<=Q&7}for(d=0;d<w;d++){Q&7||(M=e[Q>>3]);if(M&128){I&&(I[Q]=1);c=p.encoding<2?m[y++]:D;g=g>c?c:g;f[Q++]=c}else{I&&(I[Q]=0);f[Q++]=A}M<<=1}Q+=E}else if(p.encoding<2)for(B=0;B<n;B++){for(d=0;d<w;d++){c=m[y++];g=g>c?c:g;f[Q++]=c}Q+=E}else{g=g>D?D:g;for(B=0;B<n;B++){for(d=0;d<w;d++)f[Q++]=D;Q+=E}}if(p.encoding===1&&y!==p.CAs_)throw Error("Block and Mask do not match");h++}}return{dAs_:f,BAs_:I,minValue:g}}static parse(t,i,s){const e={},A=new Uint8Array(t,i,10);e.tAs_=String.fromCharCode.apply(null,A);if(e.tAs_.trim()!=="CntZImage")throw Error("Unexpected file identifier string: "+e.tAs_);i+=10;let n=new DataView(t,i,24);e.iAs_=n.getInt32(0,!0);e.sAs_=n.getInt32(4,!0);e.height=n.getUint32(8,!0);e.width=n.getUint32(12,!0);e.eAs_=n.getFloat64(16,!0);i+=24;if(!s){n=new DataView(t,i,16);e.mask={};e.mask.hAs_=n.getUint32(0,!0);e.mask.nAs_=n.getUint32(4,!0);e.mask.rAs_=n.getUint32(8,!0);e.mask.maxValue=n.getFloat32(12,!0);i+=16;if(e.mask.rAs_>0){const s=new Uint8Array(Math.ceil(e.width*e.height/8));n=new DataView(t,i,e.mask.rAs_);let A=n.getInt16(0,!0),h=2,r=0;do{if(A>0)while(A--)s[r++]=n.getUint8(h++);else{const t=n.getUint8(h++);A=-A;while(A--)s[r++]=t}A=n.getInt16(h,!0);h+=2}while(h<e.mask.rAs_);if(A!==-32768||r<s.length)throw Error("Unexpected end of mask RLE encoding");e.mask.IAs_=s;i+=e.mask.rAs_}else(e.mask.rAs_|e.mask.hAs_|e.mask.maxValue)==0&&(e.mask.IAs_=new Uint8Array(Math.ceil(e.width*e.height/8)))}n=new DataView(t,i,16);e.S7i_={};e.S7i_.hAs_=n.getUint32(0,!0);e.S7i_.nAs_=n.getUint32(4,!0);e.S7i_.rAs_=n.getUint32(8,!0);e.S7i_.maxValue=n.getFloat32(12,!0);i+=16;const h=e.S7i_.nAs_,r=e.S7i_.hAs_,o=h+(e.width%h>0?1:0),l=r+(e.height%r>0?1:0);e.S7i_.uAs_=[];let u=0;for(let s=0;s<l;s++)for(let s=0;s<o;s++){let s=0;const A=t.byteLength-i;n=new DataView(t,i,Math.min(10,A));const h={};e.S7i_.uAs_[u++]=h;let r=n.getUint8(0),o,l;s++;h.encoding=r&63;if(h.encoding>3)throw Error("Invalid block encoding ("+h.encoding+")");if(h.encoding!==2){if(r!==0&&r!==2){r>>=6;h.wAs_=r;if(r===2){h.offset=n.getInt8(1);s++}else if(r===1){h.offset=n.getInt16(1,!0);s+=2}else{if(r!==0)throw Error("Invalid block offset type");h.offset=n.getFloat32(1,!0);s+=4}if(h.encoding===1){r=n.getUint8(s);s++;h.aAs_=r&63;r>>=6;h.QAs_=r;if(r===2){h.CAs_=n.getUint8(s);s++}else if(r===1){h.CAs_=n.getUint16(s,!0);s+=2}else{if(r!==0)throw Error("Invalid valid pixel count type");h.CAs_=n.getUint32(s,!0);s+=4}}}i+=s;if(h.encoding!==3)if(h.encoding===0){const s=(e.S7i_.rAs_-1)/4;if(s!==Math.floor(s))throw Error("uncompressed block has invalid length");o=new ArrayBuffer(s*4);l=new Uint8Array(o);l.set(new Uint8Array(t,i,s*4));const A=new Float32Array(o);h.fti_=A;i+=s*4}else if(h.encoding===1){const s=Math.ceil(h.CAs_*h.aAs_/8),e=Math.ceil(s/4);o=new ArrayBuffer(e*4);l=new Uint8Array(o);l.set(new Uint8Array(t,i,s));h.fAs_=new Uint32Array(o);i+=s}}else i++}e.AAs_=i;return e}static decode(i,s){const e=(s=s||{}).EAs_||s.EAs_===null,A=t.parse(i,s.pAs_||0,e),n=s.oAs_!==null?s.oAs_:t.mAs_,h=t.cAs_(A,s.yAs_||Float32Array,s.EAs_,n,s.DAs_),r={width:A.width,height:A.height,MAs_:h.dAs_,minValue:h.minValue,maxValue:A.S7i_.maxValue,oAs_:n};h.BAs_&&(r.vAs_=h.BAs_);s.bAs_&&A.mask&&(r.EAs_=A.mask.IAs_?A.mask.IAs_:null);if(s.NAs_){r.SAs_=t.$es_(A);s.lAs_&&(r.SAs_.GAs_=t.lAs_(A))}return r}};t.mAs_=-34027999387901484e22;return t}(),Ttt=function(){var t;return class{constructor(){}}}(),Ktt=function(){var t=class{static decode(i,s){const e=(s=s||{}).oAs_,A={};A.ptr=s.pAs_||0;A.S7i_={};if(!t.kAs_.RAs_(i,A))return null;const n=A.FAs_,h=n.iAs_,r=t.kAs_.xAs_(n.sAs_);t.kAs_.LAs_(i,A);n.UAs_===n.width*n.height||A.S7i_.BAs_||(A.S7i_.BAs_=s.vAs_);const o=n.width*n.height;A.S7i_.dAs_=new r(o*n.YAs_);A.TAs_={KAs_:0,HAs_:0,lut:0,qAs_:0,constant:0,JAs_:0};if(n.UAs_!==0)if(n.PAs_===n.VAs_)t.kAs_.OAs_(A);else if(h>=4&&t.kAs_.WAs_(i,A))t.kAs_.OAs_(A);else{const s=new DataView(i,A.ptr,2),e=s.getUint8(0);A.ptr++;if(e)t.kAs_.zAs_(i,A,r);else if(h>1&&n.sAs_<=1&&Math.abs(n.eAs_-.5)<1e-5){const e=s.getUint8(1);A.ptr++;A.XAs_=e;if(e>2||h<4&&e>1)throw Error("Invalid Huffman flag "+e);e?t.kAs_.jAs_(i,A,r):t.kAs_.ZAs_(i,A,r)}else t.kAs_.ZAs_(i,A,r)}A.AAs_=A.ptr;let l;if(s.pAs_){l=A.FAs_._As_+s.pAs_-A.ptr;Math.abs(l)>=1&&(A.AAs_=s.pAs_+A.FAs_._As_)}else{l=A.FAs_._As_-A.ptr;Math.abs(l)>=1&&(A.AAs_=A.FAs_._As_)}const u={width:n.width,height:n.height,MAs_:A.S7i_.dAs_,minValue:n.VAs_,maxValue:n.PAs_,$As_:n.UAs_,tns_:n.YAs_,ins_:{sns_:n.sns_,ens_:n.ens_},vAs_:A.S7i_.BAs_};if(A.S7i_.BAs_&&t.kAs_.Ans_(n.sAs_,e)){const t=A.S7i_.BAs_;for(let i=0;i<o;i++)t[i]||(u.MAs_[i]=e);u.oAs_=e}A.oAs_=e;s.NAs_&&(u.SAs_=t.kAs_.$es_(A));return u}};t.nns_=class{static gAs_(t,i,s,e,A,n,h,r){const o=(1<<s)-1;let l=0,u,a=0,g,c,I,f;const C=t.length*4-Math.ceil(s*e/8);t[t.length-1]<<=8*C;if(A)for(u=0;u<e;u++){if(a===0){c=t[l++];a=32}if(a>=s){g=c>>>a-s&o;a-=s}else{I=s-a;g=(c&o)<<I&o;c=t[l++];a=32-I;g+=c>>>a}i[u]=A[g]}else{f=Math.ceil((r-n)/h);for(u=0;u<e;u++){if(a===0){c=t[l++];a=32}if(a>=s){g=c>>>a-s&o;a-=s}else{I=s-a;g=(c&o)<<I&o;c=t[l++];a=32-I;g+=c>>>a}i[u]=g<f?n+g*h:r}}}static hns_(t,i,s,e,A,n){const h=(1<<i)-1;let r=0,o=0,l=0,u=0,a;const g=[],c=t.length*4-Math.ceil(i*s/8);t[t.length-1]<<=8*c;const I=Math.ceil((n-e)/A);for(let c=0;c<s;c++){if(l===0){a=t[r++];l=32}if(l>=i){u=a>>>l-i&h;l-=i}else{o=i-l;u=(a&h)<<o&h;a=t[r++];l=32-o;u+=a>>>l}g[c]=u<I?e+u*A:n}g.unshift(e);return g}static rns_(t,i,s,e,A,n,h,r){const o=(1<<s)-1;let l=0,u,a=0,g=0,c,I,f;if(A)for(u=0;u<e;u++){if(a===0){I=t[l++];a=32;g=0}if(a>=s){c=I>>>g&o;a-=s;g+=s}else{f=s-a;c=I>>>g&o;I=t[l++];a=32-f;c|=(I&(1<<f)-1)<<s-f;g=f}i[u]=A[c]}else{const A=Math.ceil((r-n)/h);for(u=0;u<e;u++){if(a===0){I=t[l++];a=32;g=0}if(a>=s){c=I>>>g&o;a-=s;g+=s}else{f=s-a;c=I>>>g&o;I=t[l++];a=32-f;c|=(I&(1<<f)-1)<<s-f;g=f}i[u]=c<A?n+c*h:r}}return i}static ons_(t,i,s,e,A,n){const h=(1<<i)-1;let r=0,o=0,l=0,u=0,a=0,g;const c=[],I=Math.ceil((n-e)/A);for(let f=0;f<s;f++){if(l===0){g=t[r++];l=32;a=0}if(l>=i){u=g>>>a&h;l-=i;a+=i}else{o=i-l;u=g>>>a&h;g=t[r++];l=32-o;u|=(g&(1<<o)-1)<<i-o;a=o}c[f]=u<I?e+u*A:n}c.unshift(e);return c}static lns_(t,i,s,e){const A=(1<<s)-1;let n=0,h=0,r,o,l;const u=t.length*4-Math.ceil(s*e/8);t[t.length-1]<<=8*u;for(let u=0;u<e;u++){if(h===0){o=t[n++];h=32}if(h>=s){r=o>>>h-s&A;h-=s}else{l=s-h;r=(o&A)<<l&A;o=t[n++];h=32-l;r+=o>>>h}i[u]=r}return i}static uns_(t,i,s,e){const A=(1<<s)-1;let n=0,h=0,r=0,o,l,u;for(let a=0;a<e;a++){if(h===0){l=t[n++];h=32;r=0}if(h>=s){o=l>>>r&A;h-=s;r+=s}else{u=s-h;o=l>>>r&A;l=t[n++];h=32-u;o|=(l&(1<<u)-1)<<s-u;r=u}i[a]=o}return i}};t.kAs_=class{static ans_(t){let i=65535,s=65535;const e=t.length;let A=Math.floor(e/2),n=0;while(A){let e=A>=359?359:A;A-=e;do{i+=t[n++]<<8;s+=i+=t[n++]}while(--e);i=(i&65535)+(i>>>16);s=(s&65535)+(s>>>16)}e&1&&(s+=i+=t[n]<<8);i=(i&65535)+(i>>>16);s=(s&65535)+(s>>>16);return(s<<16|i)>>>0}static RAs_(t,i){let s=i.ptr;const e=new Uint8Array(t,s,6),A={};A.tAs_=String.fromCharCode.apply(null,e);if(A.tAs_.lastIndexOf("Lerc2",0)!==0)throw Error("Unexpected file identifier string (expect Lerc2): "+A.tAs_);s+=6;let n=new DataView(t,s,8);const h=n.getInt32(0,!0);A.iAs_=h;s+=4;if(h>=3){A.j6t_=n.getUint32(4,!0);s+=4}n=new DataView(t,s,12);A.height=n.getUint32(0,!0);A.width=n.getUint32(4,!0);s+=8;if(h>=4){A.YAs_=n.getUint32(8,!0);s+=4}else A.YAs_=1;n=new DataView(t,s,40);A.UAs_=n.getUint32(0,!0);A.gns_=n.getInt32(4,!0);A._As_=n.getInt32(8,!0);A.sAs_=n.getInt32(12,!0);A.eAs_=n.getFloat64(16,!0);A.VAs_=n.getFloat64(24,!0);A.PAs_=n.getFloat64(32,!0);s+=40;i.FAs_=A;i.ptr=s;let r,o;if(h>=3){o=h>=4?52:48;r=this.ans_(new Uint8Array(t,s-o,A._As_-14));if(r!==A.j6t_)throw Error("Checksum failed.")}return!0}static WAs_(t,i){const s=i.FAs_,e=this.xAs_(s.sAs_),A=s.YAs_*this.cns_(s.sAs_),n=this.Ins_(t,i.ptr,e,A),h=this.Ins_(t,i.ptr+A,e,A);i.ptr+=2*A;let r,o=!0;for(r=0;r<s.YAs_;r++)if(n[r]!==h[r]){o=!1;break}s.sns_=n;s.ens_=h;return o}static Ins_(t,i,s,e){let A;if(s===Uint8Array)A=new Uint8Array(t,i,e);else{const n=new ArrayBuffer(e),h=undefined;new Uint8Array(n).set(new Uint8Array(t,i,e));A=new s(n)}return A}static LAs_(t,i){let s=i.ptr;const e=i.FAs_,A=e.width*e.height,n=e.UAs_;let h=new DataView(t,s,4);const r={};r.rAs_=h.getUint32(0,!0);s+=4;if((n===0||A===n)&&r.rAs_!==0)throw Error("invalid mask");let o,l;if(n===0){o=new Uint8Array(Math.ceil(A/8));r.IAs_=o;l=new Uint8Array(A);i.S7i_.BAs_=l;s+=r.rAs_}else if(r.rAs_>0){o=new Uint8Array(Math.ceil(A/8));h=new DataView(t,s,r.rAs_);let e=h.getInt16(0,!0),n=2,u=0,a=0;do{if(e>0)while(e--)o[u++]=h.getUint8(n++);else{a=h.getUint8(n++);e=-e;while(e--)o[u++]=a}e=h.getInt16(n,!0);n+=2}while(n<r.rAs_);if(e!==-32768||u<o.length)throw Error("Unexpected end of mask RLE encoding");l=new Uint8Array(A);let g=0;for(let t=0;t<A;t++){if(t&7){g=o[t>>3];g<<=t&7}else g=o[t>>3];g&128&&(l[t]=1)}i.S7i_.BAs_=l;r.IAs_=o;s+=r.rAs_}i.ptr=s;i.mask=r;return!0}static zAs_(i,s,e){let A=s.ptr;const n=s.FAs_,h=n.YAs_,r=n.width*n.height,o=n.sAs_,l=n.UAs_*t.kAs_.cns_(o)*h;let u;const a=s.S7i_.BAs_;if(e===Uint8Array)u=new Uint8Array(i,A,l);else{const t=new ArrayBuffer(l),s=undefined;new Uint8Array(t).set(new Uint8Array(i,A,l));u=new e(t)}if(u.length===r*h)s.S7i_.dAs_=u;else{s.S7i_.dAs_=new e(r*h);let t=0,i,A=0;if(h>1)for(let e=0;e<h;e++){A=e*r;for(i=0;i<r;i++)a[i]&&(s.S7i_.dAs_[A+i]=u[t++])}else for(i=0;i<r;i++)a[i]&&(s.S7i_.dAs_[i]=u[t++])}A+=l;s.ptr=A;return!0}static fns_(i,s){const e=Utt,A=new DataView(i,s.ptr,16);s.ptr+=16;const n=undefined;if(A.getInt32(0,!0)<2)throw Error("unsupported Huffman version");const h=A.getInt32(4,!0),r=A.getInt32(8,!0),o=A.getInt32(12,!0);if(r>=o)return null;const l=new Uint32Array(o-r);t.kAs_.Cns_(i,s,l);const u=[];let a,g,c,I;for(a=r;a<o;a++){g=a-(a<h?0:h);u[g]={Rs_:l[a-r],dns_:null}}const f=i.byteLength-s.ptr,C=Math.ceil(f/4),d=new ArrayBuffer(C*4),B=undefined;new Uint8Array(d).set(new Uint8Array(i,s.ptr,f));const w=new Uint32Array(d);let Q=0,E,p=0;E=w[0];for(a=r;a<o;a++){g=a-(a<h?0:h);I=u[g].Rs_;if(I>0){u[g].dns_=E<<Q>>>32-I;if(32-Q>=I){Q+=I;if(Q===32){Q=0;p++;E=w[p]}}else{Q+=I-32;p++;E=w[p];u[g].dns_|=E>>>32-Q}}}let m=0,y=0;const D=new Ttt;for(a=0;a<u.length;a++)u[a]!==void 0&&(m=Math.max(m,u[a].Rs_));y=m>=e?e:m;const M=[];let v,b,N,S,G,R;for(a=r;a<o;a++){g=a-(a<h?0:h);I=u[g].Rs_;if(I>0){v=[I,g];if(I<=y){b=u[g].dns_<<y-I;N=1<<y-I;for(c=0;c<N;c++)M[b|c]=v}else{b=u[g].dns_;R=D;for(S=I-1;S>=0;S--){G=b>>>S&1;if(G){R.right||(R.right=new Ttt);R=R.right}else{R.left||(R.left=new Ttt);R=R.left}S!==0||R.val||(R.val=v[1])}}}}return{Bns_:M,wns_:y,Qns_:m,y6i_:D,fAs_:w,Ens_:p,pns_:Q}}static jAs_(t,i,s){const e=i.FAs_,A=e.YAs_,n=i.FAs_.height,h=i.FAs_.width,r=h*n,o=this.fns_(t,i),l=o.Bns_,u=o.y6i_,a=o.fAs_;let g=o.Ens_,c=o.pns_;const I=o.wns_,f=o.Qns_,C=i.FAs_.sAs_===0?128:0;let d,B,w;const Q=i.S7i_.BAs_;let E,p,m,y,D,M,v,b=0;if(c>0){g++;c=0}let N=a[g];const S=i.XAs_===1,G=new s(r*A);let R=G,k;for(k=0;k<e.YAs_;k++){if(A>1){R=new s(G.buffer,r*k,r);b=0}if(i.FAs_.UAs_===h*n)for(M=0,y=0;y<n;y++)for(D=0;D<h;D++,M++){B=0;E=N<<c>>>32-I;p=E;if(32-c<I){E|=a[g+1]>>>64-c-I;p=E}if(l[p]){B=l[p][1];c+=l[p][0]}else{E=N<<c>>>32-f;p=E;if(32-c<f){E|=a[g+1]>>>64-c-f;p=E}d=u;for(v=0;v<f;v++){m=E>>>f-v-1&1;d=m?d.right:d.left;if(!d.left&&!d.right){B=d.val;c=c+v+1;break}}}if(c>=32){c-=32;g++;N=a[g]}w=B-C;if(S){w+=D>0?b:y>0?R[M-h]:b;w&=255;R[M]=w;b=w}else R[M]=w}else for(M=0,y=0;y<n;y++)for(D=0;D<h;D++,M++)if(Q[M]){B=0;E=N<<c>>>32-I;p=E;if(32-c<I){E|=a[g+1]>>>64-c-I;p=E}if(l[p]){B=l[p][1];c+=l[p][0]}else{E=N<<c>>>32-f;p=E;if(32-c<f){E|=a[g+1]>>>64-c-f;p=E}d=u;for(v=0;v<f;v++){m=E>>>f-v-1&1;d=m?d.right:d.left;if(!d.left&&!d.right){B=d.val;c=c+v+1;break}}}if(c>=32){c-=32;g++;N=a[g]}w=B-C;if(S){D>0&&Q[M-1]?w+=b:y>0&&Q[M-h]?w+=R[M-h]:w+=b;w&=255;R[M]=w;b=w}else R[M]=w}i.ptr=i.ptr+(g+1)*4+(c>0?4:0)}i.S7i_.dAs_=G}static Cns_(i,s,e,A,n){const h=s.FAs_,r=h.iAs_;let o=0;const l=new DataView(i,s.ptr,5),u=l.getUint8(0);o++;const a=u>>6,g=a===0?4:3-a,c=(u&32)>0,I=u&31;let f=0;if(g===1){f=l.getUint8(o);o++}else if(g===2){f=l.getUint16(o,!0);o+=2}else{if(g!==4)throw Error("Invalid valid pixel count type");f=l.getUint32(o,!0);o+=4}const C=2*h.eAs_;let d,B,w,Q,E,p,m,y,D;const M=h.YAs_>1?h.ens_[n]:h.PAs_;if(c){s.TAs_.lut++;y=l.getUint8(o);o++;Q=Math.ceil((y-1)*I/8);E=Math.ceil(Q/4);B=new ArrayBuffer(E*4);w=new Uint8Array(B);s.ptr+=o;w.set(new Uint8Array(i,s.ptr,Q));m=new Uint32Array(B);s.ptr+=Q;D=0;while(y-1>>>D)D++;Q=Math.ceil(f*D/8);E=Math.ceil(Q/4);B=new ArrayBuffer(E*4);w=new Uint8Array(B);w.set(new Uint8Array(i,s.ptr,Q));d=new Uint32Array(B);s.ptr+=Q;p=r>=3?t.nns_.ons_(m,I,y-1,A,C,M):t.nns_.hns_(m,I,y-1,A,C,M);r>=3?t.nns_.rns_(d,e,D,f,p):t.nns_.gAs_(d,e,D,f,p)}else{s.TAs_.qAs_++;D=I;s.ptr+=o;if(D>0){Q=Math.ceil(f*D/8);E=Math.ceil(Q/4);B=new ArrayBuffer(E*4);w=new Uint8Array(B);w.set(new Uint8Array(i,s.ptr,Q));d=new Uint32Array(B);s.ptr+=Q;r>=3?A==null?t.nns_.uns_(d,e,D,f):t.nns_.rns_(d,e,D,f,!1,A,C,M):A==null?t.nns_.lns_(d,e,D,f):t.nns_.gAs_(d,e,D,f,!1,A,C,M)}}}static ZAs_(i,s,e){const A=s.FAs_,n=A.width,h=A.height,r=A.gns_,o=A.sAs_,l=t.kAs_.cns_(o),u=Math.ceil(n/r),a=Math.ceil(h/r);s.S7i_.hAs_=a;s.S7i_.nAs_=u;s.S7i_.ptr=0;let g=0,c=0,I=0,f=0,C=0,d=0,B=0,w=0,Q=0,E=0,p=0,m=0,y=0,D=0,M=0,v=0,b,N,S,G,R;const k=new e(r*r),F=h%r||r,x=n%r||r;let L,U;const Y=A.YAs_;let T;const K=s.S7i_.BAs_;let H=s.S7i_.dAs_;for(I=0;I<a;I++){C=I!==a-1?r:F;for(f=0;f<u;f++){d=f!==u-1?r:x;p=I*n*r+f*r;m=n-d;for(T=0;T<Y;T++){Y>1&&(H=new e(s.S7i_.dAs_.buffer,n*h*T*l,n*h));B=i.byteLength-s.ptr;b=new DataView(i,s.ptr,Math.min(10,B));v=0;w=b.getUint8(0);v++;Q=w>>6&255;E=w>>2&15;if(E!==(f*r>>3&15))throw Error("integrity issue");R=w&3;if(R>3){s.ptr+=v;throw Error("Invalid block encoding ("+R+")")}if(R===2){s.TAs_.constant++;s.ptr+=v}else if(R===0){s.TAs_.HAs_++;s.ptr+=v;y=C*d*l;D=i.byteLength-s.ptr;y=y<D?y:D;N=new ArrayBuffer(y%l==0?y:y+l-y%l);S=new Uint8Array(N);S.set(new Uint8Array(i,s.ptr,y));G=new e(N);M=0;if(K)for(g=0;g<C;g++){for(c=0;c<d;c++){K[p]&&(H[p]=G[M++]);p++}p+=m}else for(g=0;g<C;g++){for(c=0;c<d;c++)H[p++]=G[M++];p+=m}s.ptr+=M*l}else{L=t.kAs_.mns_(o,Q);U=t.kAs_.yns_(v,L,b);v+=t.kAs_.cns_(L);if(R===3){s.ptr+=v;s.TAs_.JAs_++;if(K)for(g=0;g<C;g++){for(c=0;c<d;c++){K[p]&&(H[p]=U);p++}p+=m}else for(g=0;g<C;g++){for(c=0;c<d;c++)H[p++]=U;p+=m}}else{s.ptr+=v;t.kAs_.Cns_(i,s,k,U,T);v=0;if(K)for(g=0;g<C;g++){for(c=0;c<d;c++){K[p]&&(H[p]=k[v++]);p++}p+=m}else for(g=0;g<C;g++){for(c=0;c<d;c++)H[p++]=k[v++];p+=m}}}}}}}static $es_(i){return{tAs_:i.FAs_.tAs_,iAs_:i.FAs_.iAs_,sAs_:i.FAs_.sAs_,height:i.FAs_.height,width:i.FAs_.width,UAs_:i.FAs_.UAs_,gns_:i.FAs_.gns_,_As_:i.FAs_._As_,eAs_:i.FAs_.eAs_,yAs_:t.kAs_.Dns_(i.FAs_.sAs_),AAs_:i.AAs_,mask:i.mask?{rAs_:i.mask.rAs_}:null,S7i_:{nAs_:i.S7i_.nAs_,hAs_:i.S7i_.hAs_,maxValue:i.FAs_.PAs_,minValue:i.FAs_.VAs_,oAs_:i.oAs_}}}static OAs_(t){const i=t.FAs_.PAs_,s=t.FAs_.YAs_,e=t.FAs_.height*t.FAs_.width,A=e*s;let n,h,r=0;const o=t.S7i_.BAs_;if(o)if(s>1)for(n=0;n<s;n++){r=n*e;for(h=0;h<e;h++)o[h]&&(t.S7i_.dAs_[r+h]=i)}else for(h=0;h<e;h++)o[h]&&(t.S7i_.dAs_[h]=i);else if(t.S7i_.dAs_.fill)t.S7i_.dAs_.fill(i);else for(h=0;h<A;h++)t.S7i_.dAs_[h]=i}static xAs_(t){switch(t){case 0:return Int8Array;case 1:return Uint8Array;case 2:return Int16Array;case 3:return Uint16Array;case 4:return Int32Array;case 5:return Uint32Array;case 6:return Float32Array;case 7:return Float64Array;default:return Float32Array}}static Dns_(t){switch(t){case 0:return"S8";case 1:return"U8";case 2:return"S16";case 3:return"U16";case 4:return"S32";case 5:return"U32";case 6:return"F32";case 7:return"F64";default:return"F32"}}static Ans_(t,i){if(i==null)return!1;switch(t){case 0:return i>=-128&&i<=127;case 1:return i>=0&&i<=255;case 2:return i>=-32768&&i<=32767;case 3:return i>=0&&i<=65536;case 4:return i>=-2147483648&&i<=2147483647;case 5:return i>=0&&i<=4294967296;case 6:return i>=-34027999387901484e22&&i<=34027999387901484e22;case 7:return i>=5e-324&&i<=17976931348623157e292;default:return!1}}static cns_(t){switch(t){case 0:case 1:return 1;case 2:case 3:return 2;case 4:case 5:case 6:return 4;case 7:return 8;default:return t}}static mns_(t,i){switch(t){case 2:case 4:return t-i;case 3:case 5:return t-2*i;case 6:return i===0?t:i===1?2:1;case 7:return i===0?t:t-2*i+1;default:return t}}static yns_(t,i,s){switch(i){case 0:return s.getInt8(t);case 1:return s.getUint8(t);case 2:return s.getInt16(t,!0);case 3:return s.getUint16(t,!0);case 4:return s.getInt32(t,!0);case 5:return s.getInt32(t,!0)>>>0;case 6:return s.getFloat32(t,!0);case 7:return s.getFloat64(t,!0);default:throw Error("the decoder does not understand this pixel type")}}};return t}(),Htt=function(){var t;return class{static decode(t,i){if(!NA.aA_())throw Error("Big endian system is not supported.");let s=(i=i||{}).pAs_||0;const e=new Uint8Array(t,s,10),A=String.fromCharCode.apply(null,e);let n,h;if(A.trim()==="CntZImage"){n=Ytt;h=1}else{if(A.substring(0,5)!=="Lerc2")throw Error("Unexpected file identifier string: "+A);n=Ktt;h=2}let r=0,o;const l=t.byteLength-10,u=[];let a;const g={width:0,height:0,S7i_:[],mask:null,kMt_:[]};while(s<l){const e=n.decode(t,{pAs_:s,EAs_:o,vAs_:a,DAs_:r===0,bAs_:r===0,NAs_:!0,yAs_:i.yAs_||null,oAs_:i.oAs_||null});s=e.SAs_.AAs_;if(r===0){o=e.EAs_;a=e.vAs_;g.width=e.width;g.height=e.height;g.tns_=e.tns_||1;g.yAs_=e.SAs_.yAs_;g.mask=e.vAs_}h>1&&e.SAs_.mask&&e.SAs_.mask.rAs_>0&&u.push(e.vAs_);r++;g.S7i_.push(e.MAs_);g.kMt_.push({minValue:e.minValue,maxValue:e.maxValue,oAs_:e.oAs_,ins_:e.ins_})}let c,I,f;if(h>1&&u.length>1){f=g.width*g.height;g.Mns_=u;a=new Uint8Array(f);a.set(u[0]);for(c=1;c<u.length;c++){const t=u[c];for(I=0;I<f;I++)a[I]=a[I]&t[I]}g.vAs_=a}return g}}}();let qtt,Jtt;var Ptt=function(){let i=class t extends h8{constructor(t){(t=t?Es(t):{})["connector"]==null&&(t["connector"]=new V4);let i=null;if(t["colorprovider"]!=null){i=t["colorprovider"];t["colorprovider"]=null}let s=0;if(t["symboltilesize"]!=null){s=t["symboltilesize"];t["symboltilesize"]=null}super(t);this.x0_=null;this.vns_={};this.N4i_={};this.Cm_=i;this.bns_=s}query(t){const i=this.N4i_.url;if(!i||typeof i!="string")return this;const s=this.bns_||1,e=i.endsWith("/")?"":"/",A=(i+e).endsWith("ImageServer/")?"exportImage":"export",n=this.N4i_.e8i_.B5i_().w2i_();let h,r,o,l,u,a,g,c;if(s>1){const i=(t["right"]-t["left"])*(s/t["width"]),I=Math.round(this.N4i_.FMt_.width/i)||1,f=this.N4i_.FMt_.width/I,C=(t["bottom"]-t["top"])*(s/t["height"]),d=Math.round(this.N4i_.FMt_.height/C)||1,B=this.N4i_.FMt_.height/d,w=Math.floor((t["left"]-this.N4i_.FMt_.x)/f),Q=Math.ceil((t["right"]-this.N4i_.FMt_.x)/f),E=Math.floor((t["top"]-this.N4i_.FMt_.y)/B),p=Math.ceil((t["bottom"]-this.N4i_.FMt_.y)/B);o=this.N4i_.FMt_.x+w*f;l=this.N4i_.FMt_.x+(Q+1)*f;u=this.N4i_.FMt_.y+E*B;a=this.N4i_.FMt_.y+(p+1)*B;g=Q-w+1;c=p-E+1;const m=undefined,y=undefined;r="?bbox="+o+"%2C"+u+"%2C"+l+"%2C"+a+"&size="+g+"%2C"+c;h=e+A+r+"&transparent=true&imageSR="+n+"&bboxSR="+n+"&f=image&format=lerc&"+"renderingRule=%7B%22rasterFunction%22%3A%22Resample%22%2C%22rasterFunctionArguments%22%3A%7B%22ResamplingType%22%3A10%2C"+"%22InputCellSize%22%3A%7B%22x%22%3A"+1/I+"%2C%22y%22%3A"+1/d+"%7D%7D%7D";this.S4i_.send(this.R4i_(h),{responsetype:"arraybuffer",key:t["key"]},((t,i)=>{if(t)this.onError(t);else if(!this.Df_()){const t=this.Nns_(i,o,a,f,B);for(let i=0;i<t.length;++i){const s=c9.Cts_(t[i].Uui_(),this.N4i_.Vts_);s!=null&&(t[i].k9i_=s)}this.notify(g8.Z4i_,this,t)}}))}else{o=t["left"];l=t["right"];u=t["top"];a=t["bottom"];g=t["width"];c=t["height"];r="?bbox="+o+"%2C"+u+"%2C"+l+"%2C"+a+"&size="+g+"%2C"+c;h=e+A+r+"&transparent=true&imageSR="+n+"&bboxSR="+n+"&f=image&format=lerc";this.S4i_.send(this.R4i_(h),{responsetype:"arraybuffer",key:t["key"]},((t,i)=>{if(t)this.onError(t);else if(!this.Df_()){const t=this.Sns_(i),s=undefined;new df({url:t,alignment:dA.ne_,ax:(o+l)/2,ay:(u+a)/2,ispointingup:!0,width:l-o,height:u-a}).on(ff.PV_,this.oQ_())}}))}return this}Nns_(t,i,s,e,A){const n=Htt.decode(t),h=n.width,r=n.height,o=n.S7i_,l=n.mask,u=[];for(let t=s-A/2,n=0,a=0;a<r;t-=A,a++)for(let s=i+e/2,A=0;A<h;s+=e,A++){l&&!l[n]||u.push(new w4({attributes:{Magnitude:o[0]&&o[0][n],Direction:o[1]&&o[1][n]},geometry:{x:s,y:t}}));n++}return u}Sns_(t){const i=Htt.decode(t),s=i.width,e=i.height,A=i.S7i_,n=i.mask;qtt=qtt!=null?qtt.setSize(s,e):fr.zw_({width:s,height:e,devicepixel:!0,contextattributes:{willReadFrequently:!0}});const h=qtt.eQ_(0,0,s,e),r=h.getData();let o,l,u,a,g;const c=s*e,I=A.length;if(I===1){u=i.kMt_[0].minValue;a=i.kMt_[0].maxValue;g=255/(a-u);if(n)for(l=0;l<c;l++)if(n[l]){o=this.getColor((A[0][l]-u)*g);r[l*4]=o.Is_();r[l*4+1]=o.Cs_();r[l*4+2]=o.fs_();r[l*4+3]=o.ds_()}else{r[l*4]=0;r[l*4+1]=0;r[l*4+2]=0;r[l*4+3]=0}else for(l=0;l<c;l++){o=this.getColor((A[0][l]-u)*g);r[l*4]=o.Is_();r[l*4+1]=o.Cs_();r[l*4+2]=o.fs_();r[l*4+3]=o.ds_()}}else if(I>=3){u=Math.min.apply(null,i.kMt_.map((function(t){return t.minValue})));a=Math.max.apply(null,i.kMt_.map((function(t){return t.maxValue})));g=255/(a-u);if(n)for(l=0;l<c;l++)if(n[l]){r[l*4]=(A[0][l]-u)*g;r[l*4+1]=(A[1][l]-u)*g;r[l*4+2]=(A[2][l]-u)*g;r[l*4+3]=255}else{r[l*4]=0;r[l*4+1]=0;r[l*4+2]=0;r[l*4+3]=0}else for(l=0;l<c;l++){r[l*4]=(A[0][l]-u)*g;r[l*4+1]=(A[1][l]-u)*g;r[l*4+2]=(A[2][l]-u)*g;r[l*4+3]=255}}qtt.km_(h,0,0);return qtt.SM_()}oQ_(){this.x0_==null&&(this.x0_=(t,i,s)=>{i.off(ff.PV_,this.x0_);this.notify(ff.PV_,i,s)});return this.x0_}getColor(t){t=Math.round(t);if(!this.vns_[t]){let i=this.Cm_||Jtt;if(i==null){Jtt=new bo({values:[0,1],colors:["black","white"]});i=Jtt}this.vns_[t]=i.getColor(t/255)}return this.vns_[t]}};i=t([_s("geotoolkit.map.sources.formats.Lerc")],i);return i}();var Vtt=function(){let i=class t extends p8{constructor(t){super(t=qi(t,{format:new Ptt({symboltilesize:50})}))}};i=t([_s("geotoolkit.map.sources.Lerc")],i);return i}();var Ott=Ci(function(){let i=class t extends q4{constructor(t){super();this.S4i_=t&&t["connector"]||new V4(t);this.x0_=t&&t["callback"]||null}send(t,i,s){this.S4i_.send(t,i,((t,i)=>{typeof this.x0_=="function"&&(i=this.x0_(t,i));s(t,i)}))}abort(t){this.S4i_.abort(t);return this}f4i_(){return this.S4i_.f4i_()}};i=t([_s("geotoolkit.map.sources.connectors.Proxy")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpc0xvYWRpbmciOiJmNGlfIn19fSAg");let Wtt,ztt;const Xtt=function(t,i){if(!t&&!i)return null;const s=OA.Ai_().gn_("px"),e=OA.Ai_().gn_("m");return new yQ({minscale:t>0?e.wn_(1/t,s):null,minscaleinclusive:!1,maxscale:i>0?e.wn_(1/i,s):null,maxscaleinclusive:!1})};var jtt=Ci(function(){var i;let s=i=class t{constructor(t){this.ytt_=t&&t["httpservice"]?t["httpservice"]:Wtt||FB.Ai_().u1_();this.Gns_=new V4({httpservice:this.ytt_})}load(t,i){const s=typeof i=="string"?this.Gns_:new Ltt({data:i}),e=typeof i=="string"?i:"";return new Promise(((i,A)=>{s.send(e,null,((s,e)=>{if(t.Df_())return;if(s){A(s);return}let n;if(typeof e=="string")try{n=JSON.parse(e)}catch(t){A(t);return}else n=e;const h=this.parse(n),r=[];for(let i=0;i<h.length;++i){t.Rns_(h[i]);r.push(h[i].load())}Promise.all(r).then((function(){i(t,h)}),(function(){A(new Error)}))}))}))}static Ai_(t){if(t)return new i(t);i.Gf_==null&&(i.Gf_=new i);return i.Gf_}static load(t,s,e){const A=undefined;return i.Ai_(e!=null?{httpservice:e}:null).load(t,s)}parse(t){const s=new lu(t&&t["baseMap"]&&t["baseMap"]["baseMapLayers"]||[],t&&t["operationalLayers"]||[]),e=[],A=[];while(s.Hs_()){const t=s.next();let n,h;const r=t.hasOwnProperty("opacity")?t["opacity"]:1,o=!t.hasOwnProperty("visibility")||t["visibility"],l=t["layerDefinition"]||{},u=t["layerType"]||t["type"];switch(u){case"ArcGISImageServiceVectorLayer":n=new S9({id:t["id"],name:t["title"],visible:o,url:t["url"],alpha:r,source:new Vtt({mode:I8.A8i_,loader:this.kns_(t,w9),format:new Ptt({symbolTileSize:t["symbolTileSize"],connector:new V4({httpservice:this.ytt_})})}),layerfilter:Xtt(t["minScale"],t["maxScale"])});break;case"ArcGISImageServiceLayer":case"ArcGISMapServiceLayer":n=new X9({id:t["id"],name:t["title"],visible:o,url:t["url"],alpha:r,source:new J9({format:new x9({connector:new t9({connector:new x6,tokenconnector:new V4({httpservice:this.ytt_})})}),loader:new L9({connector:new t9({httpservice:this.ytt_})})}),layerfilter:Xtt(t["minScale"],t["maxScale"])});t["visibleLayers"]!=null&&n.Iis_(t["visibleLayers"]);break;case"ArcGISTiledImageServiceLayer":case"ArcGISTiledMapServiceLayer":n=new $9({id:t["id"],name:t["title"],visible:o,loader:new Z9,url:t["url"],alpha:r,source:new j9({format:new U6({connector:new L6({httpservice:this.ytt_}),formatterfunction:function(t,i,s){return"/tile/"+t+"/"+i+"/"+s}})}),layerfilter:Xtt(t["minScale"],t["maxScale"])});break;case"WebTiledLayer":n=new $9(this.Fns_(t["templateUrl"],t["subDomains"],{id:t["id"],name:t["title"],visible:o,alpha:r,layerfilter:Xtt(t["minScale"],t["maxScale"])}));break;case"WMS":n=new Gtt({id:t["id"],name:t["title"],visible:o,url:t["url"],alpha:r,layers:t["visibleLayers"]||null,source:new Stt({format:new Dtt({geometryconnector:new V4({httpservice:this.ytt_})}),loader:new vtt({connector:new V4({httpservice:this.ytt_})})}),layerfilter:Xtt(t["minScale"],t["maxScale"])});break;case"ArcGISFeatureLayer":t["url"]!=null?n=new k9({id:t["id"],name:t["title"],visible:o,source:new p9({format:new d9({connector:new t9({httpservice:this.ytt_})}),loader:this.kns_(t,w9)}),alpha:r,url:t["url"],layerfilter:Xtt(l["minScale"],l["maxScale"])}):h="ArcGISFeatureLayer with featureCollection are not supported!!!";break;case"KML":n=new ntt({id:t["id"],name:t["title"],visible:o,system:B3.U2i_,alpha:r,url:t["url"],source:new Att({format:new ett({connector:new V4({httpservice:this.ytt_})})}),layerfilter:Xtt(t["minScale"],t["maxScale"])});break;case"OpenStreetMap":n=new $9({id:t["id"],name:t["title"],visible:o,url:"//{a-c}.tile.openstreetmap.org/",formatterfunction:function(t,i,s){return t+"/"+s+"/"+i+".png"},layerfilter:Xtt(t["minScale"],t["maxScale"])});break;case"CSV":const s=t["locationInfo"];n=new C7({id:t["id"],name:t["title"],visible:o,delimiter:t["columnDelimiter"],alpha:r,annotations:{visible:t["showLabels"]||!1},source:new f7({idfield:l["objectIdField"],latitudefield:s&&s["latitudeFieldName"],longitudefield:s&&s["longitudeFieldName"],url:t["url"],loader:new w9({connector:new Ltt({data:l})}),format:new I7({connector:new V4({httpservice:this.ytt_})})})});break;case"ArcGISStreamLayer":n=new Itt({id:t["id"],name:t["title"],visible:o,url:t["url"],alpha:r,source:new ctt({format:new att({connector:new t9({tokenconnector:new V4({httpservice:this.ytt_}),connector:new utt})}),loader:new gtt({connector:new t9({httpservice:this.ytt_})})}),layerfilter:Xtt(l["minScale"],l["maxScale"])});break;case"GeoRSS":const e=c9.ets_(t["pointSymbol"]),A=c9.ets_(t["lineSymbol"]),a=c9.ets_(t["polygonSymbol"]),g=[];if(e!=null){g.push({featureclassname:w4.D_(),template:e});g.push({featureclassname:W4.D_(),template:e})}if(A!=null){g.push({featureclassname:X4.D_(),template:A});g.push({featureclassname:Z4.D_(),template:A})}if(a!=null){g.push({featureclassname:$4.D_(),template:a});g.push({featureclassname:i8.D_(),template:a})}n=new S7({id:t["id"],name:t["title"],visible:o,url:t["url"],alpha:r,templates:g,source:new N7({format:new b7({connector:new V4({httpservice:this.ytt_})})}),layerfilter:Xtt(t["minScale"],t["maxScale"])});break;case"BingMapsAerial":case"BingMapsRoad":case"BingMapsHybrid":if(ztt==null)h="Bing Maps API key is not set. Use "+i.D_()+".setBingMapsKey() to support Bing layers in Webmap.";else{const i={BingMapsAerial:a3.h2i_,BingMapsRoad:a3.f2i_,BingMapsHybrid:a3.r2i_};n=new l7({id:t["id"],name:t["title"],visible:o,imageryset:i[u],alpha:r,key:ztt,layerfilter:Xtt(t["minScale"],t["maxScale"])})}break;case"VectorTileLayer":n=new ftt({id:t["id"],name:t["title"],visible:o,source:new X6({styleurl:t["styleUrl"],format:new Y6({connector:new V4({httpservice:this.ytt_})}),loader:new F6({connector:new V4({httpservice:this.ytt_})})}),alpha:r,annotations:{visible:!0,filter:new q8},layerfilter:Xtt(t["minScale"],t["maxScale"])});let c;if(t["styleUrl"]==null)h="VectorTile layer hasn't styleUrl property.";else if(typeof t["styleUrl"]=="string")this.Gns_.send(t["styleUrl"],null,function(s,e){if(s)ki(s);else{c=F6.$9i_(e);c!=null&&this.Q8i_(i.xns_(c,t["styleUrl"]))}}.bind(n));else if(typeof t["styleUrl"]=="object"){c=F6.$9i_(t["styleUrl"]);c!=null&&n.Q8i_(i.xns_(c,t["styleUrl"]))}else h="VectorTile layer has wrong styleUrl property.";break;case"WFS":const I=t["wfsInfo"]||{},f=l["drawingInfo"]||{},C=c9.cts_(f["labelingInfo"]),d=c9.parse(l,t["url"],C);n=new mtt({id:t["id"],name:t["title"],visible:o,alpha:r,url:t["url"],source:new ptt({format:new dtt({connector:new V4({httpservice:this.ytt_})}),loader:new Ett({connector:new V4({httpservice:this.ytt_})})}),featuretypes:I["name"],layerfilter:Xtt(t["minScale"],t["maxScale"])});d&&d.S3_&&n.Cvt_().on(g8.Z4i_,function(t,i,s){for(let t=0;t<s.length;t++)s[t].k9i_=c9.Cts_(s[t].Uui_(),this)}.bind(d));break}if(n!=null){t["isReference"]?A.push(n):e.push(n);t["customParameters"]!=null&&n.Cvt_().G4i_(t["customParameters"])}else{h||(h=t["layerType"]+" layer type is not supported!!!");ki(h)}}return e.concat(A)}static Lns_(t){ztt=t}static Uns_(t){Wtt=t}Fns_(t,i,s){const e=[t.indexOf("{level}"),t.indexOf("{col}"),t.indexOf("{row}")].filter((function(t){return t!==-1}));if(e.length===0)return s;const A=Math.min.apply(null,e),n=t.substr(0,A),h=t.substr(A);s["format"]=new U6({connector:new L6({httpservice:this.ytt_}),formatterfunction:function(t,i,s){return h.replace("{level}",""+t).replace("{col}",""+s).replace("{row}",""+i)}});s["url"]=Array.isArray(i)?i.map((function(t){return n.replace("{subDomain}",t)})):[n];return s}static xns_(t,i){if(t.startsWith("http")||t.startsWith("//"))return t;const s=i.split("/"),e=t.split("/"),A=s[s.length-1];(!A||A.indexOf(".")>=0)&&s.pop();for(let t=0;t<e.length;t++)e[t]===".."?s.pop():e[t]!==""&&e[t]!=="."&&s.push(e[t]);return s.join("/")}kns_(t,i){if(!t||!t["layerDefinition"]||!t["layerDefinition"]["drawingInfo"])return new i;const s=t["layerDefinition"]["drawingInfo"];return new i({connector:new Ott({connector:new V4({httpservice:this.ytt_}),callback:function(t,i){if(t||!i)return i;let e;if(typeof i=="string")try{e=JSON.parse(i)}catch(t){return i}else e=i;s!=null&&(e["drawingInfo"]=s);return e}})})}};s.Gf_=null;s=i=t([_s("geotoolkit.map.util.WebMap")],s);return s}(),2,"eyJnZXRJbnN0YW5jZSI6IkFpXyIsInNldEJpbmdNYXBzS2V5IjoiTG5zXyIsInNldEh0dHBSZXF1ZXN0U2VydmljZSI6IlVuc18iLCJnZXRDbGFzc05hbWUiOiJEXyJ9");var Ztt=Ci({Sphere:"Sphere",Yns_:"Flat"},2,"eyJGbGF0IjoiWW5zXyJ9");const _tt=new lA,$tt=new lA,tit=6371e3,iit=OA.Ai_().gn_("m"),sit=function(t,i,s){const e=t+Math.floor((i-t)/s)*s,A=e+s;return i-e>A-i?A:e},eit=function(t,i,s,e){const A=Math.cos(s),n=A*Math.cos(e),h=A*Math.sin(e),r=Math.sin(s),o=Math.cos(i),l=Math.sin(i),u=n*o+h*l,a=-n*l+h*o,g=-r*Math.cos(t)+u*Math.sin(t);return Math.PI-Math.atan2(a,g)},Ait=function(t,i){const s=undefined,e=1/298.257223563,A=e*(2-e),n=6378137*(1-e),h=(-1/3+(-31/180-59/560*A)*A)*A,r=(17/360+61/1260*A)*A*A,o=-383/45360*A*A*A,l=t.length;let u=0,a,g=0,c=0,I=0,f=0;for(let s=0;s<l;s++){let e=NA.degToRad(t[s]);const A=NA.degToRad(i[s]);e+=h*Math.sin(2*e)+r*Math.sin(4*e)+o*Math.sin(6*e);if(s>0){const t=eit(g,c,e,A);if(s===1)u=t;else{a=.5-(f-t)/2/Math.PI;I+=a-Math.round(a)}f=eit(e,A,g,c)}g=e;c=A}a=.5-(f-u)/2/Math.PI;I+=a-Math.round(a);return 2*Math.PI*(1-Math.abs(I))*n*n*(1+(2/3+(3/5+4/7*A)*A)*A)};var nit=Ci(function(){let i=class t extends mL{constructor(t){super(t=qi(t,{unit:"km",system:B3.L2i_}));this.ai_=OA.Ai_().gn_(t["unit"]);this.Tns_=X3.sx_().l5i_(t["system"]);this.hq_=null}hZt_(t,i,s,e){const A=this.Tns_.E2i_();t=A.we_()+(t-A.we_()+3*A.Ie_())%A.Ie_();s=A.we_()+(s-A.we_()+3*A.Ie_())%A.Ie_();this.Tns_.uI_(t,i,_tt);this.Tns_.uI_(s,e,$tt);const n=NA.degToRad(_tt.getY()),h=NA.degToRad($tt.getY()),r=NA.degToRad(_tt.getX()),o=undefined,l=(NA.degToRad($tt.getX())-r)/2,u=(h-n)/2,a=Math.sin(u),g=Math.sin(l),c=a*a+Math.cos(n)*Math.cos(h)*g*g,I=2*tit*Math.atan2(Math.sqrt(c),Math.sqrt(1-c));return iit.wn_(I,this.ai_)}$jt_(t,i){t=t||this.Bt_();i=i||this.wt_();const s=t.length;if(s<3)return null;let e;const A=[],n=this.Kns_().E2i_();for(e=0;e<s;e++){const s=n.we_()+(t[e]-n.we_()+3*n.Ie_())%n.Ie_();A.push(new ZA.$r_(s,i[e]))}const h=ZA.cg_.Oa_(A,ZA.oo_.lo_);let r=0;for(e=0;e<h.length;e++){const t=h[e],i=[],s=[];for(let e=0;e<t.length;e++){this.Tns_.uI_(t[e].X,t[e].Y,_tt);s.push(_tt.x);i.push(_tt.y)}i.push(i[0]);s.push(s[0]);const A=Ait(i,s);if(A<0){this.PP_().iQ_(null);return null}r+=A}r=iit.wn_(r,this.ai_);r=iit.wn_(r,this.ai_);this.PP_().iQ_(this.hq_);return r}push(t){const i=this.Bt_(),s=this.Tns_.E2i_();switch(t.Dkt_()){case Lk.vJt_:const e=t,A=this.getSize();e.getPoint().setX(sit(e.getX(),i[A-1],s.Ie_()));break;case Lk.bJt_:const n=t,h=n.getIndex(),r=i[h],o=r+n.EI_(),l=sit(o,r,s.Ie_());l!==o&&t.merge(new Mx(l-o,0,h));break}return super.push(t)}wjt_(t){const i=this.getSize();this.Xjt_().clear();if(i>0&&t!=null&&!this.isActive()&&this.hjt_(t)==null&&this.Hzt_(t)<=0){const s=this.ut_(),e=this.intersect(t);if(e!=null){const t=s.nI_(e.x,e.y);this.jjt_().gR_(t);this.iXt_().GY_(this.jjt_())}else{this.iXt_().removeChild(this.jjt_());if((this.lPt_()&xk.CJt_)!=0){const e=this.Bt_(),A=this.wt_(),n=this.Tns_.E2i_(),h=s.nI_(e[0],A[0]),r=this.bFt_(this.mgt_(),t),o=sit(r.x,e[i-1],n.Ie_());this.Xjt_().moveTo(h.getX(),h.getY()).lineTo(o,r.getY());if(i>1){const t=s.nI_(e[i-1],A[i-1]);this.Xjt_().moveTo(t.getX(),t.getY()).lineTo(o,r.getY())}}}}else this.iXt_().removeChild(this.jjt_());this.Xjt_().td_()}intersect(t){const i=t.Fkt_(),s=this.if_(),e=this.Tns_.E2i_(),A=s.rn_(e);let n=super.intersect(t);if(n==null){i.translate(A.Ie_(),0);n=super.intersect(t);i.translate(-A.Ie_(),0)}if(n==null){i.translate(-A.Ie_(),0);n=super.intersect(t);i.translate(A.Ie_(),0)}return n}dt_(t){if((t=Es(t))==null)return this;super.dt_(t);this.hq_=this.PP_().ct_();t["unit"]!==void 0&&(this.ai_=OA.Ai_().gn_(t["unit"]));t["system"]!==void 0&&(this.Tns_=X3.sx_().l5i_(t["system"]));return this}N_(){const t=super.N_();t["unit"]=this.ai_;t["system"]=this.Tns_;return t}format(t){return super.format(t)+" "+this.ai_.fn_()+"<sup>2</sup>"}Kns_(){return this.Tns_}gn_(){return this.ai_}KD_(t){this.ai_=OA.Ai_().gn_(t);return this.update()}ct_(){return this.hq_}iQ_(t){this.hq_=t;return this.update()}};i=t([_s("geotoolkit.map.tools.editors.FlatArea")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRQcm9wZXJ0aWVzIjoiZHRfIiwiZ2V0UHJvcGVydGllcyI6Ik5fIn19fSAg");const hit=new lA,rit=new lA,oit=new lA,lit=new lA,uit=OA.Ai_().gn_("m"),ait=50,git=89,cit=6371e3,Iit=function(t,i,s,e){t=i+(t-i+e)%e;const A=Math.abs(s-t)+(t-i),n=Math.abs(s-(t-e))+(i-(t-e)),h=t+e-s+(t+e)-i;n<A&&n<h?t-=e:h<A&&h<n&&(t+=e);return NA.clamp(t,i,s)},fit=function(t,i,s,e,A){hit.vs_(i[e-1]+A,s[e-1]);rit.vs_(i[e]+A,s[e]);oit.vs_(i[e+1]+A,s[e+1]);lit.vs_(i[e+2]+A,s[e+2]);const n=LL.dZt_(t,hit,rit,oit,lit);return n?{x:n.Tgt_.getX()-A,y:n.Tgt_.getY()}:null},Cit=function(t,i,s){const e=i.x,A=i.y,n=i.Hns_,h=i.qns_,r=i.Jns_,o=i.Pns_;for(let i=1;i<e.length;i++)t.bezierCurveTo(n[i-1]+s,h[i-1],r[i-1]+s,o[i-1],e[i]+s,A[i])};var dit=function(){var i;let s=i=class t extends nit{constructor(t){super(t=qi(t,{node:new Yu({linestyle:{width:2,pixelsnapmode:!0}})}));this._x=[];this._y=[];this.Rti_=[]}update(){super.update();this.PP_().clear();const t=this.getSize();if(t>0){let s;const e=this.Kns_().E2i_(),A=[0,e.Ie_(),-e.Ie_()];for(let e=0;e<A.length;e++){let n=this._x[0]+A[e];this.PP_().moveTo(n,this._y[0]);for(let e=1;e<t;e++){s=this.Rti_[e-1]||i.$St_(n,this._y[e-1],this._x[e],this._y[e],this);Cit(this.PP_(),s,n-s.x[0]);n+=s.x[s.x.length-1]-s.x[0];this.PP_().lineTo(n,this._y[e]);this.Rti_[e-1]=s}if(this.en_()){s=i.$St_(n,this._y[t-1],this._x[0],this._y[0],this);Cit(this.PP_(),s,n-s.x[0])}}this.PP_().iQ_(this.getArea()>0?this.ct_():null)}this.PP_().td_();return this}wjt_(t){const s=this.Bt_(),e=this.wt_(),A=this.getSize();this.Xjt_().clear();if(A>0&&t!=null&&!this.isActive()&&this.hjt_(t)==null&&this.Hzt_(t)<=0){const n=this.ut_(),h=this.intersect(t);if(h!=null){const t=n.nI_(h.x,h.y);this.jjt_().gR_(t);this.iXt_().GY_(this.jjt_())}else{this.iXt_().removeChild(this.jjt_());if((this.lPt_()&xk.CJt_)!=0){const h=this.bFt_(this.mgt_(),t),r=n.nI_(s[0],e[0]);let o=i.$St_(r.getX(),r.getY(),h.getX(),h.getY(),this);this.Xjt_().moveTo(o.x[0],o.y[0]);Cit(this.Xjt_(),o,0);if(A>1){const t=n.nI_(s[A-1],e[A-1]);o=i.$St_(t.getX(),t.getY(),h.getX(),h.getY(),this);this.Xjt_().moveTo(o.x[0],o.y[0]);Cit(this.Xjt_(),o,0)}}}}else this.iXt_().removeChild(this.jjt_());this.Xjt_().td_()}intersect(t){const i=t.Fkt_(),s=this.Kns_().E2i_().Ie_(),e=this.dFt_(t)?this.fFt_():this.aFt_(),A=new mA(i.getX()-e,i.getY()-e,i.getX()+e,i.getY()+e);this.if_().gI_(A,A);const n=this.PP_().nt_(),h=n.getTags(),r=n.getX(),o=n.getY();let l;for(let t=0;t<n.getLength();t++){const i=n.getIndex(t);switch(h[t]){case LA.ZA_:l=1;break;case LA.jA_:l++;break;case LA._A_:const t=fit(A,r,o,i,0)||fit(A,r,o,i,s)||fit(A,r,o,i,-s);if(t)return{index:l,x:t.x,y:t.y}}}return null}apply(t){const i=this.Rti_,s=this.Bt_(),e=this.wt_();switch(t.Dkt_()){case Lk.Mk_:if(!this.PP_().getParent()){const t=this.mgt_().FY_(this.iXt_());this.mgt_().xY_(t,this.PP_())}case Lk.vJt_:const A=t;s.push(A.getX());e.push(A.getY());return this;case Lk.bJt_:const n=t;s[n.getIndex()]+=n.EI_();e[n.getIndex()]+=n.pI_();n.getIndex()>0&&(i[n.getIndex()-1]=null);n.getIndex()<i.length&&(i[n.getIndex()]=null);return this;case Lk.SJt_:const h=t;s.splice(h.getIndex(),1);e.splice(h.getIndex(),1);i.splice(h.getIndex(),1);h.getIndex()>0&&(i[h.getIndex()-1]=null);return this;case Lk.NJt_:const r=t;s.splice(r.getIndex(),0,r.getX());e.splice(r.getIndex(),0,r.getY());i.splice(r.getIndex(),0,null);r.getIndex()>0&&(i[r.getIndex()-1]=null);return this}return super.apply(t)}Bt_(){return this._x||[]}wt_(){return this._y||[]}getSize(){return this.Bt_().length}xkt_(t){super.xkt_(t);this.hq_=this.PP_().ct_();const i=this.PP_().nt_(),s=i.getTags(),e=i.getX(),A=i.getY();this._x=[];this._y=[];this.Rti_=[];for(let t=0;t<i.getLength();t++){const n=i.getIndex(t);switch(s[t]){case LA.ZA_:if(t!==0)return this.update();case LA.jA_:this._x.push(e[n]);this._y.push(A[n]);break}}return this.update()}WXt_(t){this.Rti_.length=0;this._x.length=0;this._y.length=0;this.PP_().at_(null);this.PP_().clear();return this.update()}en_(){return!0}static $St_(t,i,s,e,A){const n=A.Kns_().E2i_(),h=Math.pow(ait/A.if_().BI_(),2);t=n.we_()+(t-n.we_()+3*n.Ie_())%n.Ie_();s=n.we_()+(s-n.we_()+3*n.Ie_())%n.Ie_();const r=A.gn_().wn_(A.hZt_(t,i,s,e),uit);A.Kns_().uI_(t,i,hit);A.Kns_().uI_(s,e,rit);const o=NA.degToRad(hit.y),l=NA.degToRad(rit.y),u=NA.degToRad(hit.x),a=NA.degToRad(rit.x),g=Math.cos(o),c=Math.sin(o),I=Math.cos(l),f=Math.sin(l),C=Math.cos(u),d=Math.sin(u),B=Math.cos(a),w=Math.sin(a),Q=r/cit,E=Math.sin(Q);Math.abs(a-u)>Math.PI&&(s>t?s-=n.Ie_():s+=n.Ie_());const p=[t,s],m=[i,e],y=[0,1],D=Math.min(t,s),M=Math.max(t,s);let v,b,N,S,G,R;for(v=0;v<p.length-1;)if(m[v+1]===1/0)v+=2;else if(y[v+1]-y[v]<.001||m[v]<n.Ee_()&&m[v+1]<n.Ee_()||m[v]>n.pe_()&&m[v+1]>n.pe_()||lA.Gs_(p[v],m[v],p[v+1],m[v+1])<=h)v++;else{const t=(y[v]+y[v+1])/2,i=Math.sin((1-t)*Q)/E,s=Math.sin(t*Q)/E,e=i*g*C+s*I*B,h=i*g*d+s*I*w,r=i*c+s*f,o=NA.radToDeg(Math.atan2(r,Math.sqrt(e*e+h*h))),l=NA.radToDeg(Math.atan2(h,e));A.Kns_().transform(l,o,hit,!1);hit.x=Iit(hit.x,D,M,n.width);if(o>=git||o<-git||hit.y<n.Ee_()||hit.y>n.pe_()){p.splice(v+1,0,hit.x,hit.x,hit.x);m.splice(v+1,0,hit.y,1/0,hit.y);y.splice(v+1,0,t,t,t)}else{p.splice(v+1,0,hit.x);m.splice(v+1,0,hit.y);y.splice(v+1,0,t)}}const k=m.indexOf(1/0);if(k>=0){const t=m.lastIndexOf(1/0);p.splice(k,t-k+1);m.splice(k,t-k+1);b=Ju.pS_(p,m,0,k-1).getPoints();N=b["firstcontrolpointsx"];S=b["firstcontrolpointsy"];G=b["secondcontrolpointsx"];R=b["secondcontrolpointsy"];N.push((p[k]+p[k-1])/2);S.push((m[k]+m[k-1])/2);G.push((p[k]+p[k-1])/2);R.push((m[k]+m[k-1])/2);b=Ju.pS_(p,m,k,p.length-1).getPoints();N.push(...b["firstcontrolpointsx"]);S.push(...b["firstcontrolpointsy"]);G.push(...b["secondcontrolpointsx"]);R.push(...b["secondcontrolpointsy"])}else{b=Ju.pS_(p,m).getPoints();N=b["firstcontrolpointsx"];S=b["firstcontrolpointsy"];G=b["secondcontrolpointsx"];R=b["secondcontrolpointsy"]}return{x:p,y:m,Hns_:N,qns_:S,Jns_:G,Pns_:R}}};s=i=t([_s("geotoolkit.map.tools.editors.SphereArea")],s);return s}();const Bit=function(t,i,s){const e=t+Math.floor((i-t)/s)*s,A=e+s;return i-e>A-i?A:e},wit=function(t,i){let s=0,e=i.x.length-1;const A=i.x.slice(),n=i.y.slice();t.NI_(A,n,A.length);const h=[];for(let t=0;t<e;t++)h[t]=lA.Ss_(A[t],n[t],A[t+1],n[t+1]);let r=0,o=0;while(e-s>1)if(Math.abs(r+h[s]-o)<Math.abs(o+h[e-1]-r)){r+=h[s];s++}else{o+=h[e-1];e--}if(s===e)return{angle:0,ax:i.x[0],ay:i.y[0]};if(r>o+h[s])return{angle:Math.atan2(i.qns_[s]-i.y[s],i.Hns_[s]-i.x[s]),ax:i.x[s],ay:i.y[s]};if(o>r+h[s])return{angle:Math.atan2(i.y[e]-i.Pns_[s],i.x[e]-i.Jns_[s]),ax:i.x[e],ay:i.y[e]};const l=(o+h[s]-r)/2/h[s],u=1-l,a=l*i.Hns_[s]+u*i.x[s],g=l*i.qns_[s]+u*i.y[s],c=l*i.Jns_[s]+u*i.Hns_[s],I=l*i.Pns_[s]+u*i.qns_[s],f=l*c+u*a,C=l*I+u*g,d=l*(l*(l*i.x[e]+u*i.Jns_[s])+u*c)+u*f,B=l*(l*(l*i.y[e]+u*i.Pns_[s])+u*I)+u*C;return{angle:Math.atan2(B-C,d-f),ax:d,ay:B}};var Qit=Ci(function(){let i=class t extends dit{constructor(t){let i=null,s=ML.W_;if(t!=null){t["directionsymbol"]!=null&&(i=t["directionsymbol"]instanceof Ca?t["directionsymbol"]:new ma(t["directionsymbol"]));t["directionmode"]!=null&&(s=t["directionmode"])}super(t);this.aPt_=[];this._$_=[];this.eZt_=i||new ma({width:12,height:21,painter:gE,alignment:dA.ne_,sizeisindevicespace:!0,selectable:!1,linestyle:"black",fillstyle:"black"});this.AZt_=s}initialize(t){if(this.Bgt_===!0)return;super.initialize(t);this.lzt_=[];this.nZt_=new sI;const i=this.iXt_().FY_(this.Wjt_());this.iXt_().xY_(i,this.nZt_)}wjt_(t){const i=this.Bt_(),s=this.wt_(),e=this.getSize();this.Xjt_().clear();if(e>0&&t!=null&&!this.isActive()&&this.hjt_(t)==null&&this.Hzt_(t)<=0){const A=this.ut_(),n=this.intersect(t);if(n!=null){const t=n.index,e=undefined,h=(t>1?this.aPt_[t-2]:0)+this.hZt_(i[t-1],s[t-1],n.x,n.y),r=this.format(h),o=A.nI_(n.x,n.y),l=mL.tZt_(this,i[t-1],s[t-1],n.x,n.y,i[t],s[t]);this._Vt_().a_(r).gR_(o).SE_(l);this.jjt_().gR_(o);this.iXt_().GY_([this.jjt_(),this._Vt_()])}else{this.iXt_().removeChild([this.jjt_(),this._Vt_()]);if((this.lPt_()&xk.CJt_)!=0){const n=this.Tns_.E2i_(),h=this.bFt_(this.mgt_(),t),r=A.nI_(i[e-1],s[e-1]),o=Bit(h.x,i[e-1],n.Ie_()),l=dit.$St_(r.getX(),r.getY(),o,h.getY(),this);this.Xjt_().moveTo(l.x[0],l.y[0]);for(let t=1;t<l.x.length;t++)this.Xjt_().bezierCurveTo(l.Hns_[t-1],l.qns_[t-1],l.Jns_[t-1],l.Pns_[t-1],l.x[t],l.y[t])}}}else this.iXt_().removeChild([this.jjt_(),this._Vt_()]);this.Xjt_().td_()}update(){super.update();if(this._$_==null)return this;const t=this.getSize(),i=this.Bt_(),s=this.wt_(),e=this.ut_(),A=[],n=[];let h=0;const r=this.if_();this.aPt_=[];for(let o=1;o<t;o++){h+=this.hZt_(i[o-1],s[o-1],i[o],s[o]);const t=this._$_[o-1]||this._Vt_().clone(),l=this.format(h),u=e.nI_(i[o],s[o]),a=vL.GE_(this,o);t.a_(l).gR_(u).SE_(a);n.push(t);this.aPt_.push(h);this.rZt_(this.Rti_[o-1],r,A,ML.Mk_);this.rZt_(this.Rti_[o-1],r,A,ML.j_);this.rZt_(this.Rti_[o-1],r,A,ML.End)}if(n.length!==this._$_.length){this.Wjt_().removeChild(this._$_);this.Wjt_().GY_(n);this._$_=n}if(A.length!==this.lzt_.length){this.nZt_.removeChild(this.lzt_);this.nZt_.GY_(A);this.lzt_=A}return this}$jt_(t,i){return null}en_(){return!1}format(t){return this.jF_.format(t)+" "+this.gn_().fn_()}cPt_(){return this.aPt_.slice()}rZt_(t,i,s,e){if((this.AZt_&e)==0)return;const A=this.lzt_[s.length]||this.eZt_.clone();let n=NA.sign(i.sI_())*Math.PI/2,h,r;switch(e){case ML.Mk_:h=t.x[0];r=t.y[0];n-=Math.atan2(t.y[1]-t.y[0],t.x[1]-t.x[0]);A.SE_(dA.re_);break;case ML.j_:const s=wit(i,t);h=s.ax;r=s.ay;n-=s.angle;A.SE_(dA.ne_);break;case ML.End:const e=t.x.length-1;h=t.x[e];r=t.y[e];n-=Math.atan2(r-t.y[e-1],h-t.x[e-1]);A.SE_(dA.le_)}const o=Gn.FI_(n,h,r).DI_(i.rI_()).vI_(i),l=this.ut_().nI_(h,r);A.gR_(o.aI_(l,l));A.at_(o);s.push(A)}oZt_(t,i){if(this.getSize()<1)return null;const s=this.Bt_(),e=this.wt_(),A=this.cPt_(),n=A.length>0?A[A.length-1]:0;return this.hZt_(s[s.length-1],e[e.length-1],t,i)+n}dt_(t){if(t==null)return this;(t=Es(t))["directionmode"]!=null&&(this.AZt_=t["directionmode"]);t["directionsymbol"]!=null&&(t["directionsymbol"]instanceof Ca?this.eZt_=t["directionsymbol"]:this.eZt_.dt_(t["directionsymbol"]));return super.dt_(t)}N_(){const t=super.N_();t["directionmode"]=this.AZt_;t["directionsymbol"]=this.eZt_;return t}lZt_(){return this._$_}};i=t([_s("geotoolkit.map.tools.editors.SphereDistance")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRQcm9wZXJ0aWVzIjoiZHRfIiwiZ2V0UHJvcGVydGllcyI6Ik5fIn19fSAg");const Eit=new lA,pit=new lA,mit=6371e3,yit=OA.Ai_().gn_("m"),Dit=function(t,i,s){const e=t+Math.floor((i-t)/s)*s,A=e+s;return i-e>A-i?A:e};var Mit=function(){let i=class t extends vL{constructor(t){super(t=qi(t,{unit:"km",system:B3.L2i_}));this.ai_=OA.Ai_().gn_(t["unit"]);this.Tns_=X3.sx_().l5i_(t["system"])}hZt_(t,i,s,e){const A=this.Tns_.E2i_();t=A.we_()+(t-A.we_()+3*A.Ie_())%A.Ie_();s=A.we_()+(s-A.we_()+3*A.Ie_())%A.Ie_();this.Tns_.uI_(t,i,Eit);this.Tns_.uI_(s,e,pit);const n=NA.degToRad(Eit.getY()),h=NA.degToRad(pit.getY()),r=NA.degToRad(Eit.getX()),o=undefined,l=(NA.degToRad(pit.getX())-r)/2,u=(h-n)/2,a=Math.sin(u),g=Math.sin(l),c=a*a+Math.cos(n)*Math.cos(h)*g*g,I=2*mit*Math.atan2(Math.sqrt(c),Math.sqrt(1-c));return yit.wn_(I,this.ai_)}push(t){const i=this.Bt_(),s=this.Tns_.E2i_();switch(t.Dkt_()){case Lk.vJt_:const e=t,A=this.getSize();e.getPoint().setX(Dit(e.getX(),i[A-1],s.Ie_()));break;case Lk.bJt_:const n=t,h=n.getIndex(),r=i[h],o=this.wt_()[h],l=r+n.EI_(),u=o+n.pI_(),a=Dit(l,r,s.Ie_()),g=NA.clamp(u,s.Ee_(),s.pe_());a===l&&g===u||t.merge(new Mx(a-l,g-u,h));break}return super.push(t)}wjt_(t){const i=this.Bt_(),s=this.wt_(),e=this.getSize();this.Xjt_().clear();if(e>0&&t!=null&&!this.isActive()&&this.hjt_(t)==null&&this.Hzt_(t)<=0){const A=this.ut_(),n=this.intersect(t);if(n!=null){const t=n.index,e=undefined,h=(t>1?this.aPt_[t-2]:0)+this.hZt_(i[t-1],s[t-1],n.x,n.y),r=this.format(h),o=A.nI_(n.x,n.y),l=mL.tZt_(this,i[t-1],s[t-1],n.x,n.y,i[t],s[t]);this._Vt_().a_(r).gR_(o).SE_(l);this.jjt_().gR_(o);this.iXt_().GY_([this.jjt_(),this._Vt_()])}else{this.iXt_().removeChild([this.jjt_(),this._Vt_()]);if((this.lPt_()&xk.CJt_)!=0){const n=this.Tns_.E2i_(),h=A.nI_(i[e-1],s[e-1]),r=this.bFt_(this.mgt_(),t),o=Dit(r.x,i[e-1],n.Ie_());this.Xjt_().moveTo(h.getX(),h.getY()).lineTo(o,r.getY())}}}else this.iXt_().removeChild([this.jjt_(),this._Vt_()]);this.Xjt_().td_()}intersect(t){const i=t.Fkt_(),s=this.if_(),e=this.Tns_.E2i_(),A=s.rn_(e);let n=super.intersect(t);if(n==null){i.translate(A.Ie_(),0);n=super.intersect(t);i.translate(-A.Ie_(),0)}if(n==null){i.translate(-A.Ie_(),0);n=super.intersect(t);i.translate(A.Ie_(),0)}return n}format(t){return super.format(t)+" "+this.ai_.fn_()}Kns_(){return this.Tns_}gn_(){return this.ai_}KD_(t){this.ai_=OA.Ai_().gn_(t);return this.update()}};i=t([_s("geotoolkit.map.tools.editors.FlatDistance")],i);return i}();const vit=function(t,i,s){i.qit_(s,!0)},bit=function(t,i,s){i.qit_(s,!1)};var Nit=Ci(function(){let i=class t extends zL{constructor(t){t=qi(t,{unit:"km",wrapped:!0,system:B3.L2i_,pathmode:Ztt.Sphere},!0);const i=X3.sx_().l5i_(t["system"]),s=t["layer"];t["layer"]=new gm({wrapped:t["wrapped"],clipchild:!0,childspread:!0}).Lq_(i.E2i_()).on(rh.eC_,vit).on(rh.AC_,bit);super(t);this.ai_=OA.Ai_().gn_(t["unit"]);s.GY_(this.mgt_());this.Vns_(t["pathmode"])}Vns_(t){if(this.Ons_===t)return this;this.Ons_=t;this.VZt_();return this}Wns_(){return this.Ons_}KD_(t){const i=OA.Ai_().gn_(t);if(t==null||this.ai_===t)return this;this.ai_=i;const s=this.zJt_();(s instanceof nit||s instanceof Mit)&&s.KD_(i);return this}gn_(){return this.ai_}VZt_(){const t=this.e7_(),i={layer:this.mgt_(),editmode:this.lPt_(),unit:this.ai_,label:{},history:this.LPt_};this.PZt_()===Ck.ra_?this.Wns_()===Ztt.Sphere?this.APt_(new dit(i)):this.APt_(new nit(i)):this.Wns_()===Ztt.Sphere?this.APt_(new Qit(i)):this.APt_(new Mit(i));t!=null&&t.dispose();return this}};i=t([_s("geotoolkit.map.tools.Measure")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRQYXRoTW9kZSI6IlZuc18iLCJnZXRQYXRoTW9kZSI6Ilduc18iLCJzZXRVbml0IjoiS0RfIiwiZ2V0VW5pdCI6ImduXyJ9fX0g");var Sit=Ci({zns_:"LayerAdded",Xns_:"LayerRemoved",jns_:"LayersModified",XZt_:"onZoomStart",jZt_:"onZoomEnd",WFt_:"onDoubleClick",e4_:"onResize"},2,"eyJvbkxheWVyQWRkZWQiOiJ6bnNfIiwib25MYXllclJlbW92ZWQiOiJYbnNfIiwib25MYXllcnNNb2RpZmllZCI6Impuc18iLCJvblpvb21TdGFydCI6IlhadF8iLCJvblpvb21FbmQiOiJqWnRfIiwib25Eb3VibGVDbGljayI6IldGdF8iLCJvblJlc2l6ZSI6ImU0XyJ9"),Git=Ci({Zns_:"Done",_ns_:"Interrupted"},2,"eyJEb25lIjoiWm5zXyIsIkludGVycnVwdGVkIjoiX25zXyJ9");const Rit=256,kit=OA.Ai_().gn_("px");var Fit=Ci(function(){let i=class t extends _H{constructor(t){const i=(t=Pi(t,{model:null,north:void 0,south:void 0,east:void 0,west:void 0,annotationssizes:{west:0,east:0,north:0,south:0},tools:{horizontalscroll:{visible:!1},verticalscroll:{visible:!1}},bounds:new mA(0,0,300,300),border:{color:"white"},system:B3.L2i_,maplimits:void 0,layerscontainer:null,wrapped:!0,viewcache:!1,viewcachesize:{width:256,height:256},zoom:{min:0,max:1/0,speed:1.5,time:400,easing:De.Lt_},viewcachemode:kc.qT_,viewcachememorylimit:null,viewcacheasync:!1,tooltip:{divelement:null,offsetx:10,offsety:-10,alignment:dA.ie_,mode:CF.__,delay:10,max:1,autoupdate:!0},webmap:null,scaleunit:OA.Ai_().gn_("px")}))["layerscontainer"]!=null?t["layerscontainer"]:new sI;if(t["model"]==null)if(t["wrapped"]){const s=new gm({clipchild:!0,wrapped:!0});s.qit_(i,!0);t["model"]=s}else t["model"]=new sI;t["viewcache"]===!0&&i.gk_(new tI(t["viewcachesize"]["width"],t["viewcachesize"]["height"],t["viewcachemode"],t["viewcachememorylimit"],t["viewcacheasync"]));t["layerscontainer"]==null&&t["model"].xY_(0,i);super(t);this.$ns_=null;this.eis_=i;this.ths_=kit;this.ihs_=null;this.shs_=null;this.j6i_=null;this.ehs_=null;this.Ahs_=null;this.nhs_=null;const s=this.UU_["system"];this.Tns_=typeof s=="string"?X3.sx_().l5i_(s):s;this.LM_().kY_(!0);this.oN_(new UQ({alignment:dA.ne_,wrapped:this.UU_["wrapped"]}));this.x0_=()=>{this.hhs_()};let e=!1;this.rhs_=()=>{if(!e){e=!0;this.bgt_();e=!1}};this.ani_=()=>{this.bni_.s0t_()};this.ohs_=null;this.lhs_=null;this.uhs_=null;this.ahs_();this.setOptions(this.UU_);if(this.UU_["maplimits"]==null){this.shs_=this.Tns_.E2i_();this.rAi_(this.shs_)}}J5i_(t,i){return this.transformPoint(t,i,this.Tns_)}e9i_(t,i){return this.transformPoint(t,this.Tns_,i)}transformPoint(t,i,s){const e=i instanceof g3?i:X3.sx_().l5i_(i),A=s instanceof g3?s:X3.sx_().l5i_(s);if(e!=null&&A!=null){this.j6i_!=null&&this.j6i_.d5i_()===e&&this.j6i_.B5i_()===A||(this.j6i_=new Z3(e,A));return this.j6i_.transform(t)}return null}ghs_(t){t==null&&this.ehs_!=null&&this.ehs_.getParent().removeChild(this.ehs_);if(t instanceof df){this.ehs_!=null&&this.ehs_.getParent().removeChild(this.ehs_);this.ehs_=t;this.ehs_.SE_(dA.Ae_);this.ehs_.OG_(!0);this.ehs_.gR_(this.LM_().getBounds().Qe_(),this.LM_().getBounds().pe_());this.LM_().getParent().GY_(this.ehs_)}return this}chs_(){return this.ehs_}zoom(t,i,s){let e=t;if(this.UU_["zoom"]["min"]!==0||this.UU_["zoom"]["max"]!==1/0){const i=this.Ihs_(),s=1/(i*t);t<1&&s>this.UU_["zoom"]["max"]?e=1/(this.UU_["zoom"]["max"]*i):t>1&&s<this.UU_["zoom"]["min"]&&(e=1/(this.UU_["zoom"]["min"]*i))}this.O4_(e,e,i,s);return this}fhs_(t,i){this.LM_().Ad_();i&&(t/=this.Chs_());t=this.ths_.wn_(t,kit);this.UU_["zoom"]["min"]!==0&&(t=Math.min(t,1/this.UU_["zoom"]["min"]));this.UU_["zoom"]["max"]!==1/0&&(t=Math.max(t,1/this.UU_["zoom"]["max"]));const s=Math.abs(t/this.LM_().if_().BI_()),e=Math.abs(t/this.LM_().if_().sI_());this.O4_(s,e);return this}Ihs_(t){this.LM_().Ad_();let i=Math.abs(this.LM_().if_().BI_());t&&(i*=this.Chs_());return kit.wn_(i,this.ths_)}P$_(t){const i=this.lAi_(),s=this.LM_().lt_(),e=this.l5i_().E2i_(),A=i.Ie_()/e.Ie_(),n=s.Ie_()/Rit/Math.pow(2,t);this.zoom(A/n);return this}V$_(){const t=this.lAi_(),i=this.LM_().lt_(),s=this.l5i_().E2i_(),e=t.Ie_()/s.Ie_();return Math.log(i.Ie_()/Rit/e)/Math.LN2}JV_(){return{maplimits:this.ihs_===null?null:this.ihs_.clone(),mapimage:this.ehs_,system:this.Tns_,mapscale:this.Ihs_(),mapscaleobject:this.dhs_,scaleunit:this.Bhs_(),webmap:this.ohs_}}setOptions(t){t["mapimage"]!==void 0&&this.ghs_(t["mapimage"]);if(t["maplimits"]!==void 0){this.ihs_=t["maplimits"];this.rAi_(this.UU_["maplimits"])}this.LM_().Eq_(this.Tns_.Q2i_());t["scaleunit"]!=null&&this.whs_(t["scaleunit"]);t["mapscale"]!==void 0&&this.fhs_(t["mapscale"]);t["mapscaleobject"]!==void 0&&this.Qhs_(t["mapscaleobject"]);t["zoom"]!=null&&this.tAi_.dt_(t["zoom"]);t["webmapservice"]!==void 0&&(this.$ns_=t["webmapservice"]);if(t["webmap"]&&t["webmap"]!==this.ohs_){if(this.uhs_){for(let t=0;t<this.uhs_.length;++t)this.Ehs_(this.uhs_[t]);this.uhs_=null}this.ohs_=t["webmap"];this.lhs_=jtt.load(this,t["webmap"],this.$ns_).then(((t,i)=>{this.uhs_=i}),(t=>{ki(t)}))}return this}l5i_(){return this.Tns_}C4t_(t){this.UU_=t||{};return super.C4t_(this.UU_)}ahs_(){this.Uei_.Eq_(!0);const t=this.mgt_();this.oUt_.off(jS.VFt_).on(jS.VFt_,((t,i,s)=>{const e=s.Dkt_();if(e!=="wheel"&&e!=="mousewheel"&&e!=="onmousewheel"&&e!=="DOMMouseScroll"){this.IB_(null);this.Zei_(i,s)}})).oxt_(!0).pxt_(!0);this.tAi_.off(rY.v0t_).on(rY.v0t_,((t,i,s)=>{this.jei_(i,s)})).on(rY.WFt_,((t,i,s)=>{this.notify(Sit.WFt_,this,s);const e=s.Lkt_()["button"]!==Ks.X_?this.UU_["zoom"]["speed"]:1/this.UU_["zoom"]["speed"];this.tAi_.zoom(e,e,s.Fkt_().x,s.Fkt_().y)})).on(rY.XZt_,((t,i,s)=>{this.IB_(null);this.phs_(!0);this.notify(Sit.XZt_,this,s)})).on(rY.jZt_,((t,i,s)=>{this.phs_(!1);this.notify(Sit.jZt_,this,s)})).TZt_(nY.M0t_);this.JDt_.off(xS.Jkt_);this.iAi_.off(xS.Jkt_).off(rU.jZt_).on(rU.jZt_,((t,i,s)=>{const e=s.getArea();if(e.isEmpty())return;const A=this.LM_().ot_();if(!A||A.isEmpty())return;const n=e.Ie_()/e.Ts_(),h=A.Ie_()/A.Ts_();if(n<h){const t=e.Ts_()*h;e.Le_((t-e.Ie_())/2,0)}else{const t=e.Ie_()/h;e.Le_(0,(t-e.Ts_())/2)}const r=Gn.xI_(e,A),o=this.LM_().if_().transform(e),l=this.LM_().if_().transform(A);this.tAi_.zoom(r.BI_(),r.sI_(),(o.ye_()-l.ye_()/r.BI_())/(1-1/r.BI_()),(o.De_()-l.De_()/r.sI_())/(1-1/r.sI_()))})).uFt_(20).Kv_(!0).rWt_(!1).rVt_(Ts.X_);this.iFi_=new AU(t).Kv_(!1).on(xS.Pkt_,((t,i)=>{if(i.isEnabled()){this.sAi_();this.JDt_.Kv_(!1)}else if(this.Hei_!=null){this.$ei_.Kv_(this.Hei_.LAi_);this.iAi_.Kv_(this.Hei_.UAi_);this.JDt_.Kv_(this.Hei_.selection);this.Hei_=null}})).on(Lk.Mk_,(()=>{this.mhs_()})).on(Lk.vJt_,(()=>{this.mhs_()})).on(Lk.End,(()=>{this.mhs_()}));this.nAi_.add(this.iFi_);this.bni_=new iY({divelement:this.UU_["tooltip"]["divelement"],offsetx:this.UU_["tooltip"]["offsetx"],offsety:this.UU_["tooltip"]["offsety"],alignment:this.UU_["tooltip"]["alignment"],delay:this.UU_["tooltip"]["delay"],mode:this.UU_["tooltip"]["mode"],autoupdate:this.UU_["tooltip"]["autoupdate"],layer:this.eis_,callback:(t,i,s)=>{let e;const A=this.yhs_();for(e=0;e<A;e++)if(this.HKi_(e).A9i_()!=null)break;if(e===A)return null;let n="",h=this.UU_["tooltip"]["max"];const r=i&&s.dFt_(i)?s.fFt_():s.aFt_();for(e=this.yhs_()-1;e>=0;e--){const i=this.HKi_(e),s=i.A9i_();if(s==null)continue;let A=[];if(h>0){A=i.$X_(t,r)||[];if(A.length>h){A.sort(n8.E4i_);A.length=h}h-=A.length}n=typeof s=="function"?s.call(i,A,n,t):s.format(A,n)}return n}});this.nAi_.add(this.bni_);this.Dhs_=new Nit({wrapped:this.UU_["wrapped"],system:this.l5i_(),layer:t}).Kv_(!1).pFt_("pointermove",!1).pFt_("pointermove",!0,Mi);const i=this.nAi_.Fxt_(this.oUt_);this.nAi_.g1_(i,this.Dhs_);return this}phs_(t){for(let i=0;i<this.yhs_();++i)this.HKi_(i).n9i_(t);this.eis_.td_();return this}Rns_(t){return this.Mhs_(t,null)}rAi_(t){let i;const s=this.LM_().ut_(),e=s?s.BI_():0,A=!NA.equals(e,this.UU_["wrapped"]?3:1);A&&(i=this.Ihs_(!0));if(t&&this.UU_["wrapped"]&&!NA.equals(t.Ie_(),this.l5i_().E2i_().Ie_())){this.lN_().setOptions({wrapped:!1});this.LM_().Jit_(!1)}super.rAi_(t);if(t!==this.shs_){this.ihs_=t;this.QAi_()}else A&&this.fhs_(i,!0);this.td_();return this}oAi_(){if(this.ihs_==null){const t=undefined;if(this.getBounds()==null)return null;this.shs_==null&&this.hhs_();return this.shs_}return this.ihs_.lock()}Qhs_(t){if(this.dhs_!=null){this.dhs_.off(rh.sC_,this.rhs_);this.dhs_.getParent().removeChild(this.dhs_)}this.dhs_=t;if(this.dhs_!=null){this.dhs_.on(rh.sC_,this.rhs_);this.LM_().getParent().GY_(this.dhs_);this.dhs_.vhs_(this)}return this}bhs_(){return this.dhs_}Nhs_(){const t=undefined;return this.LM_().ot_(!0).getCenter()}Shs_(t,i){if((t=this.transformPoint(t,i,this.Tns_)||t)==null)return this;this.mhs_();const s=undefined,e=this.LM_().ot_().clone().me_(t.getX(),t.getY()),A=this.LM_().rt_();e.we_()<A.we_()?e.setX(A.we_()):e.Qe_()>A.Qe_()&&e.setX(A.Qe_()-e.Ie_());e.Ee_()<A.Ee_()?e.setY(A.Ee_()):e.pe_()>A.pe_()&&e.setY(A.pe_()-e.Ts_());this.hAi_(e);return this}yhs_(){return this.eis_.qY_()}HKi_(t){return this.eis_.HY_(t)}Ehs_(t){if(t!=null){const i=undefined;if(this.eis_.UY_().indexOf(t)>=0){this.eis_.removeChild(t);this.td_();t.off(rh.nC_,this.x0_);t.off(g8.s8i_,this.ani_)}t.R8i_(null);this.notify(Sit.Xns_,this,this.eis_.UY_().slice(0))}return this}Mhs_(t,i){if(t instanceof h6){const s=this.eis_.FY_(t);this.eis_.removeChild(t);if(i!=null&&i<this.eis_.qY_()&&i>=0){this.eis_.xY_(i,t);this.notify(Sit.jns_,this,this.eis_.UY_().slice(0))}else if(i<0){this.eis_.xY_(0,t);this.notify(Sit.jns_,this,this.eis_.UY_().slice(0))}else this.eis_.GY_(t);if(s===-1){t.R8i_(this.Tns_);this.hhs_();t.on(rh.nC_,this.x0_);t.on(g8.s8i_,this.ani_);this.notify(Sit.zns_,this,this.eis_.UY_().slice(0))}}else Gi("Layer can not be inserted! It must be based on geotoolkit.map.layers.AbstractLayer");return this}Ghs_(t){this.IB_(null);const i=t["location"],s=t["scale"],e=t["level"],A=t["callback"];if(i==null&&s==null&&e==null){A&&A(Git.Zns_);return this}const n=t["easing"],h=t["system"]||B3.U2i_,r=t["duration"]||2e3,o=this.V$_(),l=this.lAi_(),u=[l.getCenter()];let a=o;s!=null?a=o+Math.log(s/this.Ihs_())/Math.LN2:e!=null&&(a=e);if(i)if(Array.isArray(i)&&typeof i[0]!="number"){const t=i;for(let i=0;i<t.length;i++){const s=this.J5i_(lA.Wi_(t[i]),h);u.push(s)}if(s==null&&e==null){let i=0;const s=e=>{i++;e===Git.Zns_&&i<u.length?this.Ghs_({location:u[i],system:this.l5i_(),easing:n,duration:r/t.length,callback:s}):A&&A(e)};s(Git.Zns_);return this}}else{const t=this.J5i_(lA.Wi_(i),h),s=Math.abs(u[0].getX()-t.getX()),e=Math.abs(u[0].getY()-t.getY()),g=Math.max(s/l.Ie_(),e/l.Ts_()),c=Math.max(0,o-Math.log(g+1)/Math.LN2)+1;if(g>2&&c<o&&c<a)return this.Ghs_({level:c,location:[(u[0].getX()+t.getX())/2,(u[0].getY()+t.getY())/2],system:this.l5i_(),easing:n,duration:r/2,callback:i=>{i===Git.Zns_?this.Ghs_({level:a,location:t,system:this.l5i_(),easing:n,duration:r/2,callback:A}):A&&A(i)}});u.push(t)}const g=De;this.IB_(new Bh([{attributename:"location",function:u.length>2&&g.Dt_||n||a>o&&g.kt_||g.Rt_,values:u,duration:r},{attributename:"scale",function:n||a<o&&g.zt_||g.Wt_,from:o,to:a,duration:r}]));this.Ahs_=A;return this}bgt_(){this.dhs_!=null&&this.dhs_.vhs_(this)}hhs_(){if(this.ihs_==null){let t=this.Rhs_();t&&t.isEmpty()&&(t=this.shs_);if(this.shs_==null&&this.shs_!==t||this.shs_!==null&&!this.shs_.Ce_(t)){this.shs_=t;this.rAi_(t)}}return this}mhs_(){this.tAi_.Cxt_();this.oUt_.Cxt_()}Rhs_(){let t=null;const i=this.eis_.qY_();for(let s=0;s<i;s++){const i=this.eis_.HY_(s);if(i instanceof h6){const s=i.rt_();s!=null&&(t==null?t=s.clone():t.union(s))}}const s=this.Tns_.E2i_();if(s&&!s.isEmpty()&&t&&!t.isEmpty()){const i=s.Ie_()/s.Ts_(),e=t.Ie_()/t.Ts_();let A=t.Ie_(),n=t.Ts_();if(i>e){A=t.Ts_()*i;if(A>s.Ie_()){A=s.Ie_();n=A/i}}else if(i<e){n=t.Ie_()/i;if(n>s.Ts_()){n=s.Ts_();A=n*i}}const h=(A-t.Ie_())/2,r=(n-t.Ts_())/2;if(h!==0)if(t.getX()-s.getX()<h){t.setX(s.getX());t.de_(A)}else if(s.Qe_()-t.Qe_()<h){t.setX(s.Qe_()-A);t.de_(A)}else t.Le_(h,0);if(r!==0)if(t.getY()-s.getY()<r){t.setY(s.getY());t.Be_(n)}else if(s.pe_()-t.pe_()<r){t.setY(s.pe_()-n);t.Be_(n)}else t.Le_(0,r)}return t}Chs_(){const t=this.LM_().ot_();let i,s,e,A;if(t.Ts_()<2e3){s=this.transformPoint(t.getCenter(),this.l5i_(),B3.U2i_);i=Math.abs(1/Math.cos(s.getY()*Math.PI/180))}else if(t.Ts_()<4e3){s=t.Me_();e=t.be_();s=this.transformPoint(s,this.l5i_(),B3.U2i_);e=this.transformPoint(e,this.l5i_(),B3.U2i_);i=(Math.abs(1/Math.cos(s.getY()*Math.PI/180))+Math.abs(1/Math.cos(e.getY()*Math.PI/180)))/2}else{s=t.Me_();e=t.be_();A=t.getCenter();s=this.transformPoint(s,this.l5i_(),B3.U2i_);e=this.transformPoint(e,this.l5i_(),B3.U2i_);A=this.transformPoint(A,this.l5i_(),B3.U2i_);i=(Math.abs(1/Math.cos(s.getY()*Math.PI/180))+Math.abs(1/Math.cos(e.getY()*Math.PI/180))+Math.abs(4*(1/Math.cos(A.getY()*Math.PI/180))))/6}return i}Bhs_(){return this.ths_}whs_(t){const i=OA.Ai_().gn_(t);this.ths_=i!=null?i:kit;return this}zei_(t){const i=this.lAi_();if(t&&i){const s=i.Ie_()/(i.Ts_()||1),e=t.Ie_()/(t.Ts_()||1);t=t.clone();e<s?t.Le_((t.Ts_()*s-t.Ie_())/2,0):t.Le_(0,(t.Ie_()/s-t.Ts_())/2)}super.zei_(t)}ht_(t){const i=this.Ihs_();super.ht_(t);this.fhs_(i);return this}load(){const t=[],i=this.yhs_();for(let s=0;s<i;s++)t.push(this.HKi_(s).load());this.lhs_!=null&&t.push(this.lhs_);return Promise.all(t).then((()=>this),(()=>this))}khs_(t){if(this.Ahs_!=null){const i=this.Ahs_;this.Ahs_=null;i(t)}return this}IB_(t){this.khs_(Git._ns_);return super.IB_(t)}dB_(){if(this.nhs_==null){const t=super.dB_();this.nhs_=i=>{if(i===Ch.Sd_)this.phs_(!0);else{this.phs_(!1);this.khs_(Git.Zns_)}t(i)}}return this.nhs_}};i=t([_s("geotoolkit.map.Map")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJ0cmFuc2Zvcm1Ub01hcCI6Iko1aV8iLCJ0cmFuc2Zvcm1Gcm9tTWFwIjoiZTlpXyIsImdldE1hcEltYWdlIjoiY2hzXyIsInNldE1hcFNjYWxlIjoiZmhzXyIsImdldE1hcFNjYWxlIjoiSWhzXyIsInNldFpvb21MZXZlbCI6IlAkXyIsImdldFpvb21MZXZlbCI6IlYkXyIsImdldE9wdGlvbnMiOiJKVl8iLCJnZXRDb29yZGluYXRlU3lzdGVtIjoibDVpXyIsImluaXRpYWxpemVMYXlvdXQiOiJDNHRfIiwiYWRkTGF5ZXIiOiJSbnNfIiwic2V0Q2VudGVyTW9kZWxMaW1pdHMiOiJyQWlfIiwiZ2V0Q2VudGVyTW9kZWxMaW1pdHMiOiJvQWlfIiwic2V0TWFwU2NhbGVPYmplY3QiOiJRaHNfIiwiZ2V0TWFwU2NhbGVPYmplY3QiOiJiaHNfIiwiZ2V0TWFwQ2VudGVyIjoiTmhzXyIsInBhblRvIjoiU2hzXyIsImdldExheWVyQ291bnQiOiJ5aHNfIiwiZ2V0TGF5ZXIiOiJIS2lfIiwicmVtb3ZlTGF5ZXIiOiJFaHNfIiwiaW5zZXJ0TGF5ZXIiOiJNaHNfIiwiZmx5VG8iOiJHaHNfIiwiZ2V0U2NhbGVVbml0IjoiQmhzXyIsInNldFNjYWxlVW5pdCI6Indoc18iLCJ6b29tVG9SZWN0IjoiemVpXyIsInNldEJvdW5kcyI6Imh0XyIsInNldEFuaW1hdGlvblN0eWxlIjoiSUJfIn19fSAg"),xit=Ci(function(){let i=class t extends ke{constructor(t){(t=t||{})["fill"]=me.pt_;super(t)}bi_(t,i){return t["attributename"]==="scale"&&i instanceof Fit}Yi_(t){return t.V$_()}apply(t){t.P$_(this.Ei_.current)}};i=t([_s(null)],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpc0FwcGxpY2FibGUiOiJiaV8iLCJnZXRBbmltYXRlZFZhbHVlIjoiWWlfIn19fSAg");zn.Ai_().uf_(xit);var Lit=Ci(function(){let i=class t extends ke{constructor(t){(t=t||{})["fill"]=me.pt_;super(t);this.vi_=kn.Ai_()}bi_(t,i){return t["attributename"]==="location"&&i instanceof Fit}Yi_(t){return t.lAi_().getCenter()}apply(t){t.Shs_(this.Ei_.current,t.l5i_())}};i=t([_s(null)],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpc0FwcGxpY2FibGUiOiJiaV8iLCJnZXRBbmltYXRlZFZhbHVlIjoiWWlfIn19fSAg");zn.Ai_().uf_(Lit);const Uit="cg-toolbar-maplayers";var Yit=function(){let i=class t extends mk{constructor(t){(t=qi(t,{title:"Change map layers",icon:"fas fa-layer-group",formatter:function(t){let i="fas fa-database";t instanceof $9?i="fas fa-th":t instanceof O9&&(i="fas fa-image");return new Ek({title:t.dn_()||"",text:t.dn_()||"",icon:i,border:this.Wqt_(),color:this.getColor(),checkbox:{enabled:!0,checked:t.$C_()},init:function(i,s){if(s){this.Fhs_=()=>{this.Vqt_(t.$C_())};t.on(rh.cC_,this.Fhs_)}else this.Fhs_&&t.off(rh.cC_,this.Fhs_)},action:function(i,s){t.nf_(s)}})}},!0))["buttons"]=[];super(t);this.eis_=xs("div",Uit);this.ZF_=t["formatter"]}b_(t){this.eis_=t.eis_.cloneNode(!0);this.ZF_=t.ZF_;return this}setSize(t,i){super.setSize(t,i);let s,e=-1/0;const A=this.iJt_();for(s=0;s<A.length;s++)e=Math.max(e,A[s].Ie_());if(e>t){i==null&&(i=t);for(s=0;s<A.length;s++)A[s].Ie_()<e&&A[s].setSize(e,i)}return this}init(t,i,s,e,A,n){super.init(t,i,s,e,A,n);e&&this.nn_().appendChild(e.cloneNode(!0));this.nn_().appendChild(this.eis_);const h=t.PP_();this.xhs_=()=>{this.Lhs_(t,i,e,n)};h.on(Sit.zns_,this.xhs_);this.Lhs_(t,i,e,n);return this}clear(t,i){if(this.eis_&&this.eis_.parentNode===this.nn_()){this.nn_().removeChild(this.eis_);this.eis_=null}if(this.xhs_){const i=undefined;t.PP_().off(Sit.zns_,this.xhs_);this.xhs_=null}super.clear(t,i)}Lhs_(t,i,s,e){const A=t.PP_();let n=null;A instanceof Fit?n=A:A!=null&&(n=ur(A).Gw_((function(t){return t instanceof Fit})).xw_());if(n==null)return;const h=this.iJt_();let r;for(r=0;r<h.length;r++)h[r].clear(t,i);h.length=0;this.eis_.innerHTML="";const o=n.yhs_();let l=-1/0;const u=this.eis_.style.display;this.eis_.style.display="block";for(let A=0;A<o;A++){const r=n.HKi_(A),o=this.ZF_.call(this,r);h.push(o);o.init(t,i,this.eis_,s,null,e);o.setSize(this.Ts_());l=Math.max(l,o.Ie_())}this.eis_.style.display=u;if(l>this.Ie_())for(r=0;r<h.length;r++)h[r].setSize(l,this.Ts_())}};i=t([_s("geotoolkit.controls.toolbar.MapLayers")],i);return i}();Bk.Ai_().register("map-layers",new Yit).register("map-location",{title:"Show current location",icon:"fas fa-location-arrow",action:function(t){const i=t.PP_();Mi.navigator.geolocation!=null&&i instanceof Fit&&Mi.navigator.geolocation.getCurrentPosition((function(t){i.Ghs_({level:14,location:[t.coords.longitude,t.coords.latitude]})}))}}).register("map-home",{title:"Zoom to fit",icon:"fas fa-home",action:function(t){const i=t.PP_();if(!(i instanceof Fit))return;const s=i.V$_();let e=1500;s<3?e=500:s<6&&(e=1e3);i.Ghs_({level:1,location:[0,16],duration:e})}});var Tit=Ci(function(){let i=class t extends h8{constructor(){super(...arguments);this.N4i_={}}query(t){const i=t["callback"];this.S4i_.send(this.Uhs_(t),this.Yhs_(t),((t,s)=>{t==null?i(null,this.Ths_(s)):i(t)}));return this}Yhs_(t){return{cancel:t["cancel"],responsetype:"json"}}};i.prototype.Uhs_=Zi;i.prototype.Ths_=Zi;i=t([_s("geotoolkit.map.sources.formats.GeoTile")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRVUkxGcm9tUXVlcnkiOiJVaHNfIiwiZ2V0T3B0aW9uc0Zyb21RdWVyeSI6Illoc18iLCJnZXREYXRhRnJvbVJlc3BvbnNlIjoiVGhzXyJ9fX0g");var Kit=Ci(function(){let i=class t extends o6{constructor(){super(...arguments);this.N4i_={}}parse(t,i){this.Khs_(t,(t=>{this.N4i_.pes_=t["epsg"];this.N4i_.mes_=t["imagedevicelimits"];this.N4i_.yes_=t["imagemodelpoints"];t["tiledshapeoptions"]!=null&&(this.N4i_.Ees_=t["tiledshapeoptions"]);i(this)}))}};i.prototype.Khs_=Zi;i=t([_s("geotoolkit.map.sources.loaders.GeoTile")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRTZXR0aW5nc0RhdGEiOiJLaHNfIn19fSAg");var Hit=Ci(function(){let i=class t extends MF{constructor(t){super(t=qi(t=t||{},{name:"aggregation-selection",layer:t instanceof Ic?t:t["layer"]}));this.Hhs_=[];this.jOt_(CF.st_);this.eFt_(Pi(t["slots"],{pointerdown:this.zFt_.bind(this),pointermove:this.XFt_.bind(this),pointerup:{callback:this.Ct_.bind(this),object:Mi},keydown:{callback:this.IPt_.bind(this),object:Mi}}))}sWt_(t,i){if(t.length===0)return;let s=null,e=null;for(let i=t.length-1;i>=0;i--){const A=t[i];if(A instanceof jf){const t=undefined;s=(A.getData(N9)||[]).find((t=>t instanceof p4));if(s!=null){e=A.GO_();break}}}if(e==null||s==null)return;const A=e.Ois_()||[];let n=A[A.length-1]||null;if(s.$5i_()){s._5i_(!1);s===n&&(n=null)}else if(s.getParent())s._5i_(!0);else{n!=null&&n._5i_(!1);s._5i_(!0);n=s}if(n==null)this.Hhs_=[];else{const t=[n];for(let i=0;i<t.length;++i)t[i].$5i_()&&t.push.apply(t,t[i].YY_());t.reverse();this.Hhs_=t}e.Pis_(this.Hhs_);e.td_();i.stopPropagation(!0,!0)}IPt_(t){if(t.Lkt_()["keyCode"]===27&&this.Hhs_.length>0){const i=undefined;this.Hhs_[this.Hhs_.length-1]._5i_(!1);this.Hhs_.length=0;t.getPlot().td_()}}Kv_(t){super.Kv_(t);if(!t&&this.Hhs_.length>0){const t=undefined;this.Hhs_[this.Hhs_.length-1]._5i_(!1);this.Hhs_.length=0}return this}};i=t([_s("geotoolkit.map.tools.AggregationSelection")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRFbmFibGVkIjoiS3ZfIn19fSAg");var qit=Ci({Lut_:"Edge",Max:"Max",qhs_:"NoOverlap",All:"All"},2,"eyJFZGdlIjoiTHV0XyIsIk5vT3ZlcmxhcCI6InFoc18ifSAg");var Jit=Ci({_fi_:"Metric",Jhs_:"Imperial"},2,"eyJNZXRyaWMiOiJfZmlfIiwiSW1wZXJpYWwiOiJKaHNfIn0g");const Pit=OA.Ai_().gn_("px"),Vit=OA.Ai_().gn_("metre"),Oit=OA.Ai_().gn_("ft"),Wit=[.2,1,5,10,20,50,100,200,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5,2e5,5e5,1e6,2e6],zit=["< 1m","1 m","5 m","10 m","20 m","50 m","100 m","200 m","500 m","1 km","2 km","5 km","10 km","20 km","50 km","100 km","200 km","500 km","1000 km","2000 km"],Xit=[.2,1,5,20,50,100,200,500,1e3,2e3,5280,2*5280,5*5280,10*5280,20*5280,50*5280,100*5280,200*5280,500*5280,1e3*5280],jit=["< 1 ft","1 ft","5 ft","20 ft","50 ft","100 ft","200 ft","500 ft","1000 ft","2000 ft","1 mi","2 mi","5 mi","10 mi","20 mi","50 mi","100 mi","200 mi","500 mi","1000 mi"],Zit=new mA;var _it=Ci(function(){let i=class t extends Ca{constructor(t){const i=qi(t,{x:20,y:10,width:160,height:40,textstyle:new qa({color:"black",autosize:!0}),linestyle:new hl({color:"black",width:2}),alignment:dA.se_,textalign:dA.ne_,tickheight:.25,metric:!0,system:Jit._fi_,sizeisindevicespace:!0},!0);super(i);this._dx=i["x"];this._dy=i["y"];this.Phs_=i["tickheight"];this.ai_=i["system"]===Jit._fi_?Vit:Oit;this.Dhs_=null;this.Vhs_=!1;this._q_=new YC({textstyle:i["textstyle"],sizeisindevicespace:!0,alignment:i["textalign"]});const s=this.gt_();if(s){s.VD_(nl.GD_);s.qD_(!0)}}b_(t,i){this._dx=t._dx;this._dy=t._dy;this.Phs_=t.Phs_;this.ai_=t.ai_;this._q_=t._q_.clone();this.Dhs_=null;this.Vhs_=!1;return this}fhs_(t){const i=this.ai_.wn_(this.width/t,Vit),s=this.Boi_(this.ai_),e=this.lZt_(this.ai_);let A=1;while(i>s[A]&&A<s.length)A++;this.Dhs_=Vit.wn_(s[A-1]*t,this.ai_);this.Dhs_=Math.min(this.Dhs_,this.width)/this.width;this._q_.a_(e[A-1]);const n=undefined,h=((this.gt_()?this.gt_().Ie_():0)+1)/this.Ie_(),r=this._dx/this.Ie_(),o=this._dy/this.Ts_();Zit.setX(r+h).setY(o).de_(this.Dhs_-2*h).Be_(1);const l=Ca.VG_(Zit,this._q_.GE_());this._q_.gR_(l);this.td_();return this}Ohs_(t){if(this.Kns_()===t)return this;this.ai_=t===Jit._fi_?Vit:Oit;this.td_();return this}Kns_(){return Vit===this.ai_?Jit._fi_:Jit.Jhs_}FE_(){return this._q_.FE_()}g_(t,i){this._q_.g_(t,i);this.td_();return this}vhs_(t){if(!this.Vhs_){const i=Ca.VG_(t.LM_().getBounds(),this.GE_());this.gR_(i);this.Vhs_=!0}this.fhs_(t.Bhs_().wn_(t.Ihs_(!0),Pit))}render(t){const i=this.sd_()!=null?t.uS_(this.sd_()):t;this.Xb_(i);const s=i.Ji_(),e=this.IR_(t.Ji_()),A=this._dx/this.Ie_(),n=this._dy/this.Ts_();i.dI_(e);i.rB_(this.gt_());i.oB_(A,n,A,n+this.Phs_);i.oB_(A,n+this.Phs_,A+this.Dhs_,n+this.Phs_);i.oB_(A+this.Dhs_,n,A+this.Dhs_,n+this.Phs_);this._q_.render(i);i.dI_(s);this.iN_(i)}dt_(t){if(t==null)return this;super.dt_(t);t["x"]!==void 0&&(this._dx=t["x"]);t["y"]!==void 0&&(this._dy=t["y"]);t["tickheight"]!==void 0&&(this.Phs_=t["tickheight"]);t["system"]!==void 0&&this.Ohs_(t["system"]);t["textstyle"]!=null&&this._q_.g_(t["textstyle"]);t["textalign"]!=null&&this._q_.SE_(t["textalign"]);this.Vhs_=!1;this.td_();return this}N_(){const t=super.N_();t["x"]=this._dx;t["y"]=this._dy;t["tickheight"]=this.Phs_;t["system"]=this.Kns_();t["textstyle"]=this.FE_();t["textalign"]=this._q_.GE_();return t}Whs_(){return this._dx}zhs_(){return this._dy}Xhs_(){return this.Dhs_}u3i_(){return this._q_}Boi_(t){return Vit.pn_(t)?Wit:Xit}lZt_(t){return Vit.pn_(t)?zit:jit}gn_(){return this.ai_}};i=t([_s("geotoolkit.map.util.MapScale")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJjb3B5Q29uc3RydWN0b3IiOiJiXyIsInNldE1hcFNjYWxlIjoiZmhzXyIsInNldFN5c3RlbSI6Ik9oc18iLCJnZXRTeXN0ZW0iOiJLbnNfIiwiZ2V0VGV4dFN0eWxlIjoiRkVfIiwic2V0VGV4dFN0eWxlIjoiZ18iLCJzZXRQcm9wZXJ0aWVzIjoiZHRfIiwiZ2V0UHJvcGVydGllcyI6Ik5fIn19fSAg");var $it=Ci({Top:"Top",JQ_:"Bottom",v6_:"Both"},2,"eyJCb3R0b20iOiJKUV8iLCJCb3RoIjoidjZfIn0g");const tst=qit,ist=OA.Ai_().gn_("ft"),sst=OA.Ai_().gn_("metre");var est=Ci(function(){let i=class t extends _it{constructor(t){super(t=qi(t,{fillstyles:["black","white"],minortickheight:.5,majortickheight:1,ticksamount:5,tickvisible:!0,tickposition:$it.Top,secondsystem:null,labelmode:tst.Max,height:8,y:20},!0));this.jhs_=[];this.Zhs_=t["minortickheight"];this._hs_=t["majortickheight"];this.$hs_=t["ticksamount"];this.trs_=t["tickvisible"];this.irs_=t["tickposition"];this.srs_=null;this.K$_=t["labelmode"];this.ers_=null;this.Ars_=0;this.dt_(t)}b_(t,i){this.Zhs_=t.Zhs_;this._hs_=t._hs_;this.$hs_=t.$hs_;this.trs_=t.trs_;this.irs_=t.irs_;this.srs_=t.srs_;this.K$_=t.K$_;this.ers_=null;this.Ars_=0;this.nrs_(t.jhs_.map((function(t){return t.clone()})));return this}nrs_(t){let i;for(i=0;i<this.jhs_.length;i++)this.iC_(this.jhs_[i],rh.sC_,this.oQ_());this.jhs_=[];for(i=0;i<t.length;i++){const s=il.BD_(t[i]);if(s!=null){this.tC_(s,rh.sC_,this.oQ_());this.jhs_.push(s)}}return this}hrs_(){return this.jhs_}iQ_(t,i){return this.nrs_([t,"white"])}fhs_(t){super.fhs_(t);this.Ars_=this.lZt_(this.gn_()).indexOf(this.u3i_().SG_());return this}rrs_(t){if(this.Zhs_===t)return this;this.Zhs_=t;this.td_();return this}ors_(){return this.Zhs_}lrs_(t){if(this._hs_===t)return this;this._hs_=t;this.td_();return this}urs_(){return this._hs_}ars_(t){if(this.grs_()===t)return this;this.srs_=t==null?null:t===Jit._fi_?sst:ist;this.td_();return this}grs_(){return this.srs_==null?null:sst.pn_(this.srs_)?Jit._fi_:Jit.Jhs_}q$_(t){if(this.K$_===t)return this;this.K$_=t;this.td_();return this}J$_(){return this.K$_}crs_(t){if(this.trs_===t)return this;this.trs_=t;this.td_();return this}Irs_(){return this.trs_}LE_(t){if(this.irs_===t)return this;this.irs_=t;this.td_();return this}xE_(){return this.irs_}frs_(t){if(this.$hs_===t)return this;this.$hs_=t;this.td_();return this}Crs_(){return this.$hs_}render(t){const i=this.sd_()!=null?t.uS_(this.sd_()):t;this.Xb_(i);const s=i.Ji_(),e=this.IR_(t.Ji_());i.dI_(e);let A=2;this.srs_!==null&&A++;this.irs_===$it.v6_&&A++;const n=1/A;let h=this.drs_(this.gn_());const r=this.Whs_()/this.Ie_();let o=-this.zhs_()/this.Ts_();if(this.irs_===$it.Top||this.irs_===$it.v6_){this.L__(i,r,o,n,h,0);o+=n}this.Hvt_(i,r,o,n,h,0);o+=n;if(this.srs_!==null){h=this.drs_(this.srs_);this.Hvt_(i,r,o,n,h,1);o+=n}this.irs_!==$it.JQ_&&this.irs_!==$it.v6_||this.L__(i,r,o,n,h,1);i.dI_(s);this.iN_(i)}L__(t,i,s,e,A,n){i+=this.Xhs_();const h=this.Xhs_()/A,r=n===0?s:s+e*Math.max(this.urs_(),this.ors_()),o=n===0?this.gn_():this.srs_||this.gn_();let l,u;if(this.srs_==null||this.srs_.pn_(this.gn_())||n===0){l=this.lZt_(o)[this.Ars_];u=parseInt(l)||this.Boi_(o)[this.Ars_]}else{u=this.Boi_(this.gn_())[this.Ars_];u=this.srs_.wn_(u,this.gn_());if(sst.pn_(this.srs_))if(u>1e3){u=Math.round(u/100)/10;l=u+" km"}else{u=Math.round(u*10)/10;l=u+" m"}else if(u>5280){u=Math.round(u/528)/10;l=u+" mi"}else{u=Math.round(u*10)/10;l=u+" ft"}}for(let o=A;o>=0;o--,i-=h){const h=o===0||o===A?this.urs_():this.ors_();if(this.trs_){t.rB_(this.gt_());t.oB_(i,s+e*(1-h),i,s+e)}const a=Math.round(o*u*10/A)/10;this.u3i_().a_(a+"");const g=this.u3i_().Ie_()/2/t.Ji_().BI_();if(o===A)this.u3i_().SE_(n===0?dA.se_:dA.ie_).gR_(i-g,r).a_(l).render(t);else{if(this.K$_===tst.Max)continue;if(this.K$_===tst.Lut_&&o!==0)continue;if(this.K$_===tst.qhs_&&this.ers_<=i+g)continue;this.u3i_().SE_(n===0?dA.re_:dA.le_).gR_(i,r).render(t)}this.ers_=i-g}}Hvt_(t,i,s,e,A,n){t.rB_(this.gt_());const h=this.Xhs_()/A;for(let r=0;r<A;r++){t.iQ_(this.jhs_[(r+n)%this.jhs_.length]);t.pR_(i,s,h,e);i+=h}}dt_(t){if(t==null)return this;(t=Es(t))["fillstyles"]!==void 0&&this.nrs_(t["fillstyles"]);t["secondsystem"]!==void 0&&this.ars_(t["secondsystem"]);t["minortickheight"]!==void 0&&this.rrs_(t["minortickheight"]);t["majortickheight"]!==void 0&&this.lrs_(t["majortickheight"]);t["labelmode"]!==void 0&&this.q$_(t["labelmode"]);t["tickvisible"]!==void 0&&this.crs_(t["tickvisible"]);t["tickposition"]!==void 0&&this.LE_(t["tickposition"]);t["ticksamount"]!==void 0&&this.frs_(t["ticksamount"]);return super.dt_(t)}N_(){const t=super.N_();t["fillstyles"]=this.hrs_();t["secondsystem"]=this.grs_();t["labelmode"]=this.J$_();t["tickvisible"]=this.Irs_();t["tickposition"]=this.xE_();t["ticksamount"]=this.Crs_();t["minortickheight"]=this.ors_();t["majortickheight"]=this.urs_();return t}drs_(t){return this.srs_==null||this.srs_.pn_(this.gn_())?this.$hs_:t.pn_(sst)?8:5}};i=t([_s("geotoolkit.map.util.BarScale")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJjb3B5Q29uc3RydWN0b3IiOiJiXyIsInNldEZpbGxTdHlsZUxpc3QiOiJucnNfIiwiZ2V0RmlsbFN0eWxlTGlzdCI6Imhyc18iLCJzZXRGaWxsU3R5bGUiOiJpUV8iLCJzZXRNYXBTY2FsZSI6ImZoc18iLCJzZXRNaW5vclRpY2tIZWlnaHQiOiJycnNfIiwiZ2V0TWlub3JUaWNrSGVpZ2h0Ijoib3JzXyIsInNldE1ham9yVGlja0hlaWdodCI6Imxyc18iLCJnZXRNYWpvclRpY2tIZWlnaHQiOiJ1cnNfIiwic2V0U2Vjb25kU3lzdGVtIjoiYXJzXyIsImdldFNlY29uZFN5c3RlbSI6Imdyc18iLCJzZXRMYWJlbE1vZGUiOiJxJF8iLCJnZXRMYWJlbE1vZGUiOiJKJF8iLCJzZXRUaWNrVmlzaWJsZSI6ImNyc18iLCJnZXRUaWNrVmlzaWJsZSI6Iklyc18iLCJzZXRUaWNrUG9zaXRpb24iOiJMRV8iLCJnZXRUaWNrUG9zaXRpb24iOiJ4RV8iLCJzZXRUaWNrc0Ftb3VudCI6ImZyc18iLCJnZXRUaWNrc0Ftb3VudCI6IkNyc18iLCJzZXRQcm9wZXJ0aWVzIjoiZHRfIiwiZ2V0UHJvcGVydGllcyI6Ik5fIn19fSAg");export {a3,g3,c3,I3,f3,d3,B3,Q3,D3,F3,Y3,W3,X3,Z3,_3,$3,t4,i4,s4,e4,h4,r4,l4,u4,a4,c4,d4,w4,p4,m4,b4,N4,S4,H4,q4,V4,W4,X4,Z4,$4,i8,n8,h8,r8,o8,a8,g8,c8,I8,f8,C8,w8,p8,m8,y8,N8,S8,k8,x8,L8,Y8,q8,P8,V8,W8,X8,j8,Z8,_8,$8,s6,e6,A6,n6,h6,r6,o6,R6,F6,x6,L6,U6,Y6,J6,z6,X6,_6,t9,n9,c9,d9,w9,p9,N9,S9,k9,x9,L9,K9,H9,q9,J9,O9,X9,j9,Z9,$9,t7,h7,r7,o7,l7,I7,f7,C7,d7,B7,Q7,y7,v7,b7,N7,S7,L7,U7,Y7,T7,K7,H7,J7,P7,V7,O7,W7,_7,stt,ett,Att,ntt,htt,ott,utt,att,gtt,ctt,Itt,ftt,dtt,Ett,ptt,mtt,Dtt,vtt,Ntt,Stt,Gtt,ktt,Ftt,xtt,Ltt,Htt,Ptt,Vtt,Ott,jtt,Ztt,nit,dit,Qit,Mit,Nit,Sit,Git,Fit,Tit,Kit,Hit,qit,Jit,_it,$it,est};