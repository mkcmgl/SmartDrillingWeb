/* eslint-disable */
import {BackSide as s,DoubleSide as e,FrontSide as i,Vector4 as A,Color as l,LinearFilter as o,ShaderChunk as n,Texture as r,Uniform as h,Matrix4 as u,Box2 as c,Euler as f,Matrix3 as I,Vector2 as g,Vector3 as a,Box3 as C,ShaderMaterial as d,Group as y,Material as p,Object3D as m,OrthographicCamera as v,PerspectiveCamera as Q,Plane as b,Quaternion as B,Ray as w,Scene as M,Sprite as E,WebGLRenderer as D,NoBlending as G,ShaderLib as S,UniformsUtils as N,RepeatWrapping as k,SpriteMaterial as R,LineBasicMaterial as Y,LineDashedMaterial as T,MeshBasicMaterial as F,MeshLambertMaterial as U,MeshNormalMaterial as L,MeshPhongMaterial as x,RawShaderMaterial as K,Float32BufferAttribute as V,InstancedBufferGeometry as H,InstancedInterleavedBuffer as q,InterleavedBufferAttribute as J,Sphere as P,UniformsLib as O,Mesh as W,BufferGeometry as z,DefaultLoadingManager as X,ClampToEdgeWrapping as it,LinearMipmapLinearFilter as tt,LinearMipmapNearestFilter as _,MirroredRepeatWrapping as st,NearestFilter as j,NearestMipmapLinearFilter as $,NearestMipmapNearestFilter as Z,Bone as Qt,BufferAttribute as ut,FileLoader as nt,ImageBitmapLoader as et,InterleavedBuffer as lt,Line as dt,LineLoop as Bt,LineSegments as Ct,MeshStandardMaterial as ht,Points as wt,PointsMaterial as at,PropertyBinding as ct,Skeleton as rt,SkinnedMesh as It,sRGBEncoding as gt,TextureLoader as At,TriangleFanDrawMode as ot,TriangleStripDrawMode as ft,LoaderUtils as Et,BoxGeometry as mt,ConeGeometry as yt,SphereGeometry as pt,CanvasTexture as Dt,Raycaster as Mt,Line3 as vt,PlaneGeometry as bt,AlphaFormat as Gt,RGBAFormat as Nt,RGBAIntegerFormat as St,Clock as kt,WebGLRenderTarget as Rt,AddEquation as Yt,CustomBlending as Ut,DepthFormat as Lt,DepthTexture as Ft,FloatType as xt,LessDepth as Pt,LessEqualDepth as Jt,NormalBlending as qt,OneFactor as Ht,SrcAlphaFactor as Tt,ZeroFactor as Kt,AdditiveBlending as Vt,MeshDepthMaterial as Ot,RGBADepthPacking as Wt,PointLight as zt,AmbientLight as Xt,ColorManagement as Zt,UnsignedIntType as jt,Shape as _t,ArrowHelper as $t,ShapeGeometry as ti,IcosahedronGeometry as ii,InstancedBufferAttribute as si,RedFormat as ei,Frustum as Ai,DynamicDrawUsage as ni,CylinderGeometry as hi,DataTexture as ri} from 'three';import {__decorate as t} from 'tslib';import {$n,qi,ki,xA,_s,Mi,Gi,Zi,Fi,as,gs,dp,Fo,lA,If,mA,ko,Go,Mo,mo,nA,bo,Ls,NA,Pi,hl,je,My,Dy,RA,Is,Ss,po,Dm,Es,wr,fr,sI,nl,Cp,oE,il,xs,$i,kw,eh,Fa,ka,qa,$o,Uo,yu,Rs,ys,No,Bs,Ds,lr,nr,el,ap,Zs,zC,fg,sa,Mr,Gn,Tc,Oc,Lp,rh,fA,Au,fm,Ci} from '@int/impl/geotoolkit.base.js';import {FS} from '@int/impl/geotoolkit.controls.js';import {qb,PD} from '@int/impl/geotoolkit.data.js';import {Qwt,aEt,IEt,CEt} from '@int/impl/geotoolkit.seismic.js';import {FMt} from '@int/impl/geotoolkit.schematics.js';var _kt=Ci({ij:"IJ",DWe_:"IJFLIPPED",xy:"XY"},2,"eyJpamZsaXBwZWQiOiJEV2VfIn0g"),$kt=Ci({MWe_:0,vWe_:1,lB_:2},2,"eyJCbGFja0FuZFdoaXRlIjoiTVdlXyIsIlRlcnJhcml1bSI6InZXZV8iLCJOb3JtYWwiOiJsQl8ifSAg"),tFt={Id:0,X:10,Y:20,Z:30},iFt;(function(t){t[t["FrontSide"]=i]="FrontSide";t[t["BackSide"]=s]="BackSide";t[t["DoubleSide"]=e]="DoubleSide"})(iFt||(iFt={}));var sFt={start:"start",end:"end"},eFt=Ci({bWe_:"ssaa",NWe_:"fxaa",SWe_:"sraa",R4t_:"auto"},2,"eyJTU0FBIjoiYldlXyIsIkZYQUEiOiJOV2VfIiwiU1JBQSI6IlNXZV8iLCJBVVRPIjoiUjR0XyJ9");const AFt="PICKINGMATERIAL_OVERRIDE";var nFt=Ci({GWe_:"onContext",zFt_:"onMouseDown",XFt_:"onMouseMove",Ct_:"onMouseUp",RWe_:"onMouseOut",jFt_:"onMouseWheel",kWe_:"onTouchStart",FWe_:"onTouchEnd",xWe_:"onTouchMove",WFt_:"onDoubleClick",IPt_:"onKeyDown",fPt_:"onKeyUp",LWe_:"onPointerStart",UWe_:"onPointerMove",YWe_:"onPointerEnd",id_:"onVisibilityChanged"},2,"eyJvbkNvbnRleHQiOiJHV2VfIiwib25Nb3VzZURvd24iOiJ6RnRfIiwib25Nb3VzZU1vdmUiOiJYRnRfIiwib25Nb3VzZVVwIjoiQ3RfIiwib25Nb3VzZU91dCI6IlJXZV8iLCJvbk1vdXNlV2hlZWwiOiJqRnRfIiwib25Ub3VjaFN0YXJ0Ijoia1dlXyIsIm9uVG91Y2hFbmQiOiJGV2VfIiwib25Ub3VjaE1vdmUiOiJ4V2VfIiwib25Eb3VibGVDbGljayI6IldGdF8iLCJvbktleURvd24iOiJJUHRfIiwib25LZXlVcCI6ImZQdF8iLCJvblBvaW50ZXJTdGFydCI6IkxXZV8iLCJvblBvaW50ZXJNb3ZlIjoiVVdlXyIsIm9uUG9pbnRlckVuZCI6IllXZV8iLCJvblZpc2liaWxpdHlDaGFuZ2VkIjoiaWRfIn0g");const hFt=new xA;var rFt=Ci(function(){let i=class t extends $n{constructor(t){super();this.E8_=null;this.eb_=null;this.Qpi_=null;this.TWe_=null;this.setOptions(t)}KWe_(t,i,s){this.HWe_=t=>{this.notify(nFt.GWe_,this,t);this.TWe_=t};this.qWe_=t=>{this.notify(nFt.jFt_,this,t);this.TWe_=t};this.JWe_=t=>{this.notify(nFt.IPt_,this,t)};this.PWe_=t=>{this.notify(nFt.fPt_,this,t)};this.VWe_=t=>{this.OWe_(t);this.notify(nFt.Ct_,this,t);this.TWe_=t};this.WWe_=t=>{this.OWe_(t);this.notify(nFt.RWe_,this,t);this.TWe_=t};this.zWe_=t=>{this.OWe_(t);this.notify(nFt.zFt_,this,t);this.TWe_=t};this.XWe_=t=>{this.OWe_(t);this.notify(nFt.WFt_,this,t);this.TWe_=t};this.jWe_=t=>{if(this.TWe_==null||this.TWe_.clientX!==t.clientX||this.TWe_.clientY!==t.clientY){this.OWe_(t);this.notify(nFt.XFt_,this,t)}}}OWe_(t){const i=t,s=this.ZWe_(i.clientX,i.clientY);i["plotX"]=s.x;i["plotY"]=s.y;i["plotXs"]=[i["plotX"]];i["plotYs"]=[i["plotY"]]}static isSupported(){ki("AbstractDeviceSupport.isSupported() has to be overriden");return!1}setOptions(t){const i=qi(t,{domelement:this.Qpi_,plot:this.E8_,target:this.eb_});this.E8_=i["plot"];this.eb_=i["target"];if(this.Qpi_!==i["domelement"]){this.Qpi_!=null&&this.dispose();this.Qpi_=i["domelement"];this.KWe_(this.E8_,this.Qpi_,this.eb_)}return this}JV_(){return{plot:this.E8_,target:this.eb_,domelement:this.Qpi_}}ZWe_(t,i){const s=this.Qpi_.getBoundingClientRect(),e=this.E8_.getSize(hFt);return{x:(t-s.left)/(s.right-s.left)*e.Ie_(),y:(i-s.top)/(s.bottom-s.top)*e.Ts_()}}dispose(){this.E8_=null;this.eb_=null;this.Qpi_=null;super.dispose()}};i=t([_s("geotoolkit3d.tool.devicesupport.AbstractDeviceSupport")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXR1cCI6IktXZV8iLCJnZXRPcHRpb25zIjoiSlZfIn19fSAg");const oFt={contextmenu:"contextmenu",mousedown:"mousedown",mousemove:"mousemove",mouseup:"mouseup",wheel:"wheel",DOMMouseScroll:"DOMMouseScroll",touchstart:"touchstart",touchend:"touchend",touchmove:"touchmove",dblclick:"dblclick"};var lFt=Ci(function(){let i=class t extends rFt{static isSupported(){return"ontouchstart"in Mi}KWe_(t,i,s){const e=this;let A=null;const n=t=>{t["plotXs"]=[];t["plotYs"]=[];let i=0;for(;i<t.touches.length;i++){const s=this.ZWe_(t.touches[i].clientX,t.touches[i].clientY);t["plotXs"].push(s.x);t["plotYs"].push(s.y)}if(t.touches.length===0){const s=this.ZWe_(A.touches[i].clientX,A.touches[i].clientY);t["plotXs"].push(s.x);t["plotYs"].push(s.y)}t["plotX"]=t["plotXs"][0];t["plotY"]=t["plotYs"][0]};this._We_=function(t){A=t;n(t);e.notify(nFt.kWe_,e,t)};this.$We_=function(t){n(t);e.notify(nFt.FWe_,e,t);t.touches.length>0&&e.notify(nFt.kWe_,e,t)};this.tze_=function(t){A=t;n(t);e.notify(nFt.xWe_,e,t)};super.KWe_(t,i,s);this.ize_()}dispose(){this.sze_();super.dispose()}ize_(){this.Qpi_.addEventListener(oFt["contextmenu"],this.HWe_,!1);this.Qpi_.addEventListener(oFt["mousedown"],this.zWe_,!1);this.Qpi_.addEventListener(oFt["mousemove"],this.jWe_,!1);this.Qpi_.addEventListener(oFt["mouseup"],this.VWe_,!1);this.Qpi_.addEventListener(oFt["wheel"],this.qWe_,!1);this.Qpi_.addEventListener(oFt["DOMMouseScroll"],this.qWe_,!1);this.Qpi_.addEventListener(oFt["touchstart"],this._We_,!1);this.Qpi_.addEventListener(oFt["touchend"],this.$We_,!1);this.Qpi_.addEventListener(oFt["touchmove"],this.tze_,!1);this.Qpi_.addEventListener(oFt["dblclick"],this.XWe_,!1);Mi.addEventListener("keydown",this.JWe_,!1);Mi.addEventListener("keyup",this.PWe_,!1)}sze_(){this.Qpi_.removeEventListener(oFt["contextmenu"],this.HWe_,!1);this.Qpi_.removeEventListener(oFt["mousedown"],this.zWe_,!1);this.Qpi_.removeEventListener(oFt["mousemove"],this.jWe_,!1);this.Qpi_.removeEventListener(oFt["mouseup"],this.VWe_,!1);this.Qpi_.removeEventListener(oFt["wheel"],this.qWe_,!1);this.Qpi_.removeEventListener(oFt["DOMMouseScroll"],this.qWe_,!1);this.Qpi_.removeEventListener(oFt["touchstart"],this._We_,!1);this.Qpi_.removeEventListener(oFt["touchend"],this.$We_,!1);this.Qpi_.removeEventListener(oFt["touchmove"],this.tze_,!1);this.Qpi_.removeEventListener(oFt["dblclick"],this.XWe_,!1);Mi.removeEventListener("keydown",this.JWe_,!1);Mi.removeEventListener("keyup",this.PWe_,!1);this.HWe_=null;this.zWe_=null;this.jWe_=null;this.VWe_=null;this.qWe_=null;this._We_=null;this.$We_=null;this.tze_=null;this.XWe_=null;this.JWe_=null;this.PWe_=null}};i=t([_s("geotoolkit3d.tool.devicesupport.TouchDeviceSupport")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXR1cCI6IktXZV8ifX19");const uFt={contextmenu:"contextmenu",wheel:"wheel",DOMMouseScroll:"DOMMouseScroll",touchstart:"pointerdown",touchend:"pointerup",touchout:"pointerout",touchmove:"pointermove"};function aFt(t){t.Qpi_.addEventListener(uFt["contextmenu"],t.HWe_,!1);t.Qpi_.addEventListener(uFt["wheel"],t.qWe_,!1);t.Qpi_.addEventListener(uFt["DOMMouseScroll"],t.qWe_,!1);t.Qpi_.addEventListener(uFt["touchstart"],t.eze_,!1);t.Qpi_.addEventListener(uFt["touchend"],t.Aze_,!1);t.Qpi_.addEventListener(uFt["touchmove"],t.nze_,!1);t.Qpi_.addEventListener(uFt["touchout"],t.hze_,!1);Mi.addEventListener("keydown",t.JWe_,!1);Mi.addEventListener("keyup",t.PWe_,!1)}function gFt(t){t.Qpi_.removeEventListener(uFt["contextmenu"],t.HWe_,!1);t.Qpi_.removeEventListener(uFt["wheel"],t.qWe_,!1);t.Qpi_.removeEventListener(uFt["DOMMouseScroll"],t.qWe_,!1);t.Qpi_.removeEventListener(uFt["touchstart"],t.eze_,!1);t.Qpi_.removeEventListener(uFt["touchend"],t.Aze_,!1);t.Qpi_.removeEventListener(uFt["touchmove"],t.nze_,!1);t.Qpi_.removeEventListener(uFt["touchout"],t.hze_,!1);Mi.removeEventListener("keydown",t.JWe_,!1);Mi.removeEventListener("keyup",t.PWe_,!1);t.HWe_=null;t.qWe_=null;t.eze_=null;t.Aze_=null;t.nze_=null;t.hze_=null;t.JWe_=null;t.PWe_=null}var cFt=Ci(function(){let i=class t extends rFt{constructor(t){super(t);this.Ei_={rze_:[],running:!1,visible:!1}}static isSupported(){return Mi["PointerEvent"]!=null}OWe_(t,i){const s=t,e=this.ZWe_(s.clientX,s.clientY);s["plotX"]=Math.floor(e.x);s["plotY"]=Math.floor(e.y);s["plotXs"]=[];s["plotYs"]=[];let A=!1;if(i!=null)for(let t=0;t<i.length;t++)if(i[t].pointerId===s.pointerId){s["plotXs"].push(s["plotX"]);s["plotYs"].push(s["plotY"]);i[t]=s;A=!0}else{s["plotXs"].push(i[t]["plotX"]);s["plotYs"].push(i[t]["plotY"])}if(!A){s["plotXs"].push(s["plotX"]);s["plotYs"].push(s["plotY"])}if(s.pointerType!=="touch"&&!this.Ei_.visible){this.Ei_.visible=!0;s["windowVisibility"]="visible";this.notify("onVisibilityChanged",this,s)}}KWe_(t,i,s){const e=this;e.eze_=function(t){e.OWe_(t,e.Ei_.rze_);const i=t;if(i.pointerType==="touch"){if(e.Ei_.running){e.notify(nFt.FWe_,e,i);e.Ei_.running=!1}e.Ei_.rze_.push(i)}else e.notify(nFt.zFt_,e,i);e.TWe_=i};e.Aze_=function(t){e.OWe_(t,e.Ei_.rze_);if(t.pointerType==="touch"){let i=!1,s;for(s=0;s<e.Ei_.rze_.length;s++)if(e.Ei_.rze_[s].pointerId===t.pointerId){i=!0;break}if(!i)return;e.Ei_.rze_.splice(s,1);e.notify(nFt.FWe_,e,t);e.Ei_.running=!1;if(e.Ei_.rze_.length>0){e.OWe_(e.Ei_.rze_[e.Ei_.rze_.length-1],e.Ei_.rze_);e.notify(nFt.kWe_,e,t);e.Ei_.running=!0}}else e.notify(nFt.Ct_,e,t);e.TWe_=t};e.nze_=function(t){if(e.TWe_==null||e.TWe_["clientX"]!==t["clientX"]||e.TWe_["clientY"]!==t["clientY"]||e.TWe_["movementX"]!==t["movementX"]||e.TWe_["movementY"]!==t["movementY"]){e.OWe_(t,e.Ei_.rze_);if(t.pointerType==="touch"){if(!e.Ei_.running){e.Ei_.rze_.length===0&&e.eze_(t);e.notify(nFt.kWe_,e,t);e.Ei_.running=!0}if(e.Ei_.rze_.length===3&&e.Ei_.rze_[0].pointerId!==t.pointerId)return;e.notify(nFt.xWe_,e,t)}else e.notify(nFt.XFt_,e,t);e.TWe_=t}};e.hze_=function(t){if(t.pointerType==="touch")e.Aze_(t);else{e.OWe_(t,e.Ei_.rze_);const i=t;e.notify(nFt.RWe_,e,i);if(e.Ei_.visible){e.Ei_.visible=!1;i["windowVisibility"]="hidden";e.notify("onVisibilityChanged",e,i)}e.TWe_=i}};super.KWe_(t,i,s);aFt(this)}dispose(){gFt(this);super.dispose()}};i=t([_s("geotoolkit3d.tool.devicesupport.PointerDeviceSupport")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXR1cCI6IktXZV8ifX19");const IFt={contextmenu:"contextmenu",mousedown:"mousedown",mousemove:"mousemove",mouseup:"mouseup",wheel:"wheel",DOMMouseScroll:"DOMMouseScroll",dblclick:"dblclick",mouseout:"mouseout"};function fFt(t){t.Qpi_.addEventListener(IFt["contextmenu"],t.HWe_,!1);t.Qpi_.addEventListener(IFt["mousedown"],t.zWe_,!1);t.Qpi_.addEventListener(IFt["mousemove"],t.jWe_,!1);t.Qpi_.addEventListener(IFt["mouseup"],t.VWe_,!1);t.Qpi_.addEventListener(IFt["wheel"],t.qWe_,!1);t.Qpi_.addEventListener(IFt["DOMMouseScroll"],t.qWe_,!1);t.Qpi_.addEventListener(IFt["dblclick"],t.XWe_,!1);t.Qpi_.addEventListener(IFt["mouseout"],t.WWe_,!1);Mi.addEventListener("keydown",t.JWe_,!1);Mi.addEventListener("keyup",t.PWe_,!1);t.oze_==="onfocuschange"?Mi.document.onfocusin=Mi.document.onfocusout=t.lze_:t.oze_===""?Mi["onpageshow"]=Mi["onpagehide"]=Mi.onfocus=Mi.onblur=t.uze_:Mi.document.addEventListener(t.oze_,t.lze_);Mi.addEventListener("blur",t.lze_);Mi.addEventListener("focus",t.lze_)}function CFt(t){t.Qpi_.removeEventListener(IFt["contextmenu"],t.HWe_,!1);t.Qpi_.removeEventListener(IFt["mousedown"],t.zWe_,!1);t.Qpi_.removeEventListener(IFt["mousemove"],t.jWe_,!1);t.Qpi_.removeEventListener(IFt["mouseup"],t.VWe_,!1);t.Qpi_.removeEventListener(IFt["wheel"],t.qWe_,!1);t.Qpi_.removeEventListener(IFt["DOMMouseScroll"],t.qWe_,!1);t.Qpi_.removeEventListener(IFt["dblclick"],t.XWe_,!1);t.Qpi_.removeEventListener(IFt["mouseout"],t.WWe_,!1);Mi.removeEventListener("keydown",t.JWe_,!1);Mi.removeEventListener("keyup",t.PWe_,!1);t.oze_==="onfocuschange"?Mi.document.onfocusin=Mi.document.onfocusout=null:t.oze_===""?Mi["onpageshow"]=Mi["onpagehide"]=Mi.onfocus=Mi.onblur=null:Mi.document.removeEventListener(t.oze_,t.lze_,!1);Mi.removeEventListener("blur",t.lze_,!1);Mi.removeEventListener("focus",t.lze_,!1);t.HWe_=null;t.zWe_=null;t.jWe_=null;t.VWe_=null;t.WWe_=null;t.qWe_=null;t.XWe_=null;t.JWe_=null;t.PWe_=null}var dFt=Ci(function(){let i=class t extends rFt{constructor(t){super(t);this.oze_="";this.aze_="hidden";this.aze_ in Mi.document?this.oze_="visibilitychange":(this.aze_="mozHidden")in Mi.document?this.oze_="mozvisibilitychange":(this.aze_="webkitHidden")in Mi.document?this.oze_="webkitvisibilitychange":(this.aze_="msHidden")in Mi.document?this.oze_="msvisibilitychange":"onfocusin"in Mi.document&&(this.oze_="onfocuschange")}static isSupported(){return!0}KWe_(t,i,s){const e=this;function A(t){if(t.type==="blur"){t.gze_="hidden";return}if(t.type==="focus"){t.gze_="visible";return}const i="visible",s="hidden",A={focus:i,cze_:i,Ize_:i,blur:s,fze_:s,Cze_:s};(t=t||Mi.event).type in A?t.gze_=A[t.type]:t.gze_=this[e.aze_]?"hidden":"visible"}e.lze_=function(t){A(t);e.notify("onVisibilityChanged",e,t)};super.KWe_(t,i,s);fFt(this)}dispose(){CFt(this);super.dispose()}};i=t([_s("geotoolkit3d.tool.devicesupport.MouseDeviceSupport")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXR1cCI6IktXZV8ifX19");const BFt=[];let wFt=null;var QFt=Ci(function(){let i=class t{static dze_(t){wFt=t}static Bze_(){let t=null;for(let i=0;i<BFt.length;i++){t=BFt[i];if(t.isSupported!=null){if(t.isSupported())break;t=null}else Gi("Warning: "+t.D_()+" is not implementing isSupported()")}return t!=null?t:wFt}static wze_(){return BFt}};i=t([_s("geotoolkit3d.tool.devicesupport.DeviceSupportRegistry")],i);return i}(),2,"eyJzZXREZWZhdWx0RGV2aWNlU3VwcG9ydCI6ImR6ZV8iLCJnZXREZXZpY2VTdXBwb3J0IjoiQnplXyIsImdldEFsbERldmljZVN1cHBvcnQiOiJ3emVfIiwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");QFt.wze_().push(lFt);QFt.wze_().push(cFt);QFt.dze_(dFt);const EFt=new RegExp(/touch/),pFt=new RegExp(/pointer/);var mFt=Ci(function(){var i;let s=i=class t extends $n{constructor(t){super();this.Qpi_=t["domelement"];const i=QFt.Bze_(),s=qi(t,{target:this,name:"abstracttool"});this.$v_={};if(i!=null){this.Qze_=new i(s);this.KWe_(this.Qze_)}this.ov_=s["name"];this.E8_=s["plot"]}setOptions(t){const i=qi(t,{name:this.ov_,plot:this.E8_});this.Qze_!=null&&this.Qze_.setOptions(t);this.ov_=i["name"];this.E8_=i["plot"];return this}JV_(){const t=this.Qze_.JV_();t["name"]=this.dn_();t["plot"]=this.E8_;return t}dFt_(t){t instanceof FS&&(t=t.Lkt_());return EFt.test(t.type)||pFt.test(t.type)&&t["pointerType"]!=="mouse"}KWe_(t){const s=(t,s,e)=>{Object.getPrototypeOf(this)!==i.prototype&&this.GWe_(e);this.notify(t,this,e)};this.$v_[nFt.GWe_]=s;t.on(nFt.GWe_,s);const e=(t,s,e)=>{Object.getPrototypeOf(this)!==i.prototype&&this.zFt_(e);this.notify(t,this,e)};this.$v_[nFt.zFt_]=e;t.on(nFt.zFt_,e);const A=(t,s,e)=>{Object.getPrototypeOf(this)!==i.prototype&&this.XFt_(e);this.notify(t,this,e)};this.$v_[nFt.XFt_]=A;t.on(nFt.XFt_,A);const n=(t,s,e)=>{Object.getPrototypeOf(this)!==i.prototype&&this.Ct_(e);this.notify(t,this,e)};this.$v_[nFt.Ct_]=n;t.on(nFt.Ct_,n);const h=(t,s,e)=>{Object.getPrototypeOf(this)!==i.prototype&&this.RWe_(e);this.notify(t,this,e)};this.$v_[nFt.RWe_]=h;t.on(nFt.RWe_,h);const r=(t,s,e)=>{Object.getPrototypeOf(this)!==i.prototype&&this.jFt_(e);this.notify(t,this,e)};this.$v_[nFt.jFt_]=r;t.on(nFt.jFt_,r);const o=(t,s,e)=>{Object.getPrototypeOf(this)!==i.prototype&&this.kWe_(e);this.notify(t,this,e)};this.$v_[nFt.kWe_]=o;t.on(nFt.kWe_,o);const l=(t,s,e)=>{Object.getPrototypeOf(this)!==i.prototype&&this.FWe_(e);this.notify(t,this,e)};this.$v_[nFt.FWe_]=l;t.on(nFt.FWe_,l);const u=(t,s,e)=>{Object.getPrototypeOf(this)!==i.prototype&&this.xWe_(e);this.notify(t,this,e)};this.$v_[nFt.xWe_]=u;t.on(nFt.xWe_,u);const a=(t,s,e)=>{Object.getPrototypeOf(this)!==i.prototype&&this.WFt_(e);this.notify(nFt.WFt_,this,e)};this.$v_[nFt.WFt_]=a;t.on(nFt.WFt_,a);const g=(t,s,e)=>{Object.getPrototypeOf(this)!==i.prototype&&this.IPt_(e);this.notify(t,this,e)};this.$v_[nFt.IPt_]=g;t.on(nFt.IPt_,g);const c=(t,s,e)=>{Object.getPrototypeOf(this)!==i.prototype&&this.fPt_(e);this.notify(t,this,e)};this.$v_[nFt.fPt_]=c;t.on(nFt.fPt_,c);const I=(t,s,e)=>{Object.getPrototypeOf(this)!==i.prototype&&this.id_(e);this.notify(t,this,e)};this.$v_[nFt.id_]=I;t.on(nFt.id_,I);return this}dn_(){return this.ov_}getPlot(){return this.E8_}dispose(){this.E8_=null;if(this.Qze_!=null){this.Qze_.dispose();this.Qze_=null}this.Qpi_=null;super.dispose()}};s.prototype.GWe_=Zi;s.prototype.zFt_=Zi;s.prototype.XFt_=Zi;s.prototype.Ct_=Zi;s.prototype.RWe_=Zi;s.prototype.jFt_=Zi;s.prototype.kWe_=Zi;s.prototype.FWe_=Zi;s.prototype.xWe_=Zi;s.prototype.WFt_=Zi;s.prototype.IPt_=Zi;s.prototype.fPt_=Zi;s.prototype.id_=Zi;s=i=t([_s("geotoolkit3d.tool.AbstractTool")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiaXNUb3VjaEV2ZW50IjoiZEZ0XyIsInNldHVwIjoiS1dlXyIsImdldE5hbWUiOiJkbl8iLCJvbkNvbnRleHQiOiJHV2VfIiwib25Nb3VzZURvd24iOiJ6RnRfIiwib25Nb3VzZU1vdmUiOiJYRnRfIiwib25Nb3VzZVVwIjoiQ3RfIiwib25Nb3VzZU91dCI6IlJXZV8iLCJvbk1vdXNlV2hlZWwiOiJqRnRfIiwib25Ub3VjaFN0YXJ0Ijoia1dlXyIsIm9uVG91Y2hFbmQiOiJGV2VfIiwib25Ub3VjaE1vdmUiOiJ4V2VfIiwib25Eb3VibGVDbGljayI6IldGdF8iLCJvbktleURvd24iOiJJUHRfIiwib25LZXlVcCI6ImZQdF8iLCJvblZpc2liaWxpdHlDaGFuZ2VkIjoiaWRfIn19fSAg");var yFt={NONE:"none",MB1:"mb",MB2:"mb2",MB3:"mb3",Eze_:"touch1",pze_:"touch2",mze_:"touch3",yze_:"drag",Dze_:"slide",Mze_:"pinch"};const DFt=()=>{},MFt={vze_:DFt,bze_:DFt,Nze_:DFt,Sze_:DFt,Gze_:DFt,Rze_:DFt,kze_:DFt,Fze_:DFt,xze_:DFt,Lze_:DFt,aWt_:DFt,Uze_:DFt,Yze_:DFt,Tze_:DFt,Kze_:DFt,Hze_:DFt,qze_:DFt};var vFt=Ci(function(){let i=class t extends mFt{constructor(t){super(t);const i=qi(t,{state:yFt.NONE,dragbutton:0,pinchbutton:1,slidebutton:2,dragtouchcount:1,pinchtouchcount:2,slidetouchcount:3,doubletapdelay:250,name:"abstractgesturetool",radius:0,armingkey:null},!0);this.setOptions(i);this.Jze_(this.Pze_==null);this.Xz_=i["radius"];this.Zkt_=0;this.Vze_=0;this.Oze_=!1;this.Wze_={}}setOptions(t){const i=qi(t,{state:this.zze_,dragbutton:this.Xze_,pinchbutton:this.jze_,slidebutton:this.Zze_,dragtouchcount:this._ze_,pinchtouchcount:this.$ze_,slidetouchcount:this.tXe_,doubletapdelay:this.iXe_,armingkey:this.Pze_,radius:this.Xz_},!0);this.sXe_(i["state"]);this.Xz_=i["radius"];this.Xze_=+i["dragbutton"];this.jze_=+i["pinchbutton"];this.Zze_=+i["slidebutton"];this._ze_=+i["dragtouchcount"];this.$ze_=+i["pinchtouchcount"];this.tXe_=+i["slidetouchcount"];this.iXe_=+i["doubletapdelay"];const s=this.Pze_;this.Pze_=i["armingkey"]!=null?+i["armingkey"]:null;this.Pze_!==s&&(s!=null&&this.Pze_!=null||s==null?this.Jze_(!1):this.Jze_(!0));super.setOptions(t);return this}JV_(){const t=super.JV_();t["radius"]=this.Xz_;t["dragbutton"]=this.Xze_;t["pinchbutton"]=this.jze_;t["slidebutton"]=this.Zze_;t["dragtouchcount"]=this._ze_;t["pinchtouchcount"]=this.$ze_;t["slidetouchcount"]=this.tXe_;t["doubletapdelay"]=this.iXe_;t["armingkey"]=this.Pze_;return t}sXe_(t,i){this.zze_=t}GWe_(t){this.eXe_&&t.preventDefault()}zFt_(t){this.eXe_&&t.preventDefault();switch(t.button){case this.Xze_:this.sXe_(yFt.MB1,t);break;case this.jze_:this.sXe_(yFt.MB2,t);break;case this.Zze_:this.sXe_(yFt.MB3,t);break}t.shiftKey&&this.sXe_(yFt.MB3,t)}XFt_(t){this.eXe_&&t.preventDefault();let i;switch(this.zze_){case yFt.NONE:this.TK_.Sze_(t);break;case yFt.MB1:this.sXe_(yFt.yze_,t);this.TK_.Lze_(t);break;case yFt.MB2:this.sXe_(yFt.Mze_,t);i=t;i["distanceX"]=i["plotY"];i["distanceY"]=i["plotY"];this.TK_.kze_(i);break;case yFt.MB3:this.sXe_(yFt.Dze_,t);this.TK_.Yze_(t);break;case yFt.yze_:this.TK_.aWt_(t);break;case yFt.Mze_:i=t;if(i["plotXs"].length>1){i["distanceX"]=Math.abs(i["plotXs"][0]-i["plotXs"][1]);i["distanceY"]=Math.abs(i["plotYs"][0]-i["plotYs"][1])}else{i["distanceX"]=i["plotY"];i["distanceY"]=i["plotY"]}this.TK_.Fze_(i);break;case yFt.Dze_:this.TK_.Tze_(t);break;default:this.sXe_(yFt.NONE,t)}}RWe_(t){this.Ct_(t);this.Sze_(t)}Ct_(t){this.eXe_&&t.preventDefault();switch(this.zze_){case yFt.MB1:Date.now()-this.Zkt_<this.iXe_?this.TK_.Rze_(t):this.TK_.Gze_(t);this.Zkt_=Date.now();case yFt.MB2:case yFt.MB3:this.sXe_(yFt.NONE,t);break;case yFt.yze_:this.sXe_(yFt.NONE,t);this.TK_.Uze_(t);break;case yFt.Dze_:this.sXe_(yFt.NONE,t);this.TK_.Kze_(t);break;case yFt.Mze_:this.sXe_(yFt.NONE,t);this.TK_.xze_(t);break;default:this.sXe_(yFt.NONE,t)}}WFt_(t){this.eXe_&&t.preventDefault();this.sXe_(yFt.NONE,t);this.TK_.Rze_(t)}kWe_(t){this.eXe_||t.preventDefault();switch(t["plotXs"].length){case 1:this.sXe_(yFt.Eze_,t);break;case 2:this.sXe_(yFt.pze_,t);break;case 3:this.sXe_(yFt.mze_,t);break}this.Oze_=!0}FWe_(t){this.eXe_&&t.preventDefault();if(!this.Oze_)switch(t["plotXs"].length){case 1:this.sXe_(yFt.Eze_,t);break;case 2:this.sXe_(yFt.pze_,t);break;case 3:this.sXe_(yFt.mze_,t);break}switch(this.zze_){case yFt.Eze_:Date.now()-this.Zkt_<this.iXe_?this.TK_.Rze_(t):this.TK_.Gze_(t);this.Zkt_=Date.now();case yFt.pze_:case yFt.mze_:this.sXe_(yFt.NONE,t);break;case yFt.yze_:this.sXe_(yFt.NONE,t);this.TK_.Uze_(t);break;case yFt.Dze_:this.sXe_(yFt.NONE,t);this.TK_.Kze_(t);break;case yFt.Mze_:this.sXe_(yFt.NONE,t);this.TK_.xze_(t);break;default:this.sXe_(yFt.NONE,t)}this.Oze_=!1}xWe_(t){let i;this.eXe_&&t.preventDefault();switch(this.zze_){case yFt.NONE:this.TK_.Sze_(t);break;case yFt.Eze_:this.sXe_(yFt.yze_,t);this.TK_.Lze_(t);break;case yFt.pze_:this.sXe_(yFt.Mze_,t);i=t;i["distanceX"]=Math.abs(i["plotXs"][0]-i["plotXs"][1]);i["distanceY"]=Math.abs(i["plotYs"][0]-i["plotYs"][1]);this.TK_.kze_(i);break;case yFt.mze_:this.sXe_(yFt.Dze_,t);this.TK_.Yze_(t);break;case yFt.yze_:this.TK_.aWt_(t);break;case yFt.Mze_:if(t["plotXs"].length===2){i=t;i["distanceX"]=Math.abs(i["plotXs"][0]-i["plotXs"][1]);i["distanceY"]=Math.abs(i["plotYs"][0]-i["plotYs"][1]);this.TK_.Fze_(i)}break;case yFt.Dze_:this.TK_.Tze_(t);break;default:this.sXe_(yFt.NONE,t)}}IPt_(t){this.eXe_||this.Jze_(t["keyCode"]===this.Pze_);if(this.Wze_[t["keyCode"]]!=null)this.TK_.bze_(t);else{this.Wze_[t["keyCode"]]={since:Date.now()};this.TK_.vze_(t)}}id_(t){t["windowVisibility"]==="visible"?this.TK_.Hze_(t):this.TK_.qze_(t)}fPt_(t){this.TK_.Nze_(t);if(this.Wze_[t["keyCode"]]!=null){this.Wze_[t["keyCode"]]=null;delete this.Wze_[t["keyCode"]]}this.eXe_&&this.Jze_(t["keyCode"]!==this.Pze_)}AXe_(){return this.Wze_}Jze_(t){if(this.eXe_!==t){this.TK_=t?{vze_:this.vze_.bind(this),bze_:this.bze_.bind(this),Nze_:this.Nze_.bind(this),Hze_:this.Hze_.bind(this),qze_:this.qze_.bind(this),Sze_:this.Sze_.bind(this),Gze_:this.Gze_.bind(this),Rze_:this.Rze_.bind(this),kze_:this.kze_.bind(this),Fze_:this.Fze_.bind(this),xze_:this.xze_.bind(this),Lze_:this.Lze_.bind(this),aWt_:this.aWt_.bind(this),Uze_:this.Uze_.bind(this),Yze_:this.Yze_.bind(this),Tze_:this.Tze_.bind(this),Kze_:this.Kze_.bind(this)}:MFt;this.eXe_=t}}dispose(){this.TK_=null;this.Wze_=null;super.dispose()}};i.prototype.vze_=Zi;i.prototype.bze_=Zi;i.prototype.Nze_=Zi;i.prototype.Hze_=Zi;i.prototype.qze_=Zi;i.prototype.Sze_=Zi;i.prototype.Gze_=Zi;i.prototype.Rze_=Zi;i.prototype.kze_=Zi;i.prototype.Fze_=Zi;i.prototype.xze_=Zi;i.prototype.Lze_=Zi;i.prototype.aWt_=Zi;i.prototype.Uze_=Zi;i.prototype.Yze_=Zi;i.prototype.Tze_=Zi;i.prototype.Kze_=Zi;i=t([_s("geotoolkit3d.tool.AbstractGestureTool")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwib25Db250ZXh0IjoiR1dlXyIsIm9uTW91c2VEb3duIjoiekZ0XyIsIm9uTW91c2VNb3ZlIjoiWEZ0XyIsIm9uTW91c2VPdXQiOiJSV2VfIiwib25Nb3VzZVVwIjoiQ3RfIiwib25Eb3VibGVDbGljayI6IldGdF8iLCJvblRvdWNoU3RhcnQiOiJrV2VfIiwib25Ub3VjaEVuZCI6IkZXZV8iLCJvblRvdWNoTW92ZSI6InhXZV8iLCJvbktleURvd24iOiJJUHRfIiwib25WaXNpYmlsaXR5Q2hhbmdlZCI6ImlkXyIsIm9uS2V5VXAiOiJmUHRfIiwib25LZXlTdGFydCI6InZ6ZV8iLCJvbktleSI6ImJ6ZV8iLCJvbktleUVuZCI6Ik56ZV8iLCJvblZpc2liaWxpdHlHYWluZWQiOiJIemVfIiwib25WaXNpYmlsaXR5TG9zdCI6InF6ZV8iLCJvbkN1cnNvck1vdmUiOiJTemVfIiwib25UYXAiOiJHemVfIiwib25Eb3VibGVUYXAiOiJSemVfIiwib25QaW5jaFN0YXJ0Ijoia3plXyIsIm9uUGluY2giOiJGemVfIiwib25QaW5jaEVuZCI6Inh6ZV8iLCJvbkRyYWdTdGFydCI6Ikx6ZV8iLCJvbkRyYWciOiJhV3RfIiwib25EcmFnRW5kIjoiVXplXyIsIm9uU2xpZGVTdGFydCI6Ill6ZV8iLCJvblNsaWRlIjoiVHplXyIsIm9uU2xpZGVFbmQiOiJLemVfIn19fSAg");var bFt=Ci(function(){let i=class t extends vFt{constructor(t){const i=qi(t,{enabled:!0,nozoom:!1,nopan:!1,zoomspeed:1});super(i);this.nXe_=!0;this.hXe_(i)}setOptions(t){if(t==null)return this;super.setOptions(t);this.hXe_(t);return this}hXe_(t){if(!this.nXe_)return;const i=qi(t,{enabled:this.xv_,zoomspeed:this.rXe_,nozoom:this.oXe_,nopan:this.lXe_,camera:this.uXe_,position:this.uXe_!=null?this.uXe_.position:this.aXe_,lookat:this.eb_});this.uXe_=i["camera"];this.xv_=i["enabled"];this.rXe_=i["zoomspeed"];this.oXe_=i["nozoom"];this.lXe_=i["nopan"];i["lookat"]!=null&&(this.eb_=i["lookat"].clone());i["position"]!=null&&(this.aXe_=i["position"].clone())}JV_(){const t=super.JV_();t["enabled"]=this.xv_;t["nozoom"]=this.oXe_;t["zoomspeed"]=this.rXe_;t["nopan"]=this.lXe_;t["camera"]=this.uXe_;this.eb_!=null&&(t["lookat"]=this.eb_.clone());this.aXe_!=null&&(t["position"]=this.aXe_.clone());return t}Sze_(t){}Gze_(t){}vze_(t){}bze_(t){}Nze_(t){}Hze_(t){}qze_(t){}Rze_(t){}Lze_(t){}aWt_(t){}Uze_(t){}kze_(t){}Fze_(t){}xze_(t){}Yze_(t){}Tze_(t){}Kze_(t){}akt_(){return this.eb_}gXe_(){return this.uXe_}isEnabled(){return this.xv_}cXe_(){return this.lXe_}IXe_(){return this.oXe_}getPosition(){return this.aXe_}fXe_(){return this.rXe_}dispose(){this.uXe_=null;super.dispose()}CXe_(){}};i=t([_s("geotoolkit3d.controller.AbstractController")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwib25DdXJzb3JNb3ZlIjoiU3plXyIsIm9uVGFwIjoiR3plXyIsIm9uS2V5U3RhcnQiOiJ2emVfIiwib25LZXkiOiJiemVfIiwib25LZXlFbmQiOiJOemVfIiwib25WaXNpYmlsaXR5R2FpbmVkIjoiSHplXyIsIm9uVmlzaWJpbGl0eUxvc3QiOiJxemVfIiwib25Eb3VibGVUYXAiOiJSemVfIiwib25EcmFnU3RhcnQiOiJMemVfIiwib25EcmFnIjoiYVd0XyIsIm9uRHJhZ0VuZCI6IlV6ZV8iLCJvblBpbmNoU3RhcnQiOiJremVfIiwib25QaW5jaCI6IkZ6ZV8iLCJvblBpbmNoRW5kIjoieHplXyIsIm9uU2xpZGVTdGFydCI6Ill6ZV8iLCJvblNsaWRlIjoiVHplXyIsIm9uU2xpZGVFbmQiOiJLemVfIiwiZ2V0Q2FtZXJhIjoiZ1hlXyJ9fX0g");var NFt=Ci(function(){let i=class t extends bFt{setOptions(){return this}dispose(){}dn_(){return"EmptyController"}jFt_(){}};i=t([_s("geotoolkit3d.scene.EmptyController")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXROYW1lIjoiZG5fIiwib25Nb3VzZVdoZWVsIjoiakZ0XyJ9fSwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");const SFt=new A(1,255,255*255,255*255*255),GFt=new A(1/SFt.x,1/SFt.y,1/SFt.z,1/SFt.w),RFt=(t,i,s,e)=>{const A=(t,i,s)=>{const e=t.getShaderInfoLog(i).trim(),A="Errors in "+s+":"+"\n\n"+e;if(e!==""){const s=undefined,e=t.getShaderSource(i).replaceAll("\t","  ").split("\n");let n="",h=1;for(const t of e){n+=(h<10?" ":"")+h+":\t\t"+t+"\n";h++}Fi(A+"\n"+n)}};A(t,s,"Vertex Shader");A(t,e,"Fragment Shader")};let kFt=new A,FFt=new A;const xFt=new A,LFt=new A(1/255,1/255,1/255,0),UFt=new A;var YFt=Ci(function(){var i;let s=i=class t{static dXe_(t){kFt.copy(SFt);kFt.multiplyScalar(t);FFt.copy(kFt);FFt=FFt.floor();kFt=kFt.sub(FFt);xFt.set(kFt.y,kFt.z,kFt.w,kFt.w);xFt.x*=LFt.x;xFt.y*=LFt.y;xFt.z*=LFt.z;xFt.w*=LFt.w;kFt=kFt.sub(xFt);return kFt}static BXe_(t){return i.dXe_(t).multiplyScalar(255).round()}static wXe_(t){t instanceof A?UFt.copy(t):UFt.set(t[0],t[1],t[2],t[3]);return i.QXe_(UFt.divideScalar(255))}static QXe_(t){return t.dot(GFt)}static EXe_(t,i,s,e,A){e||(s=A?[s,i].join("\n"):[i,s].join("\n"));return t=t.replace(i,s)}};s=i=t([_s("geotoolkit3d.util.Shaders")],s);return s}(),2,"eyJwYWNrRmxvYXRUb1ZlYzQiOiJkWGVfIiwicGFja0Zsb2F0VG9SR0JBIjoiQlhlXyIsInVucGFja1JHQkFUb0Zsb2F0Ijoid1hlXyIsInVucGFja1ZlYzRUb0Zsb2F0IjoiUVhlXyIsImdldENsYXNzTmFtZSI6IkRfIn0g");const TFt=YFt,KFt="addedColorMapShaders",HFt="addedUnlitShaders",qFt=["#ifdef USE_LOGDEPTHBUF","    #ifdef USE_LOGDEPTHBUF_EXT","        vFragDepth = 1.0 + gl_Position.w;","        vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );","    #else","        if (isPerspectiveMatrix ( projectionMatrix)) {","           gl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC - 1.0;","           gl_Position.z *= gl_Position.w;","        }","    #endif","#endif"].join("\n");n.logdepthbuf_vertex=["#ifndef "+AFt,qFt,"#endif"].join("\n");n.logdepthbuf_fragment=["#ifndef "+AFt,"   #if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )","       gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;","   #endif","#endif"].join("\n");const JFt=1024,PFt="useDiffuseAsColor",VFt="cgcolormapTexture",OFt="cgcolormapParams",WFt="cgcolormapLogValue",zFt=["float Shaders_norm(float value, float srcmin, float srcmax, float dstmin, float dstmax) {","   float norm = dstmin + (dstmax - dstmin) * (clamp(value, srcmin, srcmax) - srcmin)  / (srcmax - srcmin);","   if (norm < 0.0 || norm >= 0.0) {","       return norm;","   }","   return 0.0;","}"].join("\n"),XFt=["vec3 outgoingLight;","if("+PFt+" == 1) {","    outgoingLight = diffuseColor.rgb;","}  else {","    outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;","}"].join("\n"),jFt="#ifdef USE_COLOR\n varying vec3 vColor;\n#endif",ZFt="CG_USE_COLOR_MAP",_Ft=t=>{if(!t.defines.hasOwnProperty(HFt)){t.defines[HFt]=!0;t.uniforms[PFt]=new h(0)}},$Ft=t=>{const i=t.userData.pXe_!=null&&1;if(i!==t.defines[ZFt]){t.defines[ZFt]=i;t.needsUpdate=!0}},txt=t=>{if(!t.defines.hasOwnProperty(KFt)){t.defines[KFt]=!0;t.uniforms[OFt]=new h(new A);t.uniforms[VFt]=new h(null);t.uniforms[WFt]=new h(0)}};var ixt=function(){var i;let s=i=class t{static mXe_(t,i){if(i){_Ft(t);if(i.hasOwnProperty("unlit")){t.uniforms[PFt].value=i["unlit"];t.needsUpdate=!0}}}static yXe_(t){_Ft(t);return{unlit:t.uniforms[PFt].value}}static DXe_(t){const i=t.uniforms,s=t.userData.pXe_;i[VFt].value!==null&&i[VFt].value.dispose();if(s!=null){const t=1,e=new dp(0,0,JFt,t);e.iQ_(new Fo({colorprovider:s,startpoint:new lA(0,t/2),endpoint:new lA(1,t/2),startcolor:"white",endcolor:"black"}));const A=gs();as(!1);const n=If.bV_(e,JFt,t,!1,!1,new mA(0,0,JFt,t));as(A);const h=new r(n.getCanvas());h.minFilter=o;i[VFt].value=h;i[VFt].value.needsUpdate=!0;let l=s.Em_(),u=s.pm_();const a=s instanceof ko||s instanceof Go;if(a){const t=s;l=t.hy_(l);u=t.hy_(u)}i[OFt].value.set(l,u-l,0,0);i[WFt].value=a?1:0}}static MXe_(t,s){if(s!=null){txt(t);s.hasOwnProperty("color")&&(t.color=s["color"]);if(s.hasOwnProperty("colorprovider")&&s["colorprovider"]!==t.userData.pXe_){t.userData.pXe_ instanceof Mo&&typeof t.vXe_=="function"&&t.userData.pXe_.off(mo.sC_,t.vXe_());t.userData.pXe_=s["colorprovider"];if(t.userData.pXe_ instanceof Mo&&typeof t.vXe_=="function"){t.userData.pXe_.on(mo.sC_,t.vXe_());t.color=new l(16777215)}else{if(typeof s["colorprovider"]=="string"){t.color=new l(s["colorprovider"]);t.opacity=nA.cs_(s["colorprovider"]).ds_()/255}else s["colorprovider"]instanceof l&&(t.color=s["colorprovider"]);t.userData.pXe_=null}t.needsUpdate=!0;i.DXe_(t)}$Ft(t)}}static bXe_(t){txt(t);return{color:t.color,colorprovider:t.userData.pXe_}}};s.NXe_=-999.25;s.SXe_="void main()";s.GXe_=i.SXe_+" {";s.RXe_="#include <color_vertex>";s.kXe_="#include <color_fragment>";s.FXe_="#include <shadowmap_vertex>";s.xXe_="#include <project_vertex>";s.LXe_="#include <logdepthbuf_vertex>";s.UXe_=ZFt;s.YXe_="vcgdeadCell";s.TXe_="cgcolormapValue";s.KXe_=["#ifdef "+i.UXe_,"    v"+i.TXe_+" = normValueForColorMap("+i.TXe_+");","#endif"].join("\n");s.HXe_=["#ifdef "+i.UXe_,"    attribute float "+i.TXe_+";","    varying float v"+i.TXe_+";","    uniform vec4 "+OFt+";","    uniform int "+WFt+";",zFt,"    float normValueForColorMap(float value) {","        if( "+WFt+" == 1)","        {","            value = log2(value)/log2(10.0);","        }","        return Shaders_norm(value - "+OFt+".x, 0.0, "+OFt+".y, 0.0, 1.0);","    }","#endif"].join("\n");s.qXe_=["#ifdef "+i.UXe_,"    diffuseColor *= getColorFromColorMap(v"+i.TXe_+");","#endif"].join("\n");s.JXe_=["#ifdef "+i.UXe_,"    varying float v"+i.TXe_+";","    uniform sampler2D "+VFt+";","    vec4 getColorFromColorMap(float normValue) {","        return texture2D("+VFt+", vec2(normValue, 0.5));","    }","#endif"].join("\n");s.PXe_=(t=>{t=TFt.EXe_(t,i.SXe_,i.HXe_,!1,!0);return t=TFt.EXe_(t,i.RXe_,i.KXe_,!1,!1)})(n.meshlambert_vert);s.VXe_=(t=>{t=TFt.EXe_(t,i.SXe_,["uniform int "+PFt+";",i.JXe_].join("\n"),!1,!0);t=TFt.EXe_(t,i.kXe_,i.qXe_,!1,!1);return t=TFt.EXe_(t,"vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;",XFt,!0)})(n.meshlambert_frag);s.OXe_=(t=>{t=TFt.EXe_(t,i.SXe_,[jFt,i.HXe_].join("\n"),!1,!0);return t=TFt.EXe_(t,i.RXe_,i.KXe_,!1,!1)})(n.meshbasic_vert);s.WXe_=(t=>{t=TFt.EXe_(t,i.SXe_,i.JXe_,!1,!0);return t=TFt.EXe_(t,i.kXe_,i.qXe_,!1,!1)})(n.meshbasic_frag);s=i=t([_s("geotoolkit3d.util.shaders.Shaders")],s);return s}();const sxt=100,ext=100,Axt=["#ifndef SHADER_ROUND_FLOAT","\t#define SHADER_ROUND_FLOAT","\tfloat Shaders_round(float v) {","\t\treturn floor(v + 0.5);","\t}","#endif"].join("\n"),nxt=["#ifndef SHADER_FLOAT_TO_VEC4","\t#define SHADER_FLOAT_TO_VEC4","\tvec4 Shaders_FloatToVec4( float v ) {","\t\tvec4 enc = vec4(1.0, 255.0, 255.0 * 255.0, 255.0 * 255.0 * 255.0) * clamp(v, 0., 0.9999999);","\t\tenc = fract(enc);","\t\tenc -= enc.yzww * vec4(1.0/255.0,1.0/255.0,1.0/255.0,0.0);","\t\treturn enc;","\t}","#endif"].join("\n"),hxt=["#define "+AFt,"#define cgPickingModeID "+tFt.Id+".0","#define cgPickingModeX "+tFt.X+".0","#define cgPickingModeY "+tFt.Y+".0","#define cgPickingModeZ "+tFt.Z+".0"].join("\n"),rxt=["uniform mat4 cgpickingViewProjNormInv;","uniform float cgpickingmode;","uniform vec4 cgpickingrgba;","varying vec4 cgvcolor;","varying float cgvpickingmode;"].join("\n"),oxt=["if(Shaders_round(cgpickingmode) == Shaders_round(cgPickingModeID)){","\tcgvcolor = cgpickingrgba;","} else {","\tcgvcolor = cgpickingViewProjNormInv * gl_Position;","}","cgvpickingmode = cgpickingmode;"].join("\n"),lxt=["varying vec4 cgvcolor;","varying float cgvpickingmode;"].join("\n"),uxt=["\tif(Shaders_round(cgvpickingmode) == Shaders_round(cgPickingModeX)) {","\t\tgl_FragColor = Shaders_FloatToVec4(cgvcolor.x);","\t} else if(Shaders_round(cgvpickingmode) == Shaders_round(cgPickingModeY)) {","\t\tgl_FragColor = Shaders_FloatToVec4(cgvcolor.y);","\t} else if(Shaders_round(cgvpickingmode) == Shaders_round(cgPickingModeZ)) {","\t\tgl_FragColor = Shaders_FloatToVec4(cgvcolor.z);","\t} else if(Shaders_round(cgvpickingmode) == Shaders_round(cgPickingModeID)){","\t\tgl_FragColor = cgvcolor;","\t} else {","\t\tgl_FragColor = vec4(cgvpickingmode / 255.0, 1.0, 1.0, 1.0);","\t}"].join("\n"),axt="#include <envmap_vertex>",gxt=[Axt,nxt,hxt,"#define cgPickingModeIndex "+sxt+".0",rxt,"attribute float cgpointindex;"].join("\n"),cxt=[ixt.GXe_,"\tcgpickingmain();",oxt,"\tif(Shaders_round(cgpickingmode) == Shaders_round(cgPickingModeIndex)){","\t\tcgvcolor.x = cgpointindex;","\t}","}"].join("\n"),Ixt=[Axt,nxt,hxt,"#define cgPickingModeIndex "+sxt+".0",lxt].join("\n"),fxt=[ixt.GXe_,"\tcgpickingmain();",uxt,"\tif(Shaders_round(cgvpickingmode) == Shaders_round(cgPickingModeIndex)) {","\t\tgl_FragColor = Shaders_FloatToVec4(cgvcolor.x);","\t}","}"].join("\n"),Cxt=[Axt,nxt,hxt,"#define cgPickingModeIndex "+ext+".0",rxt,"attribute float cgcellindex;"].join("\n"),dxt=[ixt.GXe_,"\tcgpickingmain();",oxt,"\tif(Shaders_round(cgpickingmode) == Shaders_round(cgPickingModeIndex)){","\t\tcgvcolor.x = cgcellindex;","\t}","}"].join("\n"),Bxt=[Axt,nxt,hxt,"#define cgPickingModeIndex "+ext+".0",lxt].join("\n"),wxt=[ixt.GXe_,"\tcgpickingmain();",uxt,"\tif(Shaders_round(cgvpickingmode) == Shaders_round(cgPickingModeIndex)) {","\t\tgl_FragColor = Shaders_FloatToVec4(cgvcolor.x);","\t}","}"].join("\n"),Qxt=[Axt,nxt,hxt,rxt].join("\n"),Ext=[ixt.SXe_+" {","\tcgpickingmain();",oxt,"}"].join("\n"),pxt=[Axt,nxt,hxt,lxt].join("\n"),mxt=[ixt.SXe_+" {","\tcgpickingmain();","#include <logdepthbuf_fragment>",uxt,"}"].join("\n"),yxt=function(t){if(t.defines&&!t.defines.hasOwnProperty("addedAbstractPickingShaders")){t.defines["addedAbstractPickingShaders"]=!0;t.uniforms["cgpickingrgba"]=new h(new A);t.uniforms["cgpickingmode"]=new h(0);t.uniforms["cgpickingViewProjNormInv"]=new h(new u)}};var Dxt=function(){let i=class t{static zXe_(t){const i=t.XXe_().replace(ixt.SXe_,"void cgpickingmain()");return[gxt,i,cxt].join("\n")}static jXe_(t){const i=t.ZXe_().replace(ixt.SXe_,"void cgpickingmain()");return[Ixt,i,fxt].join("\n")}static _Xe_(t){const i=t.vertexShader.replace(ixt.SXe_,"void cgpickingmain()");return[Cxt,i,dxt].join("\n")}static $Xe_(t){const i=t.fragmentShader.replace(ixt.SXe_,"void cgpickingmain()");return[Bxt,i,wxt].join("\n")}static tje_(t){const i=t.vertexShader.replace(ixt.SXe_,"void cgpickingmain()");return[Qxt,i,Ext].join("\n")}static ije_(t){const i=t.fragmentShader.replace(ixt.SXe_,"void cgpickingmain()");return[pxt,i,mxt].join("\n")}static sje_(t,i){if(i){yxt(t);i.hasOwnProperty("pickingmode")&&(t.uniforms["cgpickingmode"].value=+i["pickingmode"]);i.hasOwnProperty("pickingrgba")&&(t.uniforms["cgpickingrgba"].value=i["pickingrgba"]);if(i.hasOwnProperty("candidates")){let s=!1;const e=t["userData"];if(i.hasOwnProperty("normalizationmatrix")){e.eje_=i["normalizationmatrix"];s=!0}if(i.hasOwnProperty("viewinversematrix")){e.Aje_=i["viewinversematrix"];s=!0}if(i.hasOwnProperty("projectioninversematrix")){e.nje_=i["projectioninversematrix"];s=!0}if(s&&e.nje_&&e.Aje_&&e.eje_){e.hje_||(e.hje_=new u);e.hje_.copy(e.nje_);e.hje_.premultiply(e.Aje_);e.hje_.premultiply(e.eje_);t.uniforms["cgpickingViewProjNormInv"].value=e.hje_}}}}static rje_(t){yxt(t);const i=t["userData"];return{pickingmode:t.uniforms["cgpickingmode"].value,pickingrgba:t.uniforms["cgpickingrgba"].value,normalizationmatrix:i.eje_,viewinversematrix:i.Aje_,projectioninversematrix:i.nje_}}};i.oje_=sxt;i.lje_=ext;i.uje_=(t=>{t=YFt.EXe_(t,ixt.GXe_,[Axt,nxt,hxt,rxt].join("\n"),!1,!0);return t=YFt.EXe_(t,axt,oxt,!1,!1)})(n.meshlambert_vert);i.aje_=(t=>t=[t=(t=YFt.EXe_(t,ixt.GXe_,[Axt,nxt,hxt,lxt].join("\n"),!1,!0)).slice(0,t.search(ixt.SXe_)),ixt.GXe_,uxt,"}"].join("\n"))(n.meshlambert_frag);i=t([_s("geotoolkit3d.util.shaders.Picking")],i);return i}();const Mxt=Math,vxt=[0,0,0],bxt=[0,0,0],Nxt=[0,0,0],Sxt=[0,0,0],Gxt=new a,Rxt=new a;var kxt=Ci(function(){var t=class{static gje_(t,i,s){const e=[t.distanceTo(i),t.distanceTo(s),i.distanceTo(s)].sort();return 1/4*Mxt.sqrt((e[0]+(e[1]+e[2]))*(e[2]-(e[0]-e[1]))*(e[2]+(e[0]-e[1]))*(e[0]+(e[1]-e[2])))}static cje_(t,i,s){s||(s=[]);s[0]=t[1]*i[2]-t[2]*i[1];s[1]=t[2]*i[0]-t[0]*i[2];s[2]=t[0]*i[1]-t[1]*i[0];return s}static Ije_(t,i){const s=t[0],e=t[1],A=t[2],n=undefined,h=undefined,r=undefined;return s*i[0]+e*i[1]+A*i[2]}static normal(t,i,s,e,A,n){A==null&&(A=[]);s*=3;e*=3;const h=t[(i*=3)+0],r=t[i+1],o=t[i+2],l=t[s+0],u=t[s+1],a=t[s+2],g=t[e+0],c=t[e+1],I=t[e+2];if(n!=null&&(o===n||a===n||I===n)){A[0]=0;A[1]=0;A[2]=0;return A}const f=c-u,C=o-a,d=I-a,B=r-u,w=h-l,Q=g-l;A[0]=f*C-d*B;A[1]=d*w-Q*C;A[2]=Q*B-f*w;const E=Mxt.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2]);if(E===0){A[0]=0;A[1]=0;A[2]=0}else{A[0]/=E;A[1]/=E;A[2]/=E}return A}static fje_(t,i,s,e,A,n){A==null&&(A=[]);const h=[t.getX(i),t.getY(i),t.getZ(i)],r=[t.getX(s),t.getY(s),t.getZ(s)],o=[t.getX(e),t.getY(e),t.getZ(e)];if(n!=null&&(h[2]===n||r[2]===n||o[2]===n)){A[0]=0;A[1]=0;A[2]=0;return A}const l=o[1]-r[1],u=h[2]-r[2],a=o[2]-r[2],g=h[1]-r[1],c=h[0]-r[0],I=o[0]-r[0];A[0]=l*u-a*g;A[1]=a*c-I*u;A[2]=I*g-l*c;const f=Mxt.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2]);if(f===0){A[0]=0;A[1]=0;A[2]=0}else{A[0]/=f;A[1]/=f;A[2]/=f}return A}static intersect(t,i,s,e){const A=i.x-t.x,n=i.y-t.y,h=e.x-s.x,r=e.y-s.y,o=(-n*(t.x-s.x)+A*(t.y-s.y))/(-h*n+A*r),l=(h*(t.y-s.y)-r*(t.x-s.x))/(-h*n+A*r);return o>=0&&o<=1&&l>=0&&l<=1?new g(t.x+l*A,t.y+l*n):null}static Cje_(t){return t*Mxt.PI/180}static dje_(t){return t*180/Mxt.PI}static y4s_(t,i,s,e,A,n,h){i==null&&(i=0);s==null&&(s=1);h==null&&(h=NaN);t=t.slice();let r=Number.MAX_VALUE,o=-Number.MAX_VALUE,l;for(l=0;l<t.length;l++)if(t[l]!=null&&!isNaN(t[l])&&t[l]!==n)if(e!=null&&t[l]<e)t[l]=e;else if(A!=null&&t[l]>A)t[l]=A;else{r=Mxt.min(r,t[l]);o=Mxt.max(o,t[l])}isNaN(i)&&(i=r);isNaN(s)&&(s=o);if((A=A!=null?A:o)===(e=e!=null?e:r))for(l=0;l<t.length;l++)t[l]==null||isNaN(t[l])||t[l]===n?t[l]=h:t[l]=i+(s-i)/2;else for(l=0;l<t.length;l++)t[l]==null||isNaN(t[l])||t[l]===n?t[l]=h:t[l]=i+(s-i)*((t[l]-e)/(A-e));return t}static Bje_(i,s,e,A){vxt[0]=s[0]-i[0];vxt[1]=s[1]-i[1];vxt[2]=s[2]-i[2];bxt[0]=e[0]-i[0];bxt[1]=e[1]-i[1];bxt[2]=e[2]-i[2];Nxt[0]=A[0]-i[0];Nxt[1]=A[1]-i[1];Nxt[2]=A[2]-i[2];t.cje_(vxt,bxt,Sxt);return Mxt.abs(t.Ije_(Sxt,Nxt))/6}static wje_(i){return t.Bje_(i[0],i[1],i[2],i[4])+t.Bje_(i[1],i[2],i[3],i[7])+t.Bje_(i[2],i[4],i[6],i[7])+t.Bje_(i[1],i[4],i[5],i[7])+t.Bje_(i[1],i[2],i[4],i[7])}static Qje_(t,i,s){const e=Mxt.pow(i.x-t.x,2)+Mxt.pow(i.y-t.y,2),A=Mxt.pow(s.x-i.x,2)+Mxt.pow(s.y-i.y,2),n=Mxt.pow(t.x-s.x,2)+Mxt.pow(t.y-s.y,2);return n>e&&n>A?new g(t.x+(s.x-i.x),t.y+(s.y-i.y)):A>e&&A>n?new g(i.x+(s.x-t.x),i.y+(s.y-t.y)):new g(t.x+(i.x-s.x),t.y+(i.y-s.y))}static Eje_(t,i,s,e,A,n){const h=Mxt.pow(s-t,2)+Mxt.pow(e-i,2),r=Mxt.pow(A-s,2)+Mxt.pow(n-e,2),o=Mxt.pow(t-A,2)+Mxt.pow(i-n,2);return o>h&&o>r?{x:t+(A-s),y:i+(n-e)}:r>h&&r>o?{x:s+(A-t),y:e+(n-i)}:{x:t+(s-A),y:i+(e-n)}}static pje_(t,i){const s=new a;s.x=t.x>i.x?t.x:i.x;s.y=t.y>i.y?t.y:i.y;s.z=t.z>i.z?t.z:i.z;return s}static mje_(t,i){const s=new a;s.x=t.x>i.x?i.x:t.x;s.y=t.y>i.y?i.y:t.y;s.z=t.z>i.z?i.z:t.z;return s}static intersectBox(t,i){return!(t.max.x<=i.min.x||t.min.x>=i.max.x||t.max.y<=i.min.y||t.min.y>=i.max.y)}static containsBox(t,i){return!(t.min.x>i.min.x||t.max.x<i.max.x||t.min.y>i.min.y||t.max.y<i.max.y)}static yje_(t,i){const s=new c;s.min.x=i.min.x>t.min.x?i.min.x:t.min.x;s.max.x=i.max.x<t.max.x?i.max.x:t.max.x;s.min.y=i.min.y>t.min.y?i.min.y:t.min.y;s.max.y=i.max.y<t.max.y?i.max.y:t.max.y;return s}static Dje_(t){const i=[0,0,0,0,0];let s;for(s=0;s<t.length;s++){const e=t[s];i[0]+=e[0];i[1]+=e[1];i[2]+=e[0]*e[0];i[3]+=e[0]*e[1];i[4]+=e[1]*e[1]}const e=(s*i[3]-i[0]*i[1])/(s*i[2]-i[0]*i[0]),A=undefined;return{a:e,b:i[1]/s-e*i[0]/s}}static Mje_(t,i){let s=(new I).set(t[0].x,t[0].y,1,t[1].x,t[1].y,1,t[2].x,t[2].y,1);s=s.invert();const e=new a(i[0].x,i[1].x,i[2].x).applyMatrix3(s),A=new a(i[0].y,i[1].y,i[2].y).applyMatrix3(s);return(new I).set(e.x,e.y,e.z,A.x,A.y,A.z,0,0,1)}static vje_(t,i){let s=(new u).set(t[0].x,t[0].y,t[0].z,1,t[1].x,t[1].y,t[1].z,1,t[2].x,t[2].y,t[2].z,1,t[3].x,t[3].y,t[3].z,1);s=s.invert();const e=new A(i[0].x,i[1].x,i[2].x,i[3].x).applyMatrix4(s),n=new A(i[0].y,i[1].y,i[2].y,i[3].y).applyMatrix4(s),h=new A(i[0].z,i[1].z,i[2].z,i[3].z).applyMatrix4(s);return(new u).set(e.x,e.y,e.z,e.w,n.x,n.y,n.z,n.w,h.x,h.y,h.z,h.w,0,0,0,1)}static bje_(t,i,s,e){const A=t=>Mxt.sin(i[t])*Mxt.cos(s[t]),n=t=>Mxt.sin(i[t])*Mxt.sin(s[t]),h=t=>Mxt.cos(i[t]),r=t=>Mxt.sin(i[t])*Mxt.cos(s[t]),o=t=>Mxt.sin(i[t])*Mxt.sin(s[t]),l=t=>Mxt.cos(i[t]),u=(t,i)=>{const s=r(i)*A(t)+o(i)*n(t)+l(i)*h(t);return Mxt.acos(s)},a=(t,i)=>{const s=u(t,i);return s===0?1:2/s*Mxt.tan(s/2)},g=[0],c=[0],I=[0];let f=0,C=0,d=0,B=0;for(let i=1;i<t.length;i++){const s=t[i]-t[B],u=a(B,i);f+=s*u*(r(i)+A(B))/2;C+=s*u*(o(i)+n(B))/2;e?d-=s*u*(l(i)+h(B))/2:d+=s*u*(l(i)+h(B))/2;g.push(f);c.push(C);I.push(d);B=i}return{x:g,y:c,z:I}}static Nje_(t,i,s){s=s||new f;const e=t.x,A=t.y,n=t.z,h=Mxt.sin(i),r=undefined,o=1-Mxt.cos(i),l=e*A*o+n*h;let u,a,g;if(l>.998){u=0;a=2*Mxt.atan2(e*Mxt.sin(i/2),Mxt.cos(i/2));g=Mxt.PI/2}else if(l<-.998){u=0;a=-2*Mxt.atan2(e*Mxt.sin(i/2),Mxt.cos(i/2));g=-Mxt.PI/2}else{u=Mxt.atan2(e*h-A*n*o,1-(e*e+n*n)*o);a=Mxt.atan2(A*h-e*n*o,1-(A*A+n*n)*o);g=Mxt.asin(e*A*A+n*h)}return s.set(u,a,g)}static Sje_(t,i,s){(s=s||new f).z=Mxt.atan2(t.y,t.x);s.x=Mxt.asin(t.z);Gxt.set(-t.y,t.x,0);Rxt.crossVectors(Gxt,t);s.y=Mxt.atan2(Gxt.dot(i)/Gxt.length(),Rxt.dot(i)/Rxt.length());Number.isFinite(s.x)||(s.x=0);Number.isFinite(s.y)||(s.y=0);Number.isFinite(s.z)||(s.z=0);return s}static Gje_(t,i){const s=new u,e=Mxt.abs(i.max.x-i.min.x)/Mxt.abs(t.max.x-t.min.x),A=Mxt.abs(i.max.y-i.min.y)/Mxt.abs(t.max.y-t.min.y),n=Mxt.abs(i.max.z-i.min.z)/Mxt.abs(t.max.z-t.min.z);s.multiply((new u).makeTranslation(i.min.x,i.min.y,i.min.z));s.multiply((new u).makeScale(e,A,n));s.multiply((new u).makeTranslation(-t.min.x,-t.min.y,-t.min.z));return s}};return t}(),2,"eyJjb21wdXRlSGVyb25BcmVhIjoiZ2plXyIsImNyb3NzUHJvZHVjdCI6ImNqZV8iLCJkb3RQcm9kdWN0IjoiSWplXyIsIm5vcm1hbEJ1ZmZlckF0dHJpYnV0ZSI6ImZqZV8iLCJkZWdyZWVUb1JhZGlhbnMiOiJDamVfIiwicmFkaWFuc1RvRGVncmVlIjoiZGplXyIsIm5vcm1hbGl6ZUFycmF5IjoieTRzXyIsImNvbXB1dGVUZXRyYWhlZHJvblZvbHVtZSI6IkJqZV8iLCJjb21wdXRlQ2VsbFZvbHVtZSI6IndqZV8iLCJtYXhWZWN0b3IzIjoicGplXyIsIm1pblZlY3RvcjMiOiJtamVfIiwiY3JlYXRlRml0Qm94IjoieWplXyIsInJlc29sdmVUcmFuc2Zvcm1NYXRyaXgzIjoiTWplXyIsInJlc29sdmVUcmFuc2Zvcm1NYXRyaXg0IjoidmplXyIsIm1pbmltdW1DdXJ2YXR1cmUiOiJiamVfIiwiYW5nbGVUb0V1bGVyIjoiTmplXyIsImRpcmVjdGlvblRvRXVsZXIiOiJTamVfIiwiZ2V0Qm94VG9Cb3hNYXRyaXgiOiJHamVfIn0g");const Fxt=new C(new a,new a(1,1,1));var xxt=Ci(function(){let i=class t extends d{constructor(t){const i=qi(t,{},!0);super({uniforms:i["uniforms"],vertexShader:i["vertexshader"],fragmentShader:i["fragmentshader"],defines:i["defines"]!=null?i["defines"]:[]});this.type="AbstractShaderPickingMaterial"}setOptions(t){Dxt.sje_(this,t);return this}JV_(){return Dxt.rje_(this)}Rje_(){return!1}kje_(){return[]}static Fje_(t){return kxt.Gje_(Fxt,t)}static xje_(t){return kxt.Gje_(t,Fxt)}static Lje_(t){const i=t.rt_(!0).clone();return kxt.Gje_(i,Fxt)}static Uje_(t){const i=t.rt_(!0).clone();return kxt.Gje_(Fxt,i)}};i=t([_s("geotoolkit3d.picking.pickingrenderer.AbstractShaderPickingMaterial")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19LCJjb21wdXRlUGxvdE5vcm1NYXRyaXgiOiJMamVfIiwiY29tcHV0ZVBsb3ROb3JtSW52TWF0cml4IjoiVWplXyJ9");var Lxt=Ci(function(){let i=class t{static pO_(t,i,s,e,A,n){ki("AbstractPicking.pick() has to be overriden");return[]}};i=t([_s("geotoolkit3d.picking.AbstractPicking")],i);return i}(),2,"eyJwaWNrIjoicE9fIiwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");var Uxt=function(){let i=class t{static addResource(t,i){t.userData["resources"]=t.userData["resources"]||[];t.userData["resources"].push(i);return t}static removeResource(t,i){if(t.userData.hasOwnProperty("resources")){const s=t.userData["resources"].indexOf(i);s!==-1&&t.userData["resources"].splice(s,1)}return t}static disposeResources(t){if(t.userData.hasOwnProperty("resources")){t.userData["resources"].forEach((function(t){t.dispose()}));delete t.userData["resources"]}return t}};i=t([_s("geotoolkit3d.util.ResourceHelper")],i);return i}();const Yxt=new a(0,1,0),Txt=new c(new g(-20037508.3428,-20037508.3428),new g(20037508.3428,20037508.3428)),Kxt=new g,Hxt=new a,qxt=new a,Jxt=new a,Pxt=new a,Vxt=new a,Oxt=new B,Wxt=new a,zxt=new a,Xxt=new xA,jxt=new xA,Zxt=new a,_xt=new a,$xt=new a,tLt=new a,iLt=new a,sLt=new a,eLt=new w,ALt=new w,nLt=new C,hLt=new a,rLt=new a,oLt=new a,lLt=new g,uLt=new g,aLt=new c,gLt=new a,cLt=new a,ILt=new a;var fLt=Ci(function(){var i;let s=i=class t{static get Yje_(){return this.Tje_}static Kje_(t,i,s){i.localToWorld(t);return s.getRoot().worldToLocal(t)}static Hje_(t,i,s){s.getRoot().localToWorld(t);return i.worldToLocal(t)}static qje_(t,i){return i.getRoot().worldToLocal(t)}static Jje_(t,i){return i.getRoot().localToWorld(t)}static Pje_(t,i,s){t.updateMatrixWorld();t.matrixWorld.decompose(Vxt,Oxt,qxt);Jxt.set(1,1,1).divide(qxt);i.matrixWorldInverse.decompose(Vxt,Oxt,Wxt);Pxt.set(1,1,1).divide(Wxt);for(let e=0;e<t.children.length;e++){const A=t.children[e];zxt.copy(A.position).applyMatrix4(t.matrixWorld);const n=this.Vje_(zxt,i),h=undefined,r=A.scale.y/n*s.userData["plot"].getSize(Xxt).Ts_(),o=A.scale.y/r;A.scale.multiplyScalar(o);A.scale.multiply(Jxt);A.scale.multiply(Pxt)}}static Vje_(t,i){let s;const e=t.distanceTo(i.position);if(i instanceof Q){const t=i.fov*Math.PI/180;s=2*Math.tan(t/2)*e}else s=i.top-i.bottom;return s}static Oje_(t,i,s,e){s=typeof s=="boolean"&&s;e=typeof e=="boolean"&&e;let A=null;const n=new C,h=new a,r=new a,o=new a(-.5,-.5,0),l=new a(.5,.5,0),u=t=>{if(!(typeof i=="function"&&i(t)===!1||e&&t.D_&&(t.D_()==="geotoolkit3d.widgets.ProjectionWidget"||t.D_()==="geotoolkit3d.scene.grid.Grid"))){if(t instanceof E){if(t.Wje_==null||t.Wje_()){n.set(h.copy(o),r.copy(l));n.applyMatrix4(t.matrixWorld)}}else if(typeof t.zje_=="function")n.copy(t.zje_(n));else if(t.geometry!=null){const i=t.geometry;i.boundingBox==null&&typeof i.computeBoundingBox=="function"&&i.computeBoundingBox();n.copy(i.boundingBox);n.applyMatrix4(t.matrixWorld)}else s||t.children.forEach(u);s&&t.children.forEach(u);isFinite(n.min.length())&&isFinite(n.max.length())&&(A==null?A=(new C).copy(n):A.union(n))}};u(t);return A}static Xje_(t){if(!t||t.isEmpty())return 0;Hxt.copy(t.max).sub(t.min);const i=Hxt.length();return isNaN(i)?0:i}static jje_(t,s,e,A){const n=A._je_.Zje_;Zxt.copy(e.position);nLt.copy(t);s.getSize(jxt);_xt.x=2*n.x/jxt.Ie_()-1;_xt.y=2*-n.y/jxt.Ts_()+1;_xt.z=+1;_xt.unproject(e);iLt.copy(_xt).sub(Zxt).normalize();sLt.copy(Zxt).sub(_xt).normalize();const h=i.Xje_(nLt);iLt.multiplyScalar(h);Zxt.sub(iLt);_xt.add(iLt);iLt.normalize();eLt.set(Zxt,iLt);ALt.set(_xt,sLt);eLt.intersectBox(nLt,$xt);ALt.intersectBox(nLt,tLt);const r=new C;if($xt&&tLt){r.makeEmpty().setFromPoints([$xt,tLt]);if(r.intersectsBox(nLt))return r}r.copy(nLt);return r}static $je_(t){if(t!=null){t.dispose();t["image"]=null;t["version"]=0;t["userData"]={}}}static tZe_(t){if(t==null)return;const i=Array.isArray(t)?t:[t];for(let t=0;t<i.length;t++){const s=i[t];if(s!=null&&s instanceof p){if(s["map"]!=null){this.$je_(s["map"]);s["map"]=null}s.dispose();s["userData"]={}}}}static dispose(t){if(Array.isArray(t)&&t.length>0)for(let s=t.length-1;s>=0;s--)i.dispose(t[s]);else if(t!=null){if(t instanceof m||t instanceof y){Uxt.disposeResources(t);i.dispose(t.children)}t.dispose!=null&&t.dispose();t.parent!=null&&t.parent.remove(t);t.geometry!=null&&t.geometry.dispose();i.tZe_(t.material)}}static iZe_(t,i,s){const e=t.clone().sub(i).normalize();return Math.abs(e.dot(s.gXe_().up))<.99?s.gXe_().up.clone():Yxt.clone()}static sZe_(t,i,s,e,A){e==null&&(e=new a);A==null&&(A=new u);hLt.copy(t);hLt.applyMatrix4(A);hLt.project(i);hLt.x=(hLt.x+1)/2;hLt.y=(-hLt.y+1)/2;return e.set(hLt.x*s.Ie_(),hLt.y*s.Ts_(),hLt.z)}static eZe_(t,i,s,e){e==null&&(e=new g);hLt.copy(t);hLt.project(i);hLt.x=(hLt.x+1)/2;hLt.y=(-hLt.y+1)/2;return e.set(hLt.x*s.Ie_(),hLt.y*s.Ts_())}static AZe_(t,i,s,e){e==null&&(e=new a);hLt.copy(t);hLt.x/=s.Ie_();hLt.y/=s.Ts_();hLt.x=hLt.x*2-1;hLt.y=-(hLt.y*2-1);hLt.unproject(i);return e.set(hLt.x,hLt.y,hLt.z)}static nZe_(t,i,s,e){const A=t.material,n=A.map.image.width,h=A.map.image.height;t.parent.localToWorld(oLt.copy(t.position));this.sZe_(oLt,s,e.userData["plot"].getSize(jxt),rLt);if(!isFinite(rLt.x)||!isFinite(rLt.y))return null;rLt.x-=n/2;rLt.y-=h/2;lLt.set(rLt.x+n,rLt.y+h);return new c(new g(rLt.x-i.x,rLt.y-i.z),new g(lLt.x+i.y,lLt.y+i.w))}static hZe_(t,i,s,e,A,n){const h=[];let r,o;if(n!=null)for(o=0;o<n.length;o++){r=n[o];if(r.visible&&(r.parent!=null&&t.userData["plot"]!=null)){const s=this.nZe_(r,A,i,t);s!==null&&h.push(s)}}for(o=0;o<s.length;o++){r=s[o];if(!r.visible||r.parent==null||t.userData["plot"]==null)continue;const n=this.nZe_(r,A,i,t);if(n==null)continue;let l=!1,u=0;for(let t=0;t<h.length;t++)if(n.intersectsBox(h[t])){aLt.copy(n).intersect(h[t]).getSize(uLt);u+=uLt.x*uLt.y;if(u>e){l=!0;break}}l?r.visible=!1:r.visible&&h.push(n)}}static rZe_(t,i,s,e){let A;e==null?e=new D:A=e.getSize(Kxt);i!=null&&s!=null&&e.setSize(i,s);const n=t.parent,h=new M;h.add(t);const r=(new C).setFromObject(t),o=new v(-16e3,16e3,-16e3,16e3);let l=new a;r.getSize(l);if(l.z===0){r.expandByVector(new a(0,0,.5));l=new a;r.getSize(l)}const u=new a;r.getCenter(u);o.translateX(u.x);o.translateY(u.y);o.translateZ(u.z+l.z*.6);o.near=l.z*.05;o.far=l.z*1.15;o.updateMatrixWorld();o.updateProjectionMatrix();const g=r.min.clone();g.project(o);const c=r.max.clone();c.project(o);const I=Math.max(g.x,c.x),f=Math.max(g.y,c.y);o.left*=I;o.right*=I;o.top*=f;o.bottom*=f;o.updateProjectionMatrix();e.render(h,o);const d=e.domElement.toDataURL();A!=null?e.setSize(A.width,A.height):e.dispose();t.parent=n;return d}static oZe_(t){t["color"]!=null&&t["colorprovider"]!=null?t["color"]=null:t["color"]!=null&&t["colorprovider"]==null&&(t["colorprovider"]=t["color"]);if(!(t["colorprovider"]instanceof Mo))if(typeof t["colorprovider"]!="string")if(t["colorprovider"]instanceof l){const i=t["colorprovider"].getStyle();t["colorprovider"]=new bo({values:[0,1],colors:[i,i]})}else t["colorprovider"]=new bo({values:[0,1],colors:["beige","beige"]});else{const i=t["colorprovider"];t["colorprovider"]=new bo({values:[0,1],colors:[i,i]})}}static lZe_(){return Txt.clone()}static uZe_(t,i){const s=(new C).copy(t);i=i||0;const e=s.max.sub(s.min).multiplyScalar(i),A=e.x,n=e.y,h=e.z,r=(1-i)/i/2,o=s.min.x+A*r,l=s.min.y+n*r,u=s.min.z+h*r,a={x:o,y:l,z:u+h},g={x:o+A,y:l,z:u+h},c={x:o,y:l+n,z:u+h},I={x:o+A,y:l+n,z:u+h},f={x:o,y:l,z:u},d={x:o+A,y:l,z:u},B={x:o,y:l+n,z:u},w={x:o+A,y:l+n,z:u};return[a.x,a.y,a.z,g.x,g.y,g.z,c.x,c.y,c.z,c.x,c.y,c.z,g.x,g.y,g.z,I.x,I.y,I.z,g.x,g.y,g.z,d.x,d.y,d.z,I.x,I.y,I.z,I.x,I.y,I.z,d.x,d.y,d.z,w.x,w.y,w.z,g.x,d.y,d.z,f.x,f.y,f.z,w.x,w.y,w.z,w.x,w.y,w.z,f.x,f.y,f.z,B.x,B.y,B.z,f.x,f.y,f.z,a.x,a.y,a.z,B.x,B.y,B.z,B.x,B.y,B.z,a.x,a.y,a.z,c.x,c.y,c.z,c.x,c.y,c.z,I.x,I.y,I.z,B.x,B.y,B.z,B.x,B.y,B.z,I.x,I.y,I.z,w.x,w.y,w.z,f.x,f.y,f.z,d.x,d.y,d.z,a.x,a.y,a.z,a.x,a.y,a.z,d.x,d.y,d.z,g.x,g.y,g.z]}static aZe_(t){const i=t.hasOwnProperty("x"),s=t=>{for(let i=0;i<t.length;i++)if(!Number.isFinite(t[i]))return!1;return!0},e=(s,e)=>{if(i){const i=s*8+e,A=t;return[A.x.getX(i),A.y.getX(i),A.z.getX(i)]}const A=s*8*3+e*3,n=t;return[n[A],n[A+1],n[A+2]]},A=()=>{let A;A=i?t.x.count:t.length/(3*8);for(let t=0;t<A;t++){const i=e(t,0),A=e(t,4);if(s([i[0],i[1],i[2],A[0],A[1],A[2]])&&i[2]!==A[2])return t}return-1},n=A();if(n===-1)return!0;const h=e(n,0),r=e(n,1),o=e(n,2),l=e(n,4),u=new a(r[0]-h[0],r[1]-h[1],r[2]-h[2]),g=new a(o[0]-h[0],o[1]-h[1],o[2]-h[2]),c=new a(l[0]-h[0],l[1]-h[1],l[2]-h[2]);c.normalize();const I=u.cross(g);I.normalize();const f=undefined;return I.dot(c)>0}static gZe_(t,i,s){i==null&&(i=new b);t.updateMatrixWorld();i.setFromCoplanarPoints(t.cZe_(0,gLt),t.cZe_(1,cLt),t.cZe_(2,ILt));if(s!=null&&i.normal.dot(s)<0){i.normal.negate();i.constant*=-1}return i}static IZe_(t){t.onUpload((()=>{t.array=null}))}};s.Tje_=1e-6;s=i=t([_s("geotoolkit3d.util.Helper")],s);return s}(),2,"eyJCQk9YX0VQU0lMT04iOiJZamVfIiwibG9jYWxUb0J1c2luZXNzIjoiS2plXyIsImJ1c2luZXNzVG9Mb2NhbCI6IkhqZV8iLCJ3b3JsZFRvQnVzaW5lc3MiOiJxamVfIiwiYnVzaW5lc3NUb1dvcmxkIjoiSmplXyIsImNvbXB1dGVXb3JsZEJvdW5kaW5nQm94IjoiT2plXyIsImdldEJveFNpemUiOiJYamVfIiwid29ybGRUb0RldmljZSI6InNaZV8iLCJ3b3JsZFRvRGV2aWNlMkQiOiJlWmVfIiwiZGV2aWNlVG9Xb3JsZCI6IkFaZV8iLCJjb252ZXJ0VG9Db2xvclByb3ZpZGVyIjoib1plXyIsImdldFdHUzg0RGVmYXVsdEV4dGVudCI6ImxaZV8iLCJjb21wdXRlQm94UG9zaXRpb25zIjoidVplXyIsImlzVHJpYW5nbGVGYWNpbmdJbndhcmQiOiJhWmVfIiwiY3JlYXRlVXBkYXRlVGhyZWVQbGFuZSI6ImdaZV8iLCJnZXRDbGFzc05hbWUiOiJEXyJ9");var CLt=function(){let i=class t extends xxt{constructor(t){const i=t["material"],s=undefined;super(qi(t,{uniforms:N.clone(S["basic"].uniforms),vertexshader:Dxt.uje_,fragmentshader:Dxt.aje_,defines:i.defines},!0));this.type="BasicPickingMaterial";this.transparent=!1;this.blending=G;this.side=i.side}};i=t([_s("geotoolkit3d.picking.pickingrenderer.BasicPickingMaterial")],i);return i}();var dLt=function(){let i=class t extends CLt{constructor(t){super(t);this.type="DefaultMeshPickingMaterial"}};i=t([_s("geotoolkit3d.picking.pickingrenderer.DefaultMeshPickingMaterial")],i);return i}();const BLt=xxt.Lje_,wLt=YFt.dXe_,QLt=Ls(1,1,!0),ELt=QLt.getContext("2d");if(ELt!=null){ELt.fillStyle="white";ELt.fillRect(0,0,1,1)}var pLt=function(){let i=class t extends R{constructor(){const t=new r(QLt);t.wrapS=t.wrapT=k;t.needsUpdate=!0;const i=Dxt;super({map:t,transparent:!1});this.vertexShader=i.uje_;this.fragmentShader=i.aje_;this.uniforms=N.clone(S["sprite"].uniforms);this.type="DefaultSpritePickingMaterial";this.blending=G}setOptions(t){const i=t["plot"];switch(t["pickingmode"]){case tFt.Id:const s=t["pickingrgba"];this.color=new l(s.x,s.y,s.z);this.opacity=s.w;break;case tFt.X:case tFt.Y:case tFt.Z:const e=t["candidates"];if(e==null)throw new Error("Cannot pick XYZ if no object has been selected");e.forEach((s=>{if(s.material===this){const e=s.position.clone().applyMatrix4(s.matrixWorld),A=undefined,n=i.fZe_(e.sub(i.Ej_())).applyMatrix4(BLt(i));let h;switch(t["pickingmode"]){case tFt.X:h=n.x;break;case tFt.Y:h=n.y;break;case tFt.Z:h=n.z;break}const r=wLt(h);this.color=new l(r.x,r.y,r.z);this.opacity=r.w}}));break;default:throw new Error("not implemented")}return this}};i=t([_s("geotoolkit3d.picking.pickingrenderer.DefaultSpritePickingMaterial")],i);return i}();var mLt=function(){let i=class t extends CLt{constructor(t){super(t);this.type="DefaultLinePickingMaterial"}};i=t([_s("geotoolkit3d.picking.pickingrenderer.DefaultLinePickingMaterial")],i);return i}();var yLt=function(){let i=class t extends xxt{constructor(t){const i=t["material"],s=undefined;super(qi(t,{uniforms:i.uniforms,vertexshader:Dxt.tje_(i),fragmentshader:Dxt.ije_(i),defines:i.defines},!0));this.type="DefaultShaderPickingMaterial";this.transparent=!1;this.lights=i.lights;this.side=i.side;this.blending=G;this.extensions["derivatives"]=!0}};i=t([_s("geotoolkit3d.picking.pickingrenderer.DefaultShaderPickingMaterial")],i);return i}();function DLt(t){return t?.material!=null}const MLt={},vLt=10,bLt=new l,NLt=new xA,SLt=new g(0,0),GLt=new g(0,0),RLt=new g(1,1),kLt={CZe_:0,dZe_:1/60,BZe_:[],wZe_:null,QZe_:null},FLt=()=>{kLt.BZe_=[];kLt.QZe_=null},xLt=xxt.Fje_,LLt=(t,i)=>{const s=[];for(let e=0;e<i.length;e++)s.push(YFt.wXe_(t[i[e]]));return s};let ULt=[],YLt=0;const TLt=t=>{const i=t.split(",");return new A(+i[0],+i[1],+i[2],+i[3])},KLt=(()=>{let t=null;const i=[];return s=>{const e=s["width"]*2+1,n=s["height"]*2+1,h=Math.floor(s["x"]-s["width"]),r=Math.floor(s["rendertarget"].height-(s["y"]+s["height"]));s["rendertarget"].scissor.set(h,r,h+e,r+n);s["rendertarget"].scissorTest=!0;const o=e*n;if(t==null||o*4!==t.length){t=new Uint8Array(o*4);i.length=o}else if(t.fill!=null)t.fill(0);else for(let i=0;i<t.length;i++)t[i]=0;const l=Object.keys(s["objects"]);for(let t=0;t<l.length;t++){if(s["candidates"]!=null&&s["candidates"].indexOf(s["objects"][l[t]])===-1)continue;s["pickingrgba"]=TLt(l[t]).divideScalar(255);const i=undefined;(Array.isArray(s["objects"][l[t]].material)?s["objects"][l[t]].material:[s["objects"][l[t]].material]).forEach((t=>{t.setOptions(s)}))}const u=s["plot"];u.EZe_().setRenderTarget(s["rendertarget"]);u.EZe_().clear();u.EZe_().render(u.pZe_(),u.gXe_());u.EZe_().setRenderTarget(null);u.EZe_().readRenderTargetPixels(s["rendertarget"],h,r,e,n,t);for(let s=0;s<o;s++)i[s]!=null?i[s].set(t[s*4],t[s*4+1],t[s*4+2],t[s*4+3]):i[s]=new A(t[s*4],t[s*4+1],t[s*4+2],t[s*4+3]);return i}})(),HLt=t=>{t.w++;if(t.w>255){t.z++;t.w=0}if(t.z>255){t.z=0;t.y++}if(t.y>255){t.x++;t.y=0}if(t.x>255)throw new Error("Error, can't generate a unique picking ID")},qLt=t=>t.x+","+t.y+","+t.z+","+t.w,JLt=(t,i)=>{const s=t.gXe_().projectionMatrix,e=t.gXe_().matrixWorldInverse,A=(new u).copy(e).invert(),n=(new u).copy(s).invert(),h=xxt.xje_(i["modellimits"]);i["projectioninversematrix"]=n;i["viewinversematrix"]=A;i["normalizationmatrix"]=h},PLt=t=>{let i=null;for(let s=0;s<t.length;s++){const e=t[s],A=fLt.Oje_(e);if(A)i?i.union(A):i=A;else if(YLt<vLt){let t=e.name;t&&t.length!==0||(t=e.type);ki("Warning Picking: object ("+e.type+"), children of ("+e.parent.type+"), do not have a proper bounding box. Picking accuracy will be reduced.");YLt++;YLt===vLt&&ki("Warning Picking: too much warnings, picking warnings will stop displaying.")}}return i},VLt=t=>t.D_?t.D_():t instanceof F||t===F?"THREE.MeshBasicMaterial":t instanceof x||t===x?"THREE.MeshPhongMaterial":t instanceof L||t===L?"THREE.MeshNormalMaterial":t instanceof U||t===U?"THREE.MeshLambertMaterial":t instanceof R||t===R?"THREE.SpriteMaterial":t instanceof Y||t===Y?"THREE.LineBasicMaterial":t instanceof T||t===T?"THREE.LineDashedMaterial":t instanceof K||t===K||t instanceof d||t===d?"THREE.RawShaderMaterial":null,OLt=(t,i,s,e,n,h)=>{const r=new A(0,0,0,0),o=t.EZe_().getClearColor(bLt),l=new A(o.r,o.g,o.b,t.EZe_().getClearAlpha()).multiplyScalar(255);t.pZe_().traverse((t=>{const A=t.OC_!=null&&t.OC_()===!1;if(h(t,!A)){if(DLt(t)){s[t.uuid]=t.visible;e[t.uuid]=t;const A=Array.isArray(t.material)?t.material:[t.material];HLt(r);r.equals(l)&&HLt(r);const h=[];A.forEach((i=>{if(t.userData.mZe_==null){const s=VLt(i);if(s==null||MLt[s]==null)return;const e=new MLt[s]({material:i,object:t});if(t instanceof m){t.userData.mZe_=e;Uxt.addResource(t,{dispose:()=>{fLt.tZe_(t.userData.mZe_);t.userData.mZe_=null}})}e.clippingPlanes=i.clippingPlanes;e.clipIntersection=i.clipIntersection;h.push(e)}else{const s=t.userData.mZe_;if(i.uniforms!=null&&s.uniforms!=null){const t=Object.keys(s.uniforms);for(let e=0;e<t.length;e++)i.uniforms[t[e]]!=null&&(s.uniforms[t[e]].value=i.uniforms[t[e]].value)}s.clippingPlanes=i.clippingPlanes;s.clipIntersection=i.clipIntersection;h.push(s)}}));if(h.length!==0)if(h.length===1){i[t.uuid]=A[0];t.material=h[0]}else{i[t.uuid]=A;t.material=h}n[qLt(r)]=t}}else{s[t.uuid]=t.visible;e[t.uuid]=t;t.visible=!1}}))},WLt=(t,i,s)=>{const e=Object.keys(t);for(let t=0;t<s.length;t++){const A=s[t];for(let t=0;t<e.length;t++)i[e[t]].visible=A.uuid===e[t]}return e},zLt=(t,i)=>{const s=Object.keys(t);for(let e=0;e<s.length;e++)i[s[e]].visible=t[s[e]]},XLt=(t,i)=>{t.pZe_().traverse((t=>{if(DLt(t)&&i[t.uuid]!=null){t.material=i[t.uuid];i[t.uuid]=null}}))},jLt=(t,i,s,e,A,n)=>{n=n||null;const h=t["usecache"]&&n===kLt.wZe_&&e<=RLt.x&&A<=RLt.y&&SLt.set(i,s).equals(GLt)&&Mi.performance.now()<kLt.CZe_+t["cachetimelimit"];if(!h){kLt.BZe_=[];GLt.set(i,s);RLt.set(e,A);kLt.wZe_=n||null;if(kLt.QZe_!==null){Mi.clearTimeout(kLt.QZe_);kLt.QZe_=null}}return h},ZLt=()=>{if(ULt.length!==0){ULt.forEach((t=>{if(t.userData&&t.userData["dispose"]){const i=undefined;(0,t.userData["dispose"])(t)}}));ULt=[]}},_Lt=(t,i,s,e)=>{const A=undefined;(Array.isArray(t.material)?t.material:[t.material]).forEach((t=>{if(t.Rje_()){const A=t.kje_();for(let t=0;t<A.length;t++){i["pickingmode"]=A[t]["pickingmode"];A[t]["callback"](KLt(i)[0],s,e)}}}))};var $Lt=Ci(function(){let i=class t extends Lxt{static yZe_(t,i){MLt[t]=i}static pO_(t,i,s,e,n,h){e==null&&(e=0);n==null&&(n=0);const r=t.JV_()["picking"];kLt.dZe_=r["cachetimelimit"];if(jLt(r,i,s,e,n,h))return kLt.BZe_;ZLt();const o=t.getSize(NLt);if(i<0||s<0||i>o.Ie_()||s>o.Ts_())return[];t.DZe_()!==!1&&t.render();h==null&&(h=(t,i)=>i);const l={},u={},c={},I={};t.MZe_();const f=t.rt_(!0).clone();OLt(t,l,c,I,u,h);const C={plot:t,rendertarget:t.vZe_(),pickingmode:tFt.Id,objects:u,x:i,y:s,width:e,height:n,modellimits:f,candidates:null};JLt(t,C);let d=xLt(f);const B=KLt(C),w=t.EZe_().getClearColor(bLt),Q=new A(w.r,w.g,w.b,t.EZe_().getClearAlpha()).multiplyScalar(255),E=[],p=[],m=[],y=C["width"],D=C["height"],M=y*2+1;for(let t=0;t<B.length;t++){const i=B[t];if(i.equals(Q))continue;const s=u[qLt(i)];if(s==null)continue;let e=E.indexOf(s);if(e===-1){E.push(s);e=E.length-1}p[e]==null&&(p[e]=[Number.MAX_VALUE,Number.MAX_VALUE]);const A=p[e],n=t%M,h=Math.floor(t/M),r=undefined,o=undefined;if((A[0]-y)*(A[0]-y)+(A[1]-D)*(A[1]-D)>(n-y)*(n-y)+(h-D)*(h-D)){A[0]=n;A[1]=h;m[e]=t}}const v=[];if(E.length>0){C["candidates"]=E;WLt(c,I,E);t.bZe_();t.getRoot().updateMatrixWorld();let e=PLt(E);(!e||fLt.Xje_(e)<fLt.Yje_)&&(e=f);t.NZe_(!0);t.MZe_({_je_:{SZe_:e,Zje_:{x:i,y:s}}});C["modellimits"]=e;JLt(t,C);d=xLt(e);C["pickingmode"]=tFt.X;const A=LLt(KLt(C),m);C["pickingmode"]=tFt.Y;const n=LLt(KLt(C),m);C["pickingmode"]=tFt.Z;const h=LLt(KLt(C),m);for(let e=0;e<E.length;e++){const r=new a(A[e],n[e],h[e]);r.applyMatrix4(d);const o=i+(p[e][0]-y),l=s-(p[e][1]-D),u={object:E[e],point:t.fZe_(r),pointdevice:new g(o,l),root:t.getRoot()};v.push(u);C["x"]=o;C["y"]=l;C["width"]=0;C["height"]=0;_Lt(E[e],C,u,ULt)}}const b=new g(i,s);v.sort(((t,i)=>{const s=t["pointdevice"].distanceTo(b),e=i["pointdevice"].distanceTo(b);return NA.sign(s-e)}));t.bZe_();t.NZe_(!1);t.GZe_().updateMatrixWorld();zLt(c,I);XLt(t,l);kLt.CZe_=Mi.performance.now();kLt.BZe_=v;kLt.QZe_=Mi.setTimeout(FLt,kLt.dZe_+1);return v}};i=t([_s("geotoolkit3d.picking.RendererPicking")],i);return i}(),2,"eyJzZXRQaWNraW5nTWF0ZXJpYWwiOiJ5WmVfIiwicGljayI6InBPXyJ9");$Lt.yZe_(VLt(F),dLt);$Lt.yZe_(VLt(U),dLt);$Lt.yZe_(VLt(x),dLt);$Lt.yZe_(VLt(L),dLt);$Lt.yZe_(VLt(R),pLt);$Lt.yZe_(VLt(Y),mLt);$Lt.yZe_(VLt(T),mLt);$Lt.yZe_(VLt(d),yLt);$Lt.yZe_(VLt(L),dLt);var tUt=Ci({RZe_:"beforerender",kZe_:"afterrender",FZe_:"duringrender",xZe_:"rendererror",sC_:"invalidate",Add:"add",mt_:"remove",Camera:"camera",cJt_:"resize",Animation:"animation",IWt_:"modellimits"},2,"eyJCZWZvcmVSZW5kZXIiOiJSWmVfIiwiQWZ0ZXJSZW5kZXIiOiJrWmVfIiwiRHVyaW5nUmVuZGVyIjoiRlplXyIsIlJlbmRlckVycm9yIjoieFplXyIsIkludmFsaWRhdGUiOiJzQ18iLCJSZW1vdmUiOiJtdF8iLCJSZXNpemUiOiJjSnRfIiwiTW9kZWxMaW1pdHMiOiJJV3RfIn0g"),iUt=Ci(function(){let i=class t{constructor(t){if(t["type"]==null)throw new Error("Type should not be null");if(t["source"]==null)throw new Error("Type should not be null");this.Qi_=t["type"];this.Utt_=t["source"];this.G1i_=t["args"]}getType(){return this.Qi_}gkt_(){return this.Utt_}LZe_(){return this.G1i_}dispose(){this.Qi_=null;this.Utt_=null;this.G1i_=null;return null}};i.YPi_=tUt;i=t([_s("geotoolkit3d.Event")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRTb3VyY2UiOiJna3RfIiwiZ2V0QXJncyI6IkxaZV8ifX0sImdldENsYXNzTmFtZSI6IkRfIn0g");const sUt=new a;var eUt=function(){var i;let s=i=class t extends H{constructor(t){t=t||{};super();this.setIndex(i.UZe_);this.setAttribute("position",i.YZe_);this.setAttribute("uv",i.TZe_);this.type="LineSegmentsGeometry";this.setData(t)}setData(t){if(t==null)return this;let s,e,A=-1;if(!t.hasOwnProperty("positions")&&t.hasOwnProperty("x")&&t.hasOwnProperty("y")&&t.hasOwnProperty("z")){A=Math.min(t["x"].length,t["y"].length,t["z"].length);t["values"]!=null&&(A=Math.min(A,t["values"].length));t["positions"]=[];for(e=0;e<A;e++)t["positions"].push(t["x"][e],t["y"][e],t["z"][e])}if(t.hasOwnProperty("positions")){s=t["positions"];let i;s instanceof Float32Array?i=s:Array.isArray(s)&&(i=new Float32Array(s));const e=new q(i,t["line"]?3:6,1);this.setAttribute("instanceStart",new J(e,3,0));this.setAttribute("instanceEnd",new J(e,3,3));this.instanceCount=i.length/3;t["line"]&&this.instanceCount--;this.computeBoundingBox();this.computeBoundingSphere()}if(!t.hasOwnProperty("colors")&&t.hasOwnProperty("values")&&t["colorprovider"]!=null){A===-1&&(A=t["values"].length);t["colors"]=[];for(e=0;e<A;e++){const i=t["colorprovider"].getColor(t["values"][e]);t["colors"].push(i.Is_()/255,i.Cs_()/255,i.fs_()/255)}}if(t.hasOwnProperty("colors")){s=t["colors"];let i;s instanceof Float32Array?i=s:Array.isArray(s)&&(i=new Float32Array(s));const e=new q(i,t["line"]?3:6,1);this.setAttribute("instanceColorStart",new J(e,3,0));this.setAttribute("instanceColorEnd",new J(e,3,3))}t.hasOwnProperty("endcaps")&&this.setIndex(t["endcaps"]?i.UZe_:i.KZe_);return this}computeBoundingBox(){this.boundingBox=this.boundingBox||new C;const t=this.getAttribute("instanceStart"),i=this.getAttribute("instanceEnd");t!=null&&i!=null&&this.boundingBox.setFromArray(this.getAttribute("instanceStart").array)}computeBoundingSphere(){this.boundingSphere=this.boundingSphere||new P;this.boundingBox==null&&this.computeBoundingBox();const t=this.getAttribute("instanceStart"),i=this.getAttribute("instanceEnd");if(t!=null&&i!=null){const s=this.boundingSphere.center;this.boundingBox.getCenter(s);let e=0;for(let A=0;A<t.count;A++){sUt.fromBufferAttribute(t,A);e=Math.max(e,s.distanceToSquared(sUt));sUt.fromBufferAttribute(i,A);e=Math.max(e,s.distanceToSquared(sUt))}this.boundingSphere.radius=Math.sqrt(e)}}HZe_(){return this.getAttribute("instanceStart")}qZe_(){return this.getAttribute("instanceEnd")}JZe_(){return this.hasAttribute("instanceColorStart")}};s.YZe_=new V([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3);s.TZe_=new V([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2);s.UZe_=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];s.KZe_=[2,4,3,4,5,3];s=i=t([_s("geotoolkit3d.scene.LineSegmentsGeometry")],s);return s}();const AUt=function(t){if(!t.defines.hasOwnProperty("addedLineShaders")){t.defines["addedLineShaders"]=!0;t.uniforms=N.merge([t.uniforms,O["common"],O["fog"],{linewidth:new h(1),polygonoffset:new h(0),polygonoffsetfactor:new h(1),resolution:new h(new g(1,1)),dashScale:new h(1),dashSize:new h(1),dashOffset:new h(0),gapSize:new h(1),opacity:new h(1),mask:new h(null),useMask:new h(!1)}])}};var nUt=function(){let i=class t{static PZe_(t,i){if(i!=null){AUt(t);i.hasOwnProperty("linewidth")&&(t.uniforms["linewidth"].value=i["linewidth"]);i.hasOwnProperty("dashscale")&&(t.uniforms["dashScale"].value=i["dashscale"]);i.hasOwnProperty("dashsize")&&(t.uniforms["dashSize"].value=i["dashsize"]);i.hasOwnProperty("dashoffset")&&(t.uniforms["dashOffset"].value=i["dashoffset"]);i.hasOwnProperty("gapsize")&&(t.uniforms["gapSize"].value=i["gapsize"]);i.hasOwnProperty("opacity")&&(t.uniforms["opacity"].value=i["opacity"]);i.hasOwnProperty("polygonoffset")&&(t.uniforms["polygonoffset"].value=i["polygonoffset"]?1:0);i.hasOwnProperty("polygonoffsetfactor")&&(t.uniforms["polygonoffsetfactor"].value=i["polygonoffsetfactor"]);i.hasOwnProperty("color")&&t.uniforms["diffuse"].value.set(i["color"]);i.hasOwnProperty("dashed")&&(i["dashed"]?t.defines["USE_DASH"]=!0:delete t.defines["USE_DASH"]);i.hasOwnProperty("colorfromattribute")&&(i["colorfromattribute"]?t.defines["USE_COLOR"]=!0:delete t.defines["USE_COLOR"])}}static VZe_(t){AUt(t);return{linewidth:t.uniforms["linewidth"].value,OZe_:t.uniforms["dashScale"].value,WZe_:t.uniforms["dashSize"].value,zZe_:t.uniforms["dashOffset"].value,XZe_:t.uniforms["gapSize"].value,opacity:t.uniforms["opacity"].value,jZe_:t.uniforms["polygonoffset"].value===1,ZZe_:t.uniforms["polygonoffsetfactor"].value,color:t.uniforms["diffuse"].value,dashed:t.defines.hasOwnProperty("USE_DASH")}}static _Ze_(t,i){i.hasOwnProperty("resolution")&&t.uniforms["resolution"].value.set(i["resolution"]["width"],i["resolution"]["height"]);if(i.hasOwnProperty("mask")){t.uniforms["mask"].value=i["mask"];t.uniforms["useMask"].value=i["mask"]!=null}}};i.$Ze_=["#include <common>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>","uniform float polygonoffset;","uniform float polygonoffsetfactor;","uniform float linewidth;","uniform vec2 resolution;","attribute vec3 instanceStart;","attribute vec3 instanceEnd;","attribute vec3 instanceColorStart;","attribute vec3 instanceColorEnd;","varying float vAdjustedLineWidth;","varying vec2 vOffset;","varying vec2 vUv;","#ifdef USE_DASH","    uniform float dashScale;","    attribute float instanceDistanceStart;","    attribute float instanceDistanceEnd;","    varying float vLineDistance;","#endif","void trimSegment( const in vec4 start, inout vec4 end ) {","    float a = projectionMatrix[ 2 ][ 2 ];","    float b = projectionMatrix[ 3 ][ 2 ];","    float nearEstimate = - 0.5 * b / a;","    float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );","    end.xyz = mix( start.xyz, end.xyz, alpha );","}","void main() {","    #ifdef USE_COLOR","        vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;","    #endif","    #ifdef USE_DASH","        vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;","    #endif","    float aspect = resolution.x / resolution.y;","    vUv = uv;","    vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );","    vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );","    if (polygonoffset > 0.) {","        float frNear = projectionMatrix[3][2] / (projectionMatrix[2][2] - 1.);","        float frFar = projectionMatrix[3][2] / (projectionMatrix[2][2] + 1.);","        float frRange = frFar - frNear;","        float baseOffset = polygonoffsetfactor * frRange / 1000.;","        start.z += baseOffset * abs(start.z) / frRange;","        end.z += baseOffset * abs(end.z) / frRange;","    }","    bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );","    if ( perspective ) {","        if ( start.z < 0.0 && end.z >= 0.0 ) {","            trimSegment( start, end );","        } else if ( end.z < 0.0 && start.z >= 0.0 ) {","            trimSegment( end, start );","        }","    }","    vec4 clipStart = projectionMatrix * start;","    vec4 clipEnd = projectionMatrix * end;","    vec2 ndcStart = clipStart.xy / clipStart.w;","    vec2 ndcEnd = clipEnd.xy / clipEnd.w;","    vec2 dir = ndcEnd - ndcStart;","    dir.x *= aspect;","    dir = normalize( dir );","    vec2 offset = vec2( dir.y, - dir.x );","    dir.x /= aspect;","    offset.x /= aspect;","    if ( position.x < 0.0 ) offset *= - 1.0;","    if ( 1. - abs(viewMatrix[2][2]) > 1e-7 ) {","        if ( position.y < 0.0 ) {","            offset += - dir;","        } else if ( position.y > 1.0 ) {","            offset += dir;","        }","    }","    vAdjustedLineWidth = linewidth + 2.;","    offset *= vAdjustedLineWidth;","    offset /= resolution.y;","    vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;","    offset *= clip.w;","    vOffset = offset;","    clip.xy += offset;","    gl_Position = clip;","    vec4 mvPosition = ( position.y < 0.5 ) ? start : end;","    #include <logdepthbuf_vertex>","    #include <clipping_planes_vertex>","    #include <fog_vertex>","}"].join("\n");i.t_e_=["uniform vec3 diffuse;","uniform float linewidth;","uniform float opacity;","uniform vec2 resolution;","uniform sampler2D mask;","uniform bool useMask;","#ifdef USE_DASH","    uniform float dashSize;","    uniform float dashOffset;","    uniform float gapSize;","#endif","varying float vLineDistance;","varying vec2 vOffset;","varying float vAdjustedLineWidth;","#include <common>","#include <color_pars_fragment>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <clipping_planes_pars_fragment>","varying vec2 vUv;","void main() {","    #include <clipping_planes_fragment>","    if (useMask) {","        vec2 actualResolution = resolution;","        #ifdef VARIABLE_RENDER_RESOLUTION","            actualResolution = renderResolution;","        #endif","        vec2 screenCoord = gl_FragCoord.xy / actualResolution;","        if (texture2D(mask, screenCoord).r != 0.) discard;","    }","    #ifdef USE_DASH","        if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard;","    #endif","    float endcapOpacity = 1.;","    float a = abs(vUv.x);","    float b = abs(vUv.y);","    if ( b > 1. ) {","        b -= 1.;","        float len2 = sqrt(1.5 * a*a + 1.2 * b*b);","        endcapOpacity = clamp(1. - len2, 0., 1.);","        if ( endcapOpacity < 0.26 ) discard;","    }","    float uvOpacity = 1. - a;","    float offsetLength = length(vOffset);","    float offsetRate = 0.4 * fwidth(offsetLength);","    #ifdef VARIABLE_RENDER_RESOLUTION","        offsetRate *=  renderResolution.y / resolution.y;","    #endif","    offsetLength = offsetLength / offsetRate / vAdjustedLineWidth;","    float offsetOpacity = 1. - offsetLength;","    float lineWidthOpacity = max(uvOpacity, offsetOpacity);","    float lineOpacity = min(lineWidthOpacity, endcapOpacity);","    lineOpacity *= lineOpacity;","    float minSmoothness = 0.1;","    float smoothFactor = 1. - min(linewidth, 5.) / 5.;","    float smoothness = minSmoothness + smoothFactor * (1. - minSmoothness);","    float lineSmoothingAlpha = smoothstep( 0., smoothness, lineOpacity );","    float alpha = opacity * lineSmoothingAlpha;","    if (alpha < 0.03) discard;","    vec4 diffuseColor = vec4( diffuse, alpha );","    #include <logdepthbuf_fragment>","    #include <color_fragment>","    gl_FragColor = vec4( diffuseColor.rgb, alpha );","    #include <tonemapping_fragment>","    #include <encodings_fragment>","    #include <fog_fragment>","    #include <premultiplied_alpha_fragment>","}"].join("\n");i=t([_s("geotoolkit3d.util.shaders.Line")],i);return i}();var hUt=function(){let i=class t extends d{constructor(t){super({vertexShader:t["vertexShader"]||nUt.$Ze_,fragmentShader:t["fragmentShader"]||nUt.t_e_});this.setOptions(t);this.type="LineMaterial";this.transparent=!0;this.userData.i_e_=!0;this.side=e}setOptions(t){if(t["linestyle"]instanceof hl){const i=t["linestyle"].hB_(),s={color:new l(i.Is_()/255,i.Cs_()/255,i.fs_()/255),opacity:i.ds_()/255,linewidth:t["linestyle"].Ie_()},e=t["linestyle"].$w_(),A=e[0],n=e[1];if(Number.isFinite(n)&&Number.isFinite(A)){s["dashed"]=!0;s["dashsize"]=A;s["gapsize"]=n}t=Pi(s,t)}nUt.PZe_(this,t);return this}JV_(){return nUt.VZe_(this)}};i=t([_s("geotoolkit3d.scene.LineMaterial")],i);return i}();$Lt.yZe_(hUt.D_(),yLt);const rUt=new a,oUt=new a,lUt=new a,uUt=new a,aUt=new g,gUt=(t,i)=>{const s=i.count;let e=0,A=Number.POSITIVE_INFINITY;for(let n=0;n<s;n++){const s=Math.abs(i.getZ(n)-t);if(s<A){e=n;A=s}}return e};var cUt=Ci(function(){let i=class t extends W{constructor(t){(t=t||{})["data"]==null||t["data"]["colors"]==null&&t["data"]["colorprovider"]==null||(t["colorfromattribute"]=!0);typeof t["color"]=="string"&&(t["color"]=new l(t["color"]));t["dashed"]&&t["data"]!=null&&(t["data"]["endcaps"]=!1);const i=undefined,s=undefined;super(new eUt(t["data"]),new hUt(t));this.onBeforeRender=(t,i,s,e,A,n)=>{super.onBeforeRender(t,i,s,e,A,n);t.getSize(aUt);if(!this.s_e_.equals(aUt)){this.s_e_.set(aUt.x,aUt.y);nUt._Ze_(this.material,{resolution:{width:aUt.x,height:aUt.y}})}};Object.assign(this,{type:"LineSegments"});this.s_e_=new g(0,0);this.frustumCulled=!1;this.bC_=t["selectable"]!==!1}setOptions(t){if(t==null)return this;t["data"]||(t["data"]={});t["dashed"]&&(t["data"]["endcaps"]=!1);this.geometry.setData(t["data"]);t["colorfromattribute"]=this.geometry.JZe_();this.material.setOptions(t);t["selectable"]!=null&&(this.bC_=t["selectable"]);return this}JV_(){return qi(this.material.JV_(),{selectable:this.bC_})}OC_(){return this.bC_}KC_(t){this.bC_=t;return this}computeLineDistances(){const t=this.geometry,i=t.getAttribute("instanceStart"),s=t.getAttribute("instanceEnd"),e=new Float32Array(2*i.count);for(let t=0,A=0;t<i.count;t++,A+=2){rUt.fromBufferAttribute(i,t);oUt.fromBufferAttribute(s,t);e[A]=A===0?0:e[A-1];e[A+1]=e[A]+rUt.distanceTo(oUt)}const A=new q(e,2,1);t.setAttribute("instanceDistanceStart",new J(A,1,0));t.setAttribute("instanceDistanceEnd",new J(A,1,1));return this}e_e_(t){if(!this.A_e_){const i=this.geometry.HZe_(),s=this.geometry.qZe_();this.n_e_((i.getZ(0)+s.getZ(s.count-1))/2,t)}return this.A_e_}n_e_(t,i){if(this.xm_&&this.xm_.equals(i)&&t===this.X9_)return this;this.xm_||(this.xm_=i);this.X9_||(this.X9_=t);this.xm_.equals(i)||this.xm_.copy(i);this.abt_=this.abt_||new a;this.A_e_=this.A_e_||new f;const s=this.geometry.HZe_(),e=this.geometry.qZe_(),A=gUt(t,s);lUt.set(s.getX(A),s.getY(A),s.getZ(A));uUt.set(e.getX(A),e.getY(A),e.getZ(A));const n=(t-s.getZ(A))/(e.getZ(A)-s.getZ(A));this.abt_.copy(uUt).sub(lUt).multiplyScalar(n).add(lUt);lUt.multiply(this.xm_);lUt.multiply(this.xm_);uUt.multiply(this.xm_);uUt.multiply(this.xm_);uUt.sub(lUt).normalize();lUt.set(-1,0,0);lUt.crossVectors(uUt,lUt).normalize();this.A_e_=kxt.Sje_(lUt,uUt,this.A_e_);return this}Ye_(t){if(!this.abt_){const i=this.geometry.HZe_(),s=this.geometry.qZe_();this.n_e_((s.getZ(s.count-1)+i.getZ(0))/2,t)}return this.abt_}h_e_(t){nUt._Ze_(this.material,{mask:t})}};i=t([_s("geotoolkit3d.scene.LineSegments")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiaXNTZWxlY3RhYmxlIjoiT0NfIiwic2V0U2VsZWN0YWJsZSI6IktDXyJ9fX0g");var IUt=Ci(function(){var i;let s=i=class t{static r_e_(t){if(!(t.geometry instanceof z))return[];const i=t.geometry,s=i.index,e=i.getAttribute("position"),A={},n=s!=null?s.count:e.count;let h;for(h=0;h<n;h+=3){let t,i,n,r,o=!0;for(t=h+2,i=h;i<h+3;t=i,i++){if(s!=null){n=s.getX(t);r=s.getX(i)}else{n=t;r=i}const A=e.getX(n),h=e.getX(r),l=e.getY(n),u=e.getY(r),a=e.getZ(n),g=e.getZ(r);if(!(Number.isFinite(A)&&Number.isFinite(h)&&Number.isFinite(l)&&Number.isFinite(u)&&Number.isFinite(a)&&Number.isFinite(g))){o=!1;break}}if(o)for(t=h+2,i=h;i<h+3;t=i,i++){if(s!=null){n=s.getX(t);r=s.getX(i)}else{n=t;r=i}if(n>r){const t=n;n=r;r=t}const e=n+"x"+r;A.hasOwnProperty(e)?A[e]++:A[e]=1}}const r=[];for(const t in A)if(A[t]===1){const i=t.split("x").map((t=>+t));r.push(e.getX(i[0]),e.getY(i[0]),e.getZ(i[0]),e.getX(i[1]),e.getY(i[1]),e.getZ(i[1]))}return r}static o_e_(t){const s=[];t.forEach((t=>{if(t instanceof cUt)return;const e=i.r_e_(t);if(e.length===0)return;const A=new cUt({data:{positions:e},color:new l("red"),linewidth:5,opacity:.75});t.add(A);s.push(A)}));return s}};s=i=t([_s("geotoolkit3d.util.MeshUtils")],s);return s}(),2,"eyJjb21wdXRlTWVzaE91dGxpbmUiOiJyX2VfIiwiZ2VuZXJhdGVNZXNoSGlnaGxpZ2h0Ijoib19lXyIsImdldENsYXNzTmFtZSI6IkRfIn0g");var fUt=Ci(function(){let i=class t extends m{constructor(){super();this.$Vt_=this.visible;this.df_=!1;this.bC_=!0;const t="visible";Object.defineProperty(this,t,{get:()=>this.$Vt_,set:t=>{if(t===this.$Vt_)return this;this.$Vt_=t;this.invalidateObject();return this}});this.frustumCulled=!1;this.TSt_=null}invalidateObject(t){t=t||new iUt({type:tUt.sC_,source:this,args:[]});let i=this;while(i.parent!=null){i=i.parent;if(i.invalidateObject!=null){i.invalidateObject(t);return this}}i.userData["plot"]!=null&&i.userData["plot"].invalidateObject(t);return this}updateObject(t,i){return this}beforeRender(t,i,s,e){return this}afterRender(t,i,s,e){return this}add(t){if(Array.isArray(t))t.forEach((t=>{super.add(t);t.updateMatrixWorld!=null&&t.updateMatrixWorld(!0)}));else{super.add.apply(this,arguments);t.updateMatrixWorld!=null&&t.updateMatrixWorld(!0)}this.invalidateObject(new iUt({type:tUt.Add,source:this,args:arguments}));return this}remove(t){super.remove.apply(this,arguments);this.invalidateObject(new iUt({type:tUt.mt_,source:this,args:arguments}));return this}l_e_(){return!1}u_e_(){return!1}a_e_(){return[]}g_e_(t){if(this.TSt_==null){if(!t)return this;this.c_e_()}this.TSt_.forEach((i=>{i.visible=t}));return this}c_e_(){const t=this.a_e_();this.TSt_=IUt.o_e_(t)}static register(){}dispose(){if(!this.Df_()){this.df_=!0;if(this.TSt_!=null&&Array.isArray(this.TSt_)){for(let t=this.TSt_.length-1;t>=0;t--){const i=this.TSt_[t];i.geometry!=null&&i.geometry.dispose();i.material!=null&&(Array.isArray(i.material)?i.material.forEach((t=>{t&&t.dispose()})):i.material.dispose());i.parent!=null&&i.parent.remove(i)}this.TSt_=null}}}Df_(){return this.df_}setOptions(t){if(t==null)return this;t.hasOwnProperty("visible")&&(this.visible=t["visible"]);return this}JV_(){return{visible:this.visible}}nf_(t,i){i===!0?this.$Vt_=t:this.visible=t;return this}$C_(){return this.visible}I_e_(t){this.$Vt_=t;return this}f_e_(){return this.visible}OC_(){return this.bC_}KC_(t){this.bC_=t}};i=t([_s("geotoolkit3d.scene.Object3D")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJ1c2VPd25IaWdobGlnaHQiOiJsX2VfIiwiaXNEaXNwb3NlZCI6IkRmXyIsImdldE9wdGlvbnMiOiJKVl8iLCJzZXRWaXNpYmxlIjoibmZfIiwiZ2V0VmlzaWJsZSI6IiRDXyIsImlzU2VsZWN0YWJsZSI6Ik9DXyIsInNldFNlbGVjdGFibGUiOiJLQ18ifX0sImdldENsYXNzTmFtZSI6IkRfIn0g");const CUt=1e-6,dUt=(new B).setFromUnitVectors(new a(0,0,1),new a(0,1,0)),BUt=dUt.clone().invert();var wUt={NONE:"none",C_e_:"touch_rotate",d_e_:"touch_dolly",B_e_:"touch_pan"},QUt=Ci(function(){let i=class t extends bFt{constructor(t){const i=qi(t,{mindistance:0,maxdistance:1/0,norotate:!1,rotatespeed:1,keypanspeed:7,nodblclick:!1,dblclickspeed:250,autorotate:!1,autorotatespeed:2,minpolarangle:0,maxpolarangle:Math.PI,minazimuthangle:-1/0,maxazimuthangle:1/0,constantzoom:!1,name:"orbitcontroller"},!0);super(i);this.w_e_=new a;this.Q_e_=i["constantzoom"];this.Ei_=wUt.NONE;this.E_e_=new g;this.p_e_=new g;this.m_e_=new g;this.y_e_=new g;this.D_e_=new g;this.M_e_=new g;this.v_e_=new a;this.T2_=new a;this.b_e_=new g;this.N_e_=new g;this.S_e_=new g;this.G_e_=0;this.R_e_=0;this.xm_=1;this.k_e_=new a;this.F_e_=!0;this.x_e_(i)}setOptions(t){super.setOptions(t);this.x_e_(t);return this}x_e_(t){if(!this.F_e_)return;const i=qi(t,{mindistance:this.s4i_,maxdistance:this.L_e_,norotate:this.U_e_,rotatespeed:this.Y_e_,nodblclick:this.T_e_,autorotate:this.K_e_,autorotatespeed:this.H_e_,minpolarangle:this.q_e_,maxpolarangle:this.J_e_,minazimuthangle:this.P_e_,maxazimuthangle:this.V_e_,constantzoom:this.Q_e_,position:this.gXe_()!=null?this.gXe_().position:this.getPosition(),lookat:this.akt_()},!0);this.Q_e_=i["constantzoom"];this.s4i_=i["mindistance"];this.L_e_=i["maxdistance"];this.U_e_=i["norotate"];this.Y_e_=i["rotatespeed"];this.T_e_=i["nodblclick"];this.K_e_=i["autorotate"];this.H_e_=i["autorotatespeed"];this.q_e_=i["minpolarangle"];this.J_e_=i["maxpolarangle"];this.P_e_=i["minazimuthangle"];this.V_e_=i["maxazimuthangle"];this.O_e_=t["dblclickspeed"];this.w_e_.copy(i["lookat"]);this.W_e_=(new a).subVectors(this.w_e_,this.getPosition()).length();this.z_e_=this.W_e_;this.akt_().copy(this.w_e_);this.X_e_()}JV_(){const t=super.JV_();t["mindistance"]=this.s4i_;t["maxdistance"]=this.L_e_;t["norotate"]=this.U_e_;t["rotatespeed"]=this.Y_e_;t["nodblclick"]=this.T_e_;t["dblclickspeed"]=this.O_e_;t["minpolarangle"]=this.q_e_;t["maxpolarangle"]=this.J_e_;t["minazimuthangle"]=this.P_e_;t["maxazimuthangle"]=this.V_e_;t["constantzoom"]=this.Q_e_;return t}Rze_(t){this.isEnabled()&&!this.T_e_&&this.j_e_(t["plotX"],t["plotY"])}Lze_(t){if(this.isEnabled()&&!this.U_e_){this.Ei_=wUt.C_e_;this.E_e_.set(t["plotX"],t["plotY"])}}aWt_(t){if(!this.isEnabled())return;if(this.U_e_===!0)return;if(this.Ei_!==wUt.C_e_)return;this.p_e_.set(t["plotX"],t["plotY"]);this.m_e_.subVectors(this.p_e_,this.E_e_);const i=this.getPlot().getSize().Ts_();this.Z_e_(2*Math.PI*this.m_e_.x/i*this.Y_e_);this.__e_(2*Math.PI*this.m_e_.y/i*this.Y_e_);this.E_e_.copy(this.p_e_);this.CXe_()}Uze_(t){this.isEnabled()&&(this.Ei_=wUt.NONE)}kze_(t){if(!this.isEnabled())return;if(this.IXe_())return;this.Ei_=wUt.d_e_;const i=t["distanceX"],s=t["distanceY"],e=Math.sqrt(i*i+s*s);this.b_e_.set(0,e)}Fze_(t){if(!this.isEnabled())return;if(this.IXe_())return;if(this.Ei_!==wUt.d_e_)return;const i=t["distanceX"],s=t["distanceY"],e=Math.sqrt(i*i+s*s);this.N_e_.set(0,e);this.S_e_.subVectors(this.N_e_,this.b_e_);if(this.S_e_.y>5)this.$_e_();else{if(!(this.S_e_.y<-5))return;this.t$e_()}this.b_e_.copy(this.N_e_);this.CXe_()}xze_(t){this.isEnabled()&&(this.Ei_=wUt.NONE)}Yze_(t){if(this.isEnabled()&&!this.cXe_()){this.Ei_=wUt.B_e_;this.y_e_.set(t["plotX"],t["plotY"])}}Tze_(t){if(this.isEnabled()&&!this.cXe_()&&this.Ei_===wUt.B_e_){this.D_e_.set(t["plotX"],t["plotY"]);this.M_e_.subVectors(this.D_e_,this.y_e_);if(!(this.M_e_.length()<5)){this.pan(this.M_e_.x,this.M_e_.y);this.y_e_.copy(this.D_e_);this.CXe_()}}}Kze_(t){this.isEnabled()&&(this.Ei_=wUt.NONE)}jFt_(t){if(!this.isEnabled()||this.IXe_())return;t.preventDefault();const i=undefined;-t["deltaY"]>0?this.$_e_():this.t$e_();this.CXe_()}X_e_(){const t=this.gXe_().position;this.T2_.copy(t).sub(this.akt_());this.T2_.applyQuaternion(dUt);this.kMs_=Math.atan2(this.T2_.x,this.T2_.z);this.i$e_=Math.atan2(Math.sqrt(this.T2_.x*this.T2_.x+this.T2_.z*this.T2_.z),this.T2_.y)}j_e_(t,i){const s=this.getPlot(),e=$Lt.pO_(s,t,i,this.Xz_,this.Xz_);if(e.length>0){s.s$e_(e[0]["point"],!0);this.w_e_.copy(e[0]["point"]);this.getPosition().copy(s.e$e_());this.W_e_=(new a).subVectors(this.w_e_,this.getPosition()).length();this.z_e_=this.W_e_}}Z_e_(t){t===void 0&&(t=this.A$e_());this.kMs_-=t;this.kMs_=Math.max(this.P_e_,Math.min(this.V_e_,this.kMs_))}__e_(t){t===void 0&&(t=this.A$e_());!this.Q_e_||this.z_e_>0?this.i$e_-=t:this.i$e_+=t;this.i$e_=Math.max(this.q_e_,Math.min(this.J_e_,this.i$e_))}A$e_(){return 2*Math.PI/60/60*this.H_e_}n$e_(){return Math.pow(.95,this.fXe_())}h$e_(t){const i=this.gXe_().matrix.elements;this.v_e_.set(i[0],i[1],i[2]);this.v_e_.multiplyScalar(-t);this.k_e_.add(this.v_e_)}r$e_(t){const i=this.gXe_().matrix.elements;this.v_e_.set(i[4],i[5],i[6]);this.v_e_.multiplyScalar(t);this.k_e_.add(this.v_e_)}pan(t,i){const s=this.getPlot().getSize(),e=s.Ie_(),A=s.Ts_(),n=this.gXe_();if(n instanceof Q){let s=this.W_e_;if(!this.Q_e_){const t=undefined,i=undefined;s=n.position.clone().sub(this.akt_()).length()}s*=Math.tan(n.fov/2*Math.PI/180);this.h$e_(2*t*s/e);this.r$e_(2*i*s/A)}else if(n instanceof v){this.h$e_(t*(n.right-n.left)/e);this.r$e_(i*(n.top-n.bottom)/A)}}t$e_(t){t===void 0&&(t=this.n$e_());this.xm_/=t;this.z_e_+=this.W_e_*(1-t)}$_e_(t){t===void 0&&(t=this.n$e_());this.xm_*=t;this.z_e_-=this.W_e_*(1-t)}CXe_(){const t=this.gXe_(),i=t.position,s=this.akt_();this.Ei_===wUt.C_e_&&(this.i$e_=Math.max(CUt,Math.min(Math.PI-CUt,this.i$e_)));let e;if(this.Q_e_){e=this.z_e_;e=Math.max(this.s4i_,Math.min(this.L_e_,e))}else{this.T2_.copy(i).sub(s);e=this.T2_.length()*this.xm_;e=Math.max(this.s4i_,Math.min(this.L_e_,e))}s.add(this.k_e_);if(t instanceof v){t.left*=this.xm_;t.right*=this.xm_;t.top*=this.xm_;t.bottom*=this.xm_;t.updateProjectionMatrix()}this.K_e_&&this.Ei_===wUt.NONE&&this.Z_e_();this.T2_.x=e*Math.sin(this.i$e_)*Math.sin(this.kMs_);this.T2_.y=e*Math.cos(this.i$e_);this.T2_.z=e*Math.sin(this.i$e_)*Math.cos(this.kMs_);this.T2_.applyQuaternion(BUt);i.copy(s).add(this.T2_);t.lookAt(s);this.xm_=1;this.k_e_.set(0,0,0);fUt.prototype.invalidateObject.call(t,new iUt({type:tUt.Camera,source:this,args:[]}))}o$e_(){return this.K_e_}l$e_(){return this.V_e_}getMaxDistance(){return this.L_e_}u$e_(){return this.J_e_}a$e_(){return this.P_e_}g$e_(){return this.s4i_}c$e_(){return this.q_e_}I$e_(){return this.U_e_}B$_(){return this.T2_}f$e_(){return this.M_e_}C$e_(){return this.D_e_}d$e_(){return this.v_e_}B$e_(){return this.y_e_}w$e_(){return this.k_e_}Q$e_(){return this.G_e_}E$e_(t){this.G_e_=t}p$e_(){return this.m_e_}m$e_(){return this.p_e_}y$e_(){return this.Y_e_}D$e_(){return this.E_e_}qm_(){return this.xm_}setScale(t){this.xm_=t}getState(){return this.Ei_}setState(t){this.Ei_=t}M$e_(){return this.R_e_}v$e_(t){this.R_e_=t}};i=t([_s("geotoolkit3d.controller.OrbitController")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwib25Eb3VibGVUYXAiOiJSemVfIiwib25EcmFnU3RhcnQiOiJMemVfIiwib25EcmFnIjoiYVd0XyIsIm9uRHJhZ0VuZCI6IlV6ZV8iLCJvblBpbmNoU3RhcnQiOiJremVfIiwib25QaW5jaCI6IkZ6ZV8iLCJvblBpbmNoRW5kIjoieHplXyIsIm9uU2xpZGVTdGFydCI6Ill6ZV8iLCJvblNsaWRlIjoiVHplXyIsIm9uU2xpZGVFbmQiOiJLemVfIiwib25Nb3VzZVdoZWVsIjoiakZ0XyJ9fX0g");var EUt=Ci(function(){let i=class t{};i.prototype.run=Zi;i=t([_s("geotoolkit3d.scene.animation.AbstractAnimation")],i);return i}(),2,"eyJnZXRDbGFzc05hbWUiOiJEXyJ9");const pUt=function(){return!0};var mUt=function(){let i=class t extends EUt{constructor(t){super();this.b$e_=(t?t["function"]:null)||pUt}run(){return this.b$e_()}};i=t([_s("geotoolkit3d.scene.animation.Animation")],i);return i}();const yUt=1e-6,DUt=(new B).setFromUnitVectors(new a(0,0,1),new a(0,1,0)),MUt=DUt.clone().invert(),vUt=new u;var bUt=Ci(function(){let i=class t extends QUt{constructor(t){const i=qi(t,{name:"firstpersoncontroller",keypanspeed:168,pointerlock:!1,inverty:!1,rotatespeed:30,deltacap:.1},!0);super(i);this.N$e_=new g;this.S$e_=new g;this.G$e_=!0;this.R$e_(i)}setOptions(t){super.setOptions(t);this.R$e_(t);return this}R$e_(t){if(!this.G$e_)return;const i=qi(t,{pointerlock:this.k$e_,inverty:this.F$e_,deltacap:this.x$e_,keypanspeed:this.L$e_},!0);this.k$e_=!je.Xi_()&&i["pointerlock"];this.F$e_=i["inverty"];this.x$e_=i["deltacap"];this.L$e_=i["keypanspeed"];this.B$_().copy(this.akt_()).sub(this.gXe_().position)}JV_(){const t=super.JV_();t["pointerlock"]=this.k$e_;t["inverty"]=this.F$e_;t["deltacap"]=this.x$e_;t["keypanspeed"]=this.L$e_;return t}Sze_(t){}Gze_(t){}Hze_(t){}qze_(t){const i=this.AXe_();for(const t in i)delete i[t]}zFt_(t){super.zFt_(t);if(this.k$e_){const t=this.getPlot().EZe_().domElement;t["requestPointerLock"]=this.U$e_(t);t["requestPointerLock"]()}}Ct_(t){super.Ct_(t);if(this.k$e_){Mi.document["exitPointerLock"]=this.Y$e_(Mi.document);Mi.document["exitPointerLock"]()}}vze_(t){this.isEnabled()&&this.T$e_()}K$e_(t,i){let s=!1,e=!1;for(let A=0;A<t.length;A++){switch(t[A]){case"37":case"65":i.add(new a(-1,0,0));break;case"39":case"68":i.add(new a(1,0,0));break;case"38":case"87":i.add(new a(0,0,-1));break;case"40":case"83":i.add(new a(0,0,1));break;case"82":i.add(new a(0,1,0));break;case"70":i.add(new a(0,-1,0));break;case"16":s=!0;break;case"90":e=!0;break;default:i.add(new a(0,0,0))}s&&i.multiplyScalar(2);e&&i.multiplyScalar(.5)}}H$e_(t,i){if(t.length!==0){const s=new a;this.K$e_(t,s);const e=this.gXe_();e.updateMatrixWorld();vUt.extractRotation(e.matrixWorld);s.applyMatrix4(vUt);s.multiplyScalar(this.L$e_*i);e.position.add(s);this.akt_().add(s)}}q$e_(){const t=Date.now();let i=(t-this.J$e_)/1e3;i>this.x$e_&&(i=this.x$e_);this.J$e_=t;const s=Object.keys(this.AXe_());if(s.length===0&&this.w$e_().lengthSq()===0&&this.M$e_()===0&&this.Q$e_()===0)return!0;this.H$e_(s,i);const e=this.gXe_();if(this.M$e_()!==0||this.Q$e_()!==0){const t=e.position,s=this.B$_();s.copy(this.akt_()).sub(t);s.applyQuaternion(DUt);let A=Math.atan2(s.x,s.z),n=Math.atan2(Math.sqrt(s.x*s.x+s.z*s.z),s.y);this.o$e_()&&this.Z_e_();A+=this.M$e_()*i*this.y$e_();n+=this.Q$e_()*i*this.y$e_();A=Math.max(this.a$e_(),Math.min(this.l$e_(),A));n=Math.max(this.c$e_(),Math.min(this.u$e_(),n));this.getState()===wUt.C_e_&&(n=Math.max(yUt,Math.min(Math.PI-yUt,n)));const h=this.qm_();let r=s.length()*h;r=Math.max(this.g$e_(),Math.min(this.getMaxDistance(),r));e.position.add(this.w$e_());if(e instanceof v){e.left*=h;e.right*=h;e.top*=h;e.bottom*=h;e.updateProjectionMatrix()}s.x=r*Math.sin(n)*Math.sin(A);s.y=r*Math.cos(n);s.z=r*Math.sin(n)*Math.cos(A);s.applyQuaternion(MUt);this.akt_().copy(t).add(s);e.lookAt(this.akt_());this.v$e_(0);this.E$e_(0);this.setScale(1)}const A=this.w$e_();if(this.w$e_().lengthSq()!==0){e.position.add(A);this.akt_().add(A);A.set(0,0,0)}return!1}T$e_(){if(this.tLt_==null){const t=this;this.tLt_=new mUt({function:t.q$e_.bind(t)})}const t=this.getPlot();if(!t.V$e_().P$e_(this.tLt_)){t.V$e_().O$e_(this.tLt_);this.J$e_=Date.now()}}Lze_(t){if(this.isEnabled()&&!this.I$e_()){this.setState(wUt.C_e_);this.D$e_().set(t["plotX"],this.F$e_?t["plotY"]:-t["plotY"])}}aWt_(t){if(!this.isEnabled())return;if(this.I$e_())return;if(this.getState()!==wUt.C_e_)return;const i=this.p$e_(),s=this.D$e_(),e=this.m$e_();if(this.k$e_&&!this.dFt_(t))i.set(t["movementX"],this.F$e_?t["movementY"]:-t["movementY"]);else if(this.k$e_&&this.dFt_(t)){e.set(t["plotX"],this.F$e_?t["plotY"]:-t["plotY"]);i.subVectors(e,this.N$e_);this.N$e_.copy(e)}else{e.set(t["plotX"],this.F$e_?t["plotY"]:-t["plotY"]);i.subVectors(e,s)}const A=this.getPlot().getSize().Ie_();this.v$e_(2*Math.PI*i.x/A);this.E$e_(2*Math.PI*i.y/A);this.k$e_||s.copy(e);this.CXe_()}Tze_(t){if(!this.isEnabled())return;if(this.cXe_())return;if(this.getState()!==wUt.B_e_)return;const i=this.f$e_(),s=this.B$e_(),e=this.C$e_(),A=this.d$e_();if(this.k$e_&&!this.dFt_(t))i.set(t["movementX"],this.F$e_?t["movementY"]:-t["movementY"]);else if(this.k$e_&&this.dFt_(t)){e.set(t["plotX"],t["plotY"]);this.S$e_.x===0&&this.S$e_.y===0&&this.S$e_.copy(s);i.subVectors(e,this.S$e_);this.S$e_.copy(e)}else{e.set(t["plotX"],t["plotY"]);i.subVectors(e,s);s.copy(e)}if(!(i.length()<5)){A.set(i.x,i.y,0);this.w$e_().add(A);this.CXe_()}}Kze_(t){super.Kze_(t);this.S$e_=new g}Uze_(t){if(this.isEnabled()){this.setState(wUt.NONE);this.k$e_&&(Mi.document["exitPointerLock"]=this.Y$e_(Mi.document))}}Y$e_(t){return t["exitPointerLock"]||t["mozExitPointerLock"]||t["webkitExitPointerLock"]}U$e_(t){return t["requestPointerLock"]||t["mozRequestPointerLock"]||t["webkitRequestPointerLock"]}kze_(t){if(!this.isEnabled()||this.IXe_())return;const i=t["distanceX"],s=t["distanceY"];this.W$e_=Math.sqrt(i*i+s*s)}Fze_(t){if(!this.isEnabled()||this.IXe_())return;t.preventDefault();const i=t["distanceX"],s=t["distanceY"],e=Math.sqrt(i*i+s*s),A=this.W$e_-e;if(A===0)return;this.W$e_=e;const n=undefined,h=this.getPlot().getSize().Ie_(),r=this.gXe_();if(r instanceof Q){const t=undefined,i=undefined;let s=r.position.clone().sub(this.akt_()).length();s*=Math.tan(r.fov/2*Math.PI/180);this.z$e_(2*A*s/h)}else r instanceof v&&this.z$e_(2*(r.right-r.left)/h);this.CXe_()}jFt_(t){if(!this.isEnabled()||this.IXe_())return;t.preventDefault();const i=-t["deltaY"],s=undefined,e=this.getPlot().getSize().Ie_(),A=this.gXe_();if(A instanceof Q){const t=undefined,s=undefined;let n=A.position.clone().sub(this.akt_()).length();n*=Math.tan(A.fov/2*Math.PI/180);this.z$e_(2*i*n/e)}else A instanceof v&&this.z$e_(2*(A.right-A.left)/e);this.CXe_()}z$e_(t){const i=this.gXe_().matrix.elements,s=this.d$e_();s.set(i[8],i[9],i[10]);s.multiplyScalar(t);this.w$e_().add(s)}CXe_(){this.T$e_()}};i=t([_s("geotoolkit3d.controller.FirstPersonController")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwib25DdXJzb3JNb3ZlIjoiU3plXyIsIm9uVGFwIjoiR3plXyIsIm9uVmlzaWJpbGl0eUdhaW5lZCI6Ikh6ZV8iLCJvblZpc2liaWxpdHlMb3N0IjoicXplXyIsIm9uTW91c2VEb3duIjoiekZ0XyIsIm9uTW91c2VVcCI6IkN0XyIsIm9uS2V5U3RhcnQiOiJ2emVfIiwib25EcmFnU3RhcnQiOiJMemVfIiwib25EcmFnIjoiYVd0XyIsIm9uU2xpZGUiOiJUemVfIiwib25TbGlkZUVuZCI6Ikt6ZV8iLCJvbkRyYWdFbmQiOiJVemVfIiwib25QaW5jaFN0YXJ0Ijoia3plXyIsIm9uUGluY2giOiJGemVfIiwib25Nb3VzZVdoZWVsIjoiakZ0XyJ9fX0g");var NUt={XY:"xy",XZ:"xz",YZ:"yz"},SUt=Ci(function(){let i=class t extends bFt{constructor(t){const i=qi(t,{panspeed:.001,noroll:!1,plane:NUt.XZ,name:"rollcontroller"});super(i);this.y_e_=new g;this.X$e_=new g;this.sb_=new g;this.j$e_=0;this.Z$e_=i["plane"].toLowerCase();this._$e_=this.$$e_();this.t0e_=!0;this.i0e_(i)}setOptions(t){if(t==null)return this;super.setOptions(t);this.i0e_(t);return this}i0e_(t){if(!this.t0e_)return;const i=qi(t,{panspeed:this.s0e_,noroll:this.e0e_,plane:this.Z$e_},!0);this.s0e_=i["panspeed"];this.e0e_=i["noroll"];this.Z$e_=i["plane"].toLowerCase();this.j$e_=0;this._$e_=this.$$e_()}JV_(){const t=super.JV_();t["panspeed"]=this.s0e_;t["noroll"]=this.e0e_;t["plane"]=this.Z$e_;return t}Lze_(t){if(!this.e0e_){this.A0e_=new g(t["plotX"],t["plotY"]);this.j$e_=this.$$e_()}}aWt_(t){if(this.e0e_===!0)return;const i=new g;this.sb_.set(t["plotX"],t["plotY"]);const s=this.getPlot().getSize(),e=new g(s.Ie_()/2,s.Ts_()/2);i.subVectors(this.sb_,e);const A=(new g).subVectors(this.A0e_,e),n=Math.atan2(A.x,-A.y),h=Math.atan2(i.x,-i.y);this.n0e_(h-n+this.j$e_);fUt.prototype.invalidateObject.call(this.gXe_(),new iUt({type:tUt.Camera,source:this,args:[]}))}Uze_(t){}kze_(t){if(this.IXe_())return;const i=t["distanceX"],s=t["distanceY"],e=Math.sqrt(i*i+s*s);this.X$e_.set(0,e)}Fze_(t){const i=this.gXe_();if(this.IXe_()||i instanceof v)return;const s=t["distanceX"],e=t["distanceY"],A=new g;this.sb_.set(s,e);A.subVectors(this.sb_,this.X$e_);this.h0e_(A.y/this.getPlot().getSize().Ts_(),i);this.X$e_.copy(this.sb_);fUt.prototype.invalidateObject.call(i,new iUt({type:tUt.Camera,source:this,args:[]}))}xze_(t){}Yze_(t){this.cXe_()||this.y_e_.set(t["plotX"],t["plotY"])}Tze_(t){const i=this.gXe_();if(this.cXe_()||i instanceof v)return;const s=new g;this.sb_.set(t["plotX"],t["plotY"]);s.subVectors(this.sb_,this.y_e_);this.r0e_(s,i);this.y_e_.copy(this.sb_);fUt.prototype.invalidateObject.call(i,new iUt({type:tUt.Camera,source:this,args:[]}))}Kze_(t){}jFt_(t){const i=this.gXe_();if(!this.isEnabled()||this.IXe_()||i instanceof v)return;t.preventDefault();const s=t["deltaY"];this.h0e_(s,i);fUt.prototype.invalidateObject.call(i,new iUt({type:tUt.Camera,source:this,args:[]}))}r0e_(t,i){const s=undefined,e=undefined;let A=i.position.clone().sub(this.akt_()).length();A*=Math.tan(i.fov/2*Math.PI/180);const n=this.getPlot().getSize();this.h$e_(2*t.x*A/n.Ie_());this.r$e_(2*t.y*A/n.Ts_())}h$e_(t){const i=this.gXe_(),s=i.matrix.elements,e=new a(s[0],s[1],s[2]);e.multiplyScalar(-t);i.position.add(e);const A=this.akt_();A.add(e);i.lookAt(A);this.o0e_()}r$e_(t){const i=this.gXe_(),s=i.matrix.elements,e=new a(s[4],s[5],s[6]);e.multiplyScalar(t);i.position.add(e);const A=this.akt_();A.add(e);i.lookAt(A);this.o0e_()}h0e_(t,i){let s=i.fov+=t*this.fXe_();s=Math.min(Math.max(10,s),90);this.getPlot().setOptions({camera:{fov:s}})}n0e_(t){this._$e_=t;this.o0e_()}$$e_(){const t=this.gXe_();switch(this.Z$e_){case NUt.XZ:return t.rotation.z;case NUt.XY:return t.rotation.y;case NUt.YZ:return t.rotation.x}return 0}o0e_(){const t=this.gXe_();switch(this.Z$e_){case NUt.XZ:t.rotation.z=this._$e_;break;case NUt.XY:t.rotation.y=this._$e_;break;case NUt.YZ:t.rotation.x=this._$e_;break}}};i=t([_s("geotoolkit3d.controller.RollController")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwib25EcmFnU3RhcnQiOiJMemVfIiwib25EcmFnIjoiYVd0XyIsIm9uRHJhZ0VuZCI6IlV6ZV8iLCJvblBpbmNoU3RhcnQiOiJremVfIiwib25QaW5jaCI6IkZ6ZV8iLCJvblBpbmNoRW5kIjoieHplXyIsIm9uU2xpZGVTdGFydCI6Ill6ZV8iLCJvblNsaWRlIjoiVHplXyIsIm9uU2xpZGVFbmQiOiJLemVfIiwib25Nb3VzZVdoZWVsIjoiakZ0XyJ9fX0g");const GUt=1e-6;var RUt={NONE:"none",C_e_:"touch_rotate",d_e_:"touch_dolly",B_e_:"touch_pan"},kUt=Ci(function(){let i=class t extends bFt{constructor(t){const i=qi(t,{rotatespeed:1,zoomspeed:.005,panspeed:.001,norotate:!1,noroll:!1,nodblclick:!1,dblclickspeed:250,staticmoving:!1,dynamicdampingfactor:.2,mindistance:0,maxdistance:1/0,name:"trackballcontroller"});super(i);this.Ei_=RUt.NONE;this.$gs_=RUt.NONE;this.l0e_=new a;this.E_e_=new a;this.p_e_=new a;this.X$e_=new g;this.u0e_=new g;this.a0e_=0;this.g0e_=0;this.y_e_=new g;this.D_e_=new g;this.P_t_=i["position"].clone();this.c0e_=!0;this.I0e_(i)}setOptions(t){if(t==null)return this;super.setOptions(t);this.I0e_(t);return this}I0e_(t){if(!this.c0e_)return;const i=qi(t,{rotatespeed:this.Y_e_,panspeed:this.s0e_,norotate:this.U_e_,noroll:this.e0e_,nodblclick:this.T_e_,staticmoving:this.f0e_,dynamicdampingfactor:this.C0e_,mindistance:this.s4i_,maxdistance:this.L_e_},!0);this.O_e_=t["dblclickspeed"];this.Y_e_=i["rotatespeed"];this.s0e_=i["panspeed"];this.U_e_=i["norotate"];this.e0e_=i["noroll"];this.T_e_=i["nodblclick"];this.f0e_=i["staticmoving"];this.C0e_=i["dynamicdampingfactor"];this.s4i_=i["mindistance"];this.L_e_=i["maxdistance"]}JV_(){const t=super.JV_();t["mindistance"]=this.s4i_;t["maxdistance"]=this.L_e_;t["norotate"]=this.U_e_;t["rotatespeed"]=this.Y_e_;t["nodblclick"]=this.T_e_;t["dblclickspeed"]=this.O_e_;t["panspeed"]=this.s0e_;t["noroll"]=this.e0e_;t["staticmoving"]=this.f0e_;t["dynamicdampingfactor"]=this.C0e_;return t}Rze_(t){this.isEnabled()&&!this.T_e_&&this.j_e_(t["plotX"],t["plotY"])}j_e_(t,i){const s=this.getPlot(),e=$Lt.pO_(s,t,i,this.Xz_,this.Xz_);e.length>0&&s.s$e_(e[0]["point"],!0)}d0e_(t,i){const s=new a,e=new a,A=new a,n=this.getPlot().getSize(),h=n.Ie_()*.5,r=n.Ts_()*.5;A.set((t-h)/h,(r-i)/r,0);const o=A.length();this.e0e_?o<Math.SQRT1_2?A.z=Math.sqrt(1-o*o):A.z=.5/o:o>1?A.normalize():A.z=Math.sqrt(1-o*o);const l=this.gXe_();this.l0e_.copy(l.position).sub(this.akt_());s.copy(l.up).setLength(A.y);s.add(e.copy(l.up).cross(this.l0e_).setLength(A.x));s.add(this.l0e_.setLength(A.z));return s}B0e_(){if(this.Ei_!==RUt.C_e_)return;const t=new a,i=new B;let s=Math.acos(this.E_e_.dot(this.p_e_)/this.E_e_.length()/this.p_e_.length());if(s>.01){t.crossVectors(this.E_e_,this.p_e_).normalize();s*=this.Y_e_;i.setFromAxisAngle(t,-s);this.l0e_.applyQuaternion(i);this.gXe_().up.applyQuaternion(i);this.p_e_.applyQuaternion(i);if(this.f0e_)this.E_e_.copy(this.p_e_);else{i.setFromAxisAngle(t,s*(this.C0e_-1));this.E_e_.applyQuaternion(i)}}}h0e_(){if(this.Ei_!==RUt.d_e_)return;let t=1+Math.abs(this.u0e_.y-this.X$e_.y)*this.fXe_();this.u0e_.y>this.X$e_.y&&(t=1/t);if(t!==1&&t>0){this.l0e_.multiplyScalar(t);this.f0e_?this.X$e_.copy(this.u0e_):this.X$e_.y+=(this.u0e_.y-this.X$e_.y)*this.C0e_}}r0e_(){if(this.Ei_!==RUt.B_e_)return;const t=new g,i=new a,s=new a;t.copy(this.D_e_).sub(this.y_e_);if(t.lengthSq()){const e=this.gXe_();t.multiplyScalar(this.l0e_.length()*this.s0e_);s.copy(this.l0e_).cross(e.up).setLength(t.x);s.add(i.copy(e.up).setLength(t.y));e.position.add(s);this.akt_().add(s);this.f0e_?this.y_e_.copy(this.D_e_):this.y_e_.add(t.subVectors(this.D_e_,this.y_e_).multiplyScalar(this.C0e_))}}w0e_(){if(!this.IXe_()||!this.cXe_()){const t=this.gXe_(),i=this.akt_();this.l0e_.lengthSq()>this.L_e_*this.L_e_&&t.position.addVectors(i,this.l0e_.setLength(this.L_e_));this.l0e_.lengthSq()<this.s4i_*this.s4i_&&t.position.addVectors(i,this.l0e_.setLength(this.s4i_))}}CXe_(){const t=this.gXe_(),i=this.akt_();this.l0e_.subVectors(t.position,i);this.U_e_||this.B0e_();this.IXe_()||this.h0e_();this.cXe_()||this.r0e_();t.position.addVectors(i,this.l0e_);this.w0e_();t.lookAt(i);this.P_t_.distanceToSquared(t.position)>GUt&&this.P_t_.copy(t.position);fUt.prototype.invalidateObject.call(t,new iUt({type:tUt.Camera,source:this,args:[]}))}Lze_(t){if(this.isEnabled()&&!this.U_e_){this.Ei_=RUt.C_e_;this.E_e_.copy(this.d0e_(t["plotX"],t["plotY"]));this.p_e_.copy(this.E_e_)}}aWt_(t){if(this.isEnabled()&&this.U_e_!==!0&&this.Ei_===RUt.C_e_){this.p_e_.copy(this.d0e_(t["plotX"],t["plotY"]));this.CXe_()}}Uze_(t){this.isEnabled()&&(this.Ei_=RUt.NONE)}kze_(t){if(!this.isEnabled())return;if(this.IXe_())return;this.Ei_=RUt.d_e_;const i=t["distanceX"],s=t["distanceY"],e=Math.sqrt(i*i+s*s);this.X$e_.set(0,e)}Fze_(t){if(!this.isEnabled())return;if(this.IXe_())return;if(this.Ei_!==RUt.d_e_)return;const i=t["distanceX"],s=t["distanceY"],e=Math.sqrt(i*i+s*s);this.u0e_.set(0,e);this.CXe_()}xze_(t){this.isEnabled()&&(this.Ei_=RUt.NONE)}Yze_(t){if(this.isEnabled()&&!this.cXe_()){this.Ei_=RUt.B_e_;this.y_e_.set(t["plotX"],t["plotY"])}}Tze_(t){if(this.isEnabled()&&!this.cXe_()&&this.Ei_===RUt.B_e_){this.D_e_.set(t["plotX"],t["plotY"]);this.CXe_()}}Kze_(t){this.isEnabled()&&(this.Ei_=RUt.NONE)}jFt_(t){if(!this.isEnabled()||this.IXe_())return;this.Ei_=RUt.d_e_;t.preventDefault();const i=-t["deltaY"];this.X$e_.y=0;this.u0e_.y=i*3;this.CXe_()}};i=t([_s("geotoolkit3d.controller.TrackballController")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwib25Eb3VibGVUYXAiOiJSemVfIiwib25EcmFnU3RhcnQiOiJMemVfIiwib25EcmFnIjoiYVd0XyIsIm9uRHJhZ0VuZCI6IlV6ZV8iLCJvblBpbmNoU3RhcnQiOiJremVfIiwib25QaW5jaCI6IkZ6ZV8iLCJvblBpbmNoRW5kIjoieHplXyIsIm9uU2xpZGVTdGFydCI6Ill6ZV8iLCJvblNsaWRlIjoiVHplXyIsIm9uU2xpZGVFbmQiOiJLemVfIiwib25Nb3VzZVdoZWVsIjoiakZ0XyJ9fX0g");var FUt=Ci(function(){let i=class t{constructor(){this.Q0e_=X;this.E0e_="";this.Oq_=""}};i.prototype.load=Zi;i=t([_s("geotoolkit3d.data.loader.AbstractLoader")],i);return i}(),2,"eyJnZXRDbGFzc05hbWUiOiJEXyJ9");const xUt={9728:j,9729:o,9984:Z,9985:_,9986:$,9987:tt},LUt={33071:it,33648:st,10497:k},UUt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},YUt={p0e_:"position",m0e_:"normal",y0e_:"tangent",D0e_:"uv",M0e_:"uv2",v0e_:"color",b0e_:"skinWeight",N0e_:"skinIndex"},TUt={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};var KUt=Ci({S0e_:"OPAQUE",G0e_:"MASK",BLEND:"BLEND"},2,"eyJPUEFRVUUiOiJTMGVfIiwiTUFTSyI6IkcwZV8ifSAg"),HUt=Ci({R0e_:"KHR_binary_glTF",k0e_:"KHR_draco_mesh_compression",F0e_:"KHR_lights_punctual",x0e_:"KHR_materials_clearcoat",L0e_:"KHR_materials_ior",U0e_:"KHR_materials_pbrSpecularGlossiness",Y0e_:"KHR_materials_sheen",T0e_:"KHR_materials_specular",K0e_:"KHR_materials_transmission",H0e_:"KHR_materials_unlit",q0e_:"KHR_materials_volume",J0e_:"KHR_texture_basisu",P0e_:"KHR_texture_transform",V0e_:"KHR_mesh_quantization",O0e_:"EXT_texture_webp",W0e_:"EXT_meshopt_compression"},2,"eyJLSFJfQklOQVJZX0dMVEYiOiJSMGVfIiwiS0hSX0RSQUNPX01FU0hfQ09NUFJFU1NJT04iOiJrMGVfIiwiS0hSX0xJR0hUU19QVU5DVFVBTCI6IkYwZV8iLCJLSFJfTUFURVJJQUxTX0NMRUFSQ09BVCI6IngwZV8iLCJLSFJfTUFURVJJQUxTX0lPUiI6IkwwZV8iLCJLSFJfTUFURVJJQUxTX1BCUl9TUEVDVUxBUl9HTE9TU0lORVNTIjoiVTBlXyIsIktIUl9NQVRFUklBTFNfU0hFRU4iOiJZMGVfIiwiS0hSX01BVEVSSUFMU19TUEVDVUxBUiI6IlQwZV8iLCJLSFJfTUFURVJJQUxTX1RSQU5TTUlTU0lPTiI6IkswZV8iLCJLSFJfTUFURVJJQUxTX1VOTElUIjoiSDBlXyIsIktIUl9NQVRFUklBTFNfVk9MVU1FIjoicTBlXyIsIktIUl9URVhUVVJFX0JBU0lTVSI6IkowZV8iLCJLSFJfVEVYVFVSRV9UUkFOU0ZPUk0iOiJQMGVfIiwiS0hSX01FU0hfUVVBTlRJWkFUSU9OIjoiVjBlXyIsIkVYVF9URVhUVVJFX1dFQlAiOiJPMGVfIiwiRVhUX01FU0hPUFRfQ09NUFJFU1NJT04iOiJXMGVfIn0g"),qUt=Ci({z0e_:"SCALAR",X0e_:"VEC2",j0e_:"VEC3",Z0e_:"VEC4",_0e_:"MAT2",$0e_:"MAT3",t1e_:"MAT4"},2,"eyJTQ0FMQVIiOiJ6MGVfIiwiVkVDMiI6IlgwZV8iLCJWRUMzIjoiajBlXyIsIlZFQzQiOiJaMGVfIiwiTUFUMiI6Il8wZV8iLCJNQVQzIjoiJDBlXyIsIk1BVDQiOiJ0MWVfIn0g"),JUt={ArrayBuffer:"arraybuffer",Text:"text"},PUt=Ci({G4t_:"image/jpeg",PNG:"image/png"},2,"eyJKUEVHIjoiRzR0XyJ9"),VUt=Ci({i1e_:"perspective",s1e_:"orthographic"},2,"eyJQZXJzcGVjdGl2ZSI6ImkxZV8iLCJPcnRob2dyYXBoaWMiOiJzMWVfIn0g"),OUt=Ci({e1e_:"translation",A1e_:"rotation",xHi_:"scale",n1e_:"weights"},2,"eyJUcmFuc2xhdGlvbiI6ImUxZV8iLCJSb3RhdGlvbiI6IkExZV8iLCJTY2FsZSI6InhIaV8iLCJXZWlnaHRzIjoibjFlXyJ9"),WUt=Ci({LINEAR:"LINEAR",h1e_:"STEP",r1e_:"CUBICSPLINE"},2,"eyJTVEVQIjoiaDFlXyIsIkNVQklDU1BMSU5FIjoicjFlXyJ9"),zUt;(function(t){t["Scene"]="scene";t["Animation"]="animation";t["Camera"]="camera";t["Mesh"]="mesh";t["Node"]="node";t["Accessor"]="accessor";t["BufferView"]="bufferView";t["Buffer"]="buffer";t["Material"]="material";t["Texture"]="texture";t["Skin"]="skin"})(zUt||(zUt={}));var XUt={Map:"map",o1e_:"alphaMap",l1e_:"bumpMap",u1e_:"displacementMap",a1e_:"emissiveMap",g1e_:"envMap",c1e_:"lightMap",I1e_:"metalnessMap",f1e_:"normalMap",C1e_:"roughnessMap",d1e_:"aoMap"},jUt=function(){var t;return class{constructor(){this._objects={}}get(t){return this._objects[t]}add(t,i){this._objects[t]=i}remove(t){delete this._objects[t]}uBe_(){this._objects={}}}}(),ZUt=function(){let s=class t{constructor(t,i){this.HMi_=t;this.B1e_={};this.acs_={};this.Kis_=i;this._cache=new jUt;this.w1e_=new Map;this.Q1e_={};this.E1e_={refs:[],uses:[]};this.p1e_={refs:[],uses:[]};this.m1e_={refs:[],uses:[]};this.y1e_={};this.D1e_={};typeof createImageBitmap!="undefined"&&/Firefox/.test(Mi.navigator.userAgent)===!1?this.M1e_=new et(this.Kis_["manager"]):this.M1e_=new At(this.Kis_["manager"]);this.M1e_.setCrossOrigin(this.Kis_["crossorigin"]);this.M1e_.setRequestHeader(this.Kis_["requestheader"]);this.v1e_=new nt(this.Kis_["manager"]);this.v1e_.setResponseType("arraybuffer");this.Kis_["crossorigin"]==="use-credentials"&&this.v1e_.setWithCredentials(!0)}b1e_(t,i,s,e){const A=undefined;switch(+t){case 5120:return new Int8Array(i,s,e);case 5121:return new Uint8Array(i,s,e);case 5122:return new Int16Array(i,s,e);case 5123:return new Uint16Array(i,s,e);case 5125:return new Uint32Array(i,s,e);case 5126:return new Float32Array(i,s,e);default:throw Error("geotoolkit3d.data.loader.GLTFParser: Unknown component type.")}}N1e_(t,i){const s=undefined;switch(+t){case 5120:return new Int8Array(i);case 5121:return new Uint8Array(i);case 5122:return new Int16Array(i);case 5123:return new Uint16Array(i);case 5125:return new Uint32Array(i);case 5126:return new Float32Array(i);default:throw Error("geotoolkit3d.data.loader.GLTFParser: Unknown component type.")}}S1e_(t){const i=undefined;switch(+t){case 5120:return 1/127;case 5121:return 1/255;case 5122:return 1/32767;case 5123:return 1/65535;default:throw Error("geotoolkit3d.data.loader.GLTFParser: Unsupported normalized accessor component type.")}}G1e_(t){const i=undefined;switch(+t){case 5120:return Int8Array.BYTES_PER_ELEMENT;case 5121:return Uint8Array.BYTES_PER_ELEMENT;case 5122:return Int16Array.BYTES_PER_ELEMENT;case 5123:return Uint16Array.BYTES_PER_ELEMENT;case 5125:return Uint32Array.BYTES_PER_ELEMENT;case 5126:return Float32Array.BYTES_PER_ELEMENT;default:throw Error("geotoolkit3d.data.loader.GLTFParser: Unknown component type.")}}resolveURL(t,i){if(typeof t!="string"||t==="")return"";/^https?:\/\//i.test(i)&&/^\//.test(t)&&(i=i.replace(/(^https?:\/\/[^\/]+).*/i,"$1"));return/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:i+t}R1e_(t){this.B1e_=t}k1e_(t){this.acs_=t}F1e_(){return this.v1e_}x1e_(t,i,s){for(const e in s.extensions)if(t[e]===void 0){i.userData.L1e_=i.userData.L1e_||{};i.userData.L1e_[e]=s.extensions[e]}}U1e_(t,i){i.Y1e_!==void 0&&(typeof i.Y1e_=="object"?Object.assign(t.userData,i.Y1e_):ki("geotoolkit3d.data.loader.GLTFParser: Ignoring primitive type .extras, "+i.Y1e_))}T1e_(t,i){let s=!1,e=!1,A,n,h;for(A=0,n=i.length;A<n;A++){h=i[A];h.p0e_!==void 0&&(s=!0);h.m0e_!==void 0&&(e=!0);if(s&&e)break}if(!s&&!e)return Promise.resolve(t);const r=[],o=[];for(A=0,n=i.length;A<n;A++){h=i[A];let n;if(s){n=h.p0e_!==void 0?this.K1e_(zUt.H1e_,h.p0e_):t.attributes.normal;r.push(n)}if(e){n=h.m0e_!==void 0?this.K1e_(zUt.H1e_,h.m0e_):t.attributes.normal;o.push(n)}}return Promise.all([Promise.all(r),Promise.all(o)]).then((i=>{const A=i[0],n=i[1];s&&(t.morphAttributes.position=A);e&&(t.morphAttributes.normal=n);t.morphTargetsRelative=!0;return t}))}updateMorphTargets(t,i){t.updateMorphTargets();let s,e;if(i.q1e_!==void 0)for(s=0,e=i.q1e_.length;s<e;s++)t.J1e_[s]=i.q1e_[s];if(i.Y1e_&&Array.isArray(i.Y1e_.P1e_)){const A=i.Y1e_.P1e_;if(t.J1e_.length===A.length){t.V1e_={};for(s=0,e=A.length;s<e;s++)t.V1e_[A[s]]=s}else ki("geotoolkit3d.data.loader.GLTFParser: Invalid extras.targetNames length. Ignoring names.")}}O1e_(t){let i="";const s=Object.keys(t).sort();for(let e=0,A=s.length;e<A;e++)i+=s[e]+":"+t[s[e]]+";";return i}W1e_(t){if(t.get("DefaultMaterial")===void 0){ht.prototype.setOptions=()=>{};t.add("DefaultMaterial",new ht({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:i}));t.get("DefaultMaterial").setOptions=()=>this}return t.get("DefaultMaterial")}z1e_(t){return t.D9_+":"+this.O1e_(t.attributes)+":"+t.mode}X1e_(t,i,s){const e=s.lT_[t];return this.K1e_(zUt.Node,t).then((t=>{if(e.j1e_===void 0)return t;let i;return this.K1e_(zUt.Z1e_,e.j1e_).then((t=>{i=t;const s=[];for(let t=0,e=i._1e_.length;t<e;t++)s.push(this.K1e_(zUt.Node,i._1e_[t]));return Promise.all(s)})).then((s=>{t.traverse((t=>{if(!t.isMesh)return;const e=[],A=[];for(let t=0,n=s.length;t<n;t++){const n=s[t];if(n){e.push(n);const s=new u;i.$1e_!==void 0&&s.fromArray(i.$1e_.array,t*16);A.push(s)}else ki('geotoolkit3d.data.loader.GLTFParser: Joint "%s" could not be found.',i._1e_[t])}t.bind(new rt(e,A),t.matrixWorld)}));return t}))})).then((t=>{i.add(t);const A=[];if(e.children){const i=e.children;for(let e=0,n=i.length;e<n;e++){const n=i[e];A.push(this.X1e_(n,t,s))}}return Promise.all(A)}))}t2e_(t,i){const s=i.attributes,e=new C;let A,n,h,r;if(s.p0e_===void 0)return;A=this.HMi_.i2e_[s.p0e_];n=A.min;h=A.max;if(n===void 0||h===void 0){ki("geotoolkit3d.data.loader.GLTFParser: Missing min/max properties for accessor POSITION.");return}e.set(new a(n[0],n[1],n[2]),new a(h[0],h[1],h[2]));if(A.normalized){r=this.S1e_(A.s2e_);e.min.multiplyScalar(r);e.max.multiplyScalar(r)}const o=i.e2e_;if(o!==void 0){const t=new a,i=new a;for(let s=0,e=o.length;s<e;s++){const e=o[s];if(e.p0e_!==void 0){A=this.HMi_.i2e_[e.p0e_];n=A.min;h=A.max;if(n!==void 0&&h!==void 0){i.setX(Math.max(Math.abs(n[0]),Math.abs(h[0])));i.setY(Math.max(Math.abs(n[1]),Math.abs(h[1])));i.setZ(Math.max(Math.abs(n[2]),Math.abs(h[2])));if(A.normalized){r=this.S1e_(A.s2e_);i.multiplyScalar(r)}t.max(i)}else ki("geotoolkit3d.data.loader.GLTFParser: Missing min/max properties for accessor POSITION.")}}e.expandByVector(t)}t.boundingBox=e;const l=new P;e.getCenter(l.center);l.radius=e.min.distanceTo(e.max)/2;t.boundingSphere=l}A2e_(t,i){const s=i.attributes,e=[],A=(i,s)=>this.K1e_(zUt.H1e_,i).then((i=>{t.setAttribute(s,i)}));for(const i in s){const n=YUt[i]||i.toLowerCase();n in t.attributes||e.push(A(s[i],n))}if(i.D9_!==void 0&&!t.index){const s=this.K1e_(zUt.H1e_,i.D9_).then((i=>{t.setIndex(i)}));e.push(s)}this.U1e_(t,i);this.t2e_(t,i);return Promise.all(e).then((()=>i.e2e_!==void 0?this.T1e_(t,i.e2e_):t))}n2e_(t,i){let s=t.getIndex(),e;if(s===null){const i=[],A=t.getAttribute("position");if(A===void 0){ki("geotoolkit3d.data.loader.GLTFParser.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.");return t}for(e=0;e<A.count;e++)i.push(e);t.setIndex(i);s=t.getIndex()}const A=s.count-2,n=[];if(i===ot)for(e=1;e<=A;e++){n.push(s.getX(0));n.push(s.getX(e));n.push(s.getX(e+1))}else for(e=0;e<A;e++)if(e%2==0){n.push(s.getX(e));n.push(s.getX(e+1));n.push(s.getX(e+2))}else{n.push(s.getX(e+2));n.push(s.getX(e+1));n.push(s.getX(e))}n.length/3!==A&&ki("geotoolkit3d.data.loader.GLTFParser.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const h=t.clone();h.setIndex(n);return h}parse(t,i){const s=this.HMi_,e=this.B1e_;this._cache.uBe_();this.h2e_((t=>t.r2e_&&t.r2e_()));Promise.all(this.h2e_((t=>t.o2e_&&t.o2e_()))).then((()=>Promise.all([this.l2e_(zUt.Scene),this.l2e_(zUt.Animation),this.l2e_(zUt.Camera)]))).then((i=>{const A={u2e_:i[0][s.u2e_||0],a2e_:i[0],g2e_:i[1],cameras:i[2],c2e_:s.c2e_,I2e_:this,userData:{L1e_:{}}};this.x1e_(e,A,s);this.U1e_(A,s);Promise.all(this.h2e_((t=>t.f2e_&&t.f2e_(A)))).then((()=>{t(A)}))})).catch(i)}C2e_(t){const i=Object.values(this.acs_);i.push(this);for(let s=0;s<i.length;s++){const e=t(i[s]);if(e)return e}return null}h2e_(t){const i=Object.values(this.acs_);i.unshift(this);const s=[];for(let e=0;e<i.length;e++){const A=t(i[e]);A&&s.push(A)}return s}r2e_(){const t=this.HMi_.lT_||[],i=this.HMi_.d2e_||[],s=this.HMi_.B2e_||[];for(let s=0,e=i.length;s<e;s++){const e=i[s]._1e_;for(let i=0,s=e.length;i<s;i++){const s=t[e[i]];s.Y1e_==null&&(s.Y1e_={});s.Y1e_.w2e_=!0}}for(let i=0,e=t.length;i<e;i++){const e=t[i];if(e.Q2e_!==void 0){this.E2e_(this.E1e_,e.Q2e_);if(e.j1e_!==void 0){const t=s[e.Q2e_];t.Y1e_==null&&(t.Y1e_={});t.Y1e_.p2e_=!0}}e.camera!==void 0&&this.E2e_(this.p1e_,e.camera)}return Promise.resolve()}E2e_(t,i){if(i!==void 0){t.m2e_[i]===void 0&&(t.m2e_[i]=t.y2e_[i]=0);t.m2e_[i]++}}D2e_(t,i,s){if(t.m2e_[i]<=1)return s;const e=s.clone(),A=(t,i)=>{const s=this.w1e_.get(t);s!=null&&this.w1e_.set(i,s);t.children.forEach(((t,s)=>{A(t,i.children[s])}))};A(s,e);e.name+="_instance_"+t.y2e_[i]++;return e}K1e_(t,i){const s=t+":"+i;let e=this._cache.get(s);if(!e){switch(t){case zUt.Scene:e=this.M2e_(i);break;case zUt.Node:e=this.v2e_(i);break;case zUt.Mesh:e=this.C2e_((t=>t.b2e_&&t.b2e_(i)));break;case zUt.H1e_:e=this.N2e_(i);break;case zUt.S2e_:e=this.C2e_((t=>t.G2e_&&t.G2e_(i)));break;case zUt.R2e_:e=this.k2e_(i);break;case zUt.Material:e=this.C2e_((t=>t.F2e_&&t.F2e_(i)));break;case zUt.Texture:e=this.C2e_((t=>t.loadTexture&&t.loadTexture(i)));break;case zUt.Z1e_:e=this.x2e_(i);break;case zUt.Animation:e=this.L2e_(i);break;case zUt.Camera:e=this.U2e_(i);break;default:throw Error("Unknown type: "+t)}this._cache.add(s,e)}return e}l2e_(t){let i=this._cache.get(t);if(!i){let s;switch(t){case zUt.Scene:s=this.HMi_.a2e_;break;case zUt.Animation:s=this.HMi_.g2e_;break;case zUt.Camera:s=this.HMi_.cameras;break;case zUt.Mesh:s=this.HMi_.B2e_;break;case zUt.Node:s=this.HMi_.lT_;break;case zUt.H1e_:s=this.HMi_.i2e_;break;case zUt.S2e_:s=this.HMi_.Y2e_;break;case zUt.R2e_:s=this.HMi_.S4s_;break;case zUt.Material:s=this.HMi_.materials;break;case zUt.Texture:s=this.HMi_.textures;break;case zUt.Z1e_:s=this.HMi_.d2e_;break;default:}s==null&&(s=[]);i=Promise.all(s.map(((i,s)=>this.K1e_(t,s))));this._cache.add(t,i)}return i}k2e_(t){const i=this.HMi_.S4s_[t],s=this.v1e_;if(i.type&&i.type!=="arraybuffer")throw Error("geotoolkit3d.data.loader.GLTFParser: "+i.type+" buffer type is not supported.");if(i.uri===void 0&&t===0)return Promise.resolve(this.B1e_[HUt.R0e_].body);const e=this.Kis_;return new Promise(((t,A)=>{s.load(this.resolveURL(i.uri,e.path),t,void 0,(()=>{A(new Error('geotoolkit3d.data.loader.GLTFParser: Failed to load buffer "'+i.uri+'".'))}))}))}G2e_(t){const i=this.HMi_.Y2e_[t];return this.K1e_(zUt.R2e_,i.buffer).then((t=>{const s=i.byteLength||0,e=i.byteOffset||0;return t.slice(e,e+s)}))}N2e_(t){const i=this.HMi_,s=this.HMi_.i2e_[t];if(s.T2e_===void 0&&s.K2e_===void 0)return Promise.resolve(null);const e=[];s.T2e_!==void 0?e.push(this.K1e_(zUt.S2e_,s.T2e_)):e.push(null);if(s.K2e_!==void 0){e.push(this.K1e_(zUt.S2e_,s.K2e_.D9_.T2e_));e.push(this.K1e_(zUt.S2e_,s.K2e_.values.T2e_))}return Promise.all(e).then((t=>{const e=t[0],A=UUt[s.type],n=s.s2e_,h=this.G1e_(n),r=h*A,o=s.byteOffset||0,l=s.T2e_!==void 0?i.Y2e_[s.T2e_].H2e_:void 0,u=s.normalized===!0;let a,g;if(l&&l!==r){const t=Math.floor(o/l),i="InterleavedBuffer:"+s.T2e_+":"+n+":"+t+":"+s.count;let r=this._cache.get(i);if(!r){a=this.b1e_(n,e,t*l,s.count*l/h);r=new lt(a,l/h);this._cache.add(i,r)}g=new J(r,A,o%l/h,u)}else{a=e===null?this.N1e_(n,s.count*A):this.b1e_(n,e,o,s.count*A);g=new ut(a,A,u)}if(s.K2e_!==void 0){const i=UUt.z0e_,h=s.K2e_.D9_.s2e_,r=s.K2e_.D9_.byteOffset||0,o=s.K2e_.values.byteOffset||0,l=this.b1e_(h,t[1],r,s.K2e_.count*i),u=this.b1e_(n,t[2],o,s.K2e_.count*A);e!==null&&(g=new ut(g.array.slice(),g.itemSize,g.normalized));for(let t=0,i=l.length;t<i;t++){const i=l[t];g.setX(i,u[t*A]);A>=2&&g.setY(i,u[t*A+1]);A>=3&&g.setZ(i,u[t*A+2]);A>=4&&g.setW(i,u[t*A+3]);if(A>=5)throw Error("geotoolkit3d.data.loader.GLTFParser: Unsupported itemSize in sparse BufferAttribute.")}}return g}))}loadTexture(t){const i=this.HMi_,s=this.Kis_,e=i.textures[t],A=i.images[e.source];let n=this.M1e_;if(A.uri){const t=s["manager"].getHandler(A.uri);t!==null&&(n=t)}return this.q2e_(t,A,n)}q2e_(t,i,s){const e=this.HMi_,A=this.Kis_,n=e.textures[t],h=(i.uri||i.T2e_)+":"+n.J2e_;if(this.y1e_[h])return this.y1e_[h];const l=Mi.URL||Mi.webkitURL;let u=i.uri||"",a=!1;if(i.T2e_!==void 0)u=this.K1e_(zUt.S2e_,i.T2e_).then((t=>{a=!0;const s=new Blob([t],{type:i.mimeType});u=l.createObjectURL(s);return u}));else if(i.uri===void 0)throw Error("geotoolkit3d.data.loader.GLTFParser: Image "+t+" is missing URI and bufferView");const g=Promise.resolve(u).then((t=>new Promise(((i,e)=>{let n=i;s.isImageBitmapLoader===!0&&(n=t=>{const s=new r(t);s.needsUpdate=!0;i(s)});s.load(this.resolveURL(t,A.path),n,void 0,e)})))).then((i=>{a===!0&&l.revokeObjectURL(u);i.flipY=!1;n.name&&(i.name=n.name);const s=undefined,A=(e.P2e_||{})[n.J2e_]||{};i.magFilter=xUt[A.magFilter]||o;i.minFilter=xUt[A.minFilter]||tt;i.wrapS=LUt[A.wrapS]||k;i.wrapT=LUt[A.wrapT]||k;this.w1e_.set(i,{textures:t});return i})).catch((()=>{ki("geotoolkit3d.data.loader.GLTFParser: Couldn't load texture",u);return null}));this.y1e_[h]=g;return g}V2e_(t,i,s){return this.K1e_(zUt.Texture,s.index).then((e=>{s.O2e_===void 0||s.O2e_===0||i==="aoMap"&&s.O2e_===1||ki("geotoolkit3d.data.loader.GLTFParser: Custom UV set "+s.O2e_+" for texture "+i+" not yet supported.");if(this.B1e_[HUt.P0e_]){const t=s.extensions!==void 0?s.extensions[HUt.P0e_]:void 0;if(t){const i=this.w1e_.get(e);e=this.B1e_[HUt.P0e_].W2e_(e,t);this.w1e_.set(e,i)}}t[i]=e;return e}))}z2e_(t){const i=t.geometry;let s=t.material,e;const A=i.attributes.X2e_===void 0,n=i.attributes.color!==void 0,h=i.attributes.normal===void 0;if(t.isPoints){e="PointsMaterial:"+s.uuid;let t=this._cache.get(e);if(!t){t=new at;p.prototype.copy.call(t,s);t.color.copy(s.color);t.map=s.map;t.sizeAttenuation=!1;this._cache.add(e,t)}s=t}else if(t.isLine){e="LineBasicMaterial:"+s.uuid;let t=this._cache.get(e);if(!t){t=new Y;p.prototype.copy.call(t,s);t.color.copy(s.color);this._cache.add(e,t)}s=t}if(A||n||h){e="ClonedMaterial:"+s.uuid+":";s.j2e_&&(e+="specular-glossiness:");A&&(e+="derivative-tangents:");n&&(e+="vertex-colors:");h&&(e+="flat-shading:");let t=this._cache.get(e);if(!t){t=s.clone();n&&(t.vertexColors=!0);h&&(t.flatShading=!0);if(A){t.normalScale&&(t.normalScale.y*=-1);t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)}this._cache.add(e,t);this.w1e_.set(t,this.w1e_.get(s))}s=t}s.aoMap&&i.attributes.uv2===void 0&&i.attributes.uv!==void 0&&i.setAttribute("uv2",i.attributes.uv);t.material=s}Z2e_(){return ht}F2e_(t){const i=this.HMi_,s=this.B1e_,A=i.materials[t];let n;const h={},r=A.extensions||{},o=[];if(r[HUt.U0e_]){const t=s[HUt.U0e_];n=t.Z2e_();o.push(t._2e_(h,A,this))}else if(r[HUt.H0e_]){const t=s[HUt.H0e_];n=t.Z2e_();o.push(t._2e_(h,A,this))}else{const i=A.$2e_||{};h.color=new l(1,1,1);h.opacity=1;if(Array.isArray(i.t5e_)){const t=i.t5e_;h.color.fromArray(t);h.opacity=t[3]}i.i5e_!==void 0&&o.push(this.V2e_(h,XUt.Map,i.i5e_));h.metalness=i.s5e_!==void 0?i.s5e_:1;h.roughness=i.e5e_!==void 0?i.e5e_:1;if(i.A5e_!==void 0){o.push(this.V2e_(h,XUt.I1e_,i.A5e_));o.push(this.V2e_(h,XUt.C1e_,i.A5e_))}n=this.C2e_((i=>i.Z2e_&&i.Z2e_(t)));o.push(Promise.all(this.h2e_((i=>i.n5e_&&i.n5e_(t,h)))))}A.h5e_===!0&&(h.side=e);const u=A.r5e_||KUt.S0e_;if(u===KUt.BLEND){h.transparent=!0;h.depthWrite=!1}else{h.transparent=!1;u===KUt.G0e_&&(h.alphaTest=A.o5e_!==void 0?A.o5e_:.5)}if(A.l5e_!==void 0&&n!==F){o.push(this.V2e_(h,XUt.f1e_,A.l5e_));h.normalScale=new g(1,1);if(A.l5e_.scale!==void 0){const t=A.l5e_.scale;h.normalScale.set(t,t)}}if(A.u5e_!==void 0&&n!==F){o.push(this.V2e_(h,XUt.d1e_,A.u5e_));A.u5e_.a5e_!==void 0&&(h.aoMapIntensity=A.u5e_.a5e_)}A.g5e_!==void 0&&n!==F&&(h.emissive=(new l).fromArray(A.g5e_));A.c5e_!==void 0&&n!==F&&o.push(this.V2e_(h,XUt.a1e_,A.c5e_));return Promise.all(o).then((()=>{const i=new n(h);A.name&&(i.name=A.name);i.map&&(i.map.encoding=gt);i.emissiveMap&&(i.emissiveMap.encoding=gt);this.U1e_(i,A);this.w1e_.set(i,{materials:t});A.extensions&&this.x1e_(s,i,A);return i}))}I5e_(t){const i=ct.sanitizeNodeName(t||"");let s=i;for(let t=1;this.D1e_[s];++t)s=i+"_"+t;this.D1e_[s]=!0;return s}f5e_(t){const i=this.B1e_,s=this.Q1e_,e=t=>i[HUt.k0e_].C5e_(t,this).then((i=>this.A2e_(i,t))),A=[];for(let i=0,n=t.length;i<n;i++){const n=t[i],h=this.z1e_(n),r=s[h];if(r)A.push(r.promise);else{let t;t=n.extensions&&n.extensions[HUt.k0e_]?e(n):this.A2e_(new z,n);s[h]={d5e_:n,promise:t};A.push(t)}}return Promise.all(A)}b2e_(t){const i=this.HMi_,s=this.B1e_,e=i.B2e_[t],A=e.B5e_,n=[];for(let t=0,i=A.length;t<i;t++){const i=A[t].material===void 0?this.W1e_(this._cache):this.K1e_(zUt.Material,A[t].material);n.push(i)}n.push(this.f5e_(A));return Promise.all(n).then((i=>{const n=i.slice(0,i.length-1),h=i[i.length-1],r=[];let o,l;for(o=0,l=h.length;o<l;o++){const i=h[o],l=A[o];let u;const a=n[o];if(l.mode===TUt.TRIANGLES||l.mode===TUt.TRIANGLE_STRIP||l.mode===TUt.TRIANGLE_FAN||l.mode===void 0){const t=e.Y1e_!=null&&e.Y1e_.p2e_===!0;u=t?new It(i,a):new W(i,a);t&&(u.geometry.attributes.w5e_ instanceof ut||u.geometry.attributes.w5e_ instanceof J)&&!u.geometry.attributes.w5e_.normalized&&u.normalizeSkinWeights();l.mode===TUt.TRIANGLE_STRIP?u.geometry=this.n2e_(u.geometry,ft):l.mode===TUt.TRIANGLE_FAN&&(u.geometry=this.n2e_(u.geometry,ot))}else if(l.mode===TUt.LINES)u=new Ct(i,a);else if(l.mode===TUt.LINE_STRIP)u=new dt(i,a);else if(l.mode===TUt.LINE_LOOP)u=new Bt(i,a);else{if(l.mode!==TUt.POINTS)throw Error("geotoolkit3d.data.loader.GLTFParser: Primitive mode unsupported: "+l.mode);u=new wt(i,a)}Object.keys(u.geometry.morphAttributes).length>0&&this.updateMorphTargets(u,e);u.name=this.I5e_(e.name||"mesh_"+t);this.U1e_(u,e);l.extensions&&this.x1e_(s,u,l);this.z2e_(u);r.push(u)}for(o=0,l=r.length;o<l;o++)this.w1e_.set(r[o],{B2e_:t,B5e_:o});if(r.length===1)return r[0];const u=new y;this.w1e_.set(u,{B2e_:t});for(o=0,l=r.length;o<l;o++)u.add(r[o]);return u}))}Q5e_(t){const i=undefined,s=this.HMi_.lT_[t];return s.Q2e_===void 0?null:this.K1e_(zUt.Mesh,s.Q2e_).then((t=>{const i=this.D2e_(this.E1e_,s.Q2e_,t);s.q1e_!==void 0&&i.traverse((t=>{if(t.isMesh)for(let i=0,e=s.q1e_.length;i<e;i++)t.J1e_[i]=s.q1e_[i]}));return i}))}v2e_(t){const i=this.HMi_,s=this.B1e_,e=i.lT_[t],A=e.name?this.I5e_(e.name):"",n=undefined;return(()=>{const i=[],s=this.C2e_((i=>i.Q5e_&&i.Q5e_(t)));s&&i.push(s);e.camera!==void 0&&i.push(this.K1e_(zUt.Camera,e.camera).then((t=>this.D2e_(this.p1e_,e.camera,t))));this.h2e_((i=>i.E5e_&&i.E5e_(t))).forEach((t=>{i.push(t)}));return Promise.all(i)})().then((i=>{let n;n=e.Y1e_!=null&&e.Y1e_.w2e_===!0?new Qt:i.length>1?new y:i.length===1?i[0]:new fUt;if(n!==i[0])for(let t=0,s=i.length;t<s;t++)n.add(i[t]);if(e.name){n.userData.name=e.name;n.name=A}this.U1e_(n,e);e.extensions&&this.x1e_(s,n,e);if(e.matrix!==void 0){const t=new u;t.fromArray(e.matrix);n.applyMatrix4(t)}else{e.p5e_!==void 0&&n.position.fromArray(e.p5e_);e.rotation!==void 0&&n.quaternion.fromArray(e.rotation);e.scale!==void 0&&n.scale.fromArray(e.scale)}this.w1e_.has(n)||this.w1e_.set(n,{});this.w1e_.get(n).lT_=t;return n}))}M2e_(t){const i=this.HMi_,s=this.B1e_,e=this.HMi_.a2e_[t],A=new y;e.name&&(A.name=this.I5e_(e.name));this.U1e_(A,e);e.extensions&&this.x1e_(s,A,e);const n=e.lT_||[],h=[];for(let t=0,s=n.length;t<s;t++)h.push(this.X1e_(n[t],A,i));return Promise.all(h).then((()=>{const t=t=>{const i=new Map;this.w1e_.forEach(((t,s)=>{(s instanceof p||s instanceof r)&&i.set(s,t)}));t.traverse((t=>{const s=this.w1e_.get(t);s!=null&&i.set(t,s)}));return i};this.w1e_=t(A);return A}))}x2e_(t){ki("GLTFParser: loadSkin is not implemented yet.");return null}L2e_(t){ki("GLTFParser: loadAnimation is not implemented yet.");return null}U2e_(t){ki("GLTFParser: loadCamera is not implemented yet.");return null}};s=t([_s("geotoolkit3d.data.loader.GLTFParser")],s);return s}();const _Ut="glTF";var $Ut=function(){let i=class t extends FUt{constructor(){super();this.m5e_={};this.XV_="anonymous";this.y5e_=!1;this.D5e_=[];this.qls_=""}load(t,i){this.E0e_!==""?this.qls_=this.E0e_:this.Oq_!==""?this.qls_=this.Oq_:this.qls_=Et.extractUrlBase(t);this.Q0e_.itemStart(t);const s=i["onLoad"],e=i["onProgress"],A=s=>{const e=i["onError"];e?e(s):ki(s);this.Q0e_.itemError(t);this.Q0e_.itemEnd(t)},n=new nt(this.Q0e_);n.setPath(this.Oq_);n.setResponseType("arraybuffer");n.setRequestHeader(this.m5e_);n.setWithCredentials(this.y5e_);n.load(t,(i=>{try{this.parse(i,(i=>{s(i);this.Q0e_.itemEnd(t)}),A)}catch(t){A(t)}}),e,A)}register(t){this.D5e_.indexOf(t)!==-1&&this.D5e_.push(t);return this}unregister(t){this.D5e_.indexOf(t)!==-1&&this.D5e_.splice(this.D5e_.indexOf(t),1);return this}parse(t,i,s){const e={},A={},n=undefined;if(Et.decodeText(new Uint8Array(t,0,4))===_Ut){ki("geotoolkit3d.data.loader.GLTFLoader: does not support binary extension");return}const h=Et.decodeText(new Uint8Array(t));let r;try{r=JSON.parse(h)}catch(t){s&&s(new Error("geotoolkit3d.data.loader.GLTFLoader: Fail to parse json."));return}if(r.c2e_==null||+r.c2e_.version[0]<2){s&&s(new Error("geotoolkit3d.data.loader.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const o=new ZUt(r,{path:this.qls_,crossorigin:this.XV_,requestheader:this.m5e_,manager:this.Q0e_});o.F1e_().setRequestHeader(this.m5e_);for(let t=0;t<this.D5e_.length;t++){const i=this.D5e_[t](o);A[i.name]=i;e[i.name]=!0}o.R1e_(e);o.k1e_(A);o.parse(i,s)}};i=t([_s("geotoolkit3d.data.loader.GLTFLoader")],i);return i}();var tYt=function(){let i=class t extends FUt{load(t,i){const s=new nt(this.Q0e_),e=i["onLoad"],A=i["onProgress"],n=i["onError"],h=t=>{this.parse(new My({stream:new Dy({buffer:t,stride:1}),chunksize:t.byteLength}),e,n)};s.setResponseType("arraybuffer");s.load(t,h.bind(this),A,n)}parse(t,i,s){t.Xlt_(0,((t,e,A)=>{t&&s();A=A.filter((t=>t&&t.length));let n=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,l=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY;const a=[],g=[],c=[],I=[],f=[];let C=!1,d=!1,B=!1,w,Q;const E=-999.25;let p;for(p=0;p<A.length;p++){let t=A[p].split(/(\s+)/).filter((t=>t.trim().length>0));if(t==null||t.length<3)continue;if(t[0]==="#"){if(A[p].toLowerCase().includes("field")){A[p].includes("4")&&A[p].toLowerCase().includes("column")&&(C=!0);A[p].includes("5")&&A[p].toLowerCase().includes("row")&&(d=!0);C&&d&&(B=!0)}if(A[p].includes("# Grid_size:")){t=A[p].split(" ");w=+t[2];Q=+t[4]}continue}const i=Number(t[0]),s=Number(t[1]),e=Number(t[2]);if(!(isNaN(i)||isNaN(s)||isNaN(e))){n=Math.min(n,i);h=Math.max(h,i);r=Math.min(r,s);o=Math.max(o,s);l=Math.min(l,e);u=Math.max(u,e);a.push(i);g.push(s);c.push(e);if(B){const i=Number(t[3]),s=Number(t[4]);if(isNaN(i)||isNaN(s))continue;I.push(i);f.push(s)}}}if(l>0){const t=l;l=-u;u=-t;for(p=0;p<c.length;p++)c[p]*=-1}let m={x:a,y:g,z:c,xmin:n,xmax:h,ymin:r,ymax:o,zmin:l,zmax:u};if(B){const t=w*Q,i=a.length,s=new Array(t),e=new Array(t),A=new Array(t);for(p=0;p<w*Q;p++)A[p]=E;let n,h,r;for(p=0;p<i;p++){n=I[p];h=f[p];r=(h-1)*w+(n-1);s[r]=a[p];e[r]=g[p];A[r]=c[p]}m=qi(m,{isgridsurface:!0,width:w,height:Q,xvalues:s,yvalues:e,elevation:A,nullvalue:E})}i(m)}))}};i=t([_s("geotoolkit3d.data.loader.surface.EarthVisionLoader")],i);return i}();const iYt=/(.*)\s+(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)/,sYt=/(.*)\s+(\-?\d+\.?[\d\-\+e]*)\s/,eYt=/^NORMALS[ ]+(\w+)[ ]+(\w+)/,AYt=/^VECTORS[ ]+(\w+)[ ]+(\w+)/,nYt=/^SCALARS[ ]+(\w+)[ ]+(\w+)/,hYt=/^FIELD[ ]+(\w+)[ ]+(\w+)/,rYt=/^POINTS /,oYt=/^POLYGONS /,lYt=/^LINES /,uYt=/^TRIANGLE_STRIPS /,aYt=/^POINT_DATA[ ]+(\d+)/,gYt=/^CELL_DATA[ ]+(\d+)/,cYt=/^CELLS /,IYt=/^CELL_TYPES /,fYt=/^DATASET[ ]+(\w+)/,CYt="STRUCTURED_POINTS",dYt="STRUCTURED_GRID",BYt="RECTILINEAR_GRID",wYt="POLYDATA",QYt="UNSTRUCTURED_GRID",EYt=/^(\d+)\s+([\s\d]*)/,pYt=/\s+/;var mYt=function(){var t=class{static M5e_(t){return+t}static v5e_(i,s,e){if(oYt.exec(i)!==null){s.I2e_=t.b5e_.tfi_;e["data"]["index"]=[]}else if(lYt.exec(i)!==null){s.I2e_=t.b5e_.line;e["data"]["lineindex"]=[]}else if(rYt.exec(i)!==null){s.I2e_=t.b5e_.points;e["data"]["position"]=[]}else if(uYt.exec(i)!==null){s.I2e_=t.b5e_.qot_;e["data"]["index"]=[]}else if(cYt.exec(i)!==null){s.I2e_=t.b5e_.cells;e["data"]["cells"]=[]}else if(IYt.exec(i)!==null){s.I2e_=t.b5e_.N5e_;s.cellIndex=0;e["data"]["index"]=[]}else if(aYt.exec(i)!==null)s.I2e_=t.b5e_.S5e_;else if(gYt.exec(i)!==null)s.I2e_=t.b5e_.S5e_;else if(hYt.test(i)){s.I2e_=t.b5e_.S5e_;const A=hYt.exec(i);s.G5e_={type:"field",name:A[1].toLowerCase(),arrays:[]};e["data"][A[1].toLowerCase()]=s.G5e_}else if(s.I2e_===t.b5e_.S5e_){let t;if(nYt.test(i)){t=nYt.exec(i);s.G5e_={type:"scalar",name:t[1].toLowerCase(),values:[]};e["data"][t[1].toLowerCase()]=s.G5e_}else if(eYt.test(i)){t=eYt.exec(i);e["data"]["normals"]==null&&(e["data"]["normals"]=e["data"][t[1].toLowerCase()]);s.G5e_={type:"normals",name:t[1].toLowerCase(),values:[]};e["data"][t[1].toLowerCase()]=s.G5e_}else if(AYt.test(i)){t=AYt.exec(i);s.G5e_={type:"vector",name:t[1].toLowerCase(),values:[]};e["data"][t[1].toLowerCase()]=s.G5e_}else if(s.G5e_!=null&&s.G5e_["type"]==="field"){const t=i.split(pYt);s.G5e_["arrays"].push({name:t[0],stride:+t[1],values:[]})}else ki("VTKParser: Unsupported/Unhandled submode: "+i)}else ki("VTKParser: Unsupported/Unhandled entry: "+i)}static R5e_(i,s){const e=t.M5e_;let A;switch(fYt.exec(i[3])[1]){case CYt:s["metadata"]["dataset"]["dimensions"]=iYt.exec(i[4]).slice(2).map(e);s["metadata"]["dataset"]["origin"]=iYt.exec(i[5]).slice(2).map(e);s["metadata"]["dataset"]["spacing"]=iYt.exec(i[6]).slice(2).map(e);A=3;break;case dYt:s["metadata"]["dataset"]["dimensions"]=iYt.exec(i[4]).slice(2).map(e);s["metadata"]["dataset"]["points"]=sYt.exec(i[5]).slice(2).map(e)[0];A=2;break;case BYt:s["metadata"]["dataset"]["dimensions"]=iYt.exec(i[4]).slice(2).map(e);A=1;break;case wYt:case QYt:s["metadata"]["dataset"]["points"]=sYt.exec(i[4]).slice(2).map(e)[0];A=1;break;default:A=-1}return A}};t.b5e_={S5e_:(i,s,e)=>{if(e.G5e_!=null)if(e.G5e_["type"]==="normals"||e.G5e_["type"]==="vector"||e.G5e_["type"]==="scalar")Array.prototype.push.apply(s["data"][e.G5e_["name"]]["values"],i.split(pYt).map(t.M5e_));else if(e.G5e_["type"]==="field"){const A=s["data"][e.G5e_["name"]]["arrays"];Array.prototype.push.apply(A[A.length-1]["values"],i.split(pYt).map(t.M5e_))}},points:(i,s,e)=>{Array.prototype.push.apply(s["data"]["position"],i.split(pYt).map(t.M5e_))},cells:(i,s,e)=>{let A;(A=EYt.exec(i))!==null&&s["data"]["cells"].push(A[2].split(pYt).map(t.M5e_))},N5e_:(t,i,s)=>{const e=i["data"]["cells"][s.cellIndex++];switch(+t){case 1:case 2:i["data"]["pointindex"]==null&&(i["data"]["pointindex"]=[]);Array.prototype.push.apply(i["data"]["pointindex"],e);break;case 3:i["data"]["lineindex"]==null&&(i["data"]["lineindex"]=[]);Array.prototype.push.apply(i["data"]["lineindex"],e);break;case 4:i["data"]["lineindex"]==null&&(i["data"]["lineindex"]=[]);Array.prototype.push.apply(i["data"]["polylineindex"],e.slice(0,2));for(let t=2;t<e.length;t++)i["data"]["polylineindex"].push(i["data"]["polylineindex"][i["data"]["polylineindex"].length-1],e[t]);break;case 5:i["data"]["index"]==null&&(i["data"]["index"]=[]);Array.prototype.push.apply(i["data"]["index"],e);break;case 6:i["data"]["index"]==null&&(i["data"]["index"]=[]);const t=i["data"]["index"];Array.prototype.push.apply(t,e.slice(0,3));for(let i=3;i<e.length;i++)t.push(t[t.length-2],t[t.length-1],e[i]);break;case 7:ki("VTKParser: Unsupported/Unhandled cell type: VTK_POLYGON");break;case 8:case 9:i["data"]["index"]==null&&(i["data"]["index"]=[]);i["data"]["index"].push(e[0],e[1],e[2]);i["data"]["index"].push(e[0],e[2],e[3]);break;case 10:i["data"]["index"]==null&&(i["data"]["index"]=[]);i["data"]["index"].push(e[0],e[2],e[1]);i["data"]["index"].push(e[0],e[1],e[3]);i["data"]["index"].push(e[1],e[2],e[3]);i["data"]["index"].push(e[0],e[3],e[2]);break;case 11:case 12:case 13:case 14:ki("VTKParser: Unsupported/Unhandled cell type: VTK_VOXEL VTK_HEXAHEDRON VTK_WEDGE VTK_PYRAMID");break;case 21:case 22:case 23:case 24:case 25:ki("VTKParser: Unsupported/Unhandled cell type: VTK_QUADRATIC_EDGE VTK_QUADRATIC_TRIANGLE "+"VTK_QUADRATIC_QUAD VTK_QUADRATIC_TETRA VTK_QUADRATIC_HEXAHEDRON");break}},qot_:(t,i,s)=>{let e;if((e=EYt.exec(t))!==null){const t=parseInt(e[1]),s=e[2].split(/\s+/);if(t>=3){let e,A,n;for(let h=0;h<t-2;h++)if(h%2==1){e=parseInt(s[h]);A=parseInt(s[h+2]);n=parseInt(s[h+1]);i["data"]["index"].push(e,A,n)}else{e=parseInt(s[h]);A=parseInt(s[h+1]);n=parseInt(s[h+2]);i["data"]["index"].push(e,A,n)}}}},tfi_:(t,i,s)=>{let e;if((e=EYt.exec(t))!==null){const t=parseInt(e[1]),s=e[2].split(pYt);if(t>=3){const e=parseInt(s[0]);let A,n,h=1;for(let r=0;r<t-2;++r){A=parseInt(s[h]);n=parseInt(s[h+1]);i["data"]["index"].push(e,A,n);h++}}}},line:(t,i,s)=>{let e;if((e=EYt.exec(t))!==null){const t=parseInt(e[1]),s=e[2].split(pYt),A=[];for(let i=0;i<t;i++)A.push(parseInt(s[i]));i["data"]["lineindex"].push(A)}}};return t}();const yYt=/^[e\-0-9\. ]*$/,DYt=/(?![\x20-\x7E]|[\x0D]|[\x0A])./g,MYt="ASCII",vYt=mYt;var bYt=function(){let i=class t{static k5e_(t){return new Promise(((i,s)=>{t.tut_(0,10,((t,e,A)=>{t?s(t):i(A[2].indexOf(MYt)!==-1)}))}))}static parse(t){return new Promise(((i,s)=>{const e={};t.tut_(0,10,((A,n,h)=>{if(A){s(A);return}const r=h;h=h.map((t=>t.replace(DYt," ").trim())).filter((t=>t.length!==0));e["metadata"]={header:h[0],title:h[1],type:h[2].split(" ")[1],dataset:{type:h[3]}};e["data"]={};let o=vYt.R5e_(h,e);if(o===-1){s(new Error("Unsupported dataset type: "+h[3]));return}o+=r.indexOf(h[3]);const l={};t.Xlt_(o,(function s(A,n,h,r){for(let t=0;t<h.length;t++){let i=h[t];i=i.replace(DYt," ").trim();i.length!==0&&i.charAt(0)!=="#"&&(yYt.test(i)?l.I2e_(i,e,l):vYt.v5e_(i,l,e))}r?i(e):t.Xlt_(n+h.length,s)}))}))}))}};i=t([_s("geotoolkit3d.data.loader.vtk.VTKASCIIStreamLoader")],i);return i}();var NYt=Ci(function(){var i;let s=i=class t{static F5e_(t){const i=t.$w_();let s;const e=t.getColor(),A=RA.cs_(e),n=new l(A.Is_()/255,A.Cs_()/255,A.fs_()/255);s=i==null||i.length===0?new Y({color:n.getHex(),linewidth:t.Ie_(),transparent:A.ds_()<255,opacity:A.ds_()/255}):new T({color:n.getHex(),linewidth:t.Ie_(),scale:250,gapSize:i[1],dashSize:i[0],transparent:A.ds_()<255,opacity:A.ds_()/255});s.userData.Jvt_=t;return s}static x5e_(t){const s=i.L5e_(t.getColor()),A=new U({color:s.color.getHex(),transparent:s.opacity<1,opacity:s.opacity,side:e});A.userData.Pvt_=t;return A}static U5e_(t){const s=i.L5e_(t.getColor()),A=new x({color:s.color.getHex(),transparent:s.opacity<1,opacity:s.opacity,side:e});A.userData.Pvt_=t;return A}static L5e_(t){const i=RA.cs_(t),s=undefined,e=undefined;return{color:new l(i.Is_()/255,i.Cs_()/255,i.fs_()/255),opacity:i.ds_()/255}}static Y5e_(t,s){const e=i.L5e_(s.getColor());t.color=e.color;t.transparent=e.opacity<1;t.opacity=e.opacity;t.userData.Pvt_=s;t.needsUpdate=!0;return t}static T5e_(t,i){if(i==null){let s=0;for(let i=0;i<t.length;i++){const e=t[i];Number.isFinite(e)&&e>s&&(s=e)}i=s}return i>65535?new Uint32Array(t):i>255?new Uint16Array(t):new Uint8Array(t)}static K5e_(t,i,s){const e=i.count;let A=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(let s=0;s<e;s++){const e=i.getX(s),u=t.getX(e),a=t.getY(e),g=t.getZ(e);A=Math.min(u,A);n=Math.max(u,n);h=Math.min(a,h);r=Math.max(a,r);o=Math.min(g,o);l=Math.max(g,l)}s==null&&(s=new C);s.min.set(A,h,o);s.max.set(n,r,l);return s}};s=i=t([_s("geotoolkit3d.util.Attributes")],s);return s}(),2,"eyJjcmVhdGVMaW5lTWF0ZXJpYWwiOiJGNWVfIiwiY3JlYXRlTWVzaE1hdGVyaWFsIjoieDVlXyIsImNyZWF0ZVBob25nTWVzaE1hdGVyaWFsIjoiVTVlXyIsImdldFRocmVlQ29sb3IiOiJMNWVfIiwidXBkYXRlTWVzaE1hdGVyaWFsIjoiWTVlXyIsImZpdFVpbnRUeXBlZEFycmF5IjoiVDVlXyIsImNvbXB1dGVCb3VuZGluZ0JveEZyb21JbmRleGVkQnVmZmVyIjoiSzVlXyIsImdldENsYXNzTmFtZSI6IkRfIn0g");const SYt=t=>{if(!t.defines.hasOwnProperty("addedPointCloudShaders")){t.defines["addedPointCloudShaders"]=!0;t.uniforms["cgalphaTest"]=new h(1);t.uniforms["cgpointTexture"]=new h(null);t.uniforms["cgpointColor"]=new h(new l(1,1,1));t.uniforms["cgpointOpacity"]=new h(1);t.uniforms["cgpixelScale"]=new h(Is())}};var GYt=function(){let i=class t{static H5e_(t,i){if(i!=null){SYt(t);i.hasOwnProperty("colorprovider")?typeof i["colorprovider"]=="string"?t.uniforms["cgpointColor"].value=new l(i["colorprovider"]):i["colorprovider"]instanceof l?t.uniforms["cgpointColor"].value=i["colorprovider"]:t.uniforms["cgpointColor"].value=new l(16777215):i.hasOwnProperty("color")&&(t.uniforms["cgpointColor"].value=i["color"]);i.hasOwnProperty("symbol")&&(t.uniforms["cgpointTexture"].value=i["symbol"]);i.hasOwnProperty("opacity")&&(t.uniforms["cgpointOpacity"].value=i["opacity"]);i.hasOwnProperty("alphatest")&&(t.uniforms["cgalphaTest"].value=i["alphatest"])}}static q5e_(t){SYt(t);return{symbol:t.uniforms["cgpointTexture"].value,color:t.uniforms["cgpointColor"].value,opacity:t.uniforms["cgpointOpacity"].value,alphatest:t.uniforms["cgalphaTest"].value,pixelscale:t.uniforms["cgpixelScale"].value}}};i.J5e_=["attribute float cgpointSize;","attribute float cgpointVisible;","varying float vcgpointVisible;","uniform float cgpixelScale;","#include <common>","#include <logdepthbuf_pars_vertex>",ixt.HXe_,"",ixt.SXe_+" {","    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);",ixt.KXe_,"    vcgpointVisible = cgpointVisible;","    gl_PointSize = cgpixelScale * cgpointSize * 2.0;","    gl_Position = projectionMatrix * mvPosition;","#include <logdepthbuf_vertex>","}"].join("\n");i.P5e_=["uniform sampler2D cgpointTexture;","uniform vec3 cgpointColor;","uniform float cgpointOpacity;","uniform float cgalphaTest;","#include <logdepthbuf_pars_fragment>",ixt.JXe_,"varying float vcgpointVisible;",ixt.SXe_+" {","    if(vcgpointVisible < 0.1) {","        discard;","    }","    vec4 diffuseColor = vec4(cgpointColor, 1.0);",ixt.qXe_,"    vec4 finalColor = texture2D(cgpointTexture, gl_PointCoord);","","    if(finalColor.a < cgalphaTest) {","        discard;","    }","    finalColor.a = max(finalColor.r + finalColor.g + finalColor.b, 1.0) * cgpointOpacity;","    gl_FragColor = diffuseColor * finalColor;","#include <logdepthbuf_fragment>","}"].join("\n");i=t([_s("geotoolkit3d.util.shaders.PointCloud")],i);return i}();var RYt=Ci(function(){let i=class t extends d{constructor(t){super({side:t["side"]||e,opacity:t["opacity"]!=null?t["opacity"]:1,transparent:t["transparent"]==null||t["transparent"],vertexShader:t["vertexShader"],fragmentShader:t["fragmentShader"],uniforms:t["uniforms"]!=null?t["uniforms"]:{}});this.V5e_=null;this.clipping=!0;this.type="ColorMapShaderMaterial";this.O5e_(t)}O5e_(t){t.hasOwnProperty("opacity")&&(this.opacity=t["opacity"]);t.hasOwnProperty("transparent")&&(this.transparent=t["transparent"]);t.hasOwnProperty("side")&&(this.side=t["side"]);t.hasOwnProperty("alphaTest")&&(this.alphaTest=t["alphaTest"]);t.hasOwnProperty("blendDst")&&(this.blendDst=t["blendDst"]);t.hasOwnProperty("blendEquation")&&(this.blendEquation=t["blendEquation"]);t.hasOwnProperty("blending")&&(this.blending=t["blending"]);t.hasOwnProperty("blendSrc")&&(this.blendSrc=t["blendSrc"]);t.hasOwnProperty("colorWrite")&&(this.colorWrite=t["colorWrite"]);t.hasOwnProperty("depthFunc")&&(this.depthFunc=t["depthFunc"]);t.hasOwnProperty("depthTest")&&(this.depthTest=t["depthTest"]);t.hasOwnProperty("depthWrite")&&(this.depthWrite=t["depthWrite"]);t.hasOwnProperty("fog")&&(this.fog=t["fog"]);t.hasOwnProperty("toneMapped")&&(this.toneMapped=t["toneMapped"]);t.hasOwnProperty("clipping")&&(this.clipping=t["clipping"]);t.hasOwnProperty("clippingplanes")&&(this.clippingPlanes=t["clippingplanes"]);t.hasOwnProperty("clipintersection")&&(this.clipIntersection=t["clipintersection"]);ixt.MXe_(this,t);this.needsUpdate=!0}setOptions(t){this.O5e_(t);return this}JV_(){return qi({opacity:this.opacity,transparent:this.transparent,side:this.side,alphaTest:this.alphaTest,blendDst:this.blendDst,blendEquation:this.blendEquation,blending:this.blending,blendSrc:this.blendSrc,colorWrite:this.colorWrite,depthFunc:this.depthFunc,depthTest:this.depthTest,depthWrite:this.depthWrite,fog:this.fog,toneMapped:this.toneMapped,clipping:this.clipping,clippingplanes:this.clippingPlanes,clipintersection:this.clipIntersection},ixt.bXe_(this))}dispose(){if(this.userData.pXe_ instanceof Mo&&this.V5e_!=null){this.userData.pXe_.off(mo.sC_,this.V5e_);this.userData.pXe_=null}this.V5e_=null;super.dispose()}onBeforeCompile(t,i){if(this.userData.W5e_!=null){ixt.DXe_(this);this.userData.W5e_=!1}super.onBeforeCompile(t,i)}vXe_(){this.V5e_==null&&(this.V5e_=()=>{this.needsUpdate=!0;this.userData.W5e_=!0});return this.V5e_}};i=t([_s("geotoolkit3d.scene.ColorMapShaderMaterial")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiZ2V0VXBkYXRlQ29sb3JNYXAiOiJ2WGVfIn19LCJnZXRDbGFzc05hbWUiOiJEXyJ9");const kYt=Dxt,FYt=new a;var xYt=function(){let i=class t extends xxt{constructor(t){const i=t["material"],s=undefined;super(qi(t,{uniforms:i.z5e_(),vertexshader:kYt.zXe_(i),fragmentshader:kYt.jXe_(i),defines:i.defines},!0));this.Gz_=t["object"];let e,A;e=this.Gz_.geometry.getAttribute("position")!=null?this.Gz_.geometry.getAttribute("position").count:0;if(this.Gz_.geometry.getAttribute("cgpointindex")!=null)A=this.Gz_.geometry.getAttribute("cgpointindex");else{const t=new Float32Array(e);A=new ut(t,1);this.Gz_.geometry.setAttribute("cgpointindex",A)}for(let t=0;t<e;t++)A.setX(t,this.X5e_(t));this.type="DefaultPointCloudPickingMaterial";this.transparent=!1;this.side=i.side;this.blending=G}X5e_(t){return t/this.Gz_.geometry.getAttribute("position").count}j5e_(t){return Math.round(t*this.Gz_.geometry.getAttribute("position").count)}Rje_(){return!0}kje_(){return[{pickingmode:kYt.oje_,callback:(t,i)=>{const s=this.j5e_(YFt.wXe_(t));i["pointindex"]=s;const e=this.Gz_.parent,A=undefined;if(!(e.D_&&e.D_()==="geotoolkit3d.scene.pointset.PointCloud")||i["point"]==null)return;const n=this.Gz_.parent.Z5e_(s);if(n!=null){const t=n["position"];FYt.set(t[0],t[1],t[2]);this.Gz_.localToWorld(FYt);i["root"].worldToLocal(FYt);i["point"].x=FYt.x;i["point"].y=FYt.y;i["point"].z=FYt.z}}}]}};i=t([_s("geotoolkit3d.picking.pickingrenderer.DefaultPointCloudPickingMaterial")],i);return i}();var LYt=Ci(function(){let i=class t extends RYt{constructor(t){super({vertexShader:GYt.J5e_,fragmentShader:GYt.P5e_,transparent:!0});this.type="PointCloudMaterial";this.setOptions(t)}setOptions(t){const i=(t=qi(t,{}))["colorprovider"]instanceof Mo;i&&(t["color"]=new l("white"));super.setOptions(t);if(i){t["colorprovider"]=t["color"];delete t["color"]}GYt.H5e_(this,t);return this}JV_(){return Pi(GYt.q5e_(this),super.JV_())}XXe_(){return GYt.J5e_}ZXe_(){return GYt.P5e_}z5e_(){return this.uniforms}};i=t([_s("geotoolkit3d.scene.pointset.PointCloudMaterial")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");$Lt.yZe_(LYt.D_(),xYt);var UYt=Ci({_5e_:"soliddot",Afi_:"circle",fr_:"square",cube:"cube",$5e_:"triangle",t3e_:"sphere",i3e_:"ball"},2,"eyJzb2xpZGRvdCI6Il81ZV8iLCJjaXJjbGUiOiJBZmlfIiwic3F1YXJlIjoiZnJfIiwidHJpYW5nbGUiOiIkNWVfIiwic3BoZXJlIjoidDNlXyIsImJhbGwiOiJpM2VfIn0g"),YYt=Ci({t3e_:"sphere",cube:"cube",s3e_:"pyramid"},2,"eyJzcGhlcmUiOiJ0M2VfIiwicHlyYW1pZCI6InMzZV8ifSAg");const TYt={sphere:function(){const t=new pt(1,12,8);t.name=YYt.t3e_;return t}(),cube:function(){const t=new mt(1,1,1,1,1,1);t.name=YYt.cube;return t}(),pyramid:function(){const t=new yt(1,1,4,1);t.rotateX(Math.PI/2);t.name=YYt.s3e_;return t}()};var KYt=Ci(function(){var i;let s=i=class t{static loadTexture(t,s,e,A){switch(t){case UYt._5e_:return i.e3e_(s,e,A);case UYt.Afi_:return i.A3e_(s,e,A);case UYt.fr_:return i.n3e_(s,e,A);case UYt.cube:return i.h3e_(s,e,A);case UYt.$5e_:return i.r3e_(s,e,A);case UYt.t3e_:return i.o3e_(s,e,A);case UYt.i3e_:default:return i.l3e_(s,e,A)}}static l3e_(t,i,s){const e=(new At).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0I"+"Ars4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sCDAApC1ev7PcAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAO/E"+"lEQVR42u1bXYxd1XX+9to/5947YzwDTCa2S8clTpGMUwhO6iq1UimtkCyraqqC+qM+IN76hpB46FsfeKrUxwoJqX2qhIMqoOpDGygmBZQqqQPESVNCH"+"UgJton/xuOZufecs39WH2bv0z3b586MDU2I6i1tnTPn3Nlnr2/9r7MOcGvcGrfGrfH/eIif4XNkNilOESfHGeL02eRfVAAIgAJgANwG4E4An4rH+Xit"+"ioB4AA2AawCWAVwCcCEeV+M9F8H5RAOQOF0BuAPArxDRPcy8n4gWhRC7AdzGzCMAA2aWACiEECKBNYBxBGIFwEUA7wF4B8C7AC5HMD42yfg4AZAARlr"+"rJWPMfQDuY+YlAItEdAeAEQAjhNAhBJXUgJnBzAgh+LAxHDPbEEITwbgC4EMAPwZwOs734z3/SQBAABgaY5aGw+ERAF8E8BkAe6SUuwGMhBAGgBJCyE"+"z3wcyCeYOR3nuOQGyg4JwPIbgQQhNCGEeJOAfgDIB/B3AqAjH5KNLwUQFQAG6/4447jhDRV5j5IIBfEkLMEdGImQ0RKSEEEVEyeEIIgcT5CARCCGBme"+"O/BzOy9T9N77533vgkhjJl5GcAHAL4H4BsAvhOlxN0sATcLXDU/P39gMBj8TgjhKIDPCiHuFELMEJFRSmkRR0b8xj+LjdMN1f9fALIpvPcIIbBzjrz3"+"yjlnvPcD7/1MCGGOmRcB3BWl7WS0Ec2NSoO6SeJHCwsLnx8MBl8NIXxBSnmX1npOSjkkIi2lJCllIr4jOB8hBEQiN0lAuh7vCaWUcM5BKUXOOWmt1c4"+"5E0IYhhBmo2fZA+Afo1SMbwQEdRPEz+zfv/83pZS/D+ALRLRHKbVLa11JKRURCa21EEJAStkRT0SdyEed3wSC9x7W2u48qYNzDlJKOOeElFJIKUXbtu"+"ScU9577b0fRAM7AjCItmF9pyCoG+X8oUOHvqy1fth7f5iIFpVSs0opk7iulBJEhDSllJ3YMzOEEPDeb5KCBELTNAghoG3b7rqUEkopOOfgnAMRCSIia"+"61u25aEEDKEoEIIOtIjopHcEQg3AsDg8OHDXxoOh3/onDtMRItSylmttVZKkVJKKKUgpeyIT5zP9T7pfBJ351x3NMbAe4+2bWGtRdM0ifub1iUiITYW"+"FNZa4b2nGE/8RnSNLYA3oof4WADQR48e/bW5ubk/mkwmD1RVtaiUmpVSamNMR7zWuuN6IjwX/z4VYGY45zoVsNaiqiq0bQutNdq27QARQiC3KdHGSmu"+"tAbALwN4QwpFI+DUAbwOwHxUAOnjw4J6lpaWHl5eX7x8Oh4tCiFljjNZa02AwEEQErXVHeCkFSfRzQwcAzrleALz3qOsaxhi0bYvJZIK6rrt1ExBN0y"+"RpSNHnbQD2RRAuxMjxw61C6J0AMDpy5MjvTiaTw6PR6NNENGOM0UopMsYIrTWUUkjir9TGkumYuJUkIM0k+skOJB1PUykFa223rpQSdV13ACSbEg1nH"+"oLvBnBXCOFLMYz+FwBrNwuAeuSRR359MBj8dtu2S1rrXUopY4yhqqo6sU8g5NxPxi8fub/PQcglINkArXVnA/J1m6bpgC3AFcwsQwgVM88z8wFm/q0Y"+"H/xgWqCktrH6swsLC8dWVlbuHg6Hu6WUlTGGtNaoqgo593NO5V6gLwZIhCfOt20L5xy01h3X27btCFdKYTKZXGcDSqliZhHzjCGABefcIQBHYsi80uc"+"VtgJAPv74418movuUUncS0VBrLY0xIk4opWCM6QjP1SBtPudUbgNy3590PnE+qUC+Vm5TEvGlV4kAkPfeMPMsEe0LIRyO4fLpPinYCoDR/Pz8V1ZWVv"+"ZWVTUrpVRVVVEiPgGQS0GfIcwByNUgcT+EAGstjDGo6xrOuWTcIKVE0zQd5/NQuuR+ploihEDMXBHRbmb+DDPfH5OoazsFgB577LHPGWMOKqXmk97nx"+"BtjOuITGH1qUAKQPEBu+IwxnQrUdd2tU9f1JrHvIzyPJBMQSinhvZfMPGLmPd77zwF4LQZHficA6H379h211i4opUZaa5V0fzAYdERrra+ThGl2IMUC"+"uQvMQch1PpeA0ojmYXKaSWVCCElthPdeeu8NEd0WQlhi5gPRFuwIgMHs7Oz9y8vLc4PBQEspyRgjBoMBcgNYgpDbgkSAlLKLA8rUNwch9yZ5RFlmjzn"+"ncwCSFGitUwgtiEgx85CIFr339wD4ZswYtwSAnnjiic8S0V4p5UgppbTWwhiDqqo6ohMY5cbLeGCaGqTpnIO1dpMRLT1HWTtIhCcwrbW9+YNSikIImo"+"jmQgi/zMzzscYYtgJA7t279xAz36a1NkRESilRVRXSzO1AaQjTLG1AHxejvl4H3jR9T7YjV4O0j6qqNkmT917EFFqFEEZEtOC9/xSAs9sBQLt27ToQQ"+"hgqpZSUkkrCSxXIA6Jc9PsAKCUghNCbP+Qcz7meq016btpXHjhl2agMIRhm3h0BoO1UQI5Go7vW19cHWmuKBk/klr885iDkaXAp/iVXk94SUZfslNwv"+"Q+YUNxhjutwhV8W2bTsGRDtAQggthJglooUQgtzWBhhjbm+axgghKOl/svyJ+6X/nxa45EQlwvKAKPfxZYSXG7gk2lVVddFiTnjKIFPmWKTOUggxirZ"+"gewC01ruy6s5UbucqUOp/6b8T8WV6TETw3m+SlOTbq6rqjGRObOJ+GYDlgVi2ByGEICGEIaLZshDcB4AwxlRSSmJmEas8mzZQEp0ePM3/5ypQhsQ9SQ"+"201gghbCI4SUCft0nPTs/LgBfZUQoh9E4AgJRSaq1FPL/uYdM20BcF9lWEiKgjPoGR4oXkGZLRK41ruYdyL7kdKiRQ5EZ2KwCYiLyUkgFAa81SSpG4X"+"G4gN3p9EpBHgTkIfZwv1yoJLZOu/Jl9yRgRcbzHzOxDCLbMCPsACEKIWmsdImdE/oCS2GlcL21AXh3KQUicT1KQvEJJWKnffaqWB17Zs9Jb50ZKub4j"+"AJh5RSkVvPcspeS80juNyzmhpevrc4W5WuR5wlYETlt3WgaaSZwXQtQArpa5APUA4EMIP62qykkpOS7I0wzctIgvz9/7Nl0SU741KivK+bOUUr2g50y"+"K9zhKtCOiVWa+vCMAJpPJu1prp5QKGQibCNtOCvoI2u5a3xplIaTv92UMUUSTXgjRALgmhLiuQNoHQLh8+fIbg8GglVL6aBQ7UeszYn1ElffL8LavXr"+"iT3/YROgVgBhCIyDFzTUSX2ra9sBMJCI8++ui3hBBXlVIueYOtkO8DonwPkOcB5b0y7p9S75v6m3J/6VoIgaPlv0pEP2ma5spOJAAAmvF4/H1jTCOl9"+"ETEALgvsZkidr2jr46XA9JT3upihTKJytcrX7DGcxZCOAATKeVFAD+MHSjYCQD24sWLXx8MBhMi6npzSsRztKdxqyyClK/CSyDKa3mxIw+TcxDySlH8"+"f459FhbAKhG937btO31F0WkAhIceeuifvPc/UUq1QogAgPuqun1czImbRmhfWpzX98qKT5r5c8v1MtA4hOCFEBMiukBE319dXT3f11JDW1SFx1euXPl"+"6VVXjJAVRp67b+DRCp13L3whvNUsg8mJI+SYpW5Mjs1oA14joXWvtd2LfAG4EAP/ggw/+NRF9oJSqmTkwMzvnuG9TeYvLVoSUv8s5nL8fLIkrCS4lKP"+"4m7c/GCvA5IcQbly9f/q9pDVVbAcAA1s+ePftMVVVrRGSjak3lTC6ifWJdvg8oAUrEpjpfqhan81QMSec5OBm43ntfM/MVKeV/eu+/Gd8N8o0CAADu2"+"LFjf9s0zZvGmHUAznsfItLXcajvmHO+BKHkdvo7vSprmqbrE0jFjlxSCqlIDVUtgBUi+hEz/+v58+ff2aqBajsAAGB88uTJv1BKXSCiOiLMOQj5ZqaB"+"0ffbvpkAqOu6I7xPLZKHSMQ750Lbts45t+a9P19V1bdXV1dfn6b7eXPjdoNfeumly8ePH+eFhYUHYoMSMTNF6yv6gpbSrZVqkYt9IjAR3zRNB0Bd191"+"M9xIw8TrH6ay1a23bnpdSfmt5eflrFy5ceG+7ZsqdSAAA2OPHj//NpUuX/n44HF4lomajl9GxtZZL8U1cS+c5F3N9zu/lxOYiX/5P/r/WWvbehxCCZe"+"Y1ABeqqnqzruvnzp07t213yI02SgoAo9dff/2v5ubmjo/H490hhIqIJBFRXjfYqh5Yxg95T0CaicuTyaTrDknHNNfX13kymYTxeGzH4/F627YXiOjNa"+"9eunTh16tTJnbbL3WinqAAw89prr/3l3Nzc8clkMue9rwCoCAJiU2RvFle+1CxdX6n/uUSsr6+nazyZTHg8Hoemadq6rtestReJ6Lurq6tfe/XVV0/e"+"SJvczbTKCgCjl19++c8XFxf/eH19fc57P2BmHauvlNffyq7Q3CbkIOSqkOt40zQYj8eo65ojAKGua1/XdWOtvWat/VBrfXplZeXZF1988bUbbZS82V5"+"hAaB64YUX/mT//v1/5pzb1zTNbAhBM3PqBI+dbBvHMiLs8/e5+0szin9omobbtg1N09i2bSdt214VQvy3lPLbH3zwwfMnT548fTOtshI3P9yJEye+J4"+"R46d57712amZm53XsvSgtf+mxrrcgJzXU/swEcAeC6rr211tuNMfHerwghzs3MzPxHCOEfXnnllb976623fhR7A39+7fLPP//8H+zdu/dPpZQHxuPxr"+"HNuEF9MSu89xU4u4ZwTUQJEFidwZgg5ztA0TWjb1lprW2vtuhDiijHmrPf+1NmzZ//52WefPf3zbpe/7oOJ55577uGFhYXfq6rqVyeTyahpmqG11jjn"+"ZAiBYve3iISLFMhEl8bW2mCt9W3b2rZt62jQlo0xP22a5q1Lly594+mnnz71Sfpgog+IwVNPPfXFpaWlYzMzM58nok83TTOo61rHbm/Ztq1MAMTw2jv"+"nbAihjd8FrAshrrZt+97a2tqbZ86c+bcTJ078OBY1/Me12Z/JR1NPPvnkgbvvvvuB0Wh0j5RyLxHNhxBGAHRUBWutHdd1vdK27cW1tbX319bWzrz99t"+"s/eOaZZ85H/f6F+Ghqq+ekz2XyT+dEkX3mn8ylc8atcWvcGv9X438A/CrBLz+OiRoAAAAASUVORK5CYII=",t,i,s);e.name=UYt.i3e_;return e}static get i3e_(){return i.l3e_()}static e3e_(t,i,s){const e=(new At).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAA"+"ACXBIWXMAAC4jAAAuIwF4pT92AAAGAGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSH"+"pyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgN"+"zkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIv"+"MjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzE"+"uMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YX"+"AvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvc"+"D0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoTWFjaW50"+"b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTktMDktMDRUMjM6NDY6MzUtMDU6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMTktMDktMDRUMjM6NDY6MzU"+"tMDU6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE5LTA5LTA0VDIzOjQ2OjM1LTA1OjAwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmRkZGEwNzYwLT"+"Y2ODMtNDQ5Yy1hMjc5LTdmZTFjMTAwYzE2ZCIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmQ3N2I5NWVlLWE5NDktNDI0Y"+"y1hZjY2LTMwZDJhMmEzOGNlMCIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjk1MTE4ZWFlLThlOTItNDY3NC04MWUyLTBjNWU0OGRh"+"MTgxYiIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY"+"2LTIuMSI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC"+"5paWQ6OTUxMThlYWUtOGU5Mi00Njc0LTgxZTItMGM1ZTQ4ZGExODFiIiBzdEV2dDp3aGVuPSIyMDE5LTA5LTA0VDIzOjQ2OjM1LTA1OjAwIiBzdEV2d"+"Dpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoTWFjaW50b3NoKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0"+"RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZGRkYTA3NjAtNjY4My00NDljLWEyNzktN2ZlMWMxMDBjMTZkIiBzdEV2dDp3aGVuPSIyMDE5LTA5LTA0VDI"+"zOjQ2OjM1LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD"+"0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tld"+"CBlbmQ9InIiPz7o6NP6AAAPRklEQVR4nO3df6zfVX3H8WfbO2qh0FJuXRAphV7J/pDfkoVqJQJDurmFDV10mOmgWTZRR8bGxGwzaiBsM8pQGUkFFzZM"+"FMeW6EBQMOiAzVTGD/+ZllKqrhlcSgsthaXl7o/37VpKy/35/bzP+ZznI/nm9o/77Xnf7+ec1/d8P9/P+Zw5Y2NjSGrT3OwCJOUxAKSGGQBSwwwAqWE"+"GgNQwA0BqmAEgNcwAkBpmAEgNMwCkhhkAUsMMAKlhBoDUMANAapgBIDXMAJAaZgBIDTMApIYZAFLDDACpYQaA1DADQGqYASA1zACQGmYASA0zAKSGDX"+"XZ2OjoaJfNSVUaHh7urK1OA0ADdSSwfPxxHPAG4Kj9HvOBRcTMbwg4fPy5zwO7gJeBbcBLwDP7Pf4beBLYOP54dsB/jzpgANRnKXDy+OOk8Z8jxMCer"+"sP3+fdRk3zONmA98Cjw2D4/n5pBHeqYAVC2IeAUYCVwFvB24JjUivZaBJwx/tjXz4HvAw+MPx4hZhcq0Jwutwf3HMCkjAAXAKuBVbzy3blGzxOBcCfw"+"LWLWoNfQ5TkAAyDfPOBs4EJi0I+kVjN464kw+BfgPmB3ajUFMgD6by7wVuB3gHcD3R3xsowCXwe+AtxPnIRsngHQX8cAlwCXEmfqtdeTwE3AzcR5hGY"+"ZAP0yD3gXsIaY4s/LLad4u4mPCF8CvkmDHxEMgH44jHi3vxw4IbeUam0AriNmBTtyS+mOAVC3XwQ+CvwBsCS5lr7YAtwIXA/8T3ItA9dlALgWYPYsBT"+"4DPAF8HAf/bFpCvKZPEK/x0txy+sMAmLklwNXEdPUKYEFuOb22gHiNNwDXYMjOmAEwfYcQnfFx4t1pYW45TVkIXEW89lcQaxw0DQbA9Pwm8GNiOro4t"+"5SmLSaOwX8Rx0RTZABMzQhwF3A7fo9fkuOIY3IX/b+SclYZAJMzBFxJrHg7P7kWHdz5xDG6Ehe6TYoBMLHTgR8Af4Un+GqwgDhWPyCOnV6DAXBwvwB8"+"CvgP4LTkWjR1pxHH7tPEsdQBGAAH9iZiLftf4FSyZkPAnwMPAicm11IkA+DVPgA8BLwluxDNmjOAHxLHVvswAPaaD6wF/h6/0++jhcSxXYvXDfw/AyA"+"sI+5asya7EA3cGuJYL8supAQGAJwLrAPOzC5EnTmTOObnZheSrfUAWEPcp87FJe1ZShz7pmd9rQbAHGIxyVo8y9+yIaIPXEP0iea0GADzgVuJxSQSRF"+"/4Cg2eHGwtAA4H7gDel12IivNeom8cll1Il1oKgCXAPcA52YWoWOcAdzOzXZaq0koALCUGv2f6NZGVwL00cqv2FgJgKXFAT02uQ/U4HfguDXw71PcAW"+"ETcYvrN2YWoOm8mvibs9ceBPgfAocRJnf03r5Qm63SiDx2aXcig9DUADgG+QXyek2ZiJdGXDskuZBD6GABziI0kPNuv2XIO0ad6d7FQHwPgGuDi7CLU"+"OxcTfatX+hYAfwh8LLsI9dbHiD7WG30KgHcAf5tdhHrveqKv9UJfAuBY4Kt47zcN3hDR147NLmQ29CEA5gP/RAMXbagYS4l9CKpfPNSHAPgiXuKr7r2"+"F6HtVqz0A3g9cml2EmnUp0QerVXMAnEAPEljVu4Hoi1WqNQDmAf8IHJFdiJp3ONEX52UXMh21BsBfAmdlFyGNO4vYRKY6c8bGxjprbHR0dDb+m9OJLZ"+"+8l59Ksgv4ZWJTmRkZHu7uVgS1zQCGgC/h4Fd5quybtQXAFbhRp8p1GtFHq1HTR4ARYu93t+hWyXYCJwPrp/sf+BHgwL6Ig1/lW0BFX0/XEgAXAudnF"+"yFN0vlEny1eDQEwH/hsdhHSFH0OeF12EROpIQA+ChyfXYQ0RcuJvlu00k8CLgE20PM7s6q3niPevLZM5UmeBNzrT3Dwq15HEH24WCXPAF4PPA4sHEw1"+"Uid2EIuFnprsE5wBhCtx8Kt+hxF9uUilzgCOJt79/d5ffbATWAFsnswvOwOAD+HgV38sAC7LLuJASpwBLAR+CiweaDFSt7YSNxLdPtEvtj4D+D0c/Oq"+"fxUTfLkppATAEXJ5dhDQgf0Rhy4VLC4B3UfH91aQJrCD6eDFKC4BebbskHUBRfbykADgeOC+7CGnAfoWC1raUFAAfpKx6pEGYA1ySXcQepQy4OUQASC"+"34XaLPpyslAFYCy7KLkDqyjOjz6UoJgN/OLkDqWBF9voQAmAu8O7sIqWPvoYDxl14A8DbgDdlFSB07GliVXUQJAXBRdgFSkt/KLqCEAFidXYCU5FezC"+"8gOgBXAm5JrkLKMEGMgTXYA+O6v1qXOArID4ILk9qVs78xsPDMA5gFnJ7YvleBsYiykyAyAU/Cmn9JC4NSsxjMD4K2JbUslSbss2ACQ8hkAUsPeltVw"+"VgAsBd6Y1LZUmjcSY6JzWQFwclK7UqlOymg0KwBOSWpXKtWpGY1mBUBK2kkFa2oGYABIr9RUAIwktSuVKmVMZATAkcCihHalki0ixkanMgJgeUKbUg2"+"Wd92gASCVY3nXDWYEQDG7okiFWd51gxkBcHRCm1INOh8bGQGwJKFNqQZHdd2gASCVo/OxkREAKYsepAp0PjYyAmA4oU2pBk18BFiQ0KZUg0O7bjAjAL"+"wKUDqw+V03mBEAaXdAlQr3uq4bzAgA7wQsHVjnb47ZG4NI2qvzN0cDQGqYASCVY3vXDWYEQOd/pFSJ3V03mBEAnf+RUiVe7LrBjAB4LqFNqQYvdd1gR"+"gC8kNCmVIPOx0ZGAIwmtCnV4JmuG8wIgKcT2pRq0PnYyAiALQltSjXofGwYAFI5mvgIsDmhTakGnY+NjADYmNCmVIONXTeYEQBPJLQp1WBj1w06A5DK"+"sbHrBjMC4FlgW0K7Usm2EWOjU1mrAdcntSuVKmVMZAXAY0ntSqVKGRMGgFSGpgLg0aR2pVI9ktFoVgCk/LFSwVLeFLMC4GngZ0ltS6X5GUmL5DLvCXh"+"/YttSSdLGggEg5WsyAB5IbFsqSdpYyAyAh/EOwdJ2YiykyAyA3cB9ie1LJbiPxDtlZ28Mcldy+1K21DGQHQB3JLcvZUsdA9kB8Djwk+QapCzriTGQJj"+"sAAO7MLkBKkj4DLiEAbs8uQEryz9kFlBAA38cbhao9m4HvZRdRQgC8DNyWXYTUsduIvp+qhAAA+Fp2AVLHinjTKyUAHgA2ZRchdWQThVwKX0oAjAG3Z"+"BchdeQWCpj+QzkBAHAzEQRSn40BX84uYo+SAuAJ4NvZRUgD9m1gQ3YRe5QUAAA3ZhcgDdjfZRewr9IC4Bu4dZj6awPwzewi9lVaAOwCPpddhDQg1xF9"+"vBilBQDECZKt2UVIs2wrBZ3826PEANgO3JBdhDTLbqDAO2CVGAAAXwB2ZhchzZKdRJ8uTqkBsBlnAeqPGyl0wducsbHurr0ZHR2dyq+/njhrethgqpE"+"6sQM4AXhqsk8YHh4eXDX7KXUGAPGCXZ9dhDRDn2cKg79rJc8AAJYQ1wUcMfvVSAP3HHA8sGUqT3IGsNcW4OrsIqRpupopDv6ulR4AEB8DNmYXIU3RRi"+"r4CFtDALwI/HF2EdIU/SnRd4tWQwBA3Dzx7uwipEm6G/h6dhGTUUsAAFxGBYmq5r0IfDi7iMmqKQDWA5/MLkKawCepaLObmgIA4DMk7qQqTeBhoo9Wo"+"7YA2AWsIXE3VekgdhN9s6jlvhOpLQAAfojXBqg8VxN9syo1BgDAp4EHs4uQxj1I9Mnq1BoAu4D3A89nF6LmPU/0xaqm/nvUGgAQKwUvyy5CzfswBd3l"+"d6pqDgCAfwBuyi5CzbqZyje0qT0AIGYB67KLUHPWAR/KLmKm+hAALwEXAU9nF6JmPE30uZeyC5mpPgQAxGaL78XrAzR4u4GL6clmtn0JAIB7gY9kF6H"+"e+wg92sKuTwEAse3StdlFqLeupbCtvWaqbwEA8HHg1uwi1Du3En2rV/oYAGPAJcRHAmk23Ev0qd5tX9/HAAD4X+DX8XJhzdyDwG8Qfap3+hoAAC8Aq4"+"GHsgtRtR4i+tCO7EIGpc8BALANuAD4UXYhqs6PiL6zLbuQQep7AEBctHEO8Eh2IarGQ8A7aODishYCAOJAnouXDGtiDxB9Zcq72NSolQAAeIaYCXw3u"+"xAV617gncDW5Do601IAQKzdXg18NbsQFedrwK8B27ML6VJrAQCxgON9eMWg9rqWWEvS3G3nWwwAiAs6rgJ+n0rv5KJZsYvoA1fRw4t8JqPVANhjLfGR"+"oIkTPnqFUeLYr80uJFPrAQDwHeAM/IagJeuIY/6d7EKyGQBhE7AKby/WgpuIY92L9fwzZQDs9SKxscMHgOeSa9Hse444tmto8GTfwRgAr3YLcBouJOq"+"TfyeOadU38BwEA+DANgBvBz6F3xLUbBdxDFdR8a27B8kAOLhdwCeAs3BD0ho9TBy7T2CIH5QBMLF1wJnEd8U7k2vRxHYSx+pM/GZnQgbA5OwirhY7Bb"+"gnuRYd3D3AqcSx8l1/EgyAqfkJcB5xT3i/RirHJuKYnAf8OLmWqhgA03M78EvAlTS0cqxAW4E/I47F7bml1MkAmL6dwN8AK4gpZ1OryJJtJ17zEeCv8"+"dzMtBkAM7eFOOl0AvBZ7IyDtJN4jVcQr/kzueXUzwCYPU8DVwDHA9cQwaDZsYV4TVcQr/FTueX0x5yxse5WQY6ONrXo7jDiXvKXE7MDTd0G4DpiG+7e"+"3pl3f8PDw5215QxgcHYAnwdOBC4E7sDNSydjN/CvxGt2IvEaNjP4u+YMoFvHAh8kFqQsyy2lOJuIlXpfBn6aXEuqLmcABkCOucBK4D3jj6Nzy0mzGbh"+"t/PEA8HJuOWUwANoyl1ischFxh5qR3HIGbj1wJ/G9/fdw0L+KAdC2EWJHmtXA2cTJxJrtAO4jBv23iADQazAAtMcQsf5g5fhjFXBMakUT+znwb8D9xL"+"T+Ebwuf0oMAL2WpcDJ44+Txn+OAIs6rmMb8W7+KPDYPj/9jn6GDABNx5HAcuKag+OIE4tH7feYDywe//35wKHj/36B2C8B4vr6l4ir7PZ9bAaeJL6b3"+"wg8O7C/pHFdBsBQZy1p0J4df/xndiGqR6czAEll8UpAqWEGgNQwA0BqmAEgNcwAkBpmAEgNMwCkhhkAUsMMAKlhBoDUMANAapgBIDXMAJAaZgBIDTMA"+"pIYZAFLDDACpYQaA1DADQGqYASA1zACQGmYASA0zAKSGGQBSwwwAqWEGgNSw/wOFn5u+68+XFgAAAABJRU5ErkJggg==",t,i,s);e.name=UYt._5e_;return e}static get _5e_(){return i.e3e_()}static A3e_(t,i,s){const e=(new At).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0"+"QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3wgaExY5fZXYlgAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJT"+"VBkLmUHAAASFUlEQVR42u1bS48bR5KOR2ZV8dHsh97WeD2Y82IxEI996YMAw/9jftb8j8ECPVgBgz74QP+AgS0YMNAtW61+kyxWZkbsIbPIYrHYLcma"+"xQK7BFJksyiy4osvIiPjAfD/j//bD/ySX/aXv/wFW9+LD6zmQxvP9y3461//qv+rAGgJXi96YDVBaAoo96z6OnwpMPALCl4Lxem1Sa9N6zWn1WZBLWQ"+"AAN94br6ur0sTtN8DAn4hjVNDMNtYWWvZw/HYQrHDvZ5h8IBgADx4BQ/inPNlWfrJZOIAwAFA1XiuXzdBCb8XCPwdwjfpbJLAeVoFABRjgN7O0VGR93"+"qFZVswY27IZMhoAMEg4NIEFDSogBcJVQihEucWpXPl5eW8nExO5gBQprVIqwYptEzkk8wCP0N4bFDdNDTdS2tweHg4GI6GwyIrBsbagWHuE1GPiQogy"+"hAxIwRGQEp3KqoaVNWpqhORUkTKEPxcJEzdwk1nZTm9PD6eTgCmADADgHkComowogbio0HAzxCeGlSvBe8DwPDo8Gg03B+OcpuPTGZGhs0OMw+JaYCE"+"PSIuECAnjAyAyAAEAFHQAAJeQSsRXajKXCTMQpBp8OHOeXfjnLspp+XNf16e38JkcgsrMGog1sziY0DAzxDeJMHzJPjOeHw4evFitJ/n/b3M2n02Zt8"+"Ys8tEO0g8JMI+EfUQMUdECwAGERkBUREAVFUVBEB9YkGlqqWqzIPoVEK4CyFce++vnXNXVbW4nE5nV8fHx1cAcAsAd4kRVcMsPgoE/AThuSF8DwAGAL"+"D7+vXr/cFg56Ao8kfWmsfGmANm3mPmXSIaEtEAEQsiyhHRYtQ8AwAhIAFG+WsPr6BeRb2qViJSqupcRO5CCLchhOsQwqV37sPCVR8W5eLD2dnlxWRyc"+"g0ANw021M7yQRDwE4XPk/A7Y4C9p99992gw6D/JsvyJtfaJYfOIDR8w8S4S7TBTn4gKQMgIySKiAQBGREKA5AMVQUE17fGquuYPVHQhKvMQwp2I3obg"+"r0IIH7xz55Vz78v5/P31zc35mzdvLgDgOplF+bEg4EfSvrb3PgCMxoeHBy/29x/3er1neZ4/s9Y+ZeYnxpgDIt5jpiFRFB4RLSFZQGBCJEAkROyMBGs"+"mJBBEVbyIOlWpRHQuItPEhMsEwm8L535dlOWvt7e3vx0fH38AgKtkEmXDL2x1jOYTbD4KPz48ePno0dNer/c8y7IX1trnxpinzHxgmPeIeUhEfUTMic"+"gSESMiQ9I6IiIg1tI3I0GI8kcg4oOESIOIOEIpAlKPkHoUTaqIPoUyQjRARK9fv8bj4+PO8LkRQa49+IF9vmnzo/F4fPDi5bNn/V7/RZ7nL7M8e2mNf"+"WGMeWqtfcTMu8w8ZOYeM+dEZJnIIDEzERERxn8RiRDT30jxD4zvE+HqQYjIiMhIZBAxLiIb/QmadA0JAMgY/cPLl+Ht27fS2BGWUeOrV6/ghx9+uB+A"+"V69e1dqv9/geAAwBYH88/vPTQX/4VZ5lL22WvTTWvjDWPEmOb5eZ+8xcMHPGRIZqsVfCR6kiBIgtSZeyE0L9SYisIYhvcVq1L0nPQIQICCiGSJ49f+5"+"//vln3xUktUEwD+z1S+1/9+13B0Vv8DTLsufGZi+MNc+N4SfMZp+Jdpi5IKKMiAwhEq6EjSJESQBT8IeIbQ8Q1RStAFUVVBUQEVQVURAFdYkXABAgkA"+"GDAKCgIKoQVNWPRrtuPB67yWTSBYJuZUDSftvud4+Ojh7t7u0+L4reyyzLXlobac+GDzgGOz0iyonIEBEnzSMz1xQHIoKoWQJEjH8nQBARID0T4dr7t"+"cSw2jZWrABIThUoBVUKAAGRQp7n7p///Gc7XN4wBfOA9vswhtFoNDrIsuxJZuxTY8wTZn7EzHtMPGSiHhFlzGSImFYU7xByyYLuDSg5Qai131yogAKa"+"3OjSiRbxP7AwQ9o6oVKVMoRi/vr16/nx8XHZCpCkyQLu0D43orzdb//j28eDweB5ludfWWu/MsY8N8Y8MswjMqbPRDkxGSamhlMDYoZa80sGNEDZDs7"+"2BUtjAlSorQobJ1NV1Xh0VoAKARbD4XBxdnbm2hFizQJzT5zfG48Ph0XR38sy+8gwPzKGD5YRHlOPo80zEy9dd1PYpqDwgA9oaj/Z/cYCABARRCRlBl"+"rtnlqoamA2uyK6EOFZZsytz7Lbx48f36XgaN7FAm5pnxqOb/fPf/73R4NB8SzLiq+Wds+8b4zZYeaCiQ0l1a/ZehK8DUQ3C6Ly7mcDtEHDVjC3llhRj"+"YcqUChFZT4cDsuzs7NFOzB69erV2i6wHvKOx/0sy0bGZHuN2H6HiPqEmCGSQcJa+C0CIiBSS5Dk8Bo/W8vV1v7qQUCkICJASFFNAKgKgKhERKyqVlUL"+"Ihow00gC77E1e5m1u/v7jy+TUmcJBKpBMB2ZHQsAxdHOft/abIeZR8Q0IsKdFN7mSGRTTIMNT32vjW9oOKp0zQRq4WttqyqoyDKEi2GBAMpyx0AAAlU"+"lJDIoYik65QExjTjQyNpsVBT5MDnMrJGyQwBQ6mCABYB8OLR9a3jIzDuMNCTiKDwuw1taBTG0XWAiwC6/0Pr8NtOJn0vX1r537TXGwJJMikV6kQm8w8"+"zDPLeDw8PDXgLANJOyppXUZACwYxgXbLM+MQ+IeBifqUDEDAlNI2Jd3kxkdn1TDWE3tB8p394K2wxoPogARNZ9AylFv4+KhASKWkeKFhFzXDFhQMYMh"+"r1hFwDQCcDOUZFbMj0m7hNBDxGLOplB7RgWCRAQENZt/YHtbGMX2BAe148vbeeoqC3Q184OlgmLQBiZQNSzhS0eYsDSCeb5MGND6cRFBRHlAGAofjnh"+"alNeJrUeEroLBIDoDBXWBUdFEJUGQWp2bP0NREStASAkI0CW4r0XTNRj5rwFAAFAoDVXmwAgshmhyZAwxzqTQ2Tqszw24o9t2l2uewIcomg+a/4BI7U"+"R2maDnVtm4zexETYbJLSImCVzyIkoPzw8tO26RNcuYKwlg4QZImaYChuUMjm12poCNm15g+ZbGYCAHekY1foHNn1D/L+aPrNpHomKlO7TAIBFxIwIM2"+"a21lrTLsp0AUDLc/dqUTOhsSlgGxDotPVuM4COEiG2hIfNLbL7jFH7V0IAQopHZ4QohzGGG/TfOA6vQKAlEOu1vPVIrFuClsBdr9ffw/YJdSMWQIQ1+"+"+/aKTa+GDEmXQEYARmAGHizLkkdOUKkmI5YfrCp2I8rNmCHoCt81vxABxu2s+P+3C52X0BI4QQDtz+CbQBgvFneBv3kipvec6V1CAJ9WKMPyp8OUvfj"+"piGEzRij/aEJgIKIKKgoaDuLop8kvq5Tepn56TjldZnAx77fcXdr5XZVFQFRAN6Qx7S+RgFAgkJQhQCylliUeAOrxNWmOldprFq72HBoS3pra+9vJUG"+"a39UWfO11t/QxoQyxvgAAAWpZ/ELa2WLTFh4AAogGUPUaS1UhrQRC4x6hpc2Gs9g43KStTes9TB/IBHVca4MVQVptn3UyHQAk5gjVq6gTEKcqzrtlEb"+"UTgGVzggvOiUiVanRVA4jlb9xH35Xnbnhz0JVJJGao6hoW25IgbYDuMQ1NDBAAiHVG0EpFq6BS3cKtb+cH2yYQAXCu0hAWolKq6iIB4VU1RKWrqip23"+"XQtWLysAF3b1mqrXzOELgC2AbK+msUUFVX1oupAdSGipaiWwYVqcjJxjU6TrQxw8/l84Xd3SwkyT7X6BZA6VQ21Y0w/CqqrFHY0g6jplZ0IaNPXag3K"+"Wshwb0I00Xs7KCpNBEKkviwkVZglhLlzruwqoVPLBwQAcCcnJwvn3SxImInKTEXnEpngRCRIrNt9lMZUFFQlJjZElk5ENf2dlqounzfXA7+1qqcFEVl"+"WlkVkJiIzH/ysAcDDDACA0lVuLiFMNeidsEw1FicrIvIqYhRRN7S/RlNZ7rIiKQBqOchtSdEmE7aDsgRHRURFREQlqKoT1VJEZyoy9SHcBR+ml5eX8w"+"4ANnyAJAAW8/l82u8Pbq31Nyx8GyRMSWmuqoWIWiLlmKHFNTMQESCiKDTpZqBxT+ID4GG6twBJm0GqJktsr1GRmUi48yI3IYRb59x0Mpl0AQDUtQsAQ"+"PnmzZuZc9Vt8P4mhHAjIrciMpMQSlVxIhJUVURENWpgReUl/ddp3qR6UxCR+r1ujUstuOja/0+rfvi0c6VeArkOwV97567v7spmB0noMoEmCD59cDab"+"zW6zLL8yNlyGEPaIaESEPRTJsU6OQKzZUeNmSQQk5fe6tF+f99ssuN8RRv8hDe3X1FdVLyKViMyDyF0QuQ4hXHnnr6qqunnz5rjdL7BsmqBW40ATgPn"+"x8eWtc9W18/4yhHApQa5CSEyIP+iT9YnULAhhQ9Mbjk42r20sbX9HZEpilUa5VUQkiIgTkbmI3IlPbTTeXzjnLmazWbNrpBkIQRcDtOEI5wCTu+l0/8"+"pau2OId4hpgAF7iJTXeYKUHDDL4yURisg9pS5IMQLcG+93275AtLil4wsi4kIIZeoeuQ4SLoL3586587KqLo+Pj28a9QD/UG2wfZSkt2/f8jd/+hNbY"+"ywjWYhpJlPX5ht5g41cyLaTizbjBNi2dW46vqTzWngfQqh7Cu9S28x77927qnKnZVW++3B1/f6Xn3++TJ1kdfOUNHuGlgD88MMP8OrVq66yEz178oSy"+"ImMiNtzo1IDY6kbrIGjz+NxVAq737Xv29VYMIJqOdBJ3PZUQQqhiM2W4CyFchRDOvfe/OudOF4vF2d3t3a//9fe/f2h0jzXtf1ke7+oP2Ego/PLLL/D"+"1H75Gaw2vta0kwXE9y1KHyG0gNw45m5pv2X0Uetk1ldxNSP6nDCFMQwhX3vtz7/2v3rvTxcKdzmazd3/729/OU8PUNGnft7W/AUCDBRun7bdv3+Ifv/"+"63uuxdt33QlhmAhsC6pPna+9qgfyNCTHRPB1pRXWpeQtrqFrXD8yFchiR81Hx1Wpbzs9OL0/dnv5zV1C+bpfF2p9hGj9AWEAAA9MeffoJvvvlGOXV7N"+"AweoTPDq0s5oXmA2MqA5fYGDUdXb3MuCT8TkdsQ/GWT9tVicTqfz9+dn5+///7k+4sk/Hwb9bcC0DKF9hSH/Pjjj5pAECRaDTEoaqzXLlMZUh/a66AN"+"1k9tqwsrhq+IvtJ4ley97hi99iFc+ODfe+/fOefOqqo6nc9nZ+fXH347+cdJl93LtmbJTgDuMYUahPD1118HIoonK8SAAEEV/CoLo6KgITnvsGp+jMK"+"2/pZ0kAki6lOkWYnIIm1xdyGEW+9Tl6j3773z76qqOquq8nQ+L88+fPjw/uQfJxct4f026t8LQAcI7ZGW8NNPP4WXL196IvCq6ADUQUxAxCXqFMCpqg"+"MAL7LMMHmNmg0i6uISJyIuneIWjZPcNIRwE728XIQQzr1zv4bgzypXnS0W5dl8Xr47PT09//777y86+oVlG/U/p1m6ORhRpGbpncPDw939/f2DoigOs"+"ix7ZIzZZ+Z9Zt5l4h2i1CofS1Sx0oRoGp1dAOt9wjGTszzP60yC3AXxNyHItfPuwrtwUVbzD9Pb6UXqGL/u6Bj/qNmBz2mX58Z0SN01Pnr97etRvxjs"+"5Vm2Z43dY2t2mXnERENC7CNRj5ByJMgA0CAgA9aHsUZzU90uL1pKnBm4C0HuvA/Xwftr593VbDG7ujn77epkMrlJgk9bwxMfPTjxOQMT7db5BhDjnW+"+"/fbxT5MWOzezIGDNk5iETD4gpltkJcwSyiMtOjWU6btkhrroIIQ5MSJBp8O6u8v7WufLm8u7m9uTNST0jMGuM0bTniOCLDUzcMy/UHJIq0uoDQP/o9d"+"FgWAz7bO3AMPUMmx4SFYSUEYFFRKOAGCvfdYs8+NQZvvAhlEFkHhZutnCL2fn53XQyOZk1xmXK1mzAZ80N/Z6hKdwCRNYcnIIxFEc7R3me57m1NqfU6"+"EwUu8viEVQEBEQk+BDABecqF9zicj5fTE5OmsNSZWuCbKMh+lMnxz57brBlEtiouzeHqWpAmqN0BgDMeDymoiioLMtYkZqAAEzqhIy7Z7X7fz9rWuxf"+"MTiJHazgjoFJbk2PbhZmNld7aHKtxPU/Pjj5kUBsG6HFlvDQAYJC98jsF58h/lcNT0PH4ei+wek2CLBl6uOLD0//NxKXqwa3BaHgAAAAAElFTkSuQmCC",t,i,s);e.name=UYt.Afi_;return e}static get Afi_(){return i.A3e_()}static n3e_(t,i,s){const e=(new At).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QA"+"/wD/AP+gvaeTAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3wQYEi8ITPQaqwAAAGVJREFUeNrt0AEBADAIAyB9/4rLoj0uRKCTTB326jgBAgQI"+"ECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEPCDBbsABBZDMwGRAAAAAElFTkSuQmCC",t,i,s);e.name=UYt.fr_;return e}static get fr_(){return i.n3e_()}static h3e_(t,i,s){const e=(new At).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAAAXNSR0IArs4c"+"6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABpzSURBVHhe7Z1pdFVVlsdv8jInZCAhCZMEBEVQS1vtgtZVFjVI9Wp"+"KywGq6OqublTCTByW/aH6"+"g8sP3dW1XBYiCIYqihYJMQkmgIg4FAFBWgWlxBANiowZGDI8Muflhf7/b+6tTlP4fMmbzr13/9Y66753D5r37jv/u/c+++xzozRBCZ5++um"+"YnJycyTExMUsvX7483eVy"+"rejp6dm2ePHiZuOfCBHAZRyFCAExRGVnZ49NS0tbCFH8Z1RU1A9xOhftR9HR0VNnzZpVd9tttzXs3bvXq/8HQlgRCxJB1qxZkwFRzIIoluD"+"tLWhxeP2X3wTi6cOhvq+v"+"7xVYk3XLly8/ydN6pxAWRCAR4LnnnktMTk6+GxaiAG//Dm3YQGFcCYTSg+4qvFzd1dW1fdmyZY39PUKoEYGEkfz8/Fi4S7QUCzDg70XLxOt"+"ovfNbgEhoOdrw3+yFRVlZ"+"V1e3/5lnnunq7xVChQgkDMyePds1Y8aMiXCn5sFqzMFYH4uBHmN0DwrD7WrAsbS7u7uwsbHxGITCc0IIEIGElqhVq1aNjI2NfRDieBiDeiq"+"EEWv0BQT+Xz04fI72Um9v"+"b/miRYsu4P8t8UmQEYGEiBUrVqQnJCTcA2Eswtvb0ZIxgIN6vQ1r0o72vtfrXQXrtGfBggUdeqcQFEQgQebpp59OGjly5HQM1kcxgO+BJtL"+"R/IozhgqFgnYBL7fAmqyb"+"MmVKNVy63v5eIRBEIEHCTPTBncrHYH0Qp3JDLYwrwd/tRavB3y1EK50/f/55nu7vFYaCCCRAIIzoUaNGjYHF+CUG5zycGo/BOaQAPIh09PX"+"17cNner6lpWXfU089RTdM"+"GAIikABAAJ4ZFxd3HwTB5SFTMSDjjK6Ig89Dy9GEVgGxvFBfX//5M888I27XIBGBDAEjzvghBLEI4/B7EEgSmpLXEp+PojiJYyEC+Y2LFy+"+"m2yX4iQhkEEAYcXCnvgNh"+"LMVdmUtEMlQVxkAMa9KN9iFe/q6urm43rEmb3in4RATiH9Hr1q2bCC1wZurneD8KryMdZwwaQyh0u3ZC5C989NFHn+J7efRO4aqIQHyjJ/o"+"QZ8zGgHoE4+t6CEOZOGOo"+"wPp58T1O4OXLHo/n5SVLlpzFa5ntugoikG+gqKgow+12z4qJiXkEg+kOnErq77EPEHwXvttBiH/16dOnd8HtumR0CQYikCsoLCxMwsCZjoG"+"zGI21GVxpG9Z8RjjBd2U2"+"vhnHN2FZXmpoaDgIoXAZiwBEIAYQRiwGyU0Qw3y0+3Aqx87CuBLD7aKr9TLaf+fn55/iafY5GccLhIm+kSNHjocrNReD5Fc4pUKiL5L04EZ"+"xGMdV7e3tbzz++OMt/aed"+"iaMFAquRhcHwMwhiIRqth+UD8CDixg1jl9frfTExMfHgvHnzHFl74kiBrF69OgUW426Xy/UY3k5HS9Y7hCvhIsh6HItwrQofeeQRznw5arb"+"LUQJhog/u1G3R0dHL8XYm"+"WhqshmPijADwwJpUQSyrOjs7K5zkdjlCIIwzcnNzJxtFS3MhirCvtLU6uG60HMy+/wntdxDKRwUFBczO2xq7CyRq7dq1o2JjY+fCl34YlmM"+"izgWlos+pQCfcfojruUp7"+"e3vXnjt37ks7l/zaViDcUgeC+Ac0BuC34pTtEn2RBELhIshq5k5wfcsWLFhwsb/HXthOIFxpO2bMmO/hh2M+4wc4xTjDUbFWOIFQWnHYg+u"+"9urW19X271Z7YZuAwAM/J"+"yZmKOCMfb+9Hy4L1kJ0jwwDEwSRjA9pWbnC3Z8+eo2VlZbbYCdLyAiktLXW53e7xuJMxyfcLNKcn+iIG3S60Grz8vcfjKVm6dGlDf491sbJ"+"AolavXp0THx9/P+5g+RDF"+"FDRJ9KlBB4SyH7/HSvw2lt5pxZICWblyZSqEwc2dF+LtnfghJABXDAiEM1tNOG6BSF7KzMysmjNnjuXcLksJBMKIT0hIuA2CWIa3P0FLxWv"+"JZygMBEJRsOT3pfb29qIn"+"nniCmXnLYAmBMNGHAHwSAnDugv4gRMGVthKAWwSIg3TD4n/Y29u7oq2t7V2rzHapLpAoWI3RsBq/wMWdj4s8AcKQANyiUCU4sOR3O9oL6en"+"pn6nudikrEG6pA2HcawTg"+"3BE9HkdLxkzC/4fTwjicwE1vIzSzIT8/n3UoSqLcgHv22WeTU1NTv4eXi9HuhiZSRBi2pRMC+QQ/76qOjo43CwoKlCv5VWbgMdGXm5t7C+I"+"Mzkz9PVo2LpwE4DbHcLtY"+"8rsTloUbcB9esGCBMjutqCCQ6DVr1kzChfklG95fA2FInOEwIBBztotuV9HChQu/5mm9M4JEUiBRzz//fHZSUtJDEAT3m5JEn8D4pIdWpLe"+"3d01MTMyO+fPnM6iPGBER"+"CJ+dAWH8GBdiIYQxDacSIQ6JMwQdjAlaDsYjLPldlZmZeXDOnDkR2WklrINyw4YNCT09Pd+FMJbhGnBLHVlpK/iC2fizsCobIZQNixcvDnv"+"Jb1gGJwLwmOzs7Cms6IM4"+"uHWnBOCC3+Bmqj9ujtYEr8shlOb+ntATcoGsXbt2NITxL3jJZ2eMgzCkok8YNHS7MHbacdgNi/JcfX39B+HY4C5kAmFFH4KsB/ByAdrN+HL"+"xeocgBAAEQrfrHERShEC+"+"cOnSpZztClnJb9AFwkRfSkoKt9Thuikm/IL+8EpBgFC4wd0XeFnY1dVVVlBQwGc0Bp2gDVyjou9vIAw+JH8WTvHZGbKgUAgZEAgDdi56fA+"+"x7Uq3273vySef7NQ7g0TA"+"AmEADmFcC2HMgyBmo12D05LoE8IJN7ij21UWGxtbuGvXrppglfwGJJCVK1eOSUhIoCgYhE/GUeIMIWIwyYgx+AXE8ke00oULFwZcezIkgdB"+"qXHfddbM6OzsL8EH+Fk0S"+"fYISYCxytouLIN/H2xdqa2v3BPK4uSEN6kOHDqV5vd436uvrpzc3N0f39srDUwW1oFAA9+p6Dcc1GKtHh7LB3ZCSdXFxcdHDhw+PgxWJRtP"+"S0tI0GhB8EONfCEJkoUeD"+"wH0EDo8iPl43YsSIsUbXoAgom42ASMvOztamTJmi5eXlaYhHjB5BUIYYj8czCm1IgzMoyz3i4+O1sWPHalOnTtVycnI0KFesiRBxEAZoTU1"+"N2ueff86wwDg7OIK2Hoqi"+"SE1N1SZNmqTdcMMNWnp6uu52CUK4oTAuXbqk1dTUaNXV1VpjY6PRM3iCvmAwJiZGy8rK0t2u8ePHa4mJiUaPIISWvr4+rb29XTt16pR29Oh"+"R7dy5c7pYAiHoAiG0HHS7"+"xowZowtl1KhRerwiCKGA7nx3d7dWW1urC+P06dP6+2B4MCERiAndrmHDhmkTJkzQrr/+em348OESnwhBg+Oop6dHO3/+vO5Kff3111pHR3B"+"3OQ2pQEzodmVmZuoioduV"+"nCyPBBQCg65Tc3Oz9uWXX+qtpaUlJDfesAiEmG7X6NGj9dkuHsXtEgYL44zW1lbtq6++0menaD2YqA7VhFDYBGJCF4sWhG4XZ7vE7RL8gcL"+"o7OzU4wvGGfX19ZrH4wn5"+"TGnYBWLicrl0cVAk1157rZaSkmL0CML/YQbgDQ0NujA4Q9XVFb5HtkdMICZ0szjLRbeLs17idgmEwqDrxBwGXSnGGW1tbWH3NCIuEEIzmZS"+"UpAfwnBZmQC9ul3OhO8VE"+"H0XxxRdf6MF4pMaCEgIxodvFDPzkyZP1jDyniAXnQBEw0cfp2qqqKj3RF8oA3B+UEgjhxaCblZubq7td11xzDVcPG72CHaEwGGecOXNGjzP"+"Onj2rB+AqoJxATCgULlMZ"+"N26c7naNGDFCtzDidtkLCoFTtRTGyZMng57oCxRlBWJiul2sO6HbxQWRkTS5QnAwA3DGGMeOHdPcbrcee6iG8gIxodvF2hNOC9PtYtJRrIn"+"1YAacib7jx4/r4rh48aJ+"+"TtWbnmUEQjizxdkuCoRuF+MULmMRoagPf6OBiT7mNcKR6AsUSwnEhG4Xy3zpcrHxtaAmZgBeV1enz0yZiT6r3NQsKRATWg9WMNKacOkKS34"+"lPlEDCoAWgi4UV9rSpeIU"+"rtWwtEBMKAxm4c2SX5ntiiyMKRh0m4k+rrRVMQD3B1sIhDA+YWJx4sSJeqJR3K7ww5sSrcSJEyd0q2FW9FnZqttGICZmyS+tCRdBSslv6KE"+"wGFcw0cc4g5V9LGSyg7tr"+"O4EQ/jADa0/Mkl9xu4IPhcAZKVoMWg7OVNnpOttSICZ0u7iMnpaEiUYur6d4RCiBQ9eJAThjDMYaXFxox+tqa4GYMGjnUhXGJpztYsGWzHY"+"NDQrDXGnLbXWYDbdqAO4P"+"jhCICd0uulsDd1oRa+IfvE5cJ8VEnxmAWyHRFyiOEgihNaHbRUtCi2LWnghXh9aBiT6usKUwrJboCxTHjgwKxdxphTGKuF1/DS2EWdHHAJx"+"rqJyG42+ddLtGjhypu12c"+"9WLtidPdLsYZTO5xla1Z0UdL4sQbiPgWgC7WwJ1WmEdxottFYbDumxV9XFDIOg2rJ/oCRQQyAIqCtSd0u7gI0ikb3NFiMq5gnEFhcGGhEwJ"+"wfxCBXAEHBd0ss+SXj3Ww"+"c8mvmehjBtyOib5AEYF8AxTKwJ1W7Fbyy4o+c6Utdyl0YgDuDyKQb8F0u+xS8suYgittKQom+hiAOz3O8IUIxE+YVORS+oElv1YaVJyF4kp"+"bboxAqxGurTutjghkEJhu"+"FwVCoVjB7eJnMyv6KAwG4nwvwvAPEcgQoCjodtHl4oyX+ZRf1bjy2RmR2LrT6ohAAoBuF60Ig3ju30W3SwUYU/DhlUz0sZkVfWI1Bo8IJEA"+"46FjyS4FwWtjcaSUSUBjm"+"ljpcHnLhwgUJwANEBBIkOAjNp/yaJb+cAQuHS8O/wfyFuXWnJPqChwgkyJiLIBnE5+Xlhbzkl0KI1LMznIAIJASYbpe50wrdrmDXngxM9EX"+"q2RlOQAQSQuhimTut0KJk"+"ZGQE7HaZiT4G34wzGIzbuaIv0ohAwgCDdoqDIuGKYeZSBhsfUBjmljp0p+ywpY4VEIGECQ7kgTut0O3yZxEkrQPjCgbeFAYTfXbZUscKiED"+"CDAe2udMKk4y+nvLLAJxT"+"tXSlmOiz4tadVkcEEiHodg0s+R34lF8G4IwtzGdnmA/JF6sRfkQgEebKnVaYzzATfao/O8MJiEAUgAJg9SKLs2gtJNGnDiIQhQhX5l3wHxG"+"IIPhABCIIPhCBKIZkxdVC"+"BKIQnLFitZ+gDiIQhZBZK/UQgQiCD0QgguADEYgg+EAEIgg+EIEIgg9EIArBaV6u5BXUQQSiEBSIFEOphQhEEHwgAlEILjOR1bxqIQJRCHG"+"t1EMEohC0ILJYUS1EIAoh"+"FkQ9RCCC4AMRiCD4QAQiCD4QgQiCD0QgguADEYhCcKmJTPOqhQhEIbgOSxYrqoUIRCFkmYl6iEAUQ0SiFiIQhZD4Qz1EIIohIlELEYhCiHu"+"lHiIQQfCBCEQQfCACEQQf"+"iEAEwQciEEHwgQhEITjFKzNZaiECUQg+G0QEohYiEIXgal4RiFqIQATBByIQhaD1EAuiFiIQhaCLJaiFCEQxxIKohQhEEHwgAhEEH4hABME"+"HIhBB8IEIRBB8IAJRCCm3"+"VY8hCSQnJ8fT29t74fLlyx7jlBAgnN7t6uqSaV7FGKpA2txu91Pd3d1/NIQit74AoTBk07jQgGvr7ezsHNIYHbKLNW3atGrweFNT0zyPx/M"+"23IMOfBC5/QWAXL7gguuJ"+"Ydl3KioqahNuPg3G6UER8CON8CGi9uzZk5mRkTE7Pj5+aUxMzHU4HdPfK/gL44/9+/drlZWVIpTAwSW83ITjNrQ1NTU1Rz7++OMhhQMBB+l"+"Q5+UZM2ZcrKioKGxtbX2g"+"o6NjjdfrPU/1Gv9E8BMJ0gMH464VbRvG5T/W1tYu2bx5M7QxNHGQoD8U78CBA4kQyF3p6ekFsCh344OmGF2CDyiOvXv36k0YPBBFF9qf8XL"+"1pUuXdr7xxhvN/T2BEbKn"+"RkIowxMSEu5HWwK3ayqEEmd0CVeBAoGrqr333nvGGcEfcN08GFvHII4/4nVZSUnJWZwOmo/qMo5BZ/369Z25ubmfjhs3brfL5erBl7iG1gR"+"Nci9XAT+wdvLkSe3UqVPG"+"GcEXuF6sDThNYURHR/874ow333nnnaBYjYGE5bnDdLvi4uKmx8bGLoFF+QFEkoYmzzwegFgQv4EmLjdh+LyOa7aurq7uMNzSLqMv6IR1kJa"+"Xl2fm5eXNgkgWwarcAuXH"+"G12ORwTyrXDOtg3C2IfGCaHK7du3txp9ISPsd3GoP+rDDz/Mg0geQRD/zxDKaHzhkLl6VkEE8s3g2nRhjBzxer1rcVPdUVxcfNHoCjkRc3N"+"KS0vjYE1uT05OfgxB/D24"+"AKlojnW7RCB/DW6mXFpwHMcNuD6bEYCf6e8JHxEfkPv37x8GS/LTpKSkZRDKrU51u7jMZPfu3YzXjDPOBYJgQqgeraKzs7OwoqLic7yOSMF"+"+xGeU7rrrrtY77rhjs9vt"+"fqi7u/s/MFBO4QI5cvcCDAbjlXPBb+/GoQTu1NzY2NinII4qvI/YeFDG91+/fn3rLbfc8j/Dhw9nEJaMxmnheKe4XdzR5NixY1pDw5CWDFk"+"eCIN3hz1ov25ra1tVXl7+"+"5aeffhrx1ZtKDr6dO3empqen/yQ1NXV5XFzcbdBIgtFlWzwej7Zjxw4Ng8I44wwgjG40ulAv4RqUb9my5UJ/jxooe3fGRYtCwDoGQvkFYpT"+"5iE3GQyi2XQRJgWzfvl07"+"cuQI17cZZ+0Lfl9ah69xLMZ3fxnf+XRZWZlyrrXyv8ShQ4dicRFvgkgWw5r8DELJwMW0XTaeAtm6datWVVVla4Hgt/Ti+7GGqBzx5vrjx49"+"/FshiwlBjmV+isrIyJTk5"+"+Z6EhISlEMs0CCXR6LIFDhAINHHZjfYuXv/B5XLt37RpU3t/l7pY7pd49913R2dlZf0cQnkYF3kSTtliEaSdBQJRMAP+MSzGWgTgbwdrpW0"+"4sOQvUVpa6hozZsyUlJSU"+"RbAmD+Dij0CztNtlR4H09fXRdfoCbR3EsQUxxjm8tlQ1mKV/CS6CjI2N/UFSUlJBTEzMnXC7kowuy2EzgXghjrP4Hq/CeqwvLi4+jnOWrAa"+"zxa3qrbfeys7IyJgLi5LP"+"kl/8MJab7bKDQCAGiqAJ4tiGVghLfxjvLb0ThS1mg2bOnHn+5MmTq1tbW+/v6up60Sj5lcLuMMI4A4cdOP4T4ozlEMdBvLf8Ni32cHYHsHP"+"nzvjs7Ow7EcQ/GRcXx5Lf"+"ZKNLaXp6erSKigqturraUhYEgujG4TBuSmtcLteOzZs3WyYA9wfbCcSksrIyCy7XQ4hPFiFOmYxBp/RsF9dhlZSUaCdOnLCEQCAMWocaHF+"+"G1S6GuGt5Wu+0EbYtf+VO"+"Kxhsv29sbJyNH3AF7nBn8WMqHSji8xmv1AWf0YvGUtfn0R6qq6tbAXEEtQ5cJWxrQQayYcOGhBtvvHE6rAn37foR7tDD0JT67rQgxcXFek2"+"6ihYEYjAD8Dejo6MLm5qa"+"Du3atYvula1xhEBMDh06lAWB3AeXaxGON+KHVqb2pKOjQ4P/rp05c0Y1gUAbegD+Pq7XGrzeW1RUdKm/y/44qtR13bp1HTk5OZ+mp6fvRhD"+"fhh98nGFNIu5qcpqXCxUv"+"XbqkjEAgBi5B/xjtN7Bwv+W07WeffWZ7qzEQR1mQgRQWFsbeeuutd8DtWg6LMhODMqI7rbS3t2u4M2u1tbURFwiE0YvG5N7G7u7uovLycpa"+"6WjLRFyiOFYgJa09gVe6F"+"RWHJ782wKhGpPVFBIBAFRXAef7+0q6tr/WuvvVaN95bPZQSC4wViELVv376xycnJ82BR/hUiGYtBElb3M5ICgTAu42+2IAB/G9/9xcbGxo+"+"cEID7gwhkAJWVlTGZmZnf"+"wSB5DG7XT3FMM7pCTqQEAm3wsRUfoj3f0dERlr2mrIQI5Cps3bp12OjRo2dySyKXy3U7hBLy2a5wCwSC6MHhKI5/gDu1paKi4nx/jzAQEcg"+"3gIHDDe5GQxy/SklJeRTx"+"CTeRCJnbFUaBMNF3Au7UJhw3lZSUnMA5Rwbg/mDbTHqgYJBenjZt2tnDhw8/29TUNKenp2eD1+tlqaglM8b42H1o59DW9vb2/vzIkSO/gTg"+"suww9XIgF8RNucAeX64ew"+"JMvi4uJY8hvU2pOWlhbtlVde0RAgG2eCgyGMS/i8ezwez4uIMw7s2LGjw+gWvgURyOCI+uCDD0bHx8fPRXsYYpkISxOU2pPm5mZdILBWxpn"+"AgTAohIM4ckudt7ds2cKV"+"tlIGMAhEIEOAs124I9+cnp6eD6Hch9c5EEpA15LCoEAolCDQA1EwAH8ZAXgpAnDuRifCGAIikAAwSn5nJCYmFsDtuhOnkoYqlGAIBILoxZ+"+"vRQC+ubu7e0N5ebnEGAEi"+"AgkCn3zyyQhYkbkQyUK4XZMwSAftdjH22Lhxo+Z2c2vawQFh0DpcxOF1tHVer/dwWVkZp3GFAHH8czmCQWFhIRdBHkxJSdkNl8sFOCU8KGv"+"C1bzcdhR3fuPMt2MIg1vq"+"/AlW49/a2toKYTVOVldXO3Lz71AgFiTIsPZkypQpd0Isj8OafB+Wxa+S34sXL+oWhKt5/QHa4J62f4Y4Xmhvb9+5bdu2FqNLCCIikBDxzjv"+"vZGZlZT0It2upUfIba3Rd"+"FX8FAlFwr6mv0PhU182vvvoqn6MhAXiIEBcrRCDg5lN+D+fl5dH96YMl4ebb3+h2fZuLBWHQbapDY4zxawjjjaqqKscULkUKsSBhoKSkJHH"+"ChAnfNUp+fwyN/FXJrw8L"+"wodXMjnyOoTxB/Q7otRVFUQgYeTAgQPDExMT70UgvwRu10049ZdFkFcTCKwG3xyAMF7q7OzcLSttw4+4WGFk/fr1dLuOTJw4sZJBNk6ZJb9"+"RXKzIklu6WEbfIbTfwjX7"+"r+Li4sM1NTViNSKAWJAIcezYsfiWlpZpycnJC+B2zayvr08vKiryQihfwWJswj/hU11P4yiJvggiAokwlZWV6WlpafeeO3fu8a1btx5yu92"+"rEIAfRZfkMiKOpv0voMgfvJ1fuOAAAAAASUVORK5CYII=",t,i,s);e.name=UYt.cube;return e}static get cube(){return i.h3e_()}static o3e_(t,i,s){const e=(new At).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0"+"QA/wD/AP+gvaeTAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3wQXCREv4CvoegAAEGhJREFUeNrNW22MHEV6fqqqu2dndnbXYwMnlKzxB3E"+"Ar5FYnfEhWUgHOn5cjoMo5g8gE4idiNzBRQSMdAoRioLukO4Hh3PgxDgIHQGLQxwfOQ6Qkh+RCDZsEIG176xwsmVfRNDinfXOzkd3V9WbH9PVW11T"+"PTbYJhmpNDPd1VX1PvW+b71fzXCePkQExlj+GwADwLPbDAA5j9jXCIA2z5/PT3A+iCYiKKU4EXEAGsDIPffc85V33333ilOnTl0mpfyK1noVEQVExD"+"nnbc75fBRFn05MTBxZt27d0Weeeea/iagDgEkpKQxD7QL7/w4AKSUjIgFA33333Wvffvvtb7ZarT9QSl0F4CLOOYQQYIwVGgAopdBut9FqtXD8+HF"+"ccsklJ4UQ/zE2Nvbali1b3iSiowCgtVZ9HM4NEOxc7Hi73ea1Wo2/9dZbYw888MC35+fnv6O13iyEQBiGMIQb4jnnA4vXWuffWmtIKfNvKSU45zON"+"RuOJXbt2vXr77befSpJERVHUl62zAOKsAEiShIVhKN577736bbfddl+73f6uEKIRhiHCMIQQAkEQ5MQbwjnvqwJHR0BrDSKC1hpKKUgpoZSCUgppm"+"iJNUyil5ur1+u59+/bt3rp1a1spJYMgoC8NALPrWuuAMRZOTU3d1Ww2/yYIgpVRFMEQHwRBgfggCLwAGOJtAJRSBRBMMyAkSQIp5alGo/H92dnZpz"+"udTjo6Oiq/iFh8bh2glGJEJLZt23b5wYMHn2KMXV2r1WAT7+MAznnebBAMqAYIpRSIaEAEbADCMESaphOLi4s/mZycvPOaa665k4h+naap8pwu544"+"DWq0Wr9frfGpqamez2Xy8UqkElUoFURTlzeUAGwBXAdpiYLO/2X0DgC0ChgNMi+MYcRyrFStWfO/QoUNPtdvttF6v63MOwNzcHL/gggtG1q5d+7iU"+"8k9GRkZQqVRgAKhUKoXdD4Ig5wIbAFsB2uxqiHdFwBBvc4ABIY5jJEmCXq+HbreLMAyfPnr06D1zc3O9iy66SJ0zEWi32+L48eP16enplwBcV6vVcD"+"oAbBFwTwEjArbdYIPgKsEoipAkiWF9JEmSj2efLN1u987Jycm1zz333B82m81Wo9FQZ80Bn332Ga/VarUNGzb8knO+tVaroVKpoFqt5oRXKhWEUYRKF"+"CIMI68StPWAKwZGB7ingK0DbC6w2d9wQBzH6Ha76PV6UEr9+4svvvjN9evXty688EL9hQFoNpt8xYoVI6tXr/45Y+wGs/PVahWVSiXngmX5jxBFy+zvA"+"8C2A9zddznANN8pYMk/4jjOQeh0Ouh2uyCifzl+/Pi3FxcXexMTE/pziUAmh0wIwdasWbMXQIH4kZGRgggY9rfFwBDv2gE28QVDiDRAy6eAC0CapgNK1"+"T1ZDKCZcXb9mjVrnjx27NgOKSUJIch3RHoByAYKNm7c+GdKqVsN8b5mEx9FUb77Lge4StBdDBFBkwbpQSUopUQQBLns+wh37QqtNTqdzvapqal3Zmdnn"+"2KMee2EoOSsD2655ZbfX1hYeMxWeD7ibQ6wj0JjBucACAHOGIQQADBgB1icN8ABaZrmhKdpOiBGNlHucdpsNndv27btbSL6FWNMDuUAIkKv12Oc8/Cd"+"d955plKpCEOgj2hzfZgdsAwAh+DlvoCtA2xjSEoJIUQOQhkXmec9uiQ4ePDgPgDXJkmiwjAsiELgYX2xcePGuzjn0y6xURQVuME+Ag3x5tsAwAOBgAsI"+"zsEdZ8iwbJkvEASB7QyVepIuAB4FunnTpk1//NFHHz3lckEBgE6nw1955ZXxhYWFvzXmra/ZLO+zBAunQCAQiKBAgOsLZL5FYecMCLbuGKY/XA5yzeiT"+"J0/+4IUXXvhZp9OZr1arORcwZ6Bgw4YND8Vx/Nf1eh21Wg2jo6OoVquo1WqoVqv5KeA7Bn0AlJnC4Ayg/gIMEC7xdkvSBDKVXlO41+sVbIFut5sfh+1"+"2G51OB0tLSxgZGXnoyJEjP7S5IDAISilZp9Opttvt79ZqtQI728S519zmWoGnc4fN7vtEQCkFqRR4mgIM4Ix72d48Z+uNKIryb+NALS0t3ffGG2/8JE"+"3ThSAIiDHWB8DI/vT09DYhxErbnB1GvL3bZX7AgB0gMjYGGyoCpi+XHGl/kWBgQxWeIdjIvk18Zk43du3adfOHH374U8MFgXUMUbPZ/NMyj84l0Fxz3"+"eBhdgA3ipAzcFv6iKAzrshlPyPeAOU76nyWo5Qyn98Qb7dms3k3gH8qiECSJHznzp3rtdZfc4l25bnsv4/40/kCfSXEoBlB6GWCOOfQWnuJL4scmbnC"+"MMxBsNdoWq/X23zfffddnCTJiTAMNQeAKIr4zMzMN8qItOW57L4d+fH1te8XxCQKEIrAazr7xhq2FndNZRv45ptv3hiGIc91AAC9tLR0o09r+4h0m7t"+"At/mOMhgxYABxAjSg+bL8p0p6lV0QBANyX7Ym1x03a2y1Wt8C8CQABJn8V6SUX42iaGAXhg3uI3KgWXYAy0xhzjmIM3Cy4lecwPTyqRCwANpSelprCC"+"GKSpLz3FhyOcdeV26UZc9kYfqIiLocAN++fftqAKvs3Xe9roGjTPDCzubmrv3fJj7guWUIwRGgD0YgBARjYKIIoBnfB6wbYLG/XY6zaTBAALjo1ltvX"+"Q2ABwDYkSNH1tseljuJ63oGnsGNrV/mpgouwBnPz3LGlxUbEwKMCFpQnjvjmsDEMvub3fet0QbBntfdQPv6sWPH1gH4mGfBzt8ri9b4BgVj4Kxo2ORG"+"ilieWDBrB1kxIjzQRH+MHOTMcWKcDQRS3G/fbrtz2aE4xhiazeYGACwAgDRNf8fu4Gu2Bde/5vR3gDjdAgYjQgDngKais8M5h2Z6EDw2GF1yN8w3r7m"+"epunFMNlapdRK1zw1hNoDF1xZhgIbk8jAARt4xv5d8AXscVnmG5iAqTF9UeL9CeuauzbLuzUEu2tQSl0MoG8HEFFYltp2CbGv5fewDBgYAzkh77JcgD"+"tuAXwwEEcOgDsv1wCxzERm/qjWaa4xAMzonND3kJ22GggnkZWDYQDTVDqhZp57VJ56AwEE6vdhxbnzNbBsDKJCLsgHdMk8EQAyzlDHF55yAxZEBAL1k"+"fcAZe4zZhkvjBBoQEMXwuBuXrAwTkaRRjFYMjCXs0E+J8l9xgKqk3MA53ze2Neu5TWQv9MAdBbAxOCk0ATS1n9FAynwfgCUMibKflORaNJ9DjCgukR7"+"r9nr8Mxp9xFCfJorwSiKfmvn5n1I5t9mVwggXfTFyXm28JwT9iLSWX+/X28HSLXWOajLQRMa8ApdR8nHCeZ/FEWf5ACMj49/bBPv/nbzdqQ1lO6HnTS"+"y/qShUIzqEIohKnNNadUnSOu8aaL+7qvl5/NssaZ8vmVA9EAQ1QZMY5AOu42NjX1sANCbNm06YsfibWJNsweTSvV3QCkoM6hZuNVfKZWJCorAmAU5/j"+"w5iywQ5ADp9nH7alXs7z571VVX/docg7R3795PAMz74nG+a0TLxJO0BpYKivTAIuxghZIqB8uEvPocoaGkGpjbtw73dw6Ctp51nrcbgP/Zs2fPpwAoy"+"LRxTwgxo5S6we1sMrRlg9n9hBD9aI4Tu2P9syw3SIw+YJnNkEeFnN21S2R8axoIfzuVJWXrFkJ8AKBnxwP42NjYa0tLSzeYB+1J7PCyHYGxCbezNr5I"+"jhCiEPHJTWFDfCb/blDUDo7a6/KCk8oBwt11p2mKer3++rIXToQ0TfWWLVvesgn1Ee1masvu9Rc8fKzlMbJxnHtSSaTKfk4OEH26sc0a7ftKKVx//fW"+"vpWlKABBku6SJ6DeTk5MzUsqv2oOY3JwJLZnfJl1lOx5uzg+6f64bjewtk8vqQ93EhqK+TpGqrzfy6hCHOB+hNsH2vWy9B3bv3n0iK+AsZIZYo9F4cm"+"FhYZ87gUu8W6FR7uEROLIji4sB9mfI7HkHAK0UZA6AgjLckkqkMnGrxQbKZ9z79rVGo7G3r36Mz7FsIKjnn3/+RaXUgjuI/W2AsbMzbl+7kkMmKdLEP"+"16SpkhTiSR15rB31iZEppCJLC2YctfpNqXUqccee+znUkplNimwnAYios7o6OjuOI4fsmPp9s6XxQrcsLUdwMw0r7dKrO/K0aClpzRSktBpeYWIDwgXB"+"Buger3+o+uuu67F2LIrxp3KT/3www8/LqVc8NXiFHZvSCvrY8YpckKMJPaMkyaQPf8aysa0+5jSGYsrFx599NEn4jjWpdnhSqWiiWjhkUce+avFxcW/c"+"2Pxw4qchtX5mCPTDWW5StCbG3QUmlsi5xJr/7bvNxqN7998880txpgeWiCRpqk6dOjQP05OTm6P4/jq02V2fC6pISAMwwFb4UyqxGxrz60UtTnILpKyQ"+"bGvx3EMrfXM7Ozs03EcD5TJBJ4ABhFRevXVV+84cODADOc88ml6X5GjvfNBEORHny+E7QYsCs6Pp0TGpwPs9LhbLWZdSzdv3ryDiOTIyAidtkgqQ0gS0"+"a+uuOKKBxYXF388kNXx1Pjayi8MAqgohFSqH/d3QthlJTJllaLueR/HcUHm3RoB07rdLiYmJv7y5ZdfPnTGRVLmHI/jWB0+fPjv161bt6nb7e7whZds1"+"jXpaK01ZBAgzDS/L0PsiweWcYBr3JSJgAHAFEhkpbPPHD58eE8cx6qsknxooeTS0hIfHR0dWb169T8zxr7uK5crFkoO1gj5FKhPj5QpQZsDbD1gKzq3U"+"rTT6UBr/a8nTpy4sdVq9cbHx/UXLpWdn58XURRVL7vssrxU1lctVloj9DlKZcvy/a4Y+CpF7fIYrfXb+/fv/9bll1/eWrVqlTrravGFhQVx6tSp2tatW"+"18B8HW7TsgtlraLJd33BdxiaTcY6nOHtdbeanFX4xv2J6J/279//01XXnlla3x8/OyLpc3n5MmTYuXKlZV169b9OEmSHaZeeBgAhvXtFPXpqsSGvTIzT"+"AcYmT969Oifz83NxWdaLv+5XpjIdIKYmpra0Ww2H6tUKpFPB5xJldjpKjzPpFjaAkE2Go3vzc7O7l1cXFTDiqPP+p2hbrfLRkZGxE033TT1/vvv/wOAz"+"aZa1FdH5IqBL0vkEwE3qOFz0Hq9HojoP6enp+989dVXP+p0Omp0dPT8vTLjJDUCAOHGjRvvajabPwjDcGxYqazPGXJFwC6SskNiPktQSjk3MTHxw8OHD"+"z8BQJad8+f1tTkpJRNCBC+99NLYgw8++BedTuc7dpmdawe42WKfQeU7BZwATbNer/9o586d++6///6TvV5PVavVL++1OV8qK0kSHkUR++CDD+rbt2//o"+"2azuVNr/bWBinGH+LKiR19Mj3N+YMWKFU+9/vrrP5ucnOx0u11Vq9XO+g3Sc/p2slKKcc4FALrjjjvWz8zMfKPVat2slJpmjK0s4wDXn8jAmBdCzNTr9"+"deuvfbaX+zZs+e3AEhKqcyLkv/nr84Oe3k6TVMehqF5ebp67733XnjgwIGpdru9No7j31VKXQBghIgCzvki5/xkFEWfjI+P/+bSSy/9r2efffYEgB4A"+"rrXWnHNt64xz9Tlv76d7Xp/nn2M+DYC+jNfn/xccNsvIlVowbwAAAABJRU5ErkJggg==",t,i,s);e.name=UYt.t3e_;return e}static get t3e_(){return i.o3e_()}static r3e_(t,i,s){const e=(new At).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0"+"IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAJ18AACdfAR2GumoAAAmWaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7v"+"yIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29y"+"ZSA1LjYtYzE0NSA3OS4xNjM0OTksIDIwMTgvMDgvMTMtMTY6NDA6MjIgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk"+"5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS"+"4wLyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tL"+"yIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9i"+"ZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkN"+"yZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTktMTAtMTBUMTI6MTA6NTQtMDU6MDAiIH"+"htcDpNZXRhZGF0YURhdGU9IjIwMTktMTAtMTBUMTY6MzY6MzYtMDU6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE5LTEwLTEwVDE2OjM2OjM2LTA1OjAwIiBkYzpmb"+"3JtYXQ9ImltYWdlL3BuZyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1MTJmYWRkYy1mZmMyLTQ4NWMtODIyOS03Yzk3YzY1YmEzMTMiIHhtcE1NOkRvY3Vt"+"ZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDoyY2YwYzBiNi0yNTFjLWU5NDItYTA5YS02ZmYyZjcxOTY4NTUiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0"+"ieG1wLmRpZDo4M2QzOGVkOS03NmNjLTQ0NTItYWMwZC01MGJiODUwMGI3ODEiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPS"+"JzUkdCIElFQzYxOTY2LTIuMSI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlS"+"UQ9InhtcC5paWQ6ODNkMzhlZDktNzZjYy00NDUyLWFjMGQtNTBiYjg1MDBiNzgxIiBzdEV2dDp3aGVuPSIyMDE5LTEwLTEwVDEyOjEwOjU0LTA1OjAwIiBzdEV2"+"dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoTWFjaW50b3NoKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Oml"+"uc3RhbmNlSUQ9InhtcC5paWQ6NmE3NTNiYjMtZDUwNi00MzNiLTk5NjktMjNlODYyODM2ZjgwIiBzdEV2dDp3aGVuPSIyMDE5LTEwLTEwVDEyOjExOjE1LTA1Oj"+"AwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0R"+"XZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+"+"IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJkZXJpdmVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJjb252ZXJ0ZWQgZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9"+"zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZWFjYTVlNDctNzBmNC00OW"+"NlLTlmZmQtZjNiMGU1MDhmODM4IiBzdEV2dDp3aGVuPSIyMDE5LTEwLTEwVDEyOjExOjE1LTA1OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b"+"3Nob3AgQ0MgMjAxOSAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9"+"InhtcC5paWQ6NTEyZmFkZGMtZmZjMi00ODVjLTgyMjktN2M5N2M2NWJhMzEzIiBzdEV2dDp3aGVuPSIyMDE5LTEwLTEwVDE2OjM2OjM2LTA1OjAwIiBzdEV2dDp"+"zb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SG"+"lzdG9yeT4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NmE3NTNiYjMtZDUwNi00MzNiLTk5NjktMjNlODYyODM2ZjgwIiBzd"+"FJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjgzZDM4ZWQ5LTc2Y2MtNDQ1Mi1hYzBkLTUwYmI4NTAwYjc4MSIgc3RSZWY6b3JpZ2luYWxEb2N1bWVudElEPSJ4bXAu"+"ZGlkOjgzZDM4ZWQ5LTc2Y2MtNDQ1Mi1hYzBkLTUwYmI4NTAwYjc4MSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGF"+"ja2V0IGVuZD0iciI/PkFrnbcAAA4lSURBVHhe7d1rt6/lFMfxneGZ4VX02Kvw1LsoSQcUUVHRgRJtGkSlKEKElKKGkeRQVE6hqK3SQTopISTb/K65tnZ777XW/3"+"AfrsP3M8Yca64e7tb6rf993dc1r8P27t27S1KfXrP5VVKHDACpYwaA1DEDQOqYASB1zACQOmYASB0zAKSOGQBSxwwAqWMGgNQxA0DqmAEgdcwAkDpmAEgdMwCkj"+"hkAUscMAKljBoDUMQNA6pgBIHXMAJA6ZgBIHTMApI4ZAFLHDACpYwaA1DEDQOqYASB1zACQOmYASB0zAKSOGQBSxwwAqWOH7d27d7PdtWvPnj2XxJc35neje23U"+"67NVZ/x/P50bDj/88Ddt9gc5MAAOjy+/jHrdxn+QVLN/Rb0hAuD+/PZgBz4C7Ik6PVtJldsdteUvPw61BvDxqDuzlVSpx6LOyXZrhwqAl6OOiHpp4ztJNXp31N+"+"y3dpWbwHuiTo3W0mV+UHUl7Ld3navAfn48NtsJVWCT/Bvi3pldX8b2wUAK4hHRv134ztJNeBV/i+y3dl2AYDboz6RraTCPR11WraL2SkA8N6oh7KVVLBTop7Jdj"+"GLBAAriUdnK6lQd0Vdnu3iFgkA3BR1ZbaSCsOC3/FRS6/XLRoAOCHqyWwlFYQ/zndku5xlAuDZKFJGUjn+GnVytstbJgDwlahvZiupAGdGPZHt8pYNABwT9Xy2k"+"mZ0X9SF2a5mlQB4POqkbCXN6O1Ra53ZWSUA8Jmo72UraQbXRt2c7epWDQBeOxwV9eLGd5Km9M+oE7Ndz6oBgAeizshW0oQ+HPVgtutZJwBwQdTd2UqaAL/4H8p2"+"fesGgMNDpGnx0Z9HgEGsGwBgiCgfSSSNi0U/Fv8GM0QA4Kwo3klKGgefsnntN6ihAsDhIdK42PAz+B/ZoQIAP4q6KFtJA2KrL1t+BzdkAODUqD9mK2kgHPbh0M/"+"ghg6AF6IcHiINh2O+o83iGDoA8O2oL2QraQ2sqXEEf6EJv6sYIwDg8BBpfYz4YtTXaMYKAKaTDv7KQuoIA3hYUxvVWAGAL0ddn62kJb0v6qlsxzNmAIDhIaOsXk"+"oN42IPLvgY3dgB8GjUe7KVtAAW/Ljai3M2oxs7AHBx1G3ZStoBl3pyueckpggAEo1twoOdYJIaxSU8XOs9mSkCAPdHvT9bSVvgRu7Hsp3GVAGAj0b9LFtJB+CP5"+"O5spzNlAPwniuEhfJX0amye41TtpKYMAPB64/xsJW26YbMmN3UAgGONv89W6h5/9fnrP4s5AoC3AbwVGO2Ag1QR1sZ4/p/FHAEA3nN+OlupW8zOYOV/NnMFANgh"+"yE5BqVfvivpHtvOYMwAcHqKecbXeV7Odz5wBAFY+v5it1A1ehbPff3ZzBwCYG8D8AKkXDM/9dbbzKiEA+OV/R7ZS8zjjX8ydmiUEAK6KujFbqWlM+Xku2/mVEgB"+"gQZCFQalVzPdjzl8xSgqAR6KYfy61iI1vTPgt6vaskgIAn4r6YbZSU5jtz4z/opQWAA4PUYt45i9yNF5pAYDfRY1yD5o0E1b9/5xtWUoMAHBkmKPDUu1431/spb"+"mlBgA7pXgUcHiIaseOv2J/jksNANwddUG2UpXY68+e/2KVHABgkOhsZ6WlNXDKj9N+RSs9AF6MenOUw0NUm3OjOO9ftNIDAN+PmuSaJGkgD0ZVMfuyhgCAw0NUk"+"xOjqtjLUksAPB/FRaNS6W6Oujbb8tUSAOCq8auzlYr0UhTzLapRUwCAd6rPZCsVh9fW92Vbh9oC4Mmo2WaoS9vgTr+zs61HbQGAz0d9J1upGNzqy+2+VakxAPCW"+"qOr+sdUs7rngXv/q1BoAbLA4JVtpVi9HsTZV5Wa1WgMAnLD6UbbSbNikVu3J1ZoDgNFKbBOe/EplaRNvpE7Ltk41BwDujapu5VXN4Je/6tfStQcAzov6VbbSZPj"+"YX/0ZlRYCgN1XR0SxGCNNgQU/Fv6q/5lrIQDAvPXd2Uqj45Ufr/6q10oA4PSoPdlKo/lrVPGDPhbVUgA4PERTYGL1n7KtX0sBAOavfSZbaXAc9Lkw2za0FgBgT/"+"bj2UqD4qgvi87NaDEAuIXl2GylwTDkg2EfTWkxAMD/LEYyS0NgvBdjvprTagCAm1ifzVZaCwM+GfTZnJYDgLvYmkxtTYqTp4z4blLLAYAropp7btOkeOfPJR9Na"+"j0A4PAQrYrXyk2vJfUQAA9FvS9baWFc6Ml+/6b1EAD4RNTt2UoL+XgUV3s3rZcA4NSWw0O0qCei2PLbvF4CAL+J+mC20rZOjuLQT/N6CgDwOueebKVDuiPqymzb"+"11sA/DvqyCiHh+hQmDPJBrJuTpT2FgD4aRQLPNKBLo9iuEw3egwAMDzkD9lKGzhEdmq2/eg1AP4exQYhh4donzOinsq2H70GAL4b9dls1Tne93PRTHd6DgCwz7u"+"Z8U5aGTv+2PnXnd4D4C9Rx2WrTn0lij3/Xeo9APD1qK9lq85wSKzrI+MGQOJTAJ8G1Jdzoh7Ltk8GQGLv9zuzVSfuj+r+MhkD4BWfi+LNgPpwQlT3h8MMgFewJ4"+"C9AewRUNtu2KzuGQCvxu7Aqu971474q89ffwUD4GDc/PKTbNUgnvt5/lcwAA7GSUFODHJyUG1hxZ+Vf20yAA6NraEfylYN4do4B8TuxwDYGtODmCKkNnCfP/f6a"+"z8GwNZ4BGCOoMND6rdvwq+nPw9gAGyPScJMFFbdOOn3i2y1PwNgZ9wp0OS9cJ3gjD9n/XUIBsDOWDQ6OsqPj3Viyg/TfnQIBsBiuF+QewZVF+b7MedPWzAAFsdh"+"IQ4NqQ58YmPCL5N+tQUDYHHPRvEDpTow258Z/9qGAbCca6KuzVYF41YfbvfRDgyA5R0b5aJS2bjXz8e1BRgAy3s86qRsVaD7ojjQpQUYAKu5LOqWbFWYt0e9lK1"+"2YgCshhXmo6L+sfGdSsGAV17ZakEGwOr2RHHFmMpAGDvoY0kGwHo+FnVntpoZV7//MVstygBYz77hIT5zzouzGudnq2UYAOv7VdR52WomXO7xz2y1DANgGGdH3Z"+"utJsain5uzVmQADINJszwKuO98Wjx68dpPKzIAhvPjqE9mq4mw4YeNP1qRATAszp4/nK1GxlZftvxqDQbAsBgewu1CGh+HfTj0ozUYAMO7KYqjqBoPx3z9Nx6AA"+"TAOXks9ma0Gxt4LrnN3RNsADIBxPBPFGGoN75Kou7PVugyA8VwddV22GgjB6uWtAzIAxnVM1PPZagD88hMCGogBMC4uo+Q+Oq2Piz34+K8BGQDjuzTq1my1Ihb8"+"WFPxmraBGQDj44eXOwZf3PhOq+BSTy731MAMgGk8EPX+bLUkNlf5GDUSA2A6F0T5+mp550SxlqIRGADT4Ypqh4cs5/6o3dlqDAbAtFjJdnLN4pjxx1FrjcQAmN5"+"ZUR5h3dn1UTdkq7EYANNjdBVvBRwesjX+jRz0MQEDYB4/jPpUtjoEHpMY9KmRGQDzOSXqkWy1H0Z7M+JbEzAA5vNC1NHZaj/vivLGpYkYAPO6MeqqbBW+F/XVbD"+"UFA2B+74h6KtuusU/CGQoTMwDm93SUK967dl0U9etsNRUDoAwcdvlWtl3iE9AZ2WpKBkA53hrV65Rbxqk/l62mZACU49Go92TblbuiLs9WUzMAynJxVE/n3tkNe"+"ezmV83AACgLw0M4MdjLTbf85f9ptpqDAVCe30d9INum8czPs79mZACU6SNRP8+2Waz6u/9hZgZAmdgUc8Tm1xbxvp/3/pqZAVAuPgHwSaBF7PhrNdyqYgCUjbUA"+"1gRawl5/9vyrAAZA2fYND2nlIkxO+XHaT4UwAMp3WxT7A1rAOX/O+6sQBkAd2CHITsGaMeHHgaiFMQDqwBkBzgrU7MSoXjY4VcMAqAenBTk1WCMGn1ybrUpiANS"+"FuQHMD6gJc/0ZeqICGQB1Yedcbb9M3OzDDT8qkAFQH2YI8pG6Btzpx91+KpQBUCcWBJkqXDpu9eV2XxXKAKgT79K5V6BkzDWoddGyGwZAvbhZiBuGSvRyFPv9W9"+"nB2CwDoF5M0WGbcInv1i+J4iZkFc4AqBu3DHPbcEmeiTotW5XOAKgf22tL+mvLLz8hoAoYAPV7KYo5gjx3z40g4uO/KmEAtOHuqAuynQ0LfsdElRBEWpAB0A5m7"+"D2Q7SyujLo9W9XCAGjHi1FzDQ/htOLJ2aomBkBbbo26NNtJnRn1RLaqiQHQHrbfsgd/KryKvDBb1cYAaM/zUSzGTYUjyryJUIUMgDZdF3V1tqNiyMfN2apGBkC7"+"2Iv/bLajYAsyY75UMQOgXU9GnZDtKNiByKBPVcwAaBvv5m/KdlAcR2bEtypnALTvLVFDD+Xgcg8u+VDlDID2PRw15DXcLPpxvZcaYAD04ZNRP852Lbzu47WfGmE"+"A9IHhIZwYZET3Otjww8YfNcIA6Me9UWdnuxK2+rLlVw0xAPpyXtQ92S6Nwz4c+lFDDIC+8Ax/RNSyZ/bviOKVohpjAPTnzqiPZbsQ1g+Oj3LCb4MMgD6dHrUn2x"+"1dHnVXtmqNAdAnNvEcFbXTX/XnoobcQ6DCGAD9uiXqsmy3xJgxLiRVowyAvp0U9Xi2B+FtwUXZqlUGQN/4iH9ctq/Co8GxUf/Z+E7NMgD0jahrsv0/LvXkck81z"+"gAQeM23b3gIJweZK6gOGAAC23zfme2uc6KmHCqqGRkA2ueKKE4N7t74Tl04bO9eN3hJvfITgNQxA0DqmAEgdcwAkDpmAEgdMwCkjhkAUscMAKljBoDUMQNA6pgB"+"IHXMAJA6ZgBIHTMApI4ZAFLHDACpYwaA1DEDQOqYASB1zACQOmYASN3atet/m2RuaReHGYUAAAAASUVORK5CYII=",t,i,s);e.name=UYt.$5e_;return e}static get $5e_(){return i.r3e_()}};s=i=t([_s("geotoolkit3d.util.Texture")],s);return s}(),2,"eyJiYWxsTG9hZGVyIjoibDNlXyIsImJhbGwiOiJpM2VfIiwic29saWRkb3RMb2FkZXIiOiJlM2VfIiwic29saWRkb3QiOiJfNWVfIiwiY2lyY2xlTG9hZGVyIjoiQTNlXyIsImNpcmNsZSI6IkFmaV8iLCJzcXVhcmVMb2FkZXIiOiJuM2VfIiwic3F1YXJlIjoiZnJfIiwiY3ViZUxvYWRlciI6ImgzZV8iLCJzcGhlcmVMb2FkZXIiOiJvM2VfIiwic3BoZXJlIjoidDNlXyIsInRyaWFuZ2xlTG9hZGVyIjoicjNlXyIsInRyaWFuZ2xlIjoiJDVlXyIsImdldENsYXNzTmFtZSI6IkRfIn0g");const HYt={sphere:KYt.t3e_,square:KYt.fr_,cube:KYt.cube};var qYt=Ci(function(){let i=class t extends fUt{constructor(t){super();const i=qi(t,{name:"default",colorprovider:"red",symbol:HYt["sphere"],symbolminsize:2,symbolmaxsize:7,alphatest:.8});this.name=i["name"];this.u3e_=-Number.MAX_VALUE;this.a3e_=Number.MAX_VALUE;let s;s=i["data"]["xyz"]!=null?i["data"]["xyz"].length/3:i["data"]["x"].length;const e=new lt(new Float32Array(s*6),6),A=new J(e,3,0),n=new J(e,1,3),h=new J(e,1,4),r=new J(e,1,5);let o,l;if(i["data"]["xyz"]!=null){o=i["data"]["xyz"];for(let t=0;t<s;t++){l=i["data"]["visible"]!=null?i["data"]["visible"][t]===!0?1:0:1;A.setXYZW(t,o[t*3],o[t*3+1],o[t*3+2],l)}}else{const t=i["data"]["x"],s=i["data"]["y"],e=i["data"]["z"];for(let n=0;n<t.length;n++){l=i["data"]["visible"]!=null?i["data"]["visible"][n]===!0?1:0:1;A.setXYZW(n,t[n],s[n],e[n],l)}}i["data"]["sizes"]==null?this.g3e_([1]):this.g3e_(i["data"]["sizes"],i["data"]["sizemin"],i["data"]["sizemax"]);this.pi_=i["data"]["values"];this.c3e_=i["colorprovider"];const u=new LYt(i),a=new z;a.setAttribute("position",A);a.setAttribute("cgpointVisible",n);a.setAttribute("cgpointSize",h);a.setAttribute(ixt.TXe_,r);this.I3e_=new wt(a,u);this.f3e_=()=>{if(this.pi_==null)return;const t=this.I3e_.geometry.getAttribute(ixt.TXe_);for(let i=0;i<this.I3e_.geometry.getAttribute("position").count;i++)t.setX(i,this.pi_[i]);this.I3e_.geometry.getAttribute(ixt.TXe_).needsUpdate=!0};this.add(this.I3e_);this.setOptions(i)}g3e_(t,i,s){let e=i,A=s;Array.isArray(t)||(t=[t]);if(e==null||A==null){e=Number.MAX_VALUE;A=-Number.MAX_VALUE;let i;for(i=0;i<t.length;i++)if(!isNaN(t[i])){e=Math.min(e,t[i]);A=Math.max(A,t[i])}}this.u3e_=A;this.a3e_=e;this.YUt_=kxt.y4s_(t,0,1,this.a3e_,this.u3e_)}setOptions(t){if(t==null)return this;super.setOptions(t);let i=!1;if(t["data"]!=null&&t["data"]["values"]!=null){i=!0;this.pi_=t["data"]["values"]}const s=qi(t,{symbolminsize:this.C3e_,symbolmaxsize:this.d3e_,colorprovider:this.c3e_});let e=this.C3e_!==s["symbolminsize"]||this.d3e_!==s["symbolmaxsize"];if(t["data"]!=null&&s["data"]["sizes"]!=null){this.g3e_(s["data"]["sizes"],s["data"]["sizemin"],s["data"]["sizemax"]);e=!0}this.C3e_=s["symbolminsize"];this.d3e_=s["symbolmaxsize"];this.c3e_=s["colorprovider"];if(e){const t=kxt.y4s_(this.YUt_,this.C3e_,this.d3e_),i=undefined,s=this.I3e_.geometry.getAttribute("cgpointSize");for(let i=0;i<s.count;i++)s.setX(i,t[i%t.length]);s.needsUpdate=!0}i&&this.f3e_();if(t["data"]!=null&&t["data"]["visible"]!=null){const i=this.I3e_.geometry.getAttribute("cgpointVisible");let s=0;if(Array.isArray(t["data"]["visible"]))for(;s<i.count&&s<t["data"]["visible"].length;s++)i.setX(s,+t["data"]["visible"][s]);else for(;s<i.count;s++)i.setX(s,+t["data"]["visible"])}this.I3e_.material.setOptions(s);this.invalidateObject();return this}JV_(){const t=this.I3e_.material.JV_();t["data"]={values:this.pi_,sizes:this.YUt_,sizemin:this.a3e_,sizemax:this.u3e_,visible:[]};t["symbolminsize"]=this.C3e_;t["symbolmaxsize"]=this.d3e_;t["colorprovider"]=this.c3e_;const i=this.I3e_.geometry.getAttribute("cgpointVisible");for(let s=0;s<i.count;s++)t["data"]["visible"][s]=i.getX(s)===1;return Pi(t,super.JV_())}B3e_(t,i){if(!this.ofs_(t))return this;const s=this.I3e_.geometry;if(i["visible"]!=null){s.getAttribute("cgpointVisible").setX(t,i["visible"]?1:0);s.getAttribute("cgpointVisible").needsUpdate=!0}if(i["size"]!=null){this.YUt_[t]=(i["size"]-this.a3e_)/(this.u3e_-this.a3e_);s.getAttribute("cgpointSize").setX(t,this.C3e_+(this.d3e_-this.C3e_)*this.YUt_[t]);s.getAttribute("cgpointSize").needsUpdate=!0}if(i["value"]!=null&&this.pi_!=null){this.pi_[t]=i["value"];s.getAttribute(ixt.TXe_).setX(t,this.pi_[t]);s.getAttribute(ixt.TXe_).needsUpdate=!0}return this}Z5e_(t){if(!this.ofs_(t))return null;const i=this.I3e_.geometry,s=i.getAttribute("position").array,e=t*6;return{visible:i.getAttribute("cgpointVisible").getX(t)===1,size:(i.getAttribute("cgpointSize").getX(t)-this.C3e_)/(this.d3e_-this.C3e_)*(this.u3e_-this.a3e_)+this.a3e_,value:this.pi_?this.pi_[t]:null,position:[s[e],s[e+1],s[e+2]]}}w3e_(t,i){t=t||"default";if(this.name!==t||!this.ofs_(i))return null;const s=undefined,e=this.I3e_.geometry.getAttribute("position").array,A=e[i*6],n=e[i*6+1],h=e[i*6+2],r=e[i*6+3],o=e[i*6+4],l=e[i*6+5],u=new lt(new Float32Array(6),6),a=new J(u,3,0),g=new J(u,1,3),c=new J(u,1,4),I=new J(u,1,5);a.setXYZ(0,A,n,h);g.setX(0,r);c.setX(0,o);I.setX(0,l);return Ss({position:a,cgpointvisible:g,cgpointsize:c,cgcolormapvalue:I},["cgpointVisible","cgpointSize","cgcolormapValue"],"PointCloud.getPointByIndex")}ofs_(t){const i=this.I3e_.geometry.getAttribute("position").count;return Number.isFinite(t)&&t>=0&&t<i}Q3e_(){return this.I3e_}};i=t([_s("geotoolkit3d.scene.pointset.PointCloud")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwic2V0UG9pbnRPcHRpb25zIjoiQjNlXyIsImdldFBvaW50T3B0aW9ucyI6Ilo1ZV8iLCJpc1ZhbGlkSW5kZXgiOiJvZnNfIiwiZ2V0UG9pbnRDbG91ZCI6IlEzZV8ifX19");var JYt=Ci(function(){let i=class t{create(t,i){const s=[],e=t["data"];e["index"]!=null&&s.push(this.E3e_(t,i));(e["pointindex"]!=null||e["index"]==null&&e["lineindex"]==null)&&s.push(this.p3e_(t,i));e["lineindex"]!=null&&Array.prototype.push.apply(s,this.m3e_(t,i));return s}E3e_(t,i){const s=t["data"],e=new z;e.setAttribute("position",new ut(new Float32Array(s["position"]),3));e.setIndex(new ut(new Uint32Array(s["index"]),1));i["mesh"]==null&&(i["mesh"]={});if(i["mesh"]["zup"]!==!0){e.applyMatrix4((new u).makeRotationZ(Math.PI/2));e.applyMatrix4((new u).makeRotationY(Math.PI/2))}s["colors"]!=null&&e.setAttribute("colors",new ut(new Float32Array(s["colors"].values),3));s["normals"]!=null?e.setAttribute("normal",new ut(new Float32Array(s["normals"].values),3)):e.computeVertexNormals();const A=i["mesh"]["material"]!=null?i["mesh"]["material"]:new x({color:"lightgrey"}),n=new W(e,A);i["mesh"]["position"]!=null&&n.position.copy(i["mesh"]["position"]);i["scale"]!=null&&n.scale.multiplyVectors(i["scale"],n.scale);i["mesh"]["scale"]!=null&&n.scale.multiplyVectors(i["mesh"]["scale"],n.scale);return n}m3e_(t,i){const s=t["data"],e=new ut(new Float32Array(s["position"]),3);return t["data"]["lineindex"].map(((t,s)=>{const A=new z;A.setAttribute("position",e);A.setIndex(new ut(new Uint32Array(t),1));i["line"]==null&&(i["line"]={});const n=i["line"]["material"]!=null?i["line"]["material"].clone():NYt.F5e_(new hl("lightgrey")),h=new dt(A,n);if(i["line"]["zup"]!==!0&&s===0){A.applyMatrix4((new u).makeRotationZ(Math.PI/2));A.applyMatrix4((new u).makeRotationY(Math.PI/2))}i["line"]["position"]!=null&&h.position.copy(i["line"]["position"]);i["scale"]!=null&&h.scale.multiplyVectors(i["scale"],h.scale);i["line"]["scale"]!=null&&h.scale.multiplyVectors(i["line"]["scale"],h.scale);return h}))}p3e_(t,i){const s=t["data"],e=undefined,A=Object.keys(s).filter((t=>t!=="position"&&s[t]["type"]==="scalar"&&s[t]["values"].length>0)).map((t=>s[t]));Object.keys(s).filter((t=>s[t]["type"]==="field")).forEach((t=>{s[t]["arrays"].forEach((t=>{t["stride"]===1&&t["values"].length>0&&A.push(t)}))}));i["pointcloud"]==null&&(i["pointcloud"]={});let n=A.filter((t=>i["pointcloud"]["attributes"]!=null&&t["name"]===i["pointcloud"]["attributes"]["sizes"])),h=A.filter((t=>i["pointcloud"]["attributes"]!=null&&t["name"]===i["pointcloud"]["attributes"]["values"]));if(n.length===0&&h.length===0&&A.length!==0)if(A.length>1){A[0]["values"].length>0&&(n=[A[0]]);A[1]["values"].length>0&&(h=[A[1]])}else A.length===1&&A[0]["values"].length>0&&(h=[A[0]]);let r=null;if(s["pointindex"]!=null){r=[];for(let t=0;t<s["position"].length/3;t++)r[t]=!1;for(let t=0;t<s["pointindex"].length;t++)r[s["pointindex"][t]]=!0}let o="red";if(h.length>0){const t=NA.oA_(h[0]["values"]);t[0]!==Number.POSITIVE_INFINITY&&t[1]!==Number.NEGATIVE_INFINITY&&(o=(new bo).setScale(po.lm_,t[0],t[1]))}const l=new qYt({data:{xyz:new Float32Array(s["position"]),sizes:n.length>0?n[0]["values"]:null,values:h.length>0?h[0]["values"]:null,visible:r},symbolmaxsize:6,colorprovider:i["pointcloud"]["colorprovider"]!=null?i["pointcloud"]["colorprovider"]:o});if(i["pointcloud"]["zup"]!==!0){l.Q3e_().geometry.applyMatrix4((new u).makeRotationZ(Math.PI/2));l.Q3e_().geometry.applyMatrix4((new u).makeRotationY(Math.PI/2))}i["pointcloud"]["position"]!=null&&l.position.copy(i["pointcloud"]["position"]);i["scale"]!=null&&l.scale.multiplyVectors(i["scale"],l.scale);i["pointcloud"]["scale"]!=null&&l.scale.multiplyVectors(i["pointcloud"]["scale"],l.scale);return l}};i=t([_s("geotoolkit3d.data.loader.vtk.VTKFactory")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJjcmVhdGVNZXNoIjoiRTNlXyIsImNyZWF0ZUxpbmVzIjoibTNlXyIsImNyZWF0ZVBvaW50Y2xvdWQiOiJwM2VfIn19LCJnZXRDbGFzc05hbWUiOiJEXyJ9");var PYt=function(){let i=class t extends FUt{load(t,i){const s=this,e=new nt(s.Q0e_),A=i["onLoad"],n=i["onProgress"],h=i["onError"];e.setResponseType("arraybuffer");e.load(t,(t=>{s.parse(new My({stream:new Dy({buffer:t,stride:1})}),A,h)}),n,h)}parse(t,i,s){bYt.k5e_(t).then((e=>{e||s("Warning: Only ASCII format is supported");bYt.parse(t).then((t=>{i(t)}),s)}),s)}};i=t([_s("geotoolkit3d.data.loader.vtk.VTKLoader")],i);return i}();var VYt=Ci(function(){var i;let s=i=class t{constructor(t,i,s,e,A){this.reset();t&&i&&s&&e&&this.dt_(t,i,s,e,A)}dt_(t,s,e,A,n){n=n===!0;this.GBt_[2]=A;this.y3e_=i.D3e_(t,s,e);if(!this.y3e_)return;this.M3e_(t,s,e,n);this.v3e_=A<this.zmi_[2]&&A>this.Xmi_[2];if(!this.v3e_)return;const h=[this.b3e_[0]-this.zmi_[0],this.b3e_[1]-this.zmi_[1],this.b3e_[2]-this.zmi_[2]],r=[this.Xmi_[0]-this.zmi_[0],this.Xmi_[1]-this.zmi_[1],this.Xmi_[2]-this.zmi_[2]],o=[this.Xmi_[0]-this.b3e_[0],this.Xmi_[1]-this.b3e_[1],this.Xmi_[2]-this.b3e_[2]],l=i.N3e_(h),u=i.N3e_(r),a=i.N3e_(o);this.S3e_=i.N3e_(kxt.cje_(h,r));if(this.Xmi_[2]===this.b3e_[2]&&this.Xmi_[2]===this.zmi_[2]){this.GBt_[0]=(this.zmi_[0]+this.b3e_[0]+this.Xmi_[0])/3;this.GBt_[1]=(this.zmi_[1]+this.b3e_[1]+this.Xmi_[1])/3;this.yBt_=(i.yBt_(h)+i.yBt_(r)+i.yBt_(o))/3;return}this.G3e_=!0;if(A===this.b3e_[2]){if(A===this.zmi_[2]){this.GBt_[0]=(this.zmi_[0]+this.b3e_[0])/2;this.GBt_[1]=(this.zmi_[1]+this.b3e_[1])/2;this.yBt_=i.yBt_(h);this.R3e_=this.b3e_;this.k3e_=this.zmi_;return}if(A===this.Xmi_[2]){this.GBt_[0]=(this.b3e_[0]+this.Xmi_[0])/2;this.GBt_[1]=(this.b3e_[1]+this.Xmi_[1])/2;this.yBt_=i.yBt_(o);this.R3e_=this.b3e_;this.k3e_=this.Xmi_;return}}let g,c,I,f;if(A<=this.zmi_[2]&&this.b3e_[2]<=A){const t=(A-this.zmi_[2])/l[2],i=(A-this.zmi_[2])/u[2];I=[l[0]*t,l[1]*t,l[2]*t];f=[u[0]*i,u[1]*i,u[2]*i];g=[this.zmi_[0]+I[0],this.zmi_[1]+I[1],this.zmi_[2]+I[2]];c=[this.zmi_[0]+f[0],this.zmi_[1]+f[1],this.zmi_[2]+f[2]]}else{const t=(A-this.Xmi_[2])/a[2],i=(A-this.Xmi_[2])/u[2];I=[a[0]*t,a[1]*t,a[2]*t];f=[u[0]*i,u[1]*i,u[2]*i];g=[this.Xmi_[0]+I[0],this.Xmi_[1]+I[1],this.Xmi_[2]+I[2]];c=[this.Xmi_[0]+f[0],this.Xmi_[1]+f[1],this.Xmi_[2]+f[2]]}this.R3e_=g;this.k3e_=c;this.GBt_[0]=(g[0]+c[0])/2;this.GBt_[1]=(g[1]+c[1])/2;this.yBt_=Math.sqrt((c[0]-g[0])*(c[0]-g[0])+(c[1]-g[1])*(c[1]-g[1]));if(!Number.isFinite(this.yBt_)&&(1-Math.abs(this.S3e_[2])<=NA.Je_||1-Math.abs(kxt.Ije_(l,u))<=NA.Je_)){this.GBt_[0]=(this.zmi_[0]+this.b3e_[0]+this.Xmi_[0])/3;this.GBt_[1]=(this.zmi_[1]+this.b3e_[1]+this.Xmi_[1])/3;this.yBt_=(i.yBt_(h)+i.yBt_(r)+i.yBt_(o))/3;this.G3e_=!1}}F3e_(){return this.y3e_}x3e_(){return this.v3e_}L3e_(){return this.G3e_}U3e_(){const t=undefined,i=undefined,s=undefined;return[(new a).fromArray(this.zmi_),(new a).fromArray(this.b3e_),(new a).fromArray(this.Xmi_)]}getPoint(){return new a(this.GBt_[0],this.GBt_[1],this.GBt_[2])}Y3e_(){return this.GBt_}getNormal(){return new a(this.S3e_[0],this.S3e_[1],this.S3e_[2])}T3e_(){return this.S3e_}K3e_(){return this.yBt_}H3e_(){if(this.R3e_==null)return null;const t=this.R3e_[0],i=this.R3e_[1],s=this.R3e_[2];return new a(t,i,s)}q3e_(){if(this.k3e_==null)return null;const t=this.k3e_[0],i=this.k3e_[1],s=this.k3e_[2];return new a(t,i,s)}J3e_(){return this.R3e_}P3e_(){return this.k3e_}M3e_(t,i,s,e){if(e){this.Xmi_=t;this.b3e_=i;this.zmi_=s}else if(t[2]>=i[2])if(t[2]>=s[2]){this.zmi_=t;if(i[2]>=s[2]){this.b3e_=i;this.Xmi_=s}else{this.b3e_=s;this.Xmi_=i}}else{this.zmi_=s;this.b3e_=t;this.Xmi_=i}else if(i[2]>=s[2]){this.zmi_=i;if(t[2]>=s[2]){this.b3e_=t;this.Xmi_=s}else{this.b3e_=s;this.Xmi_=t}}else{this.zmi_=s;this.b3e_=i;this.Xmi_=t}}static D3e_(t,i,s){const e=Number.isFinite(t[0])&&Number.isFinite(t[1])&&Number.isFinite(t[2]),A=Number.isFinite(i[0])&&Number.isFinite(i[1])&&Number.isFinite(i[2]),n=Number.isFinite(s[0])&&Number.isFinite(s[1])&&Number.isFinite(s[2]);return e&&A&&n}static yBt_(t){const i=t[0],s=t[1],e=t[2];return Math.sqrt(i*i+s*s+e*e)}static N3e_(t){const i=t[0],s=t[1],e=t[2],A=Math.sqrt(i*i+s*s+e*e);return[i/A,s/A,e/A]}reset(){this.GBt_=[0,0,0];this.yBt_=null;this.S3e_=null;this.zmi_=null;this.b3e_=null;this.Xmi_=null;this.R3e_=null;this.k3e_=null;this.G3e_=!1;this.y3e_=null;this.v3e_=null}};s=i=t([_s("geotoolkit3d.scene.surface.contour.Triangle")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRQcm9wZXJ0aWVzIjoiZHRfIiwiaXNWZXJ0aWNlc1ZhbGlkIjoiRjNlXyIsImlzSW50ZXJzZWN0RWxldmF0aW9uIjoieDNlXyIsImlzTGluZUludGVyc2VjdGlvbiI6IkwzZV8iLCJnZXRTb3J0ZWRWZXJ0aWNlcyI6IlUzZV8iLCJnZXRJbnRlcnNlY3RlZExlbmd0aCI6IkszZV8iLCJnZXRMZWZ0SW50ZXJzZWN0aW9uUG9pbnQiOiJIM2VfIiwiZ2V0UmlnaHRJbnRlcnNlY3Rpb25Qb2ludCI6InEzZV8iLCJnZXRMZWZ0SW50ZXJzZWN0aW9uIjoiSjNlXyIsImdldFJpZ2h0SW50ZXJzZWN0aW9uIjoiUDNlXyJ9fSwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");const OYt=(t,i)=>t[0]<i[0]?-1:t[0]>i[0]?1:t[1]-i[1],WYt=(t,i,s,e,A,n)=>{if(s.length<1)return;s.sort(OYt);const h=[[-1,0],[0,-1],[0,1],[1,0]];for(let r=0;r<s.length;r++){const o=s[r][0],l=s[r][1];let u=0,a=0;for(let t=0;t<h.length;t++){const s=o+h[t][0],r=l+h[t][1];if(s>=0&&s<A&&r>=0&&r<e){const t=i[r+s*e];if(isNaN(t)||t==null||t===n)continue;u+=t;a++}}let g=a>0?u/a:t;g+=Math.sqrt(1+r)*NA.Je_;i[l+o*e]=g}},zYt=(t,i,s,e)=>{const A=[];let n=Number.NaN;const h=[-s,-s+1,-1,1,s-1,s],r=[[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0]];let o=0;for(let l=0;l<e;l++)for(let u=0;u<s;u++){const a=u+l*s,g=t[a];if(g!==n||isNaN(g)||g===i)n=g;else{o++;A.push(a);const n=[[l,u]];t[a]=Number.NaN;while(A.length>0){const i=A[0];A.splice(0,1);const o=Math.floor(i/s),l=i%s;for(let u=0;u<h.length;u++){const a=o+r[u][0],c=l+r[u][1];if(a>=0&&a<e&&c>=0&&c<s&&t[i+h[u]]===g){A.push(i+h[u]);n.push([a,c]);t[i+h[u]]=Number.NaN}}}WYt(g,t,n,s,e,i)}}return o};var XYt=Ci(function(){var i;let s=i=class t{static Vot_(t){const s=qi(t["data"],{xmin:0,xstep:1,ymin:0,ystep:1,normals:!1,interleaved:!1});t["bufferpadding"]!=null&&ki("option bufferpadding is deprecated since 4.0. as interleaved buffers are now deprecated over regular BufferAttritubes.");let e=t["bufferpadding"]||0;const A=t["surfacesmooth"],n=s["width"],h=s["height"],r=n*h;let o=s["xmin"],l=Number.NEGATIVE_INFINITY,u=s["ymin"],a=Number.NEGATIVE_INFINITY,g=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,I,f,C,d,B;if(n<3||h<3)throw new Error("Unsupported operation: cannot triangulate a grid with less than 3 rows or less than 2 columns");e+=3;s["normals"]===!0&&(e+=3);if(t["interleaved"]===!0){ki("Interleaved Buffers are deprecated since 4.0, and will be replaced by regular BufferAttibute.");d=new Float32Array(r*e);B=new lt(d,e);I=new J(B,3,0);s["normals"]===!0&&(f=new J(B,3,3))}else{I=new ut(new Float32Array(r*3),3);s["normals"]===!0&&(f=new ut(new Float32Array(r*3),3))}const w=r-1,Q=(h-1)*(n-1)*6,E=NYt.T5e_(new Array(Q),w);C=new ut(E,1);A&&s["elevation"]!=null&&zYt(s["elevation"],s["nullvalue"],n,h);let p=!1,m,y,D,M,v,b,N,S,G,R;if(s["elevation"]&&Array.isArray(s["elevation"])){const t=s["xvalues"]&&Array.isArray(s["xvalues"])&&s["xvalues"].length===s["elevation"].length,i=s["yvalues"]&&Array.isArray(s["yvalues"])&&s["yvalues"].length===s["elevation"].length;p=t&&i}for(m=0;m<h;m++)for(y=0;y<n;y++){if(p){M=s["xvalues"][y+m*n];v=s["yvalues"][y+m*n]}else{M=s["xmin"]+y*s["xstep"];v=s["ymin"]+m*s["ystep"]}D=m*n+y;if(s["elevation"]!=null){const t=s["elevation"][y+m*n],i=isNaN(t)||t===s["nullvalue"];b=i?Number.NaN:t;if(!i){o=Math.min(M,o);l=Math.max(M,l);u=Math.min(v,u);a=Math.max(v,a);g=Math.min(b,g);c=Math.max(b,c)}}else b=0;I.setXYZ(D,M,v,b);if(m<h-1&&y<n-1){D=(m*(n-1)+y)*6;N=y+n*m;S=y+n*(m+1);G=y+1+n*(m+1);R=y+1+n*m;C.setXYZ(D,N,S,R);C.setXYZ(D+3,S,G,R)}}p&&(C=i.V3e_(C,I,s["nullvalue"]));s["normals"]===!0&&i.O3e_(C,I,f,s["nullvalue"]);return{triangles:{position:I,normal:f,index:C,vertexcount:r},xmin:o,xmax:l,ymin:u,ymax:a,zmin:g,zmax:c,bufferpadding:e,bufferused:s["normals"]===!0?6:3,buffer:B}}static O3e_(t,i,s,e){for(let A=0;A<t.count;A+=3){let n,h,r;const o=[],l=t.getX(A),u=t.getY(A),a=t.getZ(A);kxt.fje_(i,l,u,a,o,e);if(!isNaN(o[0])&&!isNaN(o[1])&&!isNaN(o[2])){n=s.getX(l);h=s.getY(l);r=s.getZ(l);s.setXYZ(l,n+o[0],h+o[1],r+o[2]);n=s.getX(u);h=s.getY(u);r=s.getZ(u);s.setXYZ(u,n+o[0],h+o[1],r+o[2]);n=s.getX(a);h=s.getY(a);r=s.getZ(a);s.setXYZ(a,n+o[0],h+o[1],r+o[2])}}}static V3e_(t,i,s){const e=[];let A=0;for(let n=0;n<t.count;n+=3){const h=t.getX(n),r=t.getY(n),o=t.getZ(n),l=[i.getX(h),i.getY(h),i.getZ(h)],u=[i.getX(r),i.getY(r),i.getZ(r)],a=[i.getX(o),i.getY(o),i.getZ(o)];if((s==null||l[2]!==s&&u[2]!==s&&a[2]!==s)&&(isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(a[2]))){e.push(h,r,o);A=Math.max(A,h,r,o)}}const n=NYt.T5e_(e,A);return new ut(n,1)}};s=i=t([_s("geotoolkit3d.util.surface.BasicTriangulator")],s);return s}(),2,"eyJ0cmlhbmd1bGF0ZSI6IlZvdF8iLCJjcmVhdGVOb3JtYWxzIjoiTzNlXyIsImZpbHRlckluZGljZXMiOiJWM2VfIiwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");const jYt=new a,ZYt=new a,_Yt=new a,$Yt=new C,tTt=0,iTt=1,sTt=2,eTt=3,ATt=4,nTt=5,hTt=6;var rTt=function(){var i;let s=i=class t{constructor(t,i){this.jCt_=t;this.jCt_.getSize(jYt);this.jCt_.getCenter(_Yt);this.W3e_={z3e_:jYt.x/2,X3e_:jYt.y/2,j3e_:jYt.z/2,Z3e_:_Yt.x,_3e_:_Yt.y,$3e_:_Yt.z,t4e_:[],i4e_:[],s4e_:i}}e4e_(t){if(this.A4e_(t))this.W3e_.i4e_.push(t);else if(this.n4e_!=null){const i=undefined;this.h4e_(t).e4e_(t)}else{this.W3e_.t4e_.push(t);this.W3e_.t4e_.length>this.W3e_.s4e_&&this.split()}}r4e_(t,i){if(i!=null&&!i.intersectsBox(this.jCt_))return[];if(!this.jCt_.intersectsPlane(t))return[];const s=this.gQt_!=null?this.gQt_.slice():[];if(this.n4e_!=null)for(let e=0;e<this.n4e_.length;e++){const A=this.n4e_[e].r4e_(t,i);this.o4e_(s,A)}return s}A4e_(t){return t[tTt]>this.W3e_.z3e_||t[iTt]>this.W3e_.X3e_||t[sTt]>this.W3e_.j3e_}h4e_(t){let i=t[eTt]>this.W3e_.Z3e_?1:0;t[ATt]>this.W3e_._3e_&&(i+=2);t[nTt]>this.W3e_.$3e_&&(i+=4);return this.n4e_[i]}split(){const t=this.l4e_(),s=this.W3e_.s4e_;this.n4e_=[new i(t[0],s),new i(t[1],s),new i(t[2],s),new i(t[3],s),new i(t[4],s),new i(t[5],s),new i(t[6],s),new i(t[7],s)];this.u4e_()}l4e_(){this.jCt_.getSize(ZYt).divideScalar(2);const t=this.jCt_.min,i=this.jCt_.max,s=ZYt.x,e=ZYt.y,A=ZYt.z;return[new C(t.clone(),(new a).addVectors(t,ZYt)),new C(new a(t.x+s,t.y,t.z),new a(i.x,t.y+e,t.z+A)),new C(new a(t.x,t.y+e,t.z),new a(t.x+s,i.y,t.z+A)),new C(new a(t.x+s,t.y+e,t.z),new a(i.x,i.y,i.z-A)),new C(new a(t.x,t.y,t.z+A),new a(t.x+s,t.y+e,i.z)),new C(new a(t.x+s,t.y,t.z+A),new a(i.x,t.y+e,i.z)),new C(new a(t.x,t.y+e,t.z+A),new a(t.x+s,i.y,i.z)),new C(new a(t.x+s,t.y+e,t.z+A),i.clone())]}o4e_(t,i){for(let s=0;s<i.length;s++)t.push(i[s])}u4e_(){const t=this.W3e_.t4e_;this.W3e_.t4e_=[];for(let i=0;i<t.length;i++){const s=t[i];this.h4e_(s).e4e_(s)}}trim(){const t=this.R4_();if(t==null)return;const i=[];for(let s=0;s<t.length;s++){const e=t[s];e.a4e_()&&i.push(e)}if(i.length===1&&this.W3e_.i4e_.length===0){this.copy(i[0]);this.trim()}else{this.n4e_=i;for(let t=0;t<i.length;t++)i[t].trim()}}g4e_(){this.jCt_.makeEmpty();if(this.n4e_!=null)for(let t=0;t<this.n4e_.length;t++){this.n4e_[t].g4e_();this.jCt_.union(this.n4e_[t].getBoundingBox())}this.c4e_(this.jCt_,this.W3e_.t4e_);this.c4e_(this.jCt_,this.W3e_.i4e_)}c4e_(t,i){for(let s=0;s<i.length;s++){const e=i[s];_Yt.set(e[eTt],e[ATt],e[nTt]);jYt.set(e[tTt],e[iTt],e[sTt]);$Yt.setFromCenterAndSize(_Yt,jYt);t.union($Yt)}}I4e_(){const t=this.W3e_.t4e_,i=this.W3e_.i4e_;this.W3e_=null;if(t.length+i.length>0){this.gQt_=[];for(let i=0;i<t.length;i++)this.gQt_.push(t[i][hTt]);for(let t=0;t<i.length;t++)this.gQt_.push(i[t][hTt])}if(this.n4e_!=null)for(let t=0;t<this.n4e_.length;t++)this.n4e_[t].I4e_()}a4e_(){if(this.W3e_.t4e_.length+this.W3e_.i4e_.length>0)return!0;if(this.n4e_!=null)for(let t=0;t<this.n4e_.length;t++)if(this.n4e_[t].a4e_())return!0;return!1}copy(t){this.jCt_=t.getBoundingBox();this.n4e_=t.R4_();this.gQt_=t.k9_();this.W3e_=t.f4e_()}getBoundingBox(){return this.jCt_}k9_(){return this.gQt_}R4_(){return this.n4e_}f4e_(){return this.W3e_}};s=i=t([_s("geotoolkit3d.data.util.FitBoundsNode")],s);return s}();var oTt=function(){let i=class t{constructor(t){if((t=qi(t,{maxelementpernode:300}))["maxelementpernode"]<8){t["maxelementpernode"]=8;ki("Octree 'maxelementpernode' cannot be lower than 8 elements.")}this.JP_=new rTt(t["bounds"].clone(),t["maxelementpernode"]);this.C4e_=!1}g1_(t){this.C4e_?ki("Cannot insert into finalized Octree. Finalization operation renders the octree read-only for memory savings."):this.JP_.e4e_(t)}r4e_(t,i){if(!this.C4e_){ki("Cannot retrieve indices from octree before it was finalized."+" Please finish inserting elements in the octree then call .finalize() to enable search/intersection features.");return[]}return this.JP_.r4e_(t,i)}Tnt_(){if(!this.C4e_){this.JP_.trim();this.JP_.g4e_();this.JP_.I4e_();this.C4e_=!0}}d4e_(){return this.C4e_}getRootNode(){return this.JP_}};i=t([_s("geotoolkit3d.data.util.FitBoundsOctree")],i);return i}();var lTt={B4e_:0,w4e_:1};const uTt=new VYt;var aTt=function(){let i=class t extends z{constructor(t){super();Object.assign(this,{type:"SurfaceGeometry"});if(t==null||t["data"]==null||t["data"]["surface"]==null)throw new Error("SurfaceGeometry: constructor option.data.surface is missing.");const i=t["data"]["surface"].Uui_();this.U$_=i["position"];this.Q4e_=i["interleaved"];this.E4e_=i["nullvalue"];this.p4e_=[];this.setAttribute("position",this.U$_);this.setIndex(i["index"]);this.m4e_=i["index"].count/3;i["normal"]!=null?this.setAttribute("normal",i["normal"]):this.computeVertexNormals();i["values"]!=null&&this.setAttribute(ixt.TXe_,i["values"]);const s=Number.isFinite;if(s(i["xmin"])&&s(i["xmax"])&&s(i["ymin"])&&s(i["ymax"])&&s(i["zmin"])&&s(i["zmax"])){const t=new a(i["xmin"],i["ymin"],i["zmin"]),s=new a(i["xmax"],i["ymax"],i["zmax"]);this.boundingBox=new C(t,s)}else this.computeBoundingBox();this.setData(t["data"])}setOptions(t){if(t==null||t["data"]==null)return this;if(Array.isArray(t["data"]["values"])||t["data"]["values"]instanceof Float32Array){ki("SurfaceGeometry: setting data values through setOptions() is deprecated, please use setData() instead.");this.y4e_(t["data"]["values"])}return this}JV_(){const t={data:{}},i="values";Object.defineProperty(t["data"],i,{get:()=>{ki("Surface:getOptions().data.values: data should no longer be accessed through getOptions()."+" Please use getData() instead.");return this.getValues()}});return t}getData(){return{values:this.getValues()}}setData(t){if(t==null)return this;(Array.isArray(t["values"])||t["values"]instanceof Float32Array)&&this.y4e_(t["values"]);return this}getValues(){const t=this.getAttribute(ixt.TXe_);if(t==null)return null;const i=new Float32Array(t.count);for(let s=0;s<t.count;s++)i[s]=t.getX(s);return i}computeBoundingBox(){const t=this.getAttribute("position"),i=this.getIndex();this.boundingBox==null&&(this.boundingBox=new C);NYt.K5e_(t,i,this.boundingBox)}computeBoundingSphere(){this.boundingBox==null&&this.computeBoundingBox();this.boundingSphere=new P;this.boundingBox.getBoundingSphere(this.boundingSphere)}y4e_(t){const i=this.getAttribute("position").count;t.length!==i&&ki("Given values array does not match vertices count: "+i+"="+i+", actual="+t.length);let s=this.getAttribute(ixt.TXe_);if(s==null){s=new ut(new Float32Array(i),1);this.setAttribute(ixt.TXe_,s)}for(let i=0;i<s.count;i++)s.setX(i,t[i]);s.needsUpdate=!0}computeVertexNormals(){const t=this.getAttribute("position");if(t){let i=this.getAttribute("normal");if(i===void 0){i=new ut(new Float32Array(t.count*t.itemSize),3);this.setAttribute("normal",i)}XYt.O3e_(this.getIndex(),t,i,this.E4e_);fLt.IZe_(i);this.setAttribute("normal",i)}}D4e_(t,i,s,e){this.p4e_=[];if(t.length+i.length<=0)return;const A=this.U$_.array;this.M4e_(this.p4e_,t,i,s,e);const n=this.p4e_.length,h=this.index.array;let r=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(let t=0;t<n;t++){r=Math.min(r,this.p4e_[t].v4e_);o=Math.max(o,this.p4e_[t].v4e_)}const l=[[0,0,0],[0,0,0],[0,0,0]],u=[0,1,2];for(let t=0;t<h.length;t+=3){const i=h[t]*3,s=h[t+1]*3,e=h[t+2]*3;l[0][0]=A[i];l[0][1]=A[i+1];l[0][2]=A[i+2];l[1][0]=A[s];l[1][1]=A[s+1];l[1][2]=A[s+2];l[2][0]=A[e];l[2][1]=A[e+1];l[2][2]=A[e+2];if(isNaN(l[0][2])||isNaN(l[1][2])||isNaN(l[2][2]))continue;this.b4e_(l,u);const a=l[u[0]][2],g=l[u[2]][2];if(!(a>o||g<r))for(let t=0;t<n;t++){const i=this.p4e_[t],s=i.v4e_;if(a<=s&&s<=g){uTt.reset();uTt.dt_(l[u[0]],l[u[1]],l[u[2]],s,!0);if(!uTt.L3e_())continue;const t=uTt.Y3e_(),e=uTt.T3e_(),A=uTt.K3e_(),n=uTt.J3e_(),h=uTt.P3e_();i.N4e_.push([t,e,A,n,h]);i.length+=A}else if(s>g)break}}}S4e_(t,i,s){return(t-s)/i}M4e_(t,i,s,e,A){const n=this.boundingBox.min.z,h=this.boundingBox.max.z;for(let s=0;s<i.length;s++){const r=i[s],o=this.S4e_(r,e,A);o<n||o>h||t.push({N4e_:[],length:0,type:lTt.B4e_,G4e_:r,v4e_:o})}for(let i=0;i<s.length;i++){const r=s[i],o=this.S4e_(r,e,A);o<n||o>h||t.push({N4e_:[],length:0,type:lTt.w4e_,G4e_:r,v4e_:o})}t.sort(((t,i)=>t.G4e_-i.G4e_))}R4e_(){return this.p4e_}b4e_(t,i){let s,e,A;if(t[0][2]>=t[1][2])if(t[0][2]>=t[2][2]){s=0;if(t[1][2]>=t[2][2]){e=1;A=2}else{e=2;A=1}}else{s=2;e=0;A=1}else if(t[1][2]>=t[2][2]){s=1;if(t[0][2]>=t[2][2]){e=0;A=2}else{e=2;A=0}}else{s=2;e=1;A=0}i[0]=A;i[1]=e;i[2]=s}k4e_(){this.boundingBox==null&&this.computeBoundingBox();this.F4e_=new oTt({bounds:this.boundingBox});const t=this.getIndex(),i=this.getAttribute("position");for(let s=0;s<this.m4e_;s++)this.F4e_.g1_(this.x4e_(s,t,i));this.F4e_.Tnt_()}x4e_(t,i,s){const e=t*3,A=i.getX(e);let n,h,r,o,l,u;n=h=s.getX(A);r=o=s.getY(A);l=u=s.getZ(A);for(let t=1;t<3;++t){const A=i.getX(e+t),a=s.getX(A),g=s.getY(A),c=s.getZ(A);n=Math.min(n,a);h=Math.max(h,a);r=Math.min(r,g);o=Math.max(o,g);l=Math.min(l,c);u=Math.max(u,c)}const a=h-n,g=o-r,c=u-l;return[a,g,c,n+a/2,r+g/2,l+c/2,t]}L4e_(){this.F4e_==null&&this.k4e_();return this.F4e_}dispose(){super.dispose();this.F4e_=null;this.U$_=null;this.p4e_=null}};i=t([_s("geotoolkit3d.scene.surface.SurfaceGeometry")],i);return i}();const gTt="\n#if __VERSION__ >= 300\n",cTt="\n#endif\n",ITt="flatReflectedLight";let fTt=[n.lights_fragment_begin,n.lights_fragment_maps,n.lights_fragment_end].join("\n");fTt=fTt.replaceAll("reflectedLight",ITt).replaceAll("normal","flatTransformedNormal").replaceAll(".flatTransformedNormal",".normal").replaceAll("flatTransformedNormalize","normalize");var CTt=Ci(function(){var i;let s=i=class t{};s.U4e_="isFlatShadingEnabled";s.Y4e_="smoothShadingBlendingFactor";s.T4e_=["uniform bool "+i.U4e_+";","uniform float "+i.Y4e_+";","varying vec3 vertexMVposition;","varying float flip_sided;\n"].join("\n");s.K4e_=["    if("+i.U4e_+") {","        vertexMVposition = mvPosition.xyz;","        flip_sided = 1.0;","        #ifdef FLIP_SIDED","            flip_sided = -1.0;","        #endif","    }\n"].join("\n");s.H4e_=ITt;s.q4e_=[gTt,"    if("+i.U4e_+") {","        vec3 U = dFdx(vertexMVposition);","        vec3 V = dFdy(vertexMVposition);","        vec3 flatTransformedNormal = flip_sided * normalize(cross(U,V));","        ReflectedLight "+ITt+" = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",fTt,"        float smoothScale = "+i.Y4e_+";","        float flatScale = 1. - smoothScale;","        reflectedLight.directDiffuse = reflectedLight.directDiffuse * smoothScale + "+ITt+".directDiffuse * flatScale;","        reflectedLight.indirectDiffuse = reflectedLight.indirectDiffuse * smoothScale + "+ITt+".indirectDiffuse * flatScale;","    }",cTt].join("\n");s=i=t([_s("geotoolkit3d.util.shaders.FlatShading")],s);return s}(),2,"eyJnZXRDbGFzc05hbWUiOiJEXyJ9");const dTt=CTt,BTt=YFt,wTt="addedHeightMapShaders",QTt="addedSurfaceShaders",ETt=ixt.TXe_+"NullValue",pTt="wireframeEnabled",mTt="useHeighMap",yTt="USE_VALUE_MAP",DTt=function(t){if(!t.defines.hasOwnProperty(QTt)){t.defines[QTt]=!0;t.uniforms[mTt]=new h(!1);t.uniforms[ETt]=new h(-999.25);t.uniforms[dTt.Y4e_]=new h(1);t.uniforms[dTt.U4e_]=new h(!1);t.uniforms[pTt]=new h(t.wireframe)}},MTt=undefined,vTt=undefined,bTt=["uniform sampler2D cgheightmap;","uniform sampler2D cgvaluemap;","uniform vec2 cgheightmapSize;","uniform float cgzOrient;","uniform int cgvalueMode;","uniform bool useOSMShader;",["#ifndef REGULAR_HEIGHTMAP_FORMULA","   #define REGULAR_HEIGHTMAP_FORMULA",["#ifndef HEIGHTMAP_SHADER_UTILS","   #define HEIGHTMAP_SHADER_UTILS","   const vec3 cgheightmapTextureOffset = vec3(-1.0, 0.0, 1.0);","   const vec2 cgheightmapDirection = vec2(2.0,0.0);","#endif"].join("\n"),"   vec4 computeRegularHeightValue(sampler2D cgheightmap, vec2 tex_coord, vec2 cgheightmapSize, float cgzOrient,","       float cgOSMShaderOffset) {","       float s11 = texture2D(cgheightmap, tex_coord).x * cgzOrient - cgOSMShaderOffset;","       float s01 = texture2D(cgheightmap, tex_coord + cgheightmapTextureOffset.xy / cgheightmapSize).x * cgzOrient;","       float s21 = texture2D(cgheightmap, tex_coord + cgheightmapTextureOffset.zy / cgheightmapSize).x * cgzOrient;","       float s10 = texture2D(cgheightmap, tex_coord + cgheightmapTextureOffset.yx / cgheightmapSize).x * cgzOrient;","       float s12 = texture2D(cgheightmap, tex_coord + cgheightmapTextureOffset.yz / cgheightmapSize).x * cgzOrient;","       vec3 va = normalize(vec3(cgheightmapDirection.xy, s21 - s01));","       vec3 vb = normalize(vec3(cgheightmapDirection.yx, s12 - s10));","       return vec4(cross(va, vb), s11);","   }","#endif"].join("\n")].join("\n"),NTt=["#ifdef "+yTt,"vec4 color = texture2D(cgvaluemap, uv);","float "+ixt.TXe_+" = 0.0;","if (cgvalueMode == "+$kt.MWe_+") {","\t"+ixt.TXe_+" = color.x;","} else if (cgvalueMode == "+$kt.vWe_+") {","\t"+ixt.TXe_+" = color.r * 2.0 + color.g / 128.0 + color.b / 32768.0 - 1.0;","} else if (cgvalueMode == "+$kt.lB_+") {","\t"+ixt.TXe_+" = 1.0 - color.w;","}","#endif"].join("\n"),STt=["vec3 alteredPosition = vec3(position);","float cgOSMShaderOffset = useOSMShader ? 0.5 : 0.0;","vec4 bump = computeRegularHeightValue(cgheightmap, uv, cgheightmapSize, cgzOrient, cgOSMShaderOffset);","alteredPosition.z += bump.w;","transformedNormal = normalMatrix * normalize(-bump.xyz);","#ifdef USE_SKINNING","   vec4 mvPosition = modelViewMatrix * skinned;","#elif defined( USE_MORPHTARGETS )","   vec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );","#else","   vec4 mvPosition = modelViewMatrix * vec4( alteredPosition, 1.0 );","#endif","gl_Position = projectionMatrix * mvPosition;"].join("\n"),GTt=function(t){if(!t.defines.hasOwnProperty(wTt)){t.defines[wTt]=!0;t.uniforms[mTt]=new h(!0);t.uniforms["cgheightmap"]=new h(null);t.uniforms["cgvaluemap"]=new h(null);t.uniforms["cgheightmapSize"]=new h(new g);t.uniforms["cgzOrient"]=new h(1);t.uniforms["cgvalueMode"]=new h($kt.MWe_);t.uniforms["useOSMShader"]=new h(!1)}};var RTt=function(){var i;let s=i=class t{static J4e_(t,i){if(i!=null){DTt(t);i.hasOwnProperty("wireframe")&&(t.uniforms[pTt].value=i["wireframe"]);i.hasOwnProperty("data")&&i["data"].hasOwnProperty("nullvalue")&&(t.uniforms[ETt].value=i["data"]["nullvalue"]);if(i.hasOwnProperty("smoothshadingfactor")){t.uniforms[dTt.Y4e_].value=i["smoothshadingfactor"];const s=undefined;t.uniforms[dTt.U4e_].value=i["smoothshadingfactor"]!==1}}}static P4e_(t){DTt(t);return{wireframe:!!t.uniforms[pTt].value,smoothshadingfactor:t.uniforms[dTt.Y4e_].value,data:{nullvalue:t.uniforms[ETt].value}}}static V4e_(t,i){if(!i||!i.hasOwnProperty("data"))return;GTt(t);let s=null;if(i["data"].hasOwnProperty("surface")){s=i["data"]["surface"].Uui_()["heightmap"];s==null&&(t.uniforms["useOSMShader"].value=!0)}else i["data"].hasOwnProperty("texture")&&(s=i["data"]["texture"]);if(s!=null&&s!==t.uniforms["cgheightmap"].value){t.uniforms["cgheightmap"].value=s;t.uniforms["cgheightmapSize"].value.set(s.image.width,s.image.height)}i["data"].hasOwnProperty("zsign")&&(t.uniforms["cgzOrient"].value=i["data"]["zsign"]);if(i["data"].hasOwnProperty("values")&&i["data"]["values"]instanceof r){if(t.defines[yTt]!==1){t.defines[yTt]=1;t.needsUpdate=!0}t.uniforms["cgvaluemap"].value=i["data"]["values"]}i["data"].hasOwnProperty("valuemode")&&i["data"]["valuemode"]!==t.uniforms["cgvalueMode"].value&&(t.uniforms["cgvalueMode"].value=i["data"]["valuemode"])}static O4e_(t){GTt(t);return{data:{zsign:t.uniforms["cgzOrient"].value,valuemode:t.uniforms["cgvalueMode"].value,values:t.uniforms["cgvaluemap"].value,xmin:0,ymin:0,xstep:1,ystep:1}}}};s.W4e_=["#define LAMBERT",dTt.T4e_,"varying vec3 vViewPosition;","#include <common>","#include <uv_pars_vertex>","#include <displacementmap_pars_vertex>","#include <envmap_pars_vertex>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>","#ifdef CG_USE_COLOR_MAP","    attribute float cgcolormapValue;","    varying float vcgcolormapValue;","    uniform vec4 cgcolormapParams;","    uniform int cgcolormapLogValue;","    float Shaders_norm(float value, float srcmin, float srcmax, float dstmin, float dstmax) {","        float norm = dstmin + (dstmax - dstmin) * (clamp(value, srcmin, srcmax) - srcmin)  / (srcmax - srcmin);","        if (norm < 0.0 || norm >= 0.0) {","            return norm;","        }","        return 0.0;","    }","    float normValueForColorMap(float value) {","        if( cgcolormapLogValue == 1) {","            value = log2(value)/log2(10.0);","        }","        return Shaders_norm(value - cgcolormapParams.x, 0.0, cgcolormapParams.y, 0.0, 1.0);","    }","#endif","varying float vcgdeadCell;","varying vec3 vTransformedNormal;","uniform float cgcolormapValueNullValue;","bool _isnan( float val ) {","    return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;","}","void main() {","    #ifdef CG_USE_COLOR_MAP","        vcgdeadCell = _isnan(cgcolormapValue) || abs( cgcolormapValue - cgcolormapValueNullValue ) < 0.00001 ? 1.0 : 0.0 ;","    #endif","    #include <uv_vertex>","    #include <color_vertex>","    #include <morphcolor_vertex>","    #ifdef CG_USE_COLOR_MAP","        vcgcolormapValue = normValueForColorMap(cgcolormapValue);","    #endif","    #include <beginnormal_vertex>","    #include <morphnormal_vertex>","    #include <skinbase_vertex>","    #include <skinnormal_vertex>","    #include <defaultnormal_vertex>","    #include <normal_vertex>","    #include <begin_vertex>","    #include <morphtarget_vertex>","    #include <skinning_vertex>","    #include <displacementmap_vertex>","    #include <project_vertex>","    #include <logdepthbuf_vertex>","    #include <clipping_planes_vertex>","    vViewPosition = - mvPosition.xyz;","    vTransformedNormal = transformedNormal;","    #include <worldpos_vertex>","    #include <envmap_vertex>","    #include <shadowmap_vertex>","    #include <fog_vertex>",dTt.K4e_,"}"].join("\n");s.z4e_=["#define LAMBERT","uniform vec3 diffuse;","uniform vec3 emissive;","uniform float opacity;","uniform bool "+pTt+";","uniform bool "+mTt+";",dTt.T4e_,"#include <common>","#include <packing>","#include <dithering_pars_fragment>","#include <color_pars_fragment>","#include <uv_pars_fragment>","#include <map_pars_fragment>","#include <alphamap_pars_fragment>","#include <alphatest_pars_fragment>","#include <aomap_pars_fragment>","#include <lightmap_pars_fragment>","#include <emissivemap_pars_fragment>","#include <envmap_common_pars_fragment>","#include <envmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <normal_pars_fragment>","#include <lights_lambert_pars_fragment>","#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>","#include <specularmap_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <clipping_planes_pars_fragment>","uniform int useDiffuseAsColor;","#ifdef CG_USE_COLOR_MAP","    varying float vcgcolormapValue;","    uniform sampler2D cgcolormapTexture;","    vec4 getColorFromColorMap(float normValue) {","        return texture2D(cgcolormapTexture, vec2(normValue, 0.5));","    }","#endif","varying float vcgdeadCell;","varying vec3 vTransformedNormal;","void main() {","    if(vcgdeadCell != 0.0) discard;","    #include <clipping_planes_fragment>","    vec4 diffuseColor = vec4( diffuse, opacity );","    ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","    vec3 totalEmissiveRadiance = emissive;","    #include <logdepthbuf_fragment>","    #include <map_fragment>","    #include <color_fragment>","    #ifdef CG_USE_COLOR_MAP","        diffuseColor *= getColorFromColorMap(vcgcolormapValue);","    #endif","    #include <alphamap_fragment>","    #include <alphatest_fragment>","    #include <specularmap_fragment>","    #include <normal_fragment_begin>","    #include <normal_fragment_maps>","    #include <emissivemap_fragment>","    if("+mTt+") {","       normal = normalize(vTransformedNormal);","       #ifdef DOUBLE_SIDED","           normal *= faceDirection;","       #endif","       #ifdef FLIP_SIDED","           normal = -normal;","       #endif","    };","    #include <lights_lambert_fragment>","    #include <lights_fragment_begin>","    #include <lights_fragment_maps>","    #include <lights_fragment_end>",dTt.q4e_,"    #include <aomap_fragment>","    vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;","    #include <envmap_fragment>","    #include <output_fragment>","    if(useDiffuseAsColor == 1 || "+pTt+") {","        gl_FragColor = diffuseColor;","    } else {","        gl_FragColor = vec4( outgoingLight, diffuseColor.a );","    };","    #include <tonemapping_fragment>","    #include <encodings_fragment>","    #include <fog_fragment>","    #include <premultiplied_alpha_fragment>","    #include <dithering_fragment>","}"].join("\n");s.X4e_=function(t){t=BTt.EXe_(t,ixt.GXe_,bTt,!1,!0);t=BTt.EXe_(t,ixt.RXe_,NTt,!1,!1);return t=BTt.EXe_(t,ixt.xXe_,STt,!0)}(i.W4e_);s.j4e_=i.z4e_;s=i=t([_s("geotoolkit3d.util.shaders.Surface")],s);return s}();const kTt=new l(16777215),FTt=new l(0);var xTt=Ci(function(){let i=class t extends RYt{constructor(t){const i=qi(t,{vertexShader:ixt.PXe_,fragmentShader:ixt.VXe_,uniforms:N.clone(S["lambert"].uniforms),lights:!0,aoMapIntensity:1,color:kTt,wireframe:!1,wireframeLinecap:"round",wireframeLinejoin:"round",emissive:FTt,emissiveintensity:1});super(i);this.type="MeshColorMapLambertMaterial";this["isMeshLambertMaterial"]=!0;this.Z4e_(i)}Z4e_(t){t.hasOwnProperty("alphaMap")&&(this.alphaMap=t["alphaMap"]);t.hasOwnProperty("aoMap")&&(this.aoMap=t["aoMap"]);t.hasOwnProperty("aoMapIntensity")&&(this.aoMapIntensity=t["aoMapIntensity"]);t.hasOwnProperty("color")&&(this.color=new l(t["color"]));t.hasOwnProperty("map")&&(this.map=t["map"]);t.hasOwnProperty("wireframe")&&(this.wireframe=t["wireframe"]);t.hasOwnProperty("wireframeLinecap")&&(this.wireframeLinecap=t["wireframeLinecap"]);t.hasOwnProperty("wireframeLinejoin")&&(this.wireframeLinejoin=t["wireframeLinejoin"]);t.hasOwnProperty("emissive")&&(this.emissive=t["emissive"]);t.hasOwnProperty("emissiveMap")&&(this.emissiveMap=t["emissiveMap"]);t.hasOwnProperty("emissiveintensity")&&(this.emissiveIntensity=t["emissiveintensity"]);if(t.hasOwnProperty("unlit")){ki("material option.unlit is deprecated since 4.0, please use option.lights instead.");ixt.mXe_(this,{unlit:t["unlit"]})}if(t.hasOwnProperty("lights")){const i=t["lights"]?0:1;ixt.mXe_(this,{unlit:i})}}setOptions(t){this.Z4e_(t);super.setOptions(t);return this}JV_(){const t=super.JV_();t["alphaMap"]=this.alphaMap;t["aoMap"]=this.aoMap;t["aoMapIntensity"]=this.aoMapIntensity;t["color"]=this.color;t["map"]=this.map;t["wireframe"]=this.wireframe;t["wireframeLinecap"]=this.wireframeLinecap;t["wireframeLinejoin"]=this.wireframeLinejoin;t["emissive"]=this.emissive;t["emissiveMap"]=this.emissiveMap;t["emissiveintensity"]=this.emissiveIntensity;t["lights"]=ixt.yXe_(this)["unlit"]===0;return t}dispose(){super.dispose();this.map=null;this.alphaMap=null;this.aoMap=null;this.emissiveMap=null}};i=t([_s("geotoolkit3d.scene.MeshColorMapLambertMaterial")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");$Lt.yZe_(xTt.D_(),yLt);const LTt=RTt;var UTt=Ci(function(){let i=class t extends xTt{constructor(t){const i=qi(t,{transparent:!1},!0);super(i);this.type="SurfaceMaterial";this.vertexShader=LTt.W4e_;this.fragmentShader=LTt.z4e_;this.polygonOffset=!0;this.polygonOffsetUnits=.5;this.polygonOffsetFactor=.5;LTt.J4e_(this,i)}setOptions(t){super.setOptions(t);LTt.J4e_(this,t);return this}JV_(){return Pi(LTt.P4e_(this),super.JV_())}};i=t([_s("geotoolkit3d.scene.surface.SurfaceMaterial")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");$Lt.yZe_(UTt.D_(),yLt);var YTt=Ci(function(){let i=class t{constructor(t){this._4e_={nullvalue:null,interleaved:!1};if(t!=null){if(t.hasOwnProperty("interleaved")){ki("SurfaceData option.interleaved is deprecated since 4.0.\n"+"Buffers will now default to regular BufferAttribute.");t["interleaved"]=!1}t.hasOwnProperty("bufferpadding")&&ki("SurfaceData option.bufferpadding is deprecated since 4.0.\n"+"Buffers will now default to regular BufferAttribute, which don't need padding.")}}$4e_(t){this.t8e_(t);const i=this.i8e_(t["position"],3,"position"),s=this.s8e_(i,t["index"]),e=this.e8e_(s),A=NYt.K5e_(i,e),n={position:i,index:e,xmin:A["min"]["x"],xmax:A["max"]["x"],ymin:A["min"]["y"],ymax:A["max"]["y"],zmin:A["min"]["z"],zmax:A["max"]["z"]};if(t["normal"]!=null){const i=t["normal"]instanceof ut;n["normal"]=this.i8e_(t["normal"],3,"normal");i||fLt.IZe_(n["normal"])}t.hasOwnProperty("nullvalue")&&(n["nullvalue"]=t["nullvalue"]);t["values"]!=null&&(n["values"]=this.i8e_(t["values"],1,"values"));this.b5i_(n)}b5i_(t){this._4e_["position"]=t["position"];this._4e_["index"]=t["index"];this._4e_["xmin"]=t["xmin"];this._4e_["xmax"]=t["xmax"];this._4e_["ymin"]=t["ymin"];this._4e_["ymax"]=t["ymax"];this._4e_["zmin"]=t["zmin"];this._4e_["zmax"]=t["zmax"];t.hasOwnProperty("nullvalue")&&(this._4e_["nullvalue"]=t["nullvalue"]);t["normal"]!=null&&(this._4e_["normal"]=t["normal"]);if(t["values"]!=null){this._4e_["values"]=t["values"];const i=this.A8e_(this._4e_["values"],this._4e_["nullvalue"]);this._4e_["valuemin"]=i[0];this._4e_["valuemax"]=i[1]}}Uui_(){return this._4e_}n8e_(){return{geometry:aTt,material:UTt}}h8e_(t){if(t["position"]==null||t["index"]==null)throw new Error("Cannot build surface without position or index attributes.")}r8e_(t){const i=this.getLength(t["index"]);if(!this.o8e_(i,3)||i<3)throw new Error("Surface index array must be of length multiple of 3, and contain at minimum 3 indices"+" to properly build triangles.")}l8e_(t){const i=this.getLength(t["position"]);if(!this.o8e_(i,3)||i<9)throw new Error("Surface position array must be of length multiple of 3, and contain at minimum 9 values"+" to properly build triangles (3 vertices minimum, x/y/z value for each vertex).")}t8e_(t){this.h8e_(t);this.r8e_(t);this.l8e_(t);const i=this.getLength(t["position"]),s=i/3;if(t["normal"]!=null&&this.getLength(t["normal"])!==i){ki("Surface normal attribute must be of the same length as position attribute (one normal vector is X,Y,Z per vertex).");t["normal"]=null}if(t["values"]!=null&&this.getLength(t["values"])!==s){ki("Surface values attribute must have exactly 1 value per vertex.");t["values"]=null}}i8e_(t,i,s){const e=" must be of type Float32Array or Float64Array";if(t instanceof ut){this.u8e_(t.array)||ki("BufferAttribute: "+s+e);return t}Array.isArray(t)||this.u8e_(t)||ki("Attribute: "+s+e);return new ut(new Float32Array(t),i)}e8e_(t,i){const s=" index must be of type Uint8Array, Uint16Array or Uint32Array";if(t instanceof ut){this.a8e_(t.array)||ki("BufferAttribute:"+s);return t}Array.isArray(t)||this.a8e_(t)||ki("Attribute:"+s);const e=NYt.T5e_(t,i);return new ut(e,1)}A8e_(t,i){const s=t.count;let e=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY;for(let n=0;n<s;n++){const s=t.getX(n);if(Number.isFinite(s)&&s!==i){e=Math.min(e,s);A=Math.max(A,s)}}return[e,A]}getLength(t){return t instanceof ut?t.count*t.itemSize:t.length}u8e_(t){return t instanceof Float32Array||t instanceof Float64Array}a8e_(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array}o8e_(t,i){const s=undefined;return t%i===0}B8_(t){return t instanceof ut?t.array:t}Yz_(t,i){return Number.isFinite(t.getX(i))&&Number.isFinite(t.getY(i))&&Number.isFinite(t.getZ(i))}s8e_(t,i){const s=this.B8_(i),e=Math.floor(s.length/3),A=[];for(let i=0;i<e;i++){const e=i*3,n=s[e],h=s[e+1],r=s[e+2];this.Yz_(t,n)&&this.Yz_(t,h)&&this.Yz_(t,r)&&A.push(n,h,r)}return A}dispose(){this._4e_=null}};i=t([_s("geotoolkit3d.data.surface.AbstractSurfaceData")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRBdHRyaWJ1dGVzIjoiVXVpXyJ9fSwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");var TTt=function(){let i=class t{static Vot_(t){const i=(t=qi(t,{applydepth:!0}))["data"]["lines"],s=t["applydepth"],e=[],A=[];for(let t=0;t<i.length;t++){const n=i[t];let h=n["x"].length,r=0;n["x"][r]===n["x"][h-1]&&n["y"][r]===n["y"][h-1]&&(h=n["x"].length-1);for(;r<h;r++){e.push(n["x"][r]);e.push(n["y"][r]);s?e.push(n["z"]):e.push(0);A.push(n["z"])}}let n;try{n=t["triangulator"]!=null?t["triangulator"](e):Dm.Vot_(e)}catch(t){Gi(this.D_()+" failed to Triangulate")}return{triangles:{position:e,index:n},values:A}}};i=t([_s("geotoolkit3d.util.surface.ContourLineTriangulator ")],i);return i}();var KTt=function(){var i;let s=i=class t extends YTt{constructor(t){super(t);const s=i.g8e_(t);this.$4e_({position:s["triangles"]["position"],index:s["triangles"]["index"],values:s["values"],nullvalue:null})}};s.g8e_=TTt.Vot_;s=i=t([_s("geotoolkit3d.data.surface.ContourLineData")],s);return s}();var HTt=function(){var i;let s=i=class t extends YTt{constructor(t){const s=qi(t,{surfacesmooth:!0});super(s);const e=i.g8e_(s);this.$4e_({position:e["triangles"]["position"],index:e["triangles"]["index"],normal:e["triangles"]["normal"],values:t["data"]["values"],nullvalue:s["data"]["nullvalue"]})}};s.g8e_=XYt.Vot_;s=i=t([_s("geotoolkit3d.data.surface.GridSurfaceData")],s);return s}();const qTt=new a(.5,.5,1);var JTt=function(){var i;let s=i=class t extends aTt{computeBoundingBox(){const t=this.getAttribute("position"),s=this.getIndex();this.boundingBox==null&&(this.boundingBox=new C);i.c8e_(t,s,this.boundingBox)}computeVertexNormals(){const t=this.getAttribute("position");if(t){let i=this.getAttribute("uv");if(i===void 0){this.computeBoundingBox();const s=new a;this.boundingBox.getSize(s);i=new ut(new Float32Array(t.count*2),2);fLt.IZe_(i);for(let e=0;e<t.count;e++){const A=(t.getX(e)-this.boundingBox.min.x)/s.x,n=(t.getY(e)-this.boundingBox.min.y)/s.y;i.setX(e,A);i.setY(e,n)}this.setAttribute("uv",i)}}}static c8e_(t,i,s){s==null&&(s=new C);NYt.K5e_(t,i,s);s.expandByVector(qTt);return s}};s=i=t([_s("geotoolkit3d.scene.surface.HeightMapSurfaceGeometry")],s);return s}();const PTt=RTt;var VTt=Ci(function(){let i=class t extends UTt{constructor(t){if(t==null||t["data"]==null||t["data"]["surface"]==null)throw new Error("Height Map Surface Material has no Data");super(t);this.type="HeightMapSurfaceMaterial";t["data"]=qi(t["data"],{zsign:1},!0);this.vertexShader=PTt.X4e_;this.fragmentShader=PTt.j4e_;const i=t["data"]["surface"].Uui_();this.I8e_=t["data"]["surface"];this.f8e_=new mA(0,0,i["width"],i["height"]);this.C8e_={};this._ui_={};this.setOptions(t)}setOptions(t){super.setOptions(t);PTt.V4e_(this,t);t["texture"]&&this.d8e_(t["texture"],0,0,this.f8e_.Ie_()/t["texture"].image.width,this.f8e_.Ts_()/t["texture"].image.height,"material");return this}JV_(){const t=Pi(PTt.O4e_(this),super.JV_());t["texture"]=this._ui_["material"];return t}d8e_(t,i,s,e,A,n){if(this.C8e_[n]==null){const t=Ls(this.f8e_.Ie_()/Is(),this.f8e_.Ts_()/Is());this.C8e_[n]=t.getContext("2d");this._ui_[n]=new Dt(t);if(n==="material"){this.uniforms.map.value=this._ui_[n];this.map=this._ui_[n]}n==="geometry"&&PTt.V4e_(this,{data:{surface:this.I8e_.B8e_(this._ui_[n]),values:this._ui_[n]}});this.needsUpdate=!0}this.C8e_[n].drawImage(t.image,i,s,t.image.width*e,t.image.height*A);this._ui_[n].needsUpdate=!0;return this}dispose(){for(const t in this.C8e_)if(this.C8e_.hasOwnProperty(t)){this.C8e_[t]=null;this._ui_[t].dispose();this._ui_[t]=null}super.dispose()}};i=t([_s("geotoolkit3d.scene.surface.HeightMapSurfaceMaterial")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");$Lt.yZe_(VTt.D_(),yLt);var OTt=Ci(function(){var i;let s=i=class t extends YTt{constructor(t){super(t);t==null&&(t={});t["data"]==null&&(t["data"]={});t["data"]=qi(t["data"],{width:t["data"]["heightmap"]?t["data"]["heightmap"].image.width:256,height:t["data"]["heightmap"]?t["data"]["heightmap"].image.height:256,normals:!1},!0);this.w8e_=t["data"]["heightmap"];this.Jp_=t["data"]["width"];this.Pp_=t["data"]["height"];const s=i.g8e_(t),e=s["triangles"]["position"],A=s["triangles"]["index"],n=JTt.c8e_(e,A);this.b5i_({position:e,index:A,nullvalue:t["data"]["nullvalue"],xmin:n["min"]["x"],xmax:n["max"]["x"],ymin:n["min"]["y"],ymax:n["max"]["y"],zmin:n["min"]["z"],zmax:n["max"]["z"]})}Uui_(){const t=super.Uui_();t["heightmap"]=this.w8e_;t["width"]=this.Jp_;t["height"]=this.Pp_;return t}n8e_(){return{geometry:JTt,material:VTt}}B8e_(t){this.w8e_=t;return this}};s.g8e_=XYt.Vot_;s=i=t([_s("geotoolkit3d.data.surface.HeightMapSurfaceData")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRBdHRyaWJ1dGVzIjoiVXVpXyJ9fX0g");const WTt=new a,zTt=new a;var XTt=function(){var i;let s=i=class t{static Q8e_(t,i){let s=0;if(Number.isInteger(i))s=i;else for(let i=0;i<t.length;i++)s=Math.max(s,t[i]["x"].length);for(let i=0;i<t.length;i++){const e=t[i],A=e["x"],n=e["y"],h=e["z"],r=s-A.length;for(let t=0;t<r;t++){let t=0,i=0;for(let s=0;s<A.length-1;s++){WTt.set(A[s],n[s],h[s]);WTt.set(A[s+1],n[s+1],h[s+1]);const e=WTt.distanceTo(zTt);if(e>t){WTt.add(zTt).multiplyScalar(.5);t=e;i=s}}A.splice(i+1,0,WTt.x);n.splice(i+1,0,WTt.y);h.splice(i+1,0,WTt.z)}}return t}static setOptions(t){const s=qi(t,{resamplingpointcount:i.E8e_,autosortpillars:i.p8e_,autosortpillarpoints:i.m8e_},!0);i.E8e_=s["resamplingpointcount"];i.p8e_=s["autosortpillars"];i.m8e_=s["autosortpillarpoints"]}static y8e_(t){t.forEach((t=>{const i=[],s=[],e=[];let A=-1,n=Number.MAX_VALUE;for(let i=0;i<t["z"].length;i++)if(t["z"][i]<n){A=i;n=t["z"][i]}i.push(t["x"][A]);s.push(t["y"][A]);e.push(t["z"][A]);const h=[A],r=new a;for(let A=0;A<t["z"].length-1;A++){const A=new a(i[i.length-1],s[i.length-1],e[i.length-1]);let n=Number.MAX_VALUE,o=-1;for(let i=0;i<t["z"].length;i++){if(h.indexOf(i)!==-1)continue;const s=A.distanceTo(r.set(t["x"][i],t["y"][i],t["z"][i]));if(n>s){n=s;o=i}}h.push(o);i.push(t["x"][o]);s.push(t["y"][o]);e.push(t["z"][o])}t["x"]=i;t["y"]=s;t["z"]=e}));return t}static D8e_(t){let i=Number.MAX_VALUE,s=-Number.MAX_VALUE;const e=[];for(let A=0;A<t.length;A++){i=Math.min(i,t[A]["x"][0]);s=Math.max(s,t[A]["x"][0]);e.push([t[A]["x"][0],t[A]["y"][0]])}const A=kxt.Dje_(e),n=A["a"],h=A["b"],r=[];for(let t=0;t<e.length;t++){const A=e[t],o=undefined,l=undefined,u=n*i+h,a=undefined,g=s-i,c=n*s+h-u,I=undefined,f=((A[0]-i)*g+(A[1]-u)*c)/(g*g+c*c),C=i+f*g,d=u+f*c;r.push([C,d,t])}r.sort(((t,i)=>t[0]-i[0]==0?t[1]-i[1]:t[0]-i[0]<0?-1:1));const o=[];for(let i=0;i<r.length;i++)o.push(t[r[i][2]]);return o}static Vot_(t){const s=qi(t["data"],{}),e=qi(t,{resamplingpointcount:i.E8e_,autosortpillars:i.p8e_,autosortpillarpoints:i.m8e_}),A=[];let n,h=s["pillars"];e["autosortpillarpoints"]&&(h=i.y8e_(h));e["autosortpillars"]&&(h=i.D8e_(h));e["resamplingpointcount"]>0&&(h=i.Q8e_(h,e["resamplingpointcount"]));let r=0;for(let t=0;t<h.length;t++){n=h[t];n.D9_=[];for(let t=0;t<n["x"].length;t++){A.push(n["x"][t]);A.push(n["y"][t]);A.push(n["z"][t]);n.D9_.push(r++)}}const o=[];for(let t=0;t<h.length-1;t++){n=h[t];const i=h[t+1];let s=0,e=0,A=new a(n.x[s],n.y[s],n.z[s]),r=new a(i.x[e],i.y[e],i.z[e]);while(s<n.D9_.length-1||e<i.D9_.length-1){if(s+1>=n.D9_.length){o.push(n.D9_[s],i.D9_[e],i.D9_[e+1]);e+=1;r=new a(i.x[e],i.y[e],i.z[e]);continue}if(e+1>=i.D9_.length){o.push(n.D9_[s],i.D9_[e],n.D9_[s+1]);s+=1;A=new a(n.x[s],n.y[s],n.z[s]);continue}const t=new a(n.x[s+1],n.y[s+1],n.z[s+1]),h=new a(i.x[e+1],i.y[e+1],i.z[e+1]),l=undefined,u=undefined;if(A.distanceTo(t)+r.distanceTo(t)<A.distanceTo(h)+r.distanceTo(h)){o.push(n.D9_[s],i.D9_[e],n.D9_[s+1]);s+=1;A=t}else{o.push(n.D9_[s],i.D9_[e],i.D9_[e+1]);e+=1;r=h}}}for(let t=0;t<h.length;t++){const i=undefined;delete h[t].D9_}const l=A.length/3-1;return{triangles:{position:new Float32Array(A),index:NYt.T5e_(o,l)}}}};s.E8e_=null;s.p8e_=!0;s.m8e_=!0;s=i=t([_s("geotoolkit3d.util.surface.PillarTriangulator")],s);return s}();var jTt=Ci(function(){var i;let s=i=class t extends YTt{constructor(t){super(t);this.M8e_(t);t=Es(t,!0);const s=i.Vot_(t);this.v8e_=t["data"]["pillars"];this.T2_=t["data"]["xyoffset"]||new a(0,0,0);this.$4e_({position:s["triangles"]["position"],index:s["triangles"]["index"],nullvalue:null})}r8e_(t){const i=this.getLength(t["index"]);if(!this.o8e_(i,3))throw new Error("PillarSurface index array must be of length multiple of 3"+" to properly build triangles.")}l8e_(t){const i=this.getLength(t["position"]);if(!this.o8e_(i,3)||i<3)throw new Error("PillarSurface position array must be of length multiple of 3, and contain at minimum 3 values"+" to properly build at least 1 point.")}M8e_(t){if(t["data"]==null||t["data"]["pillars"]==null)throw new Error("PillarSurfaceData has no data, constructor parameters options.data.pillars is mandatory.");const i=undefined;t["data"]["pillars"].forEach((t=>{if(!Array.isArray(t["x"])||!Array.isArray(t["y"])||!Array.isArray(t["z"]))throw new Error("PillarSurfaceData invalid constructor data:\n"+"options.data.pillars is expected to be an array of {x: number[], y: number[], z: number[]} for each pillar.");if(t["x"].length!==t["y"].length||t["x"].length!==t["z"].length)throw new Error("PillarSurfaceData invalid constructor data:\n"+"One of the pillar in options.data.pillars do not have an identical number of x/y/z values.\n"+"While pillars can have a different number of points, the same pillar's x, y and z array must be of equal size.")}))}static Vot_(t){return XTt.Vot_(t)}b8e_(){return this.v8e_}B$_(){return this.T2_}};s=i=t([_s("geotoolkit3d.data.surface.PillarSurfaceData")],s);return s}(),2,"eyJ0cmlhbmd1bGF0ZSI6IlZvdF8ifSAg");var ZTt=function(){var i;let s=i=class t extends YTt{constructor(t){super(t);this.M8e_(t);const s=t["data"];let e=null;if(s["values"]!=null){e=s["values"];s["values"]=null}const A=Pi(t,{unorderedtriangulation:{enable:!0,enablefiltergaps:!0,filtergapsthreshold:5}});if(e!=null){A["data"]["values"]=e;s["values"]=e}const n=i.g8e_(A);this.$4e_({position:n["triangles"]["position"],index:n["triangles"]["index"],values:s["values"],nullvalue:A["data"]["nullvalue"]})}M8e_(t){if(t["data"]==null||t["data"]["x"]==null||t["data"]["y"]==null||t["data"]["z"]==null)throw new Error("SurfaceData has no Data, constructor parameters options.data.x/y/z are mandatory");const i=t["data"];if(!Array.isArray(i["x"])||i["x"].length<3||!Array.isArray(i["y"])||i["y"].length<3||!Array.isArray(i["z"])||i["z"].length<3)throw new Error("SurfaceData constructor parameters options.data.x/y/z expects arrays containing"+" at least 3 values each to form at least 1 triangle.");if(i["x"].length!==i["y"].length||i["x"].length!==i["z"].length)throw new Error("SurfaceData constructor parameters options.data.x/y/z do not contain an identical number of values,"+" the data might be invalid.")}static g8e_(t){const i=t["data"]["x"],s=t["data"]["y"],e=t["data"]["z"],A=new Array(i.length*3);for(let t=0;t<i.length;t++){const n=t*3;A[n]=i[t];A[n+1]=s[t];A[n+2]=e[t]}let n;n=t["unorderedtriangulation"]["enable"]?Dm.Oot_(A,t["unorderedtriangulation"]):Dm.Vot_(A);return{triangles:{position:A,index:n}}}};s=i=t([_s("geotoolkit3d.data.surface.SurfaceData")],s);return s}();var _Tt=function(){let i=class t extends YTt{constructor(t){super(t);this.$4e_({position:t["data"]["xyz"],index:t["data"]["indices"],normal:t["data"]["normal"],values:t["data"]["values"],nullvalue:t["data"]["nullvalue"]})}};i=t([_s("geotoolkit3d.data.surface.TrimeshSurfaceData")],i);return i}();const $Tt=new C;let tKt=!0;var iKt=Ci(function(){var i;let s=i=class t{constructor(t,i){this.N8e_=12500;this.S8e_=i;this._D_=[];this._W_=null;this.G8e_=!1;if(tKt){tKt=!1;ki("Octree is deprecated since 4.0, this octree was a prototype and was not meant to be public.")}}R8e_(t){if(t<8){t=8;ki("Octree node capacity cannot be lower than 8 elements.")}this.N8e_=t;return this}split(){this._W_=new Array(8);const t=new a;this.S8e_.getSize(t).divideScalar(2);const s=this.S8e_.min,e=this.S8e_.max,A=t.x,n=t.y,h=t.z;this._W_[0]=new i(0,new C(s,(new a).addVectors(s,t))).R8e_(this.N8e_);this._W_[1]=new i(0,new C(new a(s.x+A,s.y,s.z),new a(e.x,s.y+n,s.z+h))).R8e_(this.N8e_);this._W_[2]=new i(0,new C(new a(s.x,s.y+n,s.z),new a(s.x+A,e.y,s.z+h))).R8e_(this.N8e_);this._W_[3]=new i(0,new C(new a(s.x+A,s.y+n,s.z),new a(e.x,e.y,e.z-h))).R8e_(this.N8e_);this._W_[4]=new i(0,new C(new a(s.x,s.y,s.z+h),new a(s.x+A,s.y+n,e.z))).R8e_(this.N8e_);this._W_[5]=new i(0,new C(new a(s.x+A,s.y,s.z+h),new a(e.x,s.y+n,e.z))).R8e_(this.N8e_);this._W_[6]=new i(0,new C(new a(s.x,s.y+n,s.z+h),new a(s.x+A,e.y,e.z))).R8e_(this.N8e_);this._W_[7]=new i(0,new C(new a(s.x+A,s.y+n,s.z+h),e)).R8e_(this.N8e_)}kdi_(t){if(this._W_==null)return[];let i,s;for(i=0;i<8;i++){s=this._W_[i].k8e_();if(s.containsBox(t))return[i]}const e=[];for(i=0;i<8;i++){s=this._W_[i].k8e_();s.intersectsBox(t)&&e.push(i)}return e}g1_(t){if(this.G8e_)ki("Cannot insert into reduced Octree. Reduce operation renders the octree read-only for memory savings.");else if(this._W_==null){this._D_.push(t);if(this._D_.length>this.N8e_){this.split();for(let t=0;t<this._D_.length;++t)this.g1_(this._D_[t]);this._D_=[]}}else{const i=t;$Tt.min.set(i[0],i[1],i[2]);$Tt.max.set(i[3],i[4],i[5]);const s=this.kdi_($Tt);for(let i=0;i<s.length;i++)this._W_[s[i]].g1_(t)}}intersectsPlane(t){return this.S8e_.intersectsPlane(t)}r4e_(t,i){const s=[],e=this.G8e_,A=(t,n)=>{if(i!=null&&!i.intersectsBox(t.k8e_()))return;if(!t.k8e_().intersectsPlane(n))return;const h=t.R4_();if(h!=null)for(let t=0;t<h.length;++t){const i=h[t];A(i,n)}else t.o4e_(s,e)};A(this,t);return s}o4e_(t,i){if(i){const i=this.J2_();for(let s=0;s<i.length;s++)t.push(i[s])}else{const i=this.J2_();for(let s=0;s<i.length;s++)t.push(i[s][6])}}F8e_(){const t=[],i=s=>{const e=s.J2_();if(e&&e.length>0){t.push(e);return}const A=s.R4_();if(A!=null)for(let t=0;t<A.length;t++)i(A[t])};i(this);return t}x8e_(){let t=0;const i=s=>{const e=s.J2_();if(e&&e.length>0){t++;return}const A=s.R4_();if(A!=null)for(let t=0;t<A.length;t++)i(A[t])};i(this);return t}L8e_(){if(!this.G8e_){this.U8e_();this.trim();this.G8e_=!0}}U8e_(){const t=i=>{const s=i.J2_();for(let t=0;t<s.length;t++)s[t]=s[t][6];const e=i.R4_();if(e!=null)for(let i=0;i<e.length;i++)t(e[i])};t(this)}trim(){const t=this.R4_();if(t==null)return;const i=[];for(let s=0;s<t.length;s++){const e=t[s];e.x8e_()>0&&i.push(e)}if(i.length===1){this.copy(i[0]);this.trim()}else{this.Y8e_(i);for(let t=0;t<i.length;t++)i[t].trim()}}copy(t){this.S8e_=t.k8e_();this._D_=t.J2_();this._W_=t.R4_();this.N8e_=t.T8e_()}K8e_(){return this.G8e_}R4_(){return this._W_}Y8e_(t){this._W_=t}J2_(){return this._D_}k8e_(){return this.S8e_}T8e_(){return this.N8e_}};s=i=t([_s("geotoolkit3d.data.util.Octree")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRDYXBhY2l0eSI6IlI4ZV8iLCJpbnNlcnQiOiJnMV8iLCJyZXRyaWV2ZUJ5UGxhbmUiOiJyNGVfIiwicmV0cmlldmUiOiJGOGVfIiwiZ2V0TnVtYmVyT2ZOb2RlcyI6Ing4ZV8iLCJyZWR1Y2VTaXplIjoiTDhlXyIsImlzUmVkdWNlZCI6Iks4ZV8iLCJnZXROb2RlcyI6IlI0XyIsImdldEVsZW1lbnRzIjoiSjJfIiwiZ2V0Qm91bmQiOiJrOGVfIn19LCJnZXRDbGFzc05hbWUiOiJEXyJ9");const sKt=new a,eKt=new a,AKt=new a,nKt=new a,hKt=new a,rKt=new a,oKt=new a,lKt=new a,uKt=["blue","purple","red","orange","yellow","green","cyan","white"];var aKt=function(){let i=class t{static H8e_(t){const i=new fUt,s=t["octree"],e=t["color"],A=t["levels"],n=0;if(s instanceof iKt)this.q8e_(s,i,n,e,A);else if(s instanceof oTt){const t=s.getRootNode();this.q8e_(t,i,n,e,A)}return i}static q8e_(t,i,s,e,A){const n=A==null||A.includes(s),h=e!=null?e:this.getColor(s);if(n){const s=this.J8e_(t),e=this.P8e_(h,s.min,s.max);i.add(e)}const r=t.R4_();if(r!=null&&r.length>0)for(let t=0;t<r.length;t++)this.q8e_(r[t],i,s+1,e,A)}static J8e_(t){let i;t instanceof iKt?i=t.k8e_():t instanceof rTt&&(i=t.getBoundingBox());return i}static m3e_(t,i){const s=[];for(let t=0;t<i.length;t++)s.push(i[t].x,i[t].y,i[t].z);return new cUt({data:{positions:s,endcaps:!1},color:t,linewidth:1.5})}static P8e_(t,i,s){const e=(s.x-i.x)/200,A=(s.y-i.y)/200,n=(s.z-i.z)/200;sKt.set(i.x-e,i.y-A,i.z-n);eKt.set(i.x-e,s.y+A,i.z-n);AKt.set(s.x+e,s.y+A,i.z-n);nKt.set(s.x+e,i.y-A,i.z-n);hKt.set(i.x-e,i.y-A,s.z+n);rKt.set(i.x-e,s.y+A,s.z+n);oKt.set(s.x+e,s.y+A,s.z+n);lKt.set(s.x+e,i.y-A,s.z+n);return this.m3e_(t,[sKt,eKt,eKt,AKt,AKt,nKt,nKt,sKt,hKt,rKt,rKt,oKt,oKt,lKt,lKt,hKt,sKt,eKt,eKt,rKt,rKt,hKt,hKt,sKt,eKt,AKt,AKt,oKt,oKt,rKt,rKt,eKt,AKt,nKt,nKt,lKt,lKt,oKt,oKt,AKt,sKt,nKt,nKt,lKt,lKt,hKt,hKt,sKt])}static getColor(t){const i=t%uKt.length;return uKt[i]}static V8e_(t){const i=t instanceof iKt?t:t.getRootNode();return 1+this.O8e_(i)}static O8e_(t){let i=0;const s=t.R4_();if(s!=null)for(let t=0;t<s.length;t++){i++;i+=this.O8e_(s[t])}return i}static W8e_(t,i){const s=t instanceof iKt?t:t.getRootNode(),e=new a;let A=0;const n=t=>{const i=undefined;(t instanceof iKt?t.k8e_():t.getBoundingBox()).getSize(e);A+=e.x*e.y*e.z;const s=t.R4_();if(s!=null)for(let t=0;t<s.length;t++)n(s[t])};n(s);A=Math.round(A);if(i){const t=A.toString(),i=undefined;let s=0,e=" ";for(let i=t.length-1;i>=0;i--){s++;e=t[i]+e;if(s===3){s=0;e=" "+e}}return e}return A}};i=t([_s("geotoolkit3d.data.util.OctreeDebugTool")],i);return i}();const gKt=Dxt,cKt=new a;var IKt=function(){let i=class t extends xxt{constructor(t){const i=t["material"],s=undefined;super(qi(t,{uniforms:i.z5e_(),vertexshader:gKt.zXe_(i),fragmentshader:gKt.jXe_(i),defines:i.defines},!0));this.z8e_=t["object"];this.type="DefaultPointSetPickingMaterial";this.transparent=!1;this.side=i.side;this.blending=G}j5e_(t){return Math.round(t*this.z8e_.geometry.instanceCount)}Rje_(){return!0}kje_(){return[{pickingmode:gKt.oje_,callback:(t,i)=>{const s=this.j5e_(YFt.wXe_(t));i["pointindex"]=s;if(!this.z8e_.parent)return;const e=this.z8e_.parent,A=undefined;if(!(e.D_&&e.D_()==="geotoolkit3d.scene.pointset.PointSet"))return;const n=this.z8e_.parent;n.X8e_(s);if(i["point"]){const t=n.Z5e_(s);if(t!=null){const s=t["position"];cKt.set(s[0],s[1],s[2]);this.z8e_.localToWorld(cKt);i["root"].worldToLocal(cKt);i["point"].x=cKt.x;i["point"].y=cKt.y;i["point"].z=cKt.z}}}}]}};i=t([_s("geotoolkit3d.picking.pickingrenderer.DefaultPointSetPickingMaterial")],i);return i}();var fKt=function(){var t=class{constructor(){this.reset()}notify(t,i,s){let e;++this.j8e_;const A=this.JUe_.length;for(e=0;e<A;e++)this.JUe_[e]!=null&&this.JUe_[e](t,i,s);--this.j8e_;if(this.j8e_===0&&this.Z8e_){for(e=this.JUe_.length-1;e>-1;--e)this.JUe_[e]==null&&this.JUe_.splice(e,1);this.Z8e_=!1}}clone(){const i=new t;for(let t=0;t<this.JUe_.length;t++)i.JUe_[t]=this.JUe_[t];return i}eVe_(){return this.JUe_}_8e_(t){this.JUe_[t]=null;this.Z8e_=!0}$8e_(){return this.j8e_}reset(){this.JUe_=[];this.j8e_=0;this.Z8e_=!1}};return t}(),CKt=Ci(function(){var i;let s=i=class t{constructor(){this.t6e_=null;this.i6e_=null;this.s6e_=!1;this.e6e_=!1;this.df_=!1;this.Bf_=0}dispose(){this.Qf_=null;this.Bf_=0;this.df_=!0}Ef_(){return this.Bf_>0}on(t,s){this.t6e_||(this.t6e_=new i);this.Qf_==null&&(this.Qf_={});let e=this.Qf_[t];if(!e){e=new fKt;this.Qf_[t]=e}const A=undefined;if(e.eVe_().indexOf(s)===-1){this.Bf_++;e.eVe_().push(s)}else ki("EventDispatcher.on callback function is already in the list of event listeners for this target. It is ignored!")}hasEventListener(t,i){if(!this.t6e_||this.Qf_==null)return!1;const s=this.Qf_[t];return!!s&&s.eVe_().indexOf(i)!==-1}off(t,i){if(this.Qf_!=null)if(typeof t=="string"){const s=this.Qf_[t];if(s)if(typeof i=="function"){const t=s.eVe_().indexOf(i);if(t!==-1){this.Bf_-=1;s.$8e_()>0?s._8e_(t):s.eVe_().splice(t,1)}}else{this.Bf_-=s.eVe_().length;s.reset()}}else{this.Qf_=null;this.Bf_=0}}notify(t,i,s){if(this.Qf_==null||this.wf_===!0)return;const e=this.Qf_[t];e&&e.notify.call(e,t,i,s);this.i6e_=t;if(this.s6e_&&t===tUt.kZe_){this.e6e_=!0;i.redraw!=null&&i.redraw();this.A6e_()}if(!this.s6e_&&t===tUt.kZe_){this.e6e_=!1;i.n6e_!=null&&i.n6e_()!=null&&i.n6e_().h6e_(!1)}}r6e_(){this.s6e_=!0}A6e_(){this.s6e_=!1}o6e_(){return this.e6e_}mf_(){return this.wf_}yf_(t){this.wf_!==t&&(this.wf_=t)}Df_(){return this.df_}l6e_(){return this.i6e_}u6e_(){this.i6e_=null}};s=i=t([_s("geotoolkit3d.scene.reservoir.EventDispatcher")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJwdXNoVGFzayI6InI2ZV8iLCJzZXRTaWxlbnQiOiJ5Zl8iLCJpc0Rpc3Bvc2VkIjoiRGZfIiwiZ2V0Q3VycmVudEV2ZW50IjoibDZlXyJ9fSwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");var dKt=Ci(function(){let i=class t extends fUt{constructor(){super();this.type="AbstractReservoirGrid";this.sIs_=new CKt}on(t,i){this.sIs_.on(t,i)}off(t,i){this.sIs_.off(t,i)}Gde_(){return this.sIs_}};i.prototype.a6e_=Zi;i=t([_s("geotoolkit3d.scene.reservoir.AbstractReservoirGrid")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJyZW1vdmVIaWdobGlnaHRTaGFwZSI6ImE2ZV8ifX19");var BKt=function(){let i=class t extends xxt{constructor(t){const i=t["material"],s=undefined;super(qi(t,{uniforms:i.uniforms,vertexshader:Dxt._Xe_(i),fragmentshader:Dxt.$Xe_(i),defines:i.defines},!0));this.g6e_=t["object"];this.c6e_=this.g6e_.geometry.type==="ReservoirGeometry";this.I6e_=this.g6e_.geometry.getAttribute("cgcolormapValue").count;this.type="DefaultReservoirPickingMaterial";this.transparent=!1;this.lights=i.lights;this.side=i.side;this.blending=G;this.extensions["derivatives"]=!0}X5e_(t){const i=undefined;return t/(this.c6e_?this.g6e_.geometry["userData"].f6e_:this.I6e_)}j5e_(t){const i=this.c6e_?this.g6e_.geometry["userData"].f6e_:this.I6e_;return Math.round(t*i)}Rje_(){return!0}kje_(){return[{pickingmode:Dxt.lje_,callback:(t,i,s)=>{const e=this.j5e_(YFt.wXe_(t)),A=this.g6e_.geometry.C6e_(e);let n=this.g6e_;while(n.type&&!(n instanceof dKt))n=n.parent;if(!(n instanceof dKt))return;n.d6e_(this.g6e_.geometry,A);i["value"]=A["value"];i["ijk"]=A["ijk"];const h=n.B6e_();if(h!=null){h.userData["dispose"]=n.a6e_.bind(n);s.push(h)}}}]}};i=t([_s("geotoolkit3d.picking.pickingrenderer.DefaultReservoirPickingMaterial")],i);return i}();var wKt=function(){let i=class t extends CLt{constructor(t){const i=t;i["material"]=t["material"][0];super(i);this.side=e}};i=t([_s("geotoolkit3d.picking.pickingrenderer.DefaultSeismicSlicePickingMaterial")],i);return i}();const QKt=new xA;var EKt=Ci(function(){var i;let s=i=class t extends Lxt{static w6e_(t,s,e){const A=t.getSize(QKt),n=t.EZe_().getContext().canvas.getBoundingClientRect(),h=(s-n.left)/(n.right-n.left)*A.Ie_(),r=(e-n.top)/(n.bottom-n.top)*A.Ts_();return i.Q6e_(t,h,r)}static Q6e_(t,i,s){t.gXe_().updateMatrixWorld(!0);t.GZe_().updateMatrixWorld(!0);const e=new Mt,A=new g;A.x=i/t.iM_().clientWidth*2-1;A.y=-s/t.iM_().clientHeight*2+1;e.setFromCamera(A,t.gXe_());return e.ray}static E6e_(t,i,s,e,A,n){const h=t.Ej_(),r=t.Ej_().negate();t.GZe_().position.add(r);t.gXe_().position.add(r);t.gXe_().updateMatrixWorld(!0);t.GZe_().updateMatrixWorld(!0);const o=new Mt,l=new g;l.x=i/t.iM_().clientWidth*2-1;l.y=-s/t.iM_().clientHeight*2+1;o.setFromCamera(l,t.gXe_());n!=null&&ki("RayCastPicking.pickFrom linePrecision was deprecated in geotoolkit 4.0");const u=o.intersectObjects([e],!0),a=[],c={};for(let e=0;e<u.length;e++)if(!isNaN(u[e]["distance"])&&c[u[e]["object"]["uuid"]]==null){let A=u[e]["object"],n=!1;while(A!==null){if(A.OC_!=null&&!A.OC_()){n=!0;break}A=A.parent}if(n)continue;u[e]["point"]=u[e]["point"].clone();t.fZe_(u[e]["point"]);a.push({object:u[e]["object"],point:u[e]["point"],pointdevice:new g(i,s),distance:u[e]["distance"]});c[u[e]["object"]["uuid"]]=!0}a.sort(((t,i)=>t["distance"]-i["distance"]));t.GZe_().position.add(h);t.gXe_().position.add(h);t.gXe_().updateMatrixWorld(!0);t.GZe_().updateMatrixWorld(!0);return a}static pO_(t,i,s){const e=t.GZe_();return this.E6e_(t,i,s,e)}};s=i=t([_s("geotoolkit3d.picking.RayCastPicking")],s);return s}(),2,"eyJnZXRQaWNraW5nUmF5Q2xpZW50IjoidzZlXyIsImdldFBpY2tpbmdSYXkiOiJRNmVfIiwicGljayI6InBPXyJ9");var pKt=Ci(function(){let i=class t extends Lxt{static pO_(t,i,s,e,A,n){const h=[];let r=$Lt.pO_(t,i,s,e,A,n);const o=t.JV_()["picking"];t.setOptions({picking:{usecache:!1}});while(r.length>0){const o=r.pop();h.push(o);o["object"].userData.p6e_=o["object"].visible;o["object"].visible=!1;r=$Lt.pO_(t,i,s,e,A,n)}t.setOptions({picking:o});h.forEach((t=>{t["object"].visible=t["object"].userData.p6e_}));return h}};i=t([_s("geotoolkit3d.picking.RendererMultiPicking")],i);return i}(),2,"eyJwaWNrIjoicE9fIn0g");var mKt=function(){var i;let s=i=class t{static m6e_(t){if(!i.yNi_){i.yNi_=!0;let s=!1;if(!t){try{if(!Mi.WebGLRenderingContext)return;t=new D}catch(t){return}s=!0}if(t==null)return;i.y6e_=!0;i.D6e_=t["capabilities"]["isWebGL2"];i.M6e_=t["capabilities"]["maxTextureSize"];i.v6e_=t["capabilities"]["maxTextures"];const e=t.getContext();if(je._i_()){const t=e.getParameter(e.RENDERER);i.b6e_=t.indexOf("Intel")>=0}else{const t=e.getExtension("WEBGL_debug_renderer_info");(!t||e.getParameter(t["UNMASKED_RENDERER_WEBGL"]).indexOf("Intel")>=0)&&(i.b6e_=!0)}s&&t.dispose()}}static N6e_(){i.yNi_||i.m6e_();return i.M6e_}static S6e_(){i.yNi_||i.m6e_();return i.v6e_}static G6e_(){i.yNi_||i.m6e_();return i.y6e_}static R6e_(){i.yNi_||i.m6e_();if(i.b6e_==null){ki("WebGLConstants.isIntelGPU: cannot determine the type of GPU");return null}return i.b6e_}static isWebGL2(){i.yNi_||i.m6e_();return i.D6e_}static canvas(){i.k6e_==null&&(i.k6e_=Mi.CanvasRenderingContext2D&&!0);return i.k6e_}};s.yNi_=!1;s.k6e_=null;s.y6e_=!1;s.D6e_=!1;s.b6e_=!1;s.M6e_=0;s.v6e_=0;s=i=t([_s("geotoolkit3d.util.WebGLConstants")],s);return s}();var yKt=Ci(function(){let i=class t extends fUt{constructor(){super();this.F6e_=[]}P$e_(t){return this.F6e_.indexOf(t)!==-1}x6e_(t){const i=this.F6e_.indexOf(t);this.F6e_.indexOf(t)!==-1&&this.F6e_.splice(i,1)}O$e_(t){const i=undefined;this.F6e_.indexOf(t)===-1&&this.F6e_.push(t);this.F6e_.length===1&&this.invalidateObject(new iUt({type:tUt.Animation,source:this,args:{}}));return this}updateObject(t,i){const s=[];let e;for(e=0;e<this.F6e_.length;e++)this.F6e_[e].run()&&s.push(e);for(e=s.length-1;e>=0;e--)this.F6e_.splice(s[e],1);this.F6e_.length>0&&this.invalidateObject(new iUt({type:tUt.Animation,source:this,args:{}}));return this}dispose(){this.F6e_=null}};i=t([_s("geotoolkit3d.scene.animation.AnimationManager")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJjaGVja0FuaW1hdGlvbiI6IlAkZV8iLCJyZW1vdmVBbmltYXRpb24iOiJ4NmVfIiwiYWRkQW5pbWF0aW9uIjoiTyRlXyJ9fX0g");var DKt=function(){let i=class t extends fUt{constructor(){super();Object.assign(this,{type:"AbstractSurface"})}};i=t([_s("geotoolkit3d.scene.surface.AbstractSurface")],i);return i}();const MKt=1e-6,vKt=1e-6,bKt=1e-10,NKt=new a,SKt=new a,GKt=new a,RKt=new a,kKt=new a,FKt=new a,xKt=new a;var LKt=function(){let i=class t{static intersectLine(t,i,s,e){const A=i.delta(NKt),n=t.normal.dot(A);if(Math.abs(n)<bKt){if(Math.abs(t.distanceToPoint(i.start))<vKt){s.copy(i.start);if(i.start.equals(i.end))return 1;e.copy(i.end);return 2}return 0}const h=-(i.start.dot(t.normal)+t.constant)/n;if(h<0||h>1)return 0;s.copy(i.start).addScaledVector(A,h);return 1}static L6e_(t,i,s,e,A){const n=t.distanceTo(i);let h;h=n<MKt?.5:t.distanceTo(s)/n;return h*A+(1-h)*e}static U6e_(t,i){const s=t.length/3;if(s<=3)return t;GKt.set(0,0,0);for(let i=0;i<s;i++){const s=i*3;GKt.x+=t[s];GKt.y+=t[s+1];GKt.z+=t[s+2]}GKt.divideScalar(s);SKt.set(t[0],t[1],t[2]);kKt.subVectors(SKt,GKt);FKt.copy(kKt).applyAxisAngle(i,Math.PI/2);const e=[];for(let i=1;i<s;i++){const s=i*3;RKt.set(t[s],t[s+1],t[s+2]);xKt.subVectors(RKt,GKt);const A=FKt.dot(xKt);let n;if(A===0)n=kKt.dot(xKt)>0?0:Math.PI;else{n=kKt.angleTo(xKt);A<0&&(n=2*Math.PI-n)}e.push([RKt.x,RKt.y,RKt.z,n])}e.sort(((t,i)=>t[3]-i[3]));const A=[t[0],t[1],t[2]];for(let t=0;t<e.length;t++){const i=e[t];A.push(i[0],i[1],i[2])}return A}static Y6e_(t,i){return Math.abs(t.x-i.x)<MKt&&Math.abs(t.y-i.y)<MKt&&Math.abs(t.z-i.z)<MKt}static T6e_(t,i){return this.K6e_(t,i)||this.H6e_(t,i)||this.q6e_(t,i)}static K6e_(t,i){let s,e;s=e=t[0].x;for(let i=1;i<t.length;i++){const A=t[i].x;s=Math.min(A,s);e=Math.max(A,e)}return s>i.max.x||e<i.min.x}static H6e_(t,i){let s,e;s=e=t[0].y;for(let i=1;i<t.length;i++){const A=t[i].y;s=Math.min(A,s);e=Math.max(A,e)}return s>i.max.y||e<i.min.y}static q6e_(t,i){let s,e;s=e=t[0].z;for(let i=1;i<t.length;i++){const A=t[i].z;s=Math.min(A,s);e=Math.max(A,e)}return s>i.max.z||e<i.min.z}};i=t([_s("geotoolkit3d.util.intersection.IntersecMath")],i);return i}();const UKt=[[0,1],[1,2],[2,0]],YKt=new vt;let TKt;var KKt=function(){let i=class t{static J6e_(t,i,s,e,A){if(e!=null&&LKt.T6e_(t.points,e))return;const n=this.P6e_(),h=t.points;for(let t=0;t<3;t++){const s=n[t],e=UKt[t];YKt.start.copy(h[e[0]]);YKt.end.copy(h[e[1]]);s.V6e_=LKt.intersectLine(i,YKt,s.ptA,s.ptB)}const r=!!A;r&&this.O6e_(t,n);this.W6e_(t,n,s,r)}static z6e_(){const t=[],i=[];for(let s=0;s<3;s++){t.push([new a,new a]);i.push([0,0])}return{X6e_:t,j6e_:0,values:i}}static Z6e_(t,i,s,e,A){const n=e.getX(t),h=e.getX(t+1),r=e.getX(t+2),o=i.points;o[0].set(s.getX(n),s.getY(n),s.getZ(n));o[1].set(s.getX(h),s.getY(h),s.getZ(h));o[2].set(s.getX(r),s.getY(r),s.getZ(r));if(A!=null){const t=i.values;t[0]=A[n];t[1]=A[h];t[2]=A[r]}}static O6e_(t,i){const s=t.points,e=t.values;for(let t=0;t<3;t++){const A=i[t];if(A.V6e_===0)continue;const n=UKt[t],h=n[0],r=n[1];if(A.V6e_===1)A._6e_=LKt.L6e_(s[h],s[r],A.ptA,e[h],e[r]);else if(A.V6e_===2){A._6e_=e[h];A.$6e_=e[r]}}}static P6e_(){if(TKt!=null)return TKt;const t=[];for(let i=0;i<3;i++)t[i]={V6e_:0,ptA:new a,ptB:new a,_6e_:0,$6e_:0};TKt=t;return TKt}static W6e_(t,i,s,e){let A=0,n=0,h=-1;for(let t=0;t<3;t++){const i=TKt[t];if(i.V6e_===1){A++;h===-1&&(h=t)}i.V6e_===2&&n++}if(A!==0||n!==0)if(n!==1&&n!==3)switch(A){case 1:this.t9e_(t,i,s,e,h);return;case 2:this.i9e_(i,s,e);return;case 3:this.s9e_(i,s,e);return;default:}else this.e9e_(i,s,e)}static e9e_(t,i,s){let e=0;t.forEach((t=>{if(t.V6e_===2){i.j6e_++;i.X6e_[e][0].copy(t.ptA);i.X6e_[e][1].copy(t.ptB);if(s){i.values[e][0]=t._6e_;i.values[e][1]=t.$6e_}e++}}))}static t9e_(t,i,s,e,A){const n=UKt[A],h=t.points[n[0]],r=t.points[n[1]],o=i[A].ptA;if(LKt.Y6e_(h,o)||LKt.Y6e_(r,o))return;let l=2;n[0]!==0&&n[1]!==0?l=0:n[0]!==1&&n[1]!==1&&(l=1);s.X6e_[0][0].copy(o);s.X6e_[0][1].copy(t.points[l]);if(e){s.values[0][0]=i[A]._6e_;s.values[0][1]=t.values[l]}s.j6e_=1}static i9e_(t,i,s){const e=[];for(let i=0;i<3;i++){const s=t[i];s.V6e_===1&&e.push(s)}const A=e[0],n=e[1];if(!LKt.Y6e_(A.ptA,n.ptA)){i.j6e_=1;i.X6e_[0][0].copy(A.ptA);i.X6e_[0][1].copy(n.ptA);if(s){i.values[0][0]=A._6e_;i.values[0][1]=n._6e_}}}static s9e_(t,i,s){let e=1;LKt.Y6e_(t[0].ptA,t[1].ptA)&&(e=2);const A=t[0],n=t[e];i.j6e_=1;i.X6e_[0][0].copy(A.ptA);i.X6e_[0][1].copy(n.ptA);if(s){i.values[0][0]=A._6e_;i.values[0][1]=n._6e_}}};i=t([_s("geotoolkit3d.util.intersection.Triangle")],i);return i}();const HKt=[[0,2],[0,1],[2,3],[1,3],[1,5],[3,7],[5,7],[6,7],[4,5],[4,6],[2,6],[0,4]],qKt=new vt,JKt=new a;var PKt=function(){let i=class t{static A9e_(t,i,s,e,A){const n=t["x"],h=t["y"],r=t["z"],o=[],l=new a,u=new a;for(let t=0;t<HKt.length;++t){qKt.start.set(n[HKt[t][0]],h[HKt[t][0]],r[HKt[t][0]]);qKt.end.set(n[HKt[t][1]],h[HKt[t][1]],r[HKt[t][1]]);const s=LKt.intersectLine(i,qKt,l,u);s>0&&this.n9e_(l,o);s===2&&this.n9e_(u,o)}if(o.length===0)return;const g=LKt.U6e_(o,i.normal);s.push(g);e&&A.push(t["value"])}static n9e_(t,i){for(let s=0;s<i.length;s++){const e=s*3;JKt.set(i[e],i[e+1],i[e+2]);if(LKt.Y6e_(t,JKt))return}i.push(t.x,t.y,t.z)}};i=t([_s("geotoolkit3d.util.intersection.Polyhedron")],i);return i}();const VKt="#000000",OKt=new C,WKt=new nA;var zKt=function(){let i=class t{static h9e_(t,i,s){const e=t.normal.clone().normalize(),A=(new a).subVectors(s,i).normalize(),n=e.clone().cross(A),h=(new u).set(i.x,i.x+A.x,i.x+n.x,i.x+e.x,i.y,i.y+A.y,i.y+n.y,i.y+e.y,i.z,i.z+A.z,i.z+n.z,i.z+e.z,1,1,1,1),r=undefined;return(new u).set(0,0,1,0,0,1,0,0,0,0,0,1,1,1,1,1).multiply(h.invert())}static r9e_(t,i,s){const e=i.matrixWorld.clone().invert(),A=i.o9e_(0),n=i.o9e_(1),h=i.o9e_(2),r=A.distanceTo(n),o=A.distanceTo(h),l=new b;l.setFromCoplanarPoints(A,h,n);const a=this.h9e_(l,A,h),g=(new u).makeScale(s.Ie_()/r,s.Ts_()/o,0),c=(new u).makeTranslation(s.getX(),s.getY(),0),I=t.matrixWorld.clone();I.premultiply(e);I.premultiply(a);I.premultiply(g);I.premultiply(c);return I}static l9e_(t,i){const s=t.cZe_(0),e=t.cZe_(1),A=t.cZe_(2),n=t.cZe_(3);i.worldToLocal(s);i.worldToLocal(e);i.worldToLocal(A);i.worldToLocal(n);const h=undefined,r=undefined;return[(new b).setFromCoplanarPoints(s,e,A),(new C).setFromPoints([s,e,A,n])]}static u9e_(t,i,s,e){let A,n,h,r=s;if(s){const t=i.getData(),s=i.JV_();h=s["colorprovider"];h!=null&&t!=null&&t["values"]!=null?A=t["values"]:r=!1;if(!r){const t=s["color"],i=s["opacity"]==null?1:s["opacity"];if(t==null){WKt.setColor(VKt);WKt.setAlpha(i*255)}else WKt.setColor(t.r*255,t.g*255,t.b*255,i*255);n=WKt.Es_()}}const o=[],l=[],u=i.a9e_()["geometry"],g=u.getIndex(),c=u.getAttribute("position"),I=u.L4e_().r4e_(t,e),f={points:[new a,new a,new a],values:r?[0,0,0]:null},C=KKt.z6e_();for(let i=0;i<I.length;i++){C.j6e_=0;const s=I[i]*3;KKt.Z6e_(s,f,c,g,A);KKt.J6e_(f,t,C,e,r);if(C.j6e_===0)continue;const u=C.j6e_;for(let t=0;t<u;t++){const i=C.X6e_[t];o.push(i[0].x,i[0].y,i[0].z,i[1].x,i[1].y,i[1].z);if(r){const i=C.values[t],s=h.getColor(i[0]),e=h.getColor(i[1]),A=s==null?n:s.Es_(),r=e==null?n:e.Es_();l.push(A,r)}}}s&&!r&&l.fill(n,0,o.length/3);return{coordinates:o,colors:l}}static g9e_(t,i,s,e){const A=i.getData(),n=undefined,h=A.c9e_().r4e_(t,e),r=[],o=[];for(let n=0;n<h.length;++n){const l=h[n];if(i.I9e_(l))continue;const u=A.f9e_(l,OKt);OKt.intersectsPlane(t)&&((e==null||OKt.intersectsBox(e))&&PKt.A9e_(u,t,r,s,o))}return{coordinates:r,colors:o}}};i=t([_s("geotoolkit3d.util.intersection.IntersectionUtils")],i);return i}();const XKt=2048,jKt=1,ZKt=4096,_Kt="overlaySamplerUniform";var $Kt=Ci(function(){var i;let s=i=class t extends xTt{constructor(t){let i=ixt.VXe_;const s=["uniform sampler2D "+_Kt+";"].join("\n"),e=["#ifdef USE_UV","#ifndef "+AFt,"   vec4 ov = texture2D("+_Kt+", vUv);","   diffuseColor.rgb *= diffuseColor.a;","   diffuseColor.rgb = diffuseColor.rgb * (1. - ov.a) + ov.rgb * ov.a;","   diffuseColor.a = min(1., diffuseColor.a + ov.a);","   diffuseColor.rgb /= diffuseColor.a;","#endif","#endif"].join("\n");i="#define USE_UV\n"+i;i=YFt.EXe_(i,ixt.SXe_,s,!1,!0);i=YFt.EXe_(i,ixt.kXe_,e,!1,!0);t["fragmentShader"]=i;super(t=qi(t,{lights:!1,map:new r,vertexShader:"#define USE_UV\n"+ixt.PXe_,fragmentShader:i,usemipmaps:!0}));this.type="PlaneMaterial";this.C9e_=XKt;this.d9e_=XKt;this.B9e_=t["usemipmaps"];this.w9e_=1;this.Q9e_=null;this.E9e_=null;this.uniforms[_Kt]=new h(null);this.p9e_(t["overlayoptions"])}p9e_(t){if(t==null)return;const i=t["width"]!=null||t["height"]!=null||t["pixelscale"]!=null,s=i||t["shapegroup"]!=null||t.hasOwnProperty("backgroundfillstyle");t["width"]!=null&&(this.C9e_=t["width"]);t["height"]!=null&&(this.d9e_=t["height"]);t["pixelscale"]!=null&&(this.w9e_=t["pixelscale"]);if(t.hasOwnProperty("backgroundfillstyle")){let i=t["backgroundfillstyle"];i==null||i instanceof wr||(i=new wr(i));this.E9e_=i}t["shapegroup"]!=null&&(this.Q9e_=t["shapegroup"]);s&&this.m9e_(i)}setOptions(t){if(t==null)return this;super.setOptions(t);this.p9e_(t["overlayoptions"]);return this}m9e_(t){const s=i.y9e_(this.C9e_),e=i.y9e_(this.d9e_);if(this.D9e_==null)this.M9e_();else if(t){this.v9e_.ce_(0,0,s,e);this.b9e_.ce_(0,0,this.C9e_,this.d9e_);this.D9e_.image.width=s;this.D9e_.image.height=e}const A=this.N9e_.getContext("2d"),n=fr.Xw_({context:A,viewport:this.v9e_,pixelscale:this.w9e_});A.clearRect(0,0,s,e);if(this.E9e_){n.iQ_(this.E9e_);A.fillRect(0,0,s,e)}if(this.Q9e_!=null){this.Q9e_.ht_(this.b9e_);this.Q9e_.render(n);this.D9e_.needsUpdate=!0}}M9e_(){if(this.D9e_!=null)return;const t=i.y9e_(this.C9e_*this.w9e_),s=i.y9e_(this.d9e_*this.w9e_);this.N9e_=Ls(t,s,!0);this.D9e_=new Dt(this.N9e_);if(this.B9e_){this.D9e_.generateMipmaps=!0;this.D9e_.minFilter=tt}else{this.D9e_.generateMipmaps=!1;this.D9e_.minFilter=o}this.D9e_.anisotropy=16;this["uniforms"][_Kt].value=this.D9e_;this.v9e_=new mA(0,0,t,s);this.b9e_=new mA(0,0,this.C9e_,this.d9e_)}S9e_(){return this.D9e_}G9e_(){ki("getTextureDimension() is deprecated since 4.0."+"\nPlease instead use getImageTextureDimension() or getOverlayTextureDimension() according to the need.");return this.R9e_()}k9e_(t){if(this.map&&this.map.image&&this.map.image.width>0){t||(t=new g);return t.set(this.map.image.width,this.map.image.height)}return null}R9e_(t){if(this.D9e_!=null){t||(t=new g);return t.set(this.D9e_.image.width,this.D9e_.image.height)}return null}x8_(){return this.Q9e_}static y9e_(t){return Math.min(ZKt,Math.max(jKt,t))}dispose(){super.dispose();this.N9e_=null;this.D9e_!=null&&this.D9e_.dispose();this.D9e_=null}};s=i=t([_s("geotoolkit3d.scene.plane.PlaneMaterial")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPdmVybGF5VGV4dHVyZSI6IlM5ZV8iLCJnZXRUZXh0dXJlRGltZW5zaW9uIjoiRzllXyIsImdldEltYWdlVGV4dHVyZURpbWVuc2lvbiI6Ims5ZV8iLCJnZXRPdmVybGF5VGV4dHVyZURpbWVuc2lvbiI6IlI5ZV8iLCJnZXRPdmVybGF5IjoieDhfIn19fSAg");$Lt.yZe_($Kt.D_(),yLt);const tHt="Warning: "+"options.width/height are deprecated, please use options.overlayoptions.width/height/pixelscale instead.",iHt=2048,sHt=new a,eHt=new a,AHt=new a;var nHt=Ci(function(){var i;let s=i=class t extends fUt{constructor(t){super();i.F9e_(t);const s=Pi(t,{overlayoptions:{width:iHt,height:iHt,backgroundfillstyle:"#77777777"}});this.x9e_=new $Kt(s);let e;if(t["createfrompoints"]!=null){const i=t["createfrompoints"];if(i["a"]==null||i["b"]==null||i["c"]==null){ki("Plane constructor option.createfrompoints requires all 3 points a, b and c.");return}t["planegeometry"]==null&&t["width"]==null&&t["height"]==null||ki("Plane constructor option.createfrompoints is already specified,"+" options planegeometry, width and height will be ignored.");e=this.L9e_(i["a"],i["b"],i["c"])}else if(t["planegeometry"]!=null){e=t["planegeometry"];e.index.array.length>6&&ki("Using custom PlaneGeometry with more than 2 triangles to build a geotoolkit3d/scene/plane/Plane will "+"result in artifacts when used for intersections.\n"+"Please instead create a PlaneGeometry using constructor arguments widthSegments === 1 and heightSegments === 1");t["width"]==null&&t["height"]==null||ki("Plane constructor option.planegeometry is already specified,"+" options width and height will be ignored.")}else{const i=t["width"]!=null?t["width"]:1,s=t["height"]!=null?t["height"]:1;e=new bt(i,s)}this.U9e_=new W(e,this.x9e_);this.U9e_.geometry.computeBoundingBox();this.add(this.U9e_);Object.assign(this,{type:"Plane"})}static F9e_(t){if(t["overlay"]instanceof sI){const i=t["overlay"];t["overlayoptions"]={shapegroup:i};ki("Warning: Group as options.overlay is deprecated, use options.overlayoptions.shapegroup instead.")}(t.hasOwnProperty("widthsegments")||t.hasOwnProperty("heightsegments"))&&ki("Warning: options.widthsegments and options.heightsegments are deprecated since 4.0, "+"Plane should be made of a single Quad to perform correctly. "+"If multiple quad per plane is needed please instead use THREE.PlaneGeometry.");t["overlayoptions"]==null&&(t["overlayoptions"]={});t["texturewidth"]!=null&&(t["overlayoptions"]["width"]=t["texturewidth"]);t["textureheight"]!=null&&(t["overlayoptions"]["height"]=t["textureheight"]);if(t["texturewidth"]!=null||t["textureheight"]!=null){t["texturewidth"]=null;t["textureheight"]=null;ki(tHt)}if(t.hasOwnProperty("backgroundfillstyle")){t["overlayoptions"]["backgroundfillstyle"]=t["backgroundfillstyle"];delete t["backgroundfillstyle"];ki("Warning: options.backgroundfillstyle is deprecated, use options.overlayoptions.backgroundfillstyle instead.")}}Y9e_(t){if(t!=null){i.F9e_(t);this.U9e_.geometry.computeBoundingBox();this.x9e_.setOptions(t);this.invalidateObject()}}setOptions(t){this.Y9e_(t);return this}M9e_(){this.x9e_.M9e_()}T9e_(){ki("getTexture() is deprecated since 4.0, please use getImageTexture() or getOverlayTexture() instead.");return this.S9e_()}K9e_(){return this.x9e_&&this.x9e_.map?this.x9e_.map:null}S9e_(){return this.x9e_.S9e_()}x8_(){return this.x9e_==null?null:this.x9e_.x8_()}a9e_(){return this.U9e_}H9e_(t){this.setOptions({overlayoptions:{shapegroup:t}})}G9e_(){ki("getTextureDimension() is deprecated since 4.0,"+" please use getImageTextureDimension() or getOverlayTextureDimension() instead.");return this.x9e_.G9e_()}k9e_(t){return this.x9e_.k9e_(t)}R9e_(t){return this.x9e_.R9e_(t)}getBoundingBox(){return this.U9e_.geometry.boundingBox.clone()}zje_(){const t=this.U9e_.geometry.boundingBox.clone();this.localToWorld(t.min);this.localToWorld(t.max);return t}cZe_(t,i){const s=this.a9e_();i=this.o9e_(t,i);s.localToWorld(i);return i}o9e_(t,i){const s=this.a9e_().geometry.getAttribute("position");i==null&&(i=new a);i.set(s.getX(t),s.getY(t),s.getZ(t));return i}L9e_(t,i,s){const e=new bt;eHt.subVectors(i,t);AHt.subVectors(s,t);sHt.copy(t).add(eHt).add(AHt);const A=new Float32Array([t.x,t.y,t.z,i.x,i.y,i.z,s.x,s.y,s.z,sHt.x,sHt.y,sHt.z]);e.setAttribute("position",new V(A,3));e.computeBoundingBox();e.computeVertexNormals();return e}dispose(){if(!this.Df_()){super.dispose();fLt.dispose(this.U9e_);this.U9e_=null;fLt.tZe_(this.x9e_);this.x9e_=null}}};s=i=t([_s("geotoolkit3d.scene.plane.Plane")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRUZXh0dXJlIjoiVDllXyIsImdldEltYWdlVGV4dHVyZSI6Iks5ZV8iLCJnZXRPdmVybGF5VGV4dHVyZSI6IlM5ZV8iLCJnZXRPdmVybGF5IjoieDhfIiwiZ2V0TWVzaCI6ImE5ZV8iLCJnZXRUZXh0dXJlRGltZW5zaW9uIjoiRzllXyIsImdldEltYWdlVGV4dHVyZURpbWVuc2lvbiI6Ims5ZV8iLCJnZXRPdmVybGF5VGV4dHVyZURpbWVuc2lvbiI6IlI5ZV8iLCJnZXRDb3JuZXIiOiJjWmVfIiwiZ2V0TG9jYWxDb3JuZXIiOiJvOWVfIn19fSAg");const hHt=new lA(0,0),rHt=new lA(1,0),oHt=new lA(0,1),lHt="#000000";var uHt=function(){let i=class t{static mR_(t,i){const s=i.x8_()||new sI,e=t["coordinates"]["x"],A=t["coordinates"]["y"],n=new Cp({linestyle:this.q9e_(t)});for(let t=0;t<e.length-1;t+=2){const i=t,s=t+1;n.add([e[i],e[s]],[A[i],A[s]])}s.Gq_(n);i.H9e_(s);this.J9e_(i);return[n]}static P9e_(t,i){let s=i.x8_();s==null&&(s=new sI);const e=[],A=t["coordinates"]["x"],n=t["coordinates"]["y"],h=t["fillstyle"];for(let t=0;t<A.length;t++){if(A[t].length<3)continue;A[t].length>3&&NA.cA_(A[t],n[t]);const i=new oE({x:A[t],y:n[t],fillstyle:h[t]});s.Gq_(i);e.push(i)}i.H9e_(s);this.J9e_(i);return e}static J9e_(t){const i=t.D_(),s=undefined;(i==="geotoolkit3d.scene.seismic.FencePanel"||i==="geotoolkit3d.scene.seismic.Slice")&&t.DH_(null,!0)}static V9e_(t,i,s){let e=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY;const r=t.length;if(r===0)return null;for(let s=0;s<r;s++){A=Math.max(A,t[s]);e=Math.min(e,t[s]);h=Math.max(h,i[s]);n=Math.min(n,i[s])}const o=A-e,l=h-n,u=o>l,a=u?t:i,g=u?e:n;let c=u?o:l;c<Number.EPSILON&&(c=1);const I=new Array(r);for(let t=0;t<r;t++)I[t]=(a[t]-g)/c;const f=u?rHt:oHt,C=new Fo({startcolor:s[0]||lHt,endcolor:s[r-1]||lHt,startpoint:hHt,endpoint:f});for(let t=1;t<r-1;t++)C.LQ_(I[t],s[t]||lHt);return C}static q9e_(t){let i;i=t["linestyle"]?hl.Wi_(t["linestyle"]):new hl({fill:t["fillstyle"]});i.VD_(nl._r_);i.de_(t["linewidth"]);return i}static O9e_(t){const i=new mA;if(!t||!t.D_)return i;if(t instanceof nHt){const s=new g;t.M9e_();t.R9e_(s);i.de_(s.x);i.Be_(s.y)}else if(t.D_()==="geotoolkit3d.scene.seismic.Slice"){i.ce_(t.G9e_());i.setX(0);i.setY(0)}else t.D_()==="geotoolkit3d.scene.seismic.FencePanel"&&i.ce_(t.G9e_());return i}};i=t([_s("geotoolkit3d.util.intersection.Overlay2D")],i);return i}();const aHt=new a;var gHt=function(){let i=class t{static W9e_(t,i,s){let e=!1,A=!1;i.traverse((t=>{if(t.D_)if(t.D_()==="geotoolkit3d.scene.reservoir.hexahedral.ReservoirGrid"){e=!0;i=t}else if(t instanceof DKt||t.D_()==="geotoolkit3d.scene.seismic.Horizon"){A=!0;i=t}}));typeof i.JV_!="function"||s.hasOwnProperty("preservecolor")||(s["preservecolor"]=i.JV_()["colorprovider"]!=null);let n=[];e?n=this.z9e_(t,i,s):A?n=this.X9e_(t,i,s):ki("geotoolkit3d.util.intersection.AbstractIntersection: does not support this type of object.");return n}static z9e_(t,i,s){const e=s["preservecolor"],A=zKt.l9e_(t,i),n=A[0],h=A[1],r=zKt.g9e_(n,i,e,h),o=r["coordinates"],l=r["colors"],u=uHt.O9e_(t),a=zKt.r9e_(i,t,u),g=o.length,c=[],I=[];for(let t=0;t<g;t++){const i=o[t].length/3;if(i===0)continue;const s=new Array(i),e=new Array(i);for(let A=0;A<i;A++){const i=A*3,n=o[t];aHt.set(n[i],n[i+1],n[i+2]);aHt.applyMatrix4(a);s[A]=aHt.x;e[A]=aHt.y}c.push(s);I.push(e)}let f;if(e&&Array.isArray(l)&&l.length>0){const t=i.JV_()["colorprovider"],s=new Array(g);for(let i=0;i<g;++i)s[i]=new wr(t.getColor(l[i]));f=s}else f=new Array(g).fill(s["fillstyle"]);const C={coordinates:{x:c,y:I},fillstyle:f};return uHt.P9e_(C,t)}static X9e_(t,i,s){const e=s["preservecolor"],A=zKt.l9e_(t,i),n=A[0],h=A[1],r=zKt.u9e_(n,i,e,h),o=r["coordinates"],l=r["colors"],u=uHt.O9e_(t),a=zKt.r9e_(i,t,u),g=o.length/3,c=new Array(g),I=new Array(g);for(let t=0;t<g;t++){const i=t*3;aHt.set(o[i],o[i+1],o[i+2]);aHt.applyMatrix4(a);c[t]=aHt.x;I[t]=aHt.y}const f={coordinates:{x:c,y:I},linestyle:s["linestyle"],fillstyle:s["fillstyle"],linewidth:s["linewidth"]};if(e&&r["colors"]!==void 0){f["fillstyle"]=uHt.V9e_(c,I,l);f["linestyle"]=null}return uHt.mR_(f,t)}};i=t([_s("geotoolkit3d.util.intersection.PlaneMeshIntersection")],i);return i}();const cHt=["geotoolkit3d.scene.seismic.FencePanel","geotoolkit3d.scene.seismic.Slice","geotoolkit3d.scene.plane.Plane"];let IHt;var fHt=Ci(function(){var i;let s=i=class t extends $n{constructor(){if(IHt!=null){ki("geotoolkit3d.util.intersection.IntersectionManager is singleton, "+"please avoid constructor and use getDefaultInstance() instead.");return IHt}super();this.j9e_=!0;this.Z9e_=new Map;this._9e_=new Map;this.$9e_=new Map;this.t7e_=new Map;this.i7e_=new Map;return this}static IO_(){IHt==null&&(IHt=new i);return IHt}static s7e_(t,i){ki("setBaseClass() is deprecated since 4.0, there is no need to register Intersectors for each classes now."+"New classes should either inherit supported classes or receive explicit support, as intersections are a case by case matter.")}e7e_(t){this.j9e_=t}A7e_(){return this.j9e_}n7e_(t,i,s){let e;if(this.t7e_.has(t.uuid)&&this.t7e_.get(t.uuid).has(i.uuid))e=this.t7e_.get(t.uuid).get(i.uuid);else{e={preservecolor:!0,linewidth:6,fillstyle:new wr("red")};this.t7e_.has(t.uuid)||this.t7e_.set(t.uuid,new Map)}s=Pi(s,e);this.t7e_.get(t.uuid).set(i.uuid,s);return s}h7e_(t,i,s){const e=this.r7e_(t);if(e==null)return;const A=t.uuid+i.uuid,n=e[0];this.fq_(n,A);const h=gHt.W9e_(n,i,s);this.i7e_.set(A,h);this.o7e_(h,s)}r7e_(t){let i,s;t.traverse((t=>{i==null&&t instanceof fUt&&cHt.forEach((e=>{if(e===t.D_()){const A=t;if(typeof A.x8_=="function"){i=A;s=e;return}}}))}));return i!=null?[i,s]:null}o7e_(t,i){if(t.length===0)return;let s,e=null,A=null;i["fillstyle"]==null&&delete i["fillstyle"];i["linestyle"]==null&&delete i["linestyle"];if(i["preservecolor"]===!0){e=il.BD_(i["fillstyle"]);delete i["fillstyle"];A=hl.Wi_(i["linestyle"]);delete i["linestyle"]}for(s=0;s<t.length;s++){t[s].rd_(!1);t[s].dt_(i);if(e!=null){const i=e.clone(),A=t[s].ct_();A!=null&&i.setColor(A.getColor());t[s].iQ_(i)}if(A!=null){const i=A.clone(),e=t[s].gt_();e!=null&&i.setColor(e.getColor());t[s].rB_(i)}t[s].rd_(!0)}t[0].zf_(null,!0)}l7e_(t,i){return!(!this.u7e_(t)||!this.u7e_(i))&&((t.Df_==null||!t.Df_())&&((i.Df_==null||!i.Df_())&&this.r7e_(t)!=null))}W9e_(t,i,s){if(this.l7e_(t,i)){s=this.n7e_(t,i,s);this.a7e_(this.Z9e_,t);this.a7e_(this.Z9e_,i);this.g7e_(this.$9e_,t,i);this.g7e_(this._9e_,i,t);this.h7e_(t,i,s)}else{const s=t.D_!=null?t.D_():"unknown object",e=i.D_!=null?i.D_():"unknown object";ki("IntersectionManager cannot create an intersection between\n"+s+"\nand\n"+e)}}c7e_(t,i){if(!this.u7e_(t)||!this.u7e_(i))return;const s=this.r7e_(t);if(s!=null){const e=t.uuid+i.uuid;this.fq_(s[0],e)}if(this.$9e_.has(t.uuid)){const s=this.$9e_.get(t.uuid);s.delete(i.uuid);if(s.size===0){this.$9e_.delete(t.uuid);this.t7e_.delete(t.uuid);this.Z9e_.delete(t.uuid)}}if(this._9e_.has(i.uuid)){const s=this._9e_.get(i.uuid);s.delete(t.uuid);if(s.size===0){this._9e_.delete(i.uuid);this.Z9e_.delete(i.uuid)}}this.I7e_(t.uuid,i.uuid)}fq_(t,i){if(!this.i7e_.has(i))return;const s=this.i7e_.get(i);this.i7e_.delete(i);if(s.length===0)return;if(t.Df_!=null&&t.Df_())return;const e=t.x8_();e!=null&&e.fq_(s)}I7e_(t,i){const s=t+i;let e=!1;const A=this.Z9e_.has(t)&&this.$9e_.has(t)&&this.t7e_.has(t);let n=!1;if(A){const i=this.Z9e_.get(t)["object"];n=i.Df_!=null&&i.Df_();n&&ki("IntersectionManager: Plane object "+i.D_()+" has been disposed, intersection cannot be updated.")}if(!A||n){this.Z9e_.delete(t);this.$9e_.delete(t);this.t7e_.delete(t);this._9e_.forEach(((i,s,e)=>{i.delete(t);if(i.size===0){e.delete(s);this.Z9e_.delete(s)}}));e=!0}const h=this.Z9e_.has(i)&&this._9e_.has(i);let r=!1;if(h){const t=this.Z9e_.get(i)["object"];r=t.Df_!=null&&t.Df_();r&&ki("IntersectionManager: Mesh object "+t.D_()+" has been disposed, intersection cannot be updated.")}if(!h||r){this.Z9e_.delete(i);this._9e_.delete(i);this.$9e_.forEach(((t,s,e)=>{t.delete(i);if(t.size===0){e.delete(s);this.Z9e_.delete(s);this.t7e_.delete(s)}}));this.t7e_.forEach(((t,s,e)=>{t.delete(i);t.size===0&&e.delete(s)}));e=!0}e&&this.i7e_.delete(s);return e}f7e_(t,i,s){if(s==null){ki("IntersectionManager.setPropertyByIntersection: missing properties argument");return}if(!this.u7e_(t)||!this.u7e_(i))return;if(this.I7e_(t.uuid,i.uuid))return;const e=t.uuid+i.uuid,A=this.i7e_.has(e)&&this.i7e_.get(e).length>0,n=this.t7e_.get(t.uuid).get(i.uuid)["preservecolor"]!==s["preservecolor"];s=this.n7e_(t,i,s);if(!A)return;if(n){this.h7e_(t,i,s);return}const h=this.i7e_.get(e);this.o7e_(h,s)}C7e_(t,i){if(!this.u7e_(t)||!this.u7e_(i))return!1;const s=t.uuid+i.uuid;return!(!this.i7e_.has(s)||this.i7e_.get(s).length===0)}d7e_(){const t=this.Z9e_.values();let i=t.next();while(!i.done){const s=undefined,e=i.value["object"].matrixWorld.elements,A=i.value["matrixworld"];if(!this.B7e_(e,A,16))return!0;i=t.next()}return!1}w7e_(){const t=[],i=this.Z9e_.entries();let s=i.next();while(!s.done){const e=s.value[1]["object"],A=s.value[1]["matrixworld"],n=e.matrixWorld.elements;if(!this.B7e_(n,A,16)){t.push(s.value[0]);this.j9e_&&(s.value[1]["matrixworld"]=n.slice())}s=i.next()}if(t.length===0)return;const e=[];let A,n,h;for(A=0;A<t.length;A++){const i=[];if(this._9e_.has(t[A])){const s=this._9e_.get(t[A]).values();for(const t of s)i.push(t)}this.$9e_.has(t[A])&&i.push(t[A]);for(n=0;n<i.length;n++){h=i[n];e.indexOf(h)===-1&&e.push(h)}}for(n=0;n<e.length;n++){h=e[n];if(!this.$9e_.has(h))continue;const t=this.Z9e_.get(h)["object"],i=this.$9e_.get(h).values();for(const s of i)if(!this.I7e_(h,s))if(this.j9e_){const i=this.Z9e_.get(s)["object"];this.W9e_(t,i)}else{const i=h+s;if(!this.i7e_.has(i)||this.i7e_.get(i).length===0)continue;const e=this.r7e_(t);if(e==null)continue;this.fq_(e[0],i)}}}Q7e_(t,i,s){t[i]==null&&(t[i]=[]);t[i].indexOf(s)===-1&&t[i].push(s)}E7e_(){const t={};this._9e_.forEach(((i,s)=>{i.forEach((i=>{this.Q7e_(t,s,i)}))}));return t}p7e_(){const t={};this.$9e_.forEach(((i,s)=>{i.forEach((i=>{this.Q7e_(t,s,i)}))}));return t}m7e_(){return this.$9e_}y7e_(){return this._9e_}D7e_(){return this.Z9e_}dispose(){this.$9e_=null;this._9e_=null;this.Z9e_=null;this.t7e_=null;this.i7e_=null;IHt=null;super.dispose()}a7e_(t,i){i.uuid!=null&&i.matrixWorld!=null&&(t.has(i.uuid)||t.set(i.uuid,{object:i,matrixworld:i.matrixWorld.elements.slice()}))}g7e_(t,i,s){t.has(i.uuid)||t.set(i.uuid,new Set);t.get(i.uuid).add(s.uuid)}u7e_(t){const i=t!=null&&t instanceof fUt;i||ki("geotoolkit3d.util.intersection.IntersectionManager only accepts object type of geotoolkit3d.scene.Object3D");return i}B7e_(t,i,s){for(let e=0;e<s;e++)if(t[e]!==i[e])return!1;return!0}};s=i=t([_s("geotoolkit3d.util.intersection.IntersectionManager")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRBdXRvUmVkcmF3IjoiZTdlXyIsImlzQXV0b1JlZHJhd0VuYWJsZWQiOiJBN2VfIiwiZWxsaWdpYmxlRm9ySW50ZXJzZWN0aW9uIjoibDdlXyIsImdlbmVyYXRlSW50ZXJzZWN0aW9uIjoiVzllXyIsInJlbW92ZUludGVyc2VjdGlvbiI6ImM3ZV8iLCJzZXRQcm9wZXJ0eUJ5SW50ZXJzZWN0aW9uIjoiZjdlXyIsImlzSW50ZXJzZWN0aW9uRXhpc3RzIjoiQzdlXyIsImlzTWF0cml4V29ybGRDaGFuZ2UiOiJkN2VfIiwiZ2V0SW50ZXJzZWN0aW9uR3JvdXAiOiJFN2VfIiwiZ2V0QmFzZUdyb3VwIjoicDdlXyIsImdldFBsYW5lTWFwIjoibTdlXyIsImdldE1lc2hNYXAiOiJ5N2VfIiwiZ2V0T2JqZWN0TWFwIjoiRDdlXyJ9fSwiZ2V0RGVmYXVsdEluc3RhbmNlIjoiSU9fIiwic2V0QmFzZUNsYXNzIjoiczdlXyJ9");var CHt=function(){let i=class t extends fUt{constructor(t){super();arguments.length>1&&(t={origin:arguments[0],direction:arguments[1]});const i=qi(t,{origin:new a(0,0,0),direction:new a(0,1,0),topcolor:new l(65280),bottomcolor:new l(16711680),outlinecolor:new l(0)},!0),s=i["origin"],e=i["direction"];this.position.copy(s);const A=[new a(0,3,-.5),new a(1.5,1,-.5),new a(.5,1,-.5),new a(.5,-2,-.5),new a(-.5,-2,-.5),new a(-.5,1,-.5),new a(-1.5,1,-.5),new a(0,3,0),new a(1.5,1,0),new a(.5,1,0),new a(.5,-2,0),new a(-.5,-2,0),new a(-.5,1,0),new a(-1.5,1,0),new a(0,3,.5),new a(1.5,1,.5),new a(.5,1,.5),new a(.5,-2,.5),new a(-.5,-2,.5),new a(-.5,1,.5),new a(-1.5,1,.5)],n=[20,14,15,19,16,18,17,10,16,9,15,8,14,7,20,13,19,12,18,11,10],h=[1,0,14,15,1,15,16,17,3,17,18,4,18,19,20,6,20,14,0,6,5,4,3,2,1],r=[],o=[2,1,0,5,4,3,5,6,8,15,13,11,17,9,19,9,20,19,12,10,11,11,13,12,10,4,9,9,11,10,4,6,7,7,9,4,6,5,19,19,7,6,5,3,17,17,19,5,3,0,15,15,17,3,0,1,13,13,15,0];let g;for(g=0;g<o.length;g++)r.push(A[n[o[g]]]);const c=new z;c.setFromPoints(r);const I=new W(c,new F({color:i["topcolor"]}));I.matrixAutoUpdate=!1;this.add(I);const f=c.clone();f.applyMatrix4((new u).makeTranslation(0,0,-.5));const C=new W(f,new F({color:i["bottomcolor"]}));C.matrixAutoUpdate=!1;this.add(C);const d={x:[],y:[],z:[],line:!0};for(g=0;g<h.length;g++){const t=A[h[g]];d["x"].push(t.x);d["y"].push(t.y);d["z"].push(t.z)}const B=new cUt({data:d,color:i["outlinecolor"]});B.matrixAutoUpdate=!1;this.add(B);this.setDirection(e);this.scale.set(2,2,2)}setDirection(t){const i=new a;let s;if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{i.set(t.z,0,-t.x).normalize();s=Math.acos(t.y);this.quaternion.setFromAxisAngle(i,s)}}};i=t([_s("geotoolkit3d.scene.compass.CompassArrow")],i);return i}();const dHt=new a;var BHt=Ci(function(){let i=class t{constructor(t){const i=qi(t,{container:null,camera:null,visible:!0},!0);this._D_=i["container"];t["renderer"]==null&&(t["renderer"]={});t["renderer"]["parameters"]==null&&(t["renderer"]["parameters"]={});const s=qi(t["renderer"]["parameters"],{canvas:i["canvas"],alpha:!0});this.M7e_=new D(s);this.M7e_.setPixelRatio(Is());this.M7e_.setSize(this._D_.offsetWidth,this._D_.offsetHeight);this.M7e_.debug["onShaderError"]=RFt;this.v7e_=new M;this.uXe_=new Q(60,1,1,2e3);i["camera"]!=null&&(this.uXe_.up=i["camera"].up);this.v7e_.add(this.uXe_);this.b7e_(new CHt);this.$Vt_=i["visible"];this.Qis_=!0;this._D_!=null&&this._D_.appendChild(this.M7e_.domElement)}updateObject(t,i){dHt.set(0,0,1).applyEuler(i.rotation);this.uXe_.position.copy(dHt);this.uXe_.position.setLength(18);this.uXe_.rotation.copy(i.rotation);this.Qis_=!1}N7e_(){return this.S7e_}b7e_(t){if(t==null)return this;this.S7e_!=null&&this.v7e_.remove(this.S7e_);this.S7e_=t;this.v7e_.add(this.S7e_);return this}render(t,i){if(this.Qis_!==!1){this.updateObject(t,i);this.$Vt_&&this.M7e_.render(this.v7e_,this.uXe_)}}invalidateObject(t){this.Qis_=!0}setSize(t,i){t=+t;if(this.uXe_ instanceof Q)this.uXe_.aspect=1;else{this.uXe_.left=-t;this.uXe_.right=t;this.uXe_.top=t;this.uXe_.bottom=-t}this.uXe_.updateProjectionMatrix();isNaN(i)||this.M7e_.setPixelRatio(i);this.M7e_.setSize(t,t);if(this._D_!=null){this._D_.style["width"]=t+"px";this._D_.style["height"]=t+"px"}}dispose(){this.v7e_!=null&&fLt.dispose(this.v7e_.children);this.v7e_=null;if(this.M7e_!=null){this._D_!=null&&this._D_.removeChild(this.M7e_.domElement);this.M7e_.dispose!=null&&this.M7e_.dispose();const t=this.M7e_.getContext().getExtension("WEBGL_lose_context");t&&t.loseContext()}this.M7e_=null;this._D_=null;this.uXe_=null}};i=t([_s("geotoolkit3d.scene.compass.Compass")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRDb21wYXNzT2JqZWN0IjoiTjdlXyIsInNldENvbXBhc3NPYmplY3QiOiJiN2VfIn19LCJnZXRDbGFzc05hbWUiOiJEXyJ9");var wHt=function(){var t;return class{constructor(t,i,s){this.ov_=t;this.bft_=1/0;this.Nft_=0;this.G7e_=s;this.R7e_=i;this._pr=Math.round(Is()||1);this.Jp_=80*this._pr;const e=48*this._pr;this.k7e_=3*this._pr;this.F7e_=2*this._pr;this.x7e_=3*this._pr;this.L7e_=15*this._pr;this.U7e_=74*this._pr;this.Y7e_=30*this._pr;this.ojt_=Ls(this.Jp_,e,!0);this.ojt_.style.cssText="width:80px;height:48px";this.dS_=this.ojt_.getContext("2d");this.dS_.font="bold "+9*this._pr+"px Helvetica,Arial,sans-serif";this.dS_.textBaseline="top";this.dS_.fillStyle=this.G7e_;this.dS_.fillRect(0,0,this.Jp_,e);this.dS_.fillStyle=this.R7e_;this.dS_.fillText(t,this.k7e_,this.F7e_);this.dS_.fillRect(this.x7e_,this.L7e_,this.U7e_,this.Y7e_);this.dS_.fillStyle=this.G7e_;this.dS_.globalAlpha=.9;this.dS_.fillRect(this.x7e_,this.L7e_,this.U7e_,this.Y7e_)}update(t,i){this.bft_=Math.min(this.bft_,t);this.Nft_=Math.max(this.Nft_,t);this.dS_.fillStyle=this.G7e_;this.dS_.globalAlpha=1;this.dS_.fillRect(0,0,this.Jp_,this.L7e_);this.dS_.fillStyle=this.R7e_;this.dS_.fillText(Math.round(t)+" "+this.ov_+" ("+Math.round(this.bft_)+"-"+Math.round(this.Nft_)+")",this.k7e_,this.F7e_);this.dS_.drawImage(this.ojt_,this.x7e_+this._pr,this.L7e_,this.U7e_-this._pr,this.Y7e_,this.x7e_,this.L7e_,this.U7e_-this._pr,this.Y7e_);this.dS_.fillRect(this.x7e_+this.U7e_-this._pr,this.L7e_,this._pr,this.Y7e_);this.dS_.fillStyle=this.G7e_;this.dS_.globalAlpha=.9;this.dS_.fillRect(this.x7e_+this.U7e_-this._pr,this.L7e_,this._pr,Math.round((1-t/i)*this.Y7e_))}getCanvas(){return this.ojt_}}}(),QHt=function(){let i=class t{constructor(){this.d4_=0;this._D_=xs("div");this._D_.style.cssText="position:absolute;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000";this._D_.addEventListener("click",(t=>{t.preventDefault();this.T7e_(++this.d4_%this._D_.children.length)}),!1);this.K7e_=(Mi.performance||Date).now();this.H7e_=this.K7e_;this.q7e_=0;this.J7e_=this.P7e_(new wHt("FPS","#0ff","#002"));this.V7e_=this.P7e_(new wHt("MS","#0f0","#020"));Mi.performance!=null&&Mi.performance.memory!=null&&(this.O7e_=this.P7e_(new wHt("MB","#f08","#201")));this.T7e_(0)}Zb_(){this.K7e_=(Mi.performance||Date).now()}end(){this.q7e_++;const t=(Mi.performance||Date).now();this.V7e_.update(t-this.K7e_,200);if(t>=this.H7e_+1e3){this.J7e_.update(this.q7e_*1e3/(t-this.H7e_),100);this.H7e_=t;this.q7e_=0;if(this.O7e_!=null){const t=Mi.performance.memory;this.O7e_.update(t.W7e_/1048576,t.z7e_/1048576)}}return t}update(){this.K7e_=this.end()}X7e_(){return this._D_}P7e_(t){this._D_.appendChild(t.getCanvas());return t}T7e_(t){for(let i=0;i<this._D_.children.length;i++)this._D_.children[i].style.display=i===t?"block":"none";this.d4_=t}};i=t([_s("geotoolkit3d.util.Stats")],i);return i}();var EHt=function(){var t=class{};t.j7e_={uniforms:{tDiffuse:new h(null),opacity:new h(1)},vertexShader:["varying vec2 vUv;","void main() {","    vUv = uv;","    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","    vec4 texel = texture2D( tDiffuse, vUv );","    gl_FragColor = opacity * texel;","}"].join("\n")};t.Z7e_={uniforms:{depthTexture:new h(null),cameraNearFar:new h(new g(.5,.5)),textureMatrix:new h(new u)},vertexShader:["varying vec4 projTexCoord;","varying vec4 vPosition;","uniform mat4 textureMatrix;","void main() {","    vPosition = modelViewMatrix * vec4( position, 1.0 );","    vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","    projTexCoord = textureMatrix * worldPosition;","    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <packing>","varying vec4 vPosition;","varying vec4 projTexCoord;","uniform sampler2D depthTexture;","uniform vec2 cameraNearFar;","void main() {","    float depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));","    float viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );","    float depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;","    gl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);","}"].join("\n")};t._7e_={uniforms:{maskTexture:new h(null),texSize:new h(new g(.5,.5)),visibleEdgeColor:new h(new a(1,1,1)),hiddenEdgeColor:new h(new a(1,1,1)),hiddenLine:new h(!1)},vertexShader:["varying vec2 vUv;","void main() {","    vUv = uv;","    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D maskTexture;","uniform vec2 texSize;","uniform vec3 visibleEdgeColor;","uniform vec3 hiddenEdgeColor;","uniform bool hiddenLine;","void main() {","    vec2 invSize = 1.0 / texSize;","    vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","    vec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);","    vec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);","    vec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);","    vec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);","    float diff1 = (c1.r - c2.r)*0.5;","    float diff2 = (c3.r - c4.r)*0.5;","    float d = length( vec2(diff1, diff2) );","    float a1 = min(c1.g, c2.g);","    float a2 = min(c3.g, c4.g);","    float visibilityFactor = min(a1, a2);","    vec4 edgeColor;","    if (1.0 - visibilityFactor > 0.001) {","        gl_FragColor = vec4(visibleEdgeColor, 1.0) * vec4(d);","    } else {","        gl_FragColor = vec4(hiddenEdgeColor, hiddenLine ? 0.7 : 0.0) * vec4(d);","    }","}"].join("\n")};t.$7e_={uniforms:{colorTexture:new h(null),texSize:new h(new g(.5,.5)),direction:new h(new g(.5,.5)),kernelRadius:new h(1)},vertexShader:["varying vec2 vUv;","void main() {","    vUv = uv;","    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D colorTexture;","uniform vec2 texSize;","uniform vec2 direction;","uniform float kernelRadius;","float gaussianPdf(in float x, in float sigma) {","    return 0.39894 * exp(-0.5 * x * x / (sigma * sigma)) / sigma;","}","void main() {","    vec2 invSize = 1.0 / texSize;","    float weightSum = gaussianPdf(0.0, kernelRadius);","    vec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;","    vec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);","    vec2 uvOffset = delta;","    for( int i = 1; i <= MAX_RADIUS; i ++ ) {","        float w = gaussianPdf(uvOffset.x, kernelRadius);","        vec4 sample1 = texture2D( colorTexture, vUv + uvOffset);","        vec4 sample2 = texture2D( colorTexture, vUv - uvOffset);","        diffuseSum += ((sample1 + sample2) * w);","        weightSum += (2.0 * w);","        uvOffset += delta;","    }","    gl_FragColor = diffuseSum / weightSum;","}"].join("\n")};t.ttA_={uniforms:{maskTexture:new h(null),edgeTexture1:new h(null),edgeTexture2:new h(null),patternTexture:new h(null),edgeStrength:new h(1),edgeGlow:new h(1),usePatternTexture:new h(0)},vertexShader:["varying vec2 vUv;","void main() {","    vUv = uv;","    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D maskTexture;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform sampler2D patternTexture;","uniform float edgeStrength;","uniform float edgeGlow;","uniform bool usePatternTexture;","void main() {","    vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","    vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","    vec4 maskColor = texture2D(maskTexture, vUv);","    vec4 patternColor = texture2D(patternTexture, 6.0 * vUv);","    float visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;","    vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","    vec4 finalColor = edgeStrength * maskColor.r * edgeValue;","    if(usePatternTexture)","        finalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);","    gl_FragColor = finalColor;","}"].join("\n")};t.itA_={uniforms:{resolution:new h(new g(1/1024,1/512)),tDiffuse:new h(null)},vertexShader:["varying vec2 vUv;","void main() {","   vUv = uv;","   gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        https://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS`` AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 0","#define FXAA_QUALITY_PRESET 39","","#define FXAA_GREEN_AS_LUMA 0","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 1","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)","    // Requires \"#version 130' or better","    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immediates.","    // Immediates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")};return t}();const pHt=1/256;var mHt=Ci(function(){let i=class t{constructor(){this.type="AbstractPass";this.enabled=!0;this.stA_=!0;this.clear=!1;this.etA_=!1}static AtA_(t){t.userData.ntA_&&t.userData.i_e_&&Gi("WARNING: Materials cannot have the property [forceTransparent] and [forceOpaque] both true at the same time ("+t.type+")");if(t.userData.ntA_){t.opacity=1;t.transparent=!1;t.userData.transparent=!1;return}if(t.userData.i_e_){t.userData.transparent=!0;return}const i=t.htA_||t.defines&&t.defines["ALPHA_TO_COVERAGE"],s=t.opacity<1-pHt,e=t.alphaMap!=null||t.map!=null&&(t.map.format===Nt||t.map.format===St||t.map.format===Gt);t.userData.transparent=s||i||e}setOptions(t){return this}getType(){return this.type}isEnabled(){return this.enabled}};i.prototype.setSize=Zi;i.prototype.dispose=Zi;i.prototype.render=Zi;i=t([_s("geotoolkit3d.postprocessing.AbstractPass")],i);return i}(),2,"eyJnZXRDbGFzc05hbWUiOiJEXyJ9");const yHt=new v(-1,1,1,-1,0,1),DHt=new bt(2,2);var MHt=function(){let i=class t{constructor(t){this.U9e_=new W(DHt,t);const i="material";Object.defineProperty(this,i,{get:()=>this.U9e_.material,set:t=>{this.U9e_.material=t}})}dispose(){this.U9e_.geometry.dispose()}render(t){t.render(this.U9e_,yHt)}};i=t([_s("geotoolkit3d.postprocessing.FullScreenQuad")],i);return i}();var vHt=function(){let i=class t extends mHt{constructor(t){super();this.Kis_=qi(t,{textureid:"tDiffuse"},!0);this.type="ShaderPass";const i=this.Kis_["shader"];if(i instanceof d){this.uniforms=i.uniforms;this.material=i}else if(i!=null){this.uniforms=N.clone(i.uniforms);this.material=new d({defines:Object.assign({},i.defines),uniforms:this.uniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader})}this.rtA_=new MHt(this.material);this.setOptions(this.Kis_)}setOptions(t){this.Kis_=qi(t,this.Kis_);t["enabled"]!=null&&(this.enabled=t["enabled"]);return this}JV_(){return this.Kis_}setSize(t,i){return this}dispose(){this.material!=null&&this.material.dispose()}render(t,i,s,e,A){this.uniforms[this.Kis_["textureid"]]&&(this.uniforms[this.Kis_["textureid"]].value=s.texture);this.rtA_.material=this.material;if(this.etA_){t.setRenderTarget(null);this.rtA_.render(t)}else{t.setRenderTarget(i);this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil);this.rtA_.render(t)}}};i=t([_s("geotoolkit3d.postprocessing.ShaderPass")],i);return i}();const bHt=EHt;var NHt=function(){let i=class t{constructor(t,i){this.S3_=t;if(i===void 0){const s={minFilter:o,magFilter:o,format:Nt,stencilBuffer:!1},e=t.getSize(new g);this.otA_=t.getPixelRatio();this.Jp_=e.width;this.Pp_=e.height;(i=new Rt(this.Jp_*this.otA_,this.Pp_*this.otA_,s)).texture.name="EffectComposer.rt1"}else{this.otA_=1;this.Jp_=i.width;this.Pp_=i.height}this.ltA_=i;this.utA_=i.clone();this.utA_.texture.name="EffectComposer.rt2";this.atA_=this.ltA_;this.readBuffer=this.utA_;this.etA_=!0;this.gtA_=[];this.ctA_=new vHt({shader:bHt.j7e_});this.ItA_=new kt}setOptions(t){return this}ftA_(){const t=this.readBuffer;this.readBuffer=this.atA_;this.atA_=t}CtA_(t){this.gtA_.push(t);t.setSize(this.Jp_*this.otA_,this.Pp_*this.otA_)}dtA_(t,i){this.gtA_.splice(i,0,t)}BtA_(t){for(let i=t+1;i<this.gtA_.length;i++)if(this.gtA_[i].enabled)return!1;return!0}render(t){t===void 0&&(t=this.ItA_.getDelta());const i=this.S3_.getRenderTarget();let s,e;const A=this.gtA_.length;for(e=0;e<A;e++){s=this.gtA_[e];if(s.enabled!==!1){s.etA_=this.etA_&&this.BtA_(e);s.render(this.S3_,this.atA_,this.readBuffer,t);s.stA_&&this.ftA_()}}this.S3_.setRenderTarget(i)}reset(t){if(t===void 0){const i=this.S3_.getSize(new g);this.otA_=this.S3_.getPixelRatio();this.Jp_=i.width;this.Pp_=i.height;(t=this.ltA_.clone()).setSize(this.Jp_*this.otA_,this.Pp_*this.otA_)}this.ltA_.dispose();this.utA_.dispose();this.ltA_=t;this.utA_=t.clone();this.atA_=this.ltA_;this.readBuffer=this.utA_}dispose(){this.ltA_.dispose();this.utA_.dispose();this.render=null;this.atA_=null;this.readBuffer=null;for(let t=0;t<this.gtA_.length;t++)this.gtA_[t].dispose();this.gtA_=[]}setSize(t,i){this.Jp_=t;this.Pp_=i;const s=this.Jp_*this.otA_,e=this.Pp_*this.otA_;this.ltA_.setSize(s,e);this.utA_.setSize(s,e);for(let t=0;t<this.gtA_.length;t++)this.gtA_[t].setSize(s,e);return this}setPixelRatio(t){this.otA_=t;this.setSize(this.Jp_,this.Pp_);return this}wtA_(){return this.gtA_}};i=t([_s("geotoolkit3d.postprocessing.EffectComposer")],i);return i}();let SHt=null;var GHt=Ci(function(){var i;let s=i=class t{constructor(t){this.ov_=t||"processor";this.vi_={};this.Lui_=0}dn_(){return this.ov_}HC_(t){this.ov_=t;return this}QtA_(t,i){if(t==null||i==null)return this;this.vi_.hasOwnProperty(t)||this.Lui_++;this.vi_[t]=i;return this}EtA_(t){let i;const s=t;while(t!=null){if(typeof t.D_=="function"){i=this.vi_[t.D_()];if(i!=null)return i(t)}t=t.parent}return s}static IO_(){SHt==null&&(SHt=new i);return SHt}N_(){const t={count:this.Lui_};t[this.ov_]=this.vi_;return t}ptA_(){this.Lui_=0;this.vi_={};this.ov_="processor";return this}};s=i=t([_s("geotoolkit3d.util.ObjectProcessor")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXROYW1lIjoiZG5fIiwic2V0TmFtZSI6IkhDXyIsInJlZ2lzdGVyT2JqZWN0IjoiUXRBXyIsInByb2Nlc3NPYmplY3QiOiJFdEFfIiwiZ2V0UHJvcGVydGllcyI6Ik5fIiwicmVzZXRQcm9jZXNzb3IiOiJwdEFfIn19LCJnZXREZWZhdWx0SW5zdGFuY2UiOiJJT18iLCJnZXRDbGFzc05hbWUiOiJEXyJ9");var RHt=Ci(function(){let i=class t extends mHt{constructor(){super();this.mtA_=[];this.vi_=GHt.IO_()}ytA_(){this.mtA_=[]}DtA_(t){const i=this.vi_.EtA_(t),s=Array.isArray(i)?i:[i];for(let t=0;t<s.length;t++)s[t]!=null&&this.mtA_.push(s[t])}};i=t([_s("geotoolkit3d.posprocessing.AbstractHighlightPass")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJjbGVhclNlbGVjdGVkT2JqZWN0cyI6Inl0QV8iLCJhZGRTZWxlY3RlZE9iamVjdHMiOiJEdEFfIn19fSAg");const kHt=(t,i)=>{while(t!=null){if(t instanceof fUt){t.g_e_(i);return}t=t.parent}};var FHt=Ci(function(){let i=class t extends RHt{constructor(t){super();this.Kis_=qi(t,{resolution:new g(256,256)},!0);this.stA_=!1;this.type="HighlightPass";this.setOptions(this.Kis_)}setOptions(t){if(t==null)return this;t.hasOwnProperty("highlight")&&delete(t=qi(t,t["highlight"]))["highlight"];this.Kis_=qi(t,this.Kis_);t["enabled"]!=null&&(this.enabled=t["enabled"]);return this}JV_(){return this.Kis_}ytA_(){this.mtA_.forEach((t=>{kHt(t,!1)}));this.mtA_=[]}DtA_(t){const i=this.vi_.EtA_(t),s=Array.isArray(i)?i:[i];for(let t=0;t<s.length;t++)if(s[t]!=null){kHt(s[t],!0);this.mtA_.push(s[t])}}render(t,i,s,e,A){}setSize(t,i){return this}dispose(){}};i=t([_s("geotoolkit3d.posprocessing.HighlighPass")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiY2xlYXJTZWxlY3RlZE9iamVjdHMiOiJ5dEFfIiwiYWRkU2VsZWN0ZWRPYmplY3RzIjoiRHRBXyJ9fX0g");const xHt=1,LHt=2,UHt=3,YHt=new l(0),THt=je.is_()?.001:1e-7,KHt="depthPeelingEnabled",HHt="ignoreDepthTest",qHt="enablePeelingDiscard",JHt="peelingDepthTexture",PHt="opaqueGeometryDepthTexture",VHt="renderResolution",OHt="#if __VERSION__ >= 300",WHt="#endif";n.clipping_planes_pars_fragment=[n.clipping_planes_pars_fragment,OHt,"uniform bool "+KHt+";","uniform bool "+HHt+";","uniform bool "+qHt+";","uniform sampler2D "+JHt+";","uniform sampler2D "+PHt+";",WHt,"#define VARIABLE_RENDER_RESOLUTION","uniform vec2 "+VHt+";"].join("\n");const zHt="currentDepth";let XHt=n.logdepthbuf_fragment;XHt=XHt.replace("gl_FragDepthEXT",zHt);n.clipping_planes_fragment=[n.clipping_planes_fragment,OHt,"if ("+KHt+" || "+qHt+" && "+HHt+") {","   float "+zHt+" = gl_FragCoord.z;",XHt,"   ivec2 intFragCoord = ivec2(gl_FragCoord.xy);","   bool isNotDeeper = false;","   bool isOccluded = false;","   if ("+KHt+") {","      isNotDeeper = "+zHt+" <= texelFetch("+JHt+", intFragCoord, 0).x + "+THt+";","   }","   if ("+qHt+") {","      isOccluded = "+zHt+" >= texelFetch("+PHt+", intFragCoord, 0).x;","   }","   if(isNotDeeper || isOccluded) discard;","}",WHt].join("\n");const jHt=t=>{const i=new Ft(0,0,xt);i.format=Lt;i.name=t;return i},ZHt=(t,i,s,e)=>{const A=new Rt(t,i,{format:Nt,minFilter:o,magFilter:o,generateMipmaps:!1,stencilBuffer:!1,depthBuffer:!0,depthTexture:e});A.texture.name="RenderTarget_"+s;return A},_Ht=(t,i)=>{t.forEach((t=>{if(i){t.blending=Ut;t.blendEquation=Yt;t.blendSrc=Tt;t.blendDst=Kt;t.blendEquationAlpha=Yt;t.blendSrcAlpha=Ht;t.blendDstAlpha=Kt}else{t.blending=t.userData.MtA_.blending;t.blendEquation=t.userData.MtA_.blendEquation;t.blendSrc=t.userData.MtA_.blendSrc;t.blendDst=t.userData.MtA_.blendDst;t.blendEquationAlpha=t.userData.MtA_.blendEquationAlpha;t.blendSrcAlpha=t.userData.MtA_.blendSrcAlpha;t.blendDstAlpha=t.userData.MtA_.blendDstAlpha}}))},$Ht=(t,i)=>{t.forEach((t=>{switch(i){case xHt:t.visible=!t.userData.transparent;break;case LHt:t.visible=t.userData.transparent;break;case UHt:default:t.visible=t.userData.vtA_;break}}))};var tqt=Ci(function(){var i;let s=i=class t extends mHt{constructor(t){super();this.zui_=0;this.btA_=0;this.NtA_=5;this.StA_=!0;this.GtA_=eFt.NWe_;this.RtA_=!0;this.setOptions(t);this.ktA_=t["scene"];this.FtA_=t["camera"];this.xtA_=2;this.LtA_=[];this.UtA_=void 0;this.YtA_=void 0;this.TtA_=jHt("depthTexture_1");this.KtA_=jHt("depthTexture_2");this.HtA_=jHt("opacity_depthTexture");const i=EHt.j7e_;this.qtA_=new d({uniforms:N.clone(i.uniforms),blending:qt,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,premultipliedAlpha:!0,transparent:!0,depthTest:!1,depthWrite:!1});this.rtA_=new MHt(this.qtA_);this.rtA_.material.uniforms["tDiffuse"].value=null;this.JtA_=new d({uniforms:N.clone(i.uniforms),blending:G,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,premultipliedAlpha:!1,transparent:!1,depthTest:!1,depthWrite:!1});this.PtA_=new MHt(this.JtA_);this.PtA_.material.uniforms["tDiffuse"].value=null;this.VtA_=new h(!1);this.OtA_=new h(!1);this.WtA_=new h(this.KtA_);this.ztA_=new h(null);this.XtA_=new h(new g)}setOptions(t){if(!t)return this;t["clearcolor"]!=null&&(this.zui_=t["clearcolor"]);t["clearcoloralpha"]!=null&&(this.btA_=t["clearcoloralpha"]);if(t["antialias"]!=null){t["antialias"]["mode"]!=null&&(this.GtA_=t["antialias"]["mode"]);t["antialias"]["enabled"]!=null&&(this.RtA_=t["antialias"]["enabled"])}if(t["depthpeeling"]!=null){t["depthpeeling"]["enabled"]!=null&&(this.StA_=t["depthpeeling"]["enabled"]);if(t["depthpeeling"]["peelinglevel"]!=null){this.NtA_=t["depthpeeling"]["peelinglevel"];this.jtA_(t["depthpeeling"]["peelinglevel"])}}return this}JV_(){return{depthpeeling:{peelinglevel:this.NtA_,enabled:this.StA_},antialias:{enabled:this.RtA_,mode:this.GtA_},clearcolor:this.zui_,clearcoloralpha:this.btA_,scene:this.ktA_,camera:this.FtA_}}setSize(t,i){if(this.RtA_){t*=this.xtA_;i*=this.xtA_}this.XtA_.value.set(t,i);if(this.LtA_){const s=this.LtA_.length;for(let e=0;e<s;e++)this.LtA_[e].setSize(t,i)}if(this.UtA_){this.UtA_.setSize(t,i);this.YtA_.setSize(t,i)}return this}dispose(){this.ZtA_();this.TtA_&&this.TtA_.dispose();this.KtA_&&this.KtA_.dispose();this.HtA_&&this.HtA_.dispose()}ZtA_(){if(this.LtA_&&this.LtA_.length>0){const t=this.LtA_.length;for(let i=0;i<t;i++)this.LtA_[i].dispose();this.LtA_=[]}this.UtA_&&this.UtA_.dispose();this.YtA_&&this.YtA_.dispose()}jtA_(t){this._tA_=Math.max(t,2)}$tA_(t,i){if(this.RtA_){t*=this.xtA_;i*=this.xtA_}const s=this._tA_+1;if(this.LtA_.length!==s){this.ZtA_();let e=!0;for(let A=0;A<s;A++){const s=e?this.TtA_:this.KtA_,n="transparency_target_"+A;this.LtA_[A]=ZHt(t,i,n,s);e=!e}}this.UtA_||(this.UtA_=ZHt(t,i,"opacity_target",this.HtA_));this.YtA_||(this.YtA_=ZHt(t,i,"composition_target",null))}d8e_(t){if(t.userData.tiA_)return;t.userData.tiA_=!0;const i=t.onBeforeCompile;t.onBeforeCompile=(s,e)=>{s.uniforms===void 0&&(s.uniforms={});const A=t.depthFunc===Jt||t.depthFunc===Pt,n=t.depthWrite&&t.depthTest&&A;s.uniforms[KHt]=this.VtA_;s.uniforms[qHt]=this.OtA_;s.uniforms[PHt]=this.ztA_;s.uniforms[HHt]={value:n};s.uniforms[JHt]=this.WtA_;s.uniforms[VHt]=this.XtA_;t.needsUpdate=!0;typeof i=="function"&&i.call(t,s,e)}}iiA_(t){t.traverse((t=>{if(t.material!=null)if(Array.isArray(t.material))for(let i=0;i<t.material.length;i++)this.d8e_(t.material[i]);else this.d8e_(t.material)}))}static siA_(t,i){t.push(i);i.userData.vtA_=i.visible;i.userData.MtA_==null&&(i.userData.MtA_={blending:i.blending,blendEquation:i.blendEquation,blendSrc:i.blendSrc,blendDst:i.blendDst,blendEquationAlpha:i.blendEquationAlpha,blendSrcAlpha:i.blendSrcAlpha,blendDstAlpha:i.blendDstAlpha});mHt.AtA_(i)}eiA_(t){const s=[];t.traverseVisible((t=>{if(t.material!=null)if(Array.isArray(t.material))for(let e=0;e<t.material.length;e++)i.siA_(s,t.material[e]);else i.siA_(s,t.material)}));return s}AiA_(t,i,s){s&&(this.WtA_.value=s.depthTexture);t.setRenderTarget(i);t.clear();t.render(this.ktA_,this.FtA_)}render(t,i,s){this.iiA_(this.ktA_);this.$tA_(s.width,s.height);const e=t.autoClear;t.autoClear=!1;const A=this.ktA_.background;this.ktA_.background=null;if(this.StA_){t.setClearColor(YHt,0);const s=this._tA_-1,e=this.eiA_(this.ktA_);this.VtA_.value=!1;this.OtA_.value=!1;this.ztA_.value=null;$Ht(e,xHt);this.AiA_(t,this.UtA_);this.ztA_.value=this.HtA_;this.OtA_.value=!0;$Ht(e,LHt);_Ht(e,!0);this.AiA_(t,this.LtA_[0]);this.VtA_.value=!0;for(let i=1;i<s;i++)this.AiA_(t,this.LtA_[i],this.LtA_[i-1]);_Ht(e,!1);this.AiA_(t,this.LtA_[s],this.LtA_[s-1]);$Ht(e,UHt);this.VtA_.value=!1;this.OtA_.value=!1;this.ztA_.value=null;this.WtA_.value=null;t.setRenderTarget(this.YtA_);t.setClearColor(this.zui_,this.btA_);this.ktA_.background=A;t.clear();this.rtA_.material.uniforms["tDiffuse"].value=this.UtA_.texture;this.rtA_.render(t);for(let i=s;i>=0;i--){this.rtA_.material.uniforms["tDiffuse"].value=this.LtA_[i].texture;this.rtA_.render(t)}t.setRenderTarget(this.etA_?null:i);this.PtA_.material.uniforms["tDiffuse"].value=this.YtA_.texture;this.PtA_.render(t)}else{t.setClearColor(this.zui_,this.btA_);this.AiA_(t,this.LtA_[0]);this.ktA_.background=A;t.setRenderTarget(this.etA_?null:i);t.clear();this.PtA_.material.uniforms["tDiffuse"].value=this.LtA_[0].texture;this.PtA_.render(t)}t.autoClear=e}};s=i=t([_s("geotoolkit3d.postprocessing.DepthPeelingPass")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");const iqt=new l,sqt=EHt;var eqt=function(){var i;let s=i=class t extends mHt{constructor(t){super();this.Kis_=qi(t,{clearcolor:0,clearcoloralpha:0,unbiased:!0,samplelevel:2},!0);this.type="SSAARenderPass";this.ktA_=t["scene"];this.FtA_=t["camera"];const i=sqt.j7e_;this.niA_=N.clone(i.uniforms);this.hiA_=null;this.qtA_=new d({uniforms:this.niA_,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,premultipliedAlpha:!0,transparent:!0,blending:Vt,depthTest:!1,depthWrite:!1});this.rtA_=new MHt(this.qtA_);this.setOptions(this.Kis_)}setOptions(t){if(t==null)return this;t.hasOwnProperty("antialias")&&delete(t=qi(t,t["antialias"]))["antialias"];this.Kis_=qi(t,this.Kis_);t["enabled"]!=null&&(this.enabled=t["enabled"]);return this}JV_(){return this.Kis_}setSize(t,i){this.hiA_&&this.hiA_.setSize(t,i);return this}dispose(){if(this.hiA_){this.hiA_.dispose();this.hiA_=null}}riA_(t){t.traverseVisible((t=>{if(t.material!==void 0)if(Array.isArray(t.material))for(let i=0;i<t.material.length;i++)mHt.AtA_(t.material[i]);else mHt.AtA_(t.material)}))}render(t,s,e,A,n){const h=e.width,r=e.height;this.riA_(this.ktA_);if(this.hiA_==null){this.hiA_=new Rt(h,r,{minFilter:o,magFilter:o,format:Nt});this.hiA_.texture.name="SSAARenderPass.sample"}const l=i.oiA_[Math.max(0,Math.min(this.Kis_["samplelevel"],5))],u=t.autoClear;t.autoClear=!1;const a=t.getClearColor(iqt).getHex(),g=t.getClearAlpha(),c=1/l.length,I=1/32;this.niA_["tDiffuse"].value=this.hiA_.texture;for(let i=0;i<l.length;i++){const e=l[i];this.FtA_.setViewOffset&&this.FtA_.setViewOffset(h,r,e[0]*.0625,e[1]*.0625,h,r);let A=c;if(this.Kis_["unbiased"]){const t=undefined;A+=I*(-.5+(i+.5)/l.length)}this.niA_["opacity"].value=A;t.setClearColor(this.Kis_["clearcolor"],this.Kis_["clearcoloralpha"]);t.setRenderTarget(this.hiA_);t.clear();t.render(this.ktA_,this.FtA_);t.setRenderTarget(this.etA_?null:s);if(i===0){t.setClearColor(0,0);t.clear()}this.rtA_.render(t)}this.FtA_.clearViewOffset&&this.FtA_.clearViewOffset();t.autoClear=u;t.setClearColor(a,g)}};s.oiA_=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]];s=i=t([_s("geotoolkit3d.postprocessing.SSAARenderPass")],s);return s}();const Aqt=new l("white"),nqt=EHt,hqt=function(t,i){const s=i.isPerspectiveCamera?"perspective":"orthographic";return t.replace(/DEPTH_TO_VIEW_Z/g,s+"DepthToViewZ")};var rqt=function(){var i;let s=i=class t extends RHt{constructor(t){super();this.Kis_=qi(t,{resolution:new g(256,256)},!0);this.stA_=!1;this.type="OutlinePass";this.ktA_=t["scene"];this.FtA_=t["camera"];this.liA_=!1;this.uiA_=2;this.vi_=GHt.IO_();const i={minFilter:o,magFilter:o,format:Nt},s=Math.round(this.Kis_["resolution"].x/this.uiA_),A=Math.round(this.Kis_["resolution"].y/this.uiA_);this.aiA_=new Rt(this.Kis_["resolution"].x,this.Kis_["resolution"].y,i);this.aiA_.texture.name="OutlinePass.mask";this.aiA_.texture.generateMipmaps=!1;this.giA_=new Ot;this.giA_.side=e;this.giA_.depthPacking=Wt;this.giA_.blending=G;this.ciA_=this.IiA_();this.ciA_.side=e;this.ciA_.fragmentShader=hqt(this.ciA_.fragmentShader,this.FtA_);this.fiA_=new Rt(this.Kis_["resolution"].x,this.Kis_["resolution"].y,i);this.fiA_.texture.name="OutlinePass.depth";this.fiA_.texture.generateMipmaps=!1;this.CiA_=new Rt(s,A,i);this.CiA_.texture.name="OutlinePass.depthDownSample";this.CiA_.texture.generateMipmaps=!1;this.diA_=new Rt(s,A,i);this.diA_.texture.name="OutlinePass.blur1";this.diA_.texture.generateMipmaps=!1;this.BiA_=new Rt(Math.round(s/2),Math.round(A/2),i);this.BiA_.texture.name="OutlinePass.blur2";this.BiA_.texture.generateMipmaps=!1;this.wiA_=this.QiA_();this.EiA_=new Rt(s,A,i);this.EiA_.texture.name="OutlinePass.edge1";this.EiA_.texture.generateMipmaps=!1;this.piA_=new Rt(Math.round(s/2),Math.round(A/2),i);this.piA_.texture.name="OutlinePass.edge2";this.piA_.texture.generateMipmaps=!1;const n=4,h=4;this.miA_=this.yiA_(n);this.miA_.uniforms["texSize"].value=new g(s,A);this.miA_.uniforms["kernelRadius"].value=1;this.DiA_=this.yiA_(h);this.DiA_.uniforms["texSize"].value=new g(Math.round(s/2),Math.round(A/2));this.DiA_.uniforms["kernelRadius"].value=h;this.MiA_=this.viA_();const r=nqt.j7e_;this.niA_=N.clone(r.uniforms);this.niA_["opacity"].value=1;this.biA_=new d({uniforms:this.niA_,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,blending:G,depthTest:!1,depthWrite:!1,transparent:!0});this.NiA_=new l;this.SiA_=1;this.rtA_=new MHt(null);this.GiA_=new l;this.RiA_=new l;this.kiA_=new u;this.setOptions(this.Kis_)}setOptions(t){if(t==null)return this;t.hasOwnProperty("highlight")&&delete(t=qi(t,t["highlight"]))["highlight"];this.Kis_=qi(t,this.Kis_);t["enabled"]!=null&&(this.enabled=t["enabled"]);return this}JV_(){return this.Kis_}dispose(){this.aiA_.dispose();this.fiA_.dispose();this.CiA_.dispose();this.diA_.dispose();this.BiA_.dispose();this.EiA_.dispose();this.piA_.dispose()}setSize(t,i){this.aiA_.setSize(t,i);this.fiA_.setSize(t,i);let s=Math.round(t/this.uiA_),e=Math.round(i/this.uiA_);this.CiA_.setSize(s,e);this.diA_.setSize(s,e);this.EiA_.setSize(s,e);this.miA_.uniforms["texSize"].value=new g(s,e);s=Math.round(s/2);e=Math.round(e/2);this.BiA_.setSize(s,e);this.piA_.setSize(s,e);this.DiA_.uniforms["texSize"].value=new g(s,e);return this}FiA_(t){const i=i=>{if(i.isMesh)if(t){i.visible=i.userData.xiA_;delete i.userData.xiA_}else{i.userData.xiA_=i.visible;i.visible=t}};for(let t=0;t<this.mtA_.length;t++){const s=undefined;this.mtA_[t].traverse(i)}}LiA_(t){const i=[],s=t,e=t=>{t.isMesh&&i.push(t)};for(let t=0;t<this.mtA_.length;t++){const i=undefined;this.mtA_[t].traverse(e)}const A=e=>{if(e.isMesh||e.isLine||e.isSprite){let s=!1;for(let t=0;t<i.length;t++){const A=undefined;if(i[t].id===e.id){s=!0;break}}if(!s){const i=e.visible;t&&!e.userData.UiA_||(e.visible=t);e.userData.UiA_=i}}s&&e instanceof fUt&&!e.OC_()&&e.nf_(e.userData["oldVisible"],!0)};this.ktA_.traverse(A)}YiA_(t){const i=i=>{if(i instanceof fUt&&!i.OC_()){i.userData["oldVisible"]=i.visible;i.nf_(t,!0)}};this.ktA_.traverse(i)}TiA_(){this.kiA_.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);this.kiA_.multiply(this.FtA_.projectionMatrix);this.kiA_.multiply(this.FtA_.matrixWorldInverse)}render(t,s,e,A,n){if(this.mtA_.length>0){t.getClearColor(this.NiA_);this.SiA_=t.getClearAlpha();const s=t.autoClear;t.autoClear=!1;t.setClearColor(16777215,1);this.FiA_(!1);this.YiA_(!1);const A=this.ktA_.background;this.ktA_.background=null;this.ktA_.overrideMaterial=this.giA_;t.setRenderTarget(this.fiA_);t.clear();t.render(this.ktA_,this.FtA_);this.FiA_(!0);this.TiA_();this.LiA_(!1);this.ktA_.overrideMaterial=this.ciA_;this.ciA_.uniforms["cameraNearFar"].value=new g(this.FtA_.near,this.FtA_.far);this.ciA_.uniforms["depthTexture"].value=this.fiA_.texture;this.ciA_.uniforms["textureMatrix"].value=this.kiA_;t.setRenderTarget(this.aiA_);t.clear();t.render(this.ktA_,this.FtA_);this.ktA_.overrideMaterial=null;this.LiA_(!0);this.ktA_.background=A;this.rtA_.material=this.biA_;this.niA_["tDiffuse"].value=this.aiA_.texture;t.setRenderTarget(this.CiA_);t.clear();this.rtA_.render(t);this.GiA_.copy(this.Kis_["visiblecolor"]);this.RiA_.copy(this.Kis_["hiddencolor"]);if(this.Kis_["pulseperiod"]>0){const t=(Mi.performance||Date).now(),i=(1+.25)/2+Math.cos(t*.01/this.Kis_["pulseperiod"])*(1-.25)/2;this.GiA_.multiplyScalar(i);this.RiA_.multiplyScalar(i)}this.rtA_.material=this.wiA_;this.wiA_.uniforms["maskTexture"].value=this.CiA_.texture;this.wiA_.uniforms["texSize"].value=new g(this.CiA_.width,this.CiA_.height);this.wiA_.uniforms["visibleEdgeColor"].value=this.GiA_;this.wiA_.uniforms["hiddenEdgeColor"].value=this.RiA_;this.wiA_.uniforms["hiddenLine"].value=this.Kis_["hiddenline"];t.setRenderTarget(this.EiA_);t.clear();this.rtA_.render(t);this.rtA_.material=this.miA_;this.miA_.uniforms["colorTexture"].value=this.EiA_.texture;this.miA_.uniforms["direction"].value=i.KiA_;this.miA_.uniforms["kernelRadius"].value=this.Kis_["edgethickness"];t.setRenderTarget(this.diA_);t.clear();this.rtA_.render(t);this.miA_.uniforms["colorTexture"].value=this.diA_.texture;this.miA_.uniforms["direction"].value=i.HiA_;t.setRenderTarget(this.EiA_);t.clear();this.rtA_.render(t);this.rtA_.material=this.DiA_;this.DiA_.uniforms["colorTexture"].value=this.EiA_.texture;this.DiA_.uniforms["direction"].value=i.KiA_;t.setRenderTarget(this.BiA_);t.clear();this.rtA_.render(t);this.DiA_.uniforms["colorTexture"].value=this.BiA_.texture;this.DiA_.uniforms["direction"].value=i.HiA_;t.setRenderTarget(this.piA_);t.clear();this.rtA_.render(t);this.MiA_.blending=this.NiA_.equals(Aqt)?qt:Vt;this.rtA_.material=this.MiA_;this.MiA_.uniforms["maskTexture"].value=this.aiA_.texture;this.MiA_.uniforms["edgeTexture1"].value=this.EiA_.texture;this.MiA_.uniforms["edgeTexture2"].value=this.piA_.texture;this.MiA_.uniforms["patternTexture"].value=this.Kis_["patterntexture"];this.MiA_.uniforms["edgeStrength"].value=this.Kis_["edgestrength"];this.MiA_.uniforms["edgeGlow"].value=this.Kis_["edgeglow"];this.MiA_.uniforms["usePatternTexture"].value=this.liA_;t.setRenderTarget(e);this.rtA_.render(t);t.setClearColor(this.NiA_,this.SiA_);t.autoClear=s}if(this.etA_){this.rtA_.material=this.biA_;this.niA_["tDiffuse"].value=e.texture;t.setRenderTarget(null);this.rtA_.render(t)}}IiA_(){const t=nqt.Z7e_;return new d({uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})}QiA_(){const t=nqt._7e_;return new d({uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})}yiA_(t){const i=nqt.$7e_;return new d({defines:{MAX_RADIUS:t},uniforms:i.uniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader})}viA_(){const t=nqt.ttA_,i=this.Kis_["clearcolor"];let s=Vt;i.equals(Aqt)&&(s=qt);return new d({uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,blending:s,depthTest:!1,depthWrite:!1,transparent:!0})}};s.KiA_=new g(1,0);s.HiA_=new g(0,1);s=i=t([_s("geotoolkit3d.postprocessing.OutlinePass")],s);return s}();var oqt=Ci({yOt_:"onSelectionChanged",qiA_:"onSelection"},2,"eyJvblNlbGVjdGlvbkNoYW5nZWQiOiJ5T3RfIiwib25TZWxlY3Rpb24iOiJxaUFfIn0g"),lqt=Ci(function(){let i=class t extends vFt{constructor(t){const i=qi(t,{name:"selectiontool",enabled:!0,filter:null,hover:!1,picking:$Lt});super(i);this.gp_=i["filter"];this.JiA_=i["hover"];this.JUe_=[];this.PiA_=i["picking"]}setOptions(t){const i=qi(t,{plot:this.E8_,enabled:this.xv_,filter:this.gp_,hover:this.JiA_,picking:this.PiA_});this.gp_=i["filter"];this.E8_=i["plot"];this.JiA_=i["hover"];this.xv_=i["enabled"];this.PiA_=i["picking"];super.setOptions(i);return this}JV_(){const t=super.JV_();t["filter"]=this.gp_;t["hover"]=this.JiA_;t["enabled"]=this.xv_;t["picking"]=this.PiA_;return t}Sze_(t){this.JiA_&&this.qiA_(this.PiA_.pO_(this.E8_,t["plotX"],t["plotY"],this.Xz_,this.Xz_,this.gp_),t)}Gze_(t){this.xv_&&this.qiA_(this.PiA_.pO_(this.E8_,t["plotX"],t["plotY"],this.Xz_,this.Xz_,this.gp_),t)}qiA_(t,i){this.notify(oqt.qiA_,this,t);this.notify(oqt.yOt_,this,{selection:t,event:i});for(let s=0;s<this.JUe_.length;s++)this.JUe_[s](t,i)}vze_(t){return $i()}bze_(t){return $i()}Nze_(t){return $i()}Rze_(t){return $i()}jFt_(t){return $i()}kze_(t){return $i()}Fze_(t){return $i()}xze_(t){return $i()}Lze_(t){return $i()}aWt_(t){return $i()}Uze_(t){return $i()}Yze_(t){return $i()}Tze_(t){return $i()}Kze_(t){return $i()}Hze_(t){return $i()}qze_(t){return $i()}};i=t([_s("geotoolkit3d.tool.SelectionTool")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwib25DdXJzb3JNb3ZlIjoiU3plXyIsIm9uVGFwIjoiR3plXyIsIm9uU2VsZWN0aW9uIjoicWlBXyIsIm9uS2V5U3RhcnQiOiJ2emVfIiwib25LZXkiOiJiemVfIiwib25LZXlFbmQiOiJOemVfIiwib25Eb3VibGVUYXAiOiJSemVfIiwib25Nb3VzZVdoZWVsIjoiakZ0XyIsIm9uUGluY2hTdGFydCI6Imt6ZV8iLCJvblBpbmNoIjoiRnplXyIsIm9uUGluY2hFbmQiOiJ4emVfIiwib25EcmFnU3RhcnQiOiJMemVfIiwib25EcmFnIjoiYVd0XyIsIm9uRHJhZ0VuZCI6IlV6ZV8iLCJvblNsaWRlU3RhcnQiOiJZemVfIiwib25TbGlkZSI6IlR6ZV8iLCJvblNsaWRlRW5kIjoiS3plXyIsIm9uVmlzaWJpbGl0eUdhaW5lZCI6Ikh6ZV8iLCJvblZpc2liaWxpdHlMb3N0IjoicXplXyJ9fX0g");var uqt=function(){let i=class t extends vHt{constructor(t){super({shader:EHt.itA_});this.type="FXAARenderPass";this.setOptions(t)}setOptions(t){if(!t)return this;t["enabled"]!=null&&(this.enabled=t["enabled"]);return this}setSize(t,i){this.material.uniforms["resolution"].value.x=1/t;this.material.uniforms["resolution"].value.y=1/i;return this}render(t,i,s,e,A){super.render(t,i,s)}};i=t([_s("geotoolkit3d.postprocessing.FXAARenderPass")],i);return i}();const aqt=new a,gqt=new u;var cqt=function(){let i=class t extends EUt{constructor(t){super();t=t||{};this.E8_=t["plot"];this.ib_=Date.now();this.Ltt_=!1;this.ViA_=t["duration"]||1e3;this.O_t_=this.E8_.OiA_(this.E8_.e$e_());this.tz_=this.E8_.OiA_(t["position"]||this.E8_.e$e_());this.WiA_=this.E8_.gXe_().quaternion.clone();this.ziA_=this.E8_.gXe_().quaternion.clone();this.XiA_=null;const i=t["lookat"];if(i){this.XiA_=this.E8_.OiA_(i);const t=fLt.iZe_(this.tz_,this.XiA_,this.E8_);aqt.copy(this.tz_).sub(this.XiA_).normalize();gqt.lookAt(this.tz_,i,t);gqt.decompose(aqt,this.ziA_,aqt)}}run(){if(!this.E8_||this.Ltt_)return!0;const t=this.E8_.gXe_(),i=this.E8_.jiA_(),s=Date.now()-this.ib_;if(s>this.ViA_){t.position.copy(this.tz_);t.quaternion.copy(this.ziA_);i.setOptions({position:this.tz_,lookat:this.XiA_?this.XiA_:this.E8_.ZiA_()});this.E8_.invalidateObject(new iUt({type:tUt.Camera,source:this.E8_.gXe_(),args:[]}));return!0}t.position.lerpVectors(this.O_t_,this.tz_,s/this.ViA_);t.quaternion.copy(this.WiA_).slerp(this.ziA_,s/this.ViA_);i.setOptions({position:this.E8_.e$e_(),lookat:this.E8_.ZiA_()});this.E8_.invalidateObject(new iUt({type:tUt.Camera,source:this.E8_.gXe_(),args:[]}));return!1}stop(){this.Ltt_=!0}};i=t([_s("geotoolkit3d.scene.animation.CameraMoveAnimation")],i);return i}();const Iqt=new a;var fqt=function(){let i=class t extends zt{beforeRender(t,i,s,e){this.position.copy(s.OiA_(s.e$e_(Iqt)))}};i=t([_s("geotoolkit3d.scene.PointLight")],i);return i}();const Cqt=["varying vec2 vUv;","uniform vec2 aspectScale;","void main() {","    vUv = uv;","    gl_Position = vec4( aspectScale * position.xy, -0.999, 1.0 );","}"].join("\n"),dqt=["uniform sampler2D tDiffuse;","uniform float opacity;","varying vec2 vUv;","void main() {","    vec4 texel = texture2D( tDiffuse, vUv );","    texel.a *= opacity;","    if (texel.a < 0.00392) discard;","    gl_FragColor = texel;","}"].join("\n"),Bqt=new g,wqt=1080;var Qqt=function(){let i=class t extends d{constructor(){const t=new h(null),i=new h(1),s=new h(new g(1,1));super({vertexShader:Cqt,fragmentShader:dqt,uniforms:{opacity:i,tDiffuse:t,aspectScale:s}});this._iA_=t;this.$iA_=s;this.tsA_=i;this.isA_=new g(0,0);this.ssA_=1;this["transparent"]=!0;this["userData"].i_e_=!0;this["opacity"]=1}setTexture(t,i){this._iA_["value"]=t;this.ssA_=i}beforeRender(t){if(!this.isA_.equals(t)){this.isA_.copy(t);const i=t.x/t.y;let s,e;const A=this.ssA_/i;if(i>=this.ssA_){s=A;e=1}else{s=1;e=1/A}this.$iA_["value"].set(s,e)}this.tsA_["value"]=this["opacity"]}dispose(){super.dispose();if(this._iA_!=null){fLt.$je_(this._iA_["value"]);this._iA_=null}}};i=t([_s("geotoolkit3d.scene.WatermarkMaterial")],i);return i}(),Eqt=function(){let i=class t extends W{constructor(){const t=new bt(2,2),i=new Qqt;super(t,i);this.onBeforeRender=(t,i,s,e,A,n)=>{super.onBeforeRender(t,i,s,e,A,n);if(this.esA_!=null){t.getSize(Bqt);this.x9e_.beforeRender(Bqt)}};this.x9e_=i;this["renderOrder"]=999;this["frustumCulled"]=!1;this.AsA_=new fUt;this.add(this.AsA_)}nsA_(t,i,s){const e=t.getBounds(),A=this.hsA_(e,i,s),n=(new At).load(If.MV_(t,A.x,A.y,!1,!1,e),(()=>{this.AsA_.invalidateObject()})),h=A.x/A.y;this.x9e_.setTexture(n,h);this.esA_=t}hsA_(t,i,s){if(i!=null&&s!=null)return new g(i,s);const e=t.Ie_()/t.Ts_(),A=e<1;if(i==null&&s==null)return new g(i=A?wqt*e:wqt,s=A?wqt:wqt/e);i==null?i=s*e:s=i/e;return new g(i,s)}rsA_(){return this.esA_}osA_(){return this.x9e_}OC_(){return!1}dispose(){if(this.x9e_!=null){this.x9e_.dispose();this.x9e_=null}this.AsA_=null;this.esA_=null}};i=t([_s("geotoolkit3d.scene.Watermark")],i);return i}();var pqt=Ci({i1e_:"perspective",s1e_:"orthographic"},2,"eyJQZXJzcGVjdGl2ZSI6ImkxZV8iLCJPcnRob2dyYXBoaWMiOiJzMWVfIn0g"),mqt=Ci({W_:"None",lsA_:"MaintainScale"},2,"eyJOb25lIjoiV18iLCJNYWludGFpblNjYWxlIjoibHNBXyJ9"),yqt=Ci({usA_:"orbit",asA_:"trackball",gsA_:"firstperson",W_:"none"},2,"eyJPcmJpdCI6InVzQV8iLCJUcmFja0JhbGwiOiJhc0FfIiwiRmlyc3RQZXJzb24iOiJnc0FfIiwiTm9uZSI6IldfIn0g"),Dqt=Ci({__:"hover",st_:"click"},2,"eyJIb3ZlciI6Il9fIiwiQ2xpY2siOiJzdF8ifSAg"),Mqt=Ci({csA_:"HighlightTool"},2,"eyJIaWdobGlnaHRUb29sIjoiY3NBXyJ9");const vqt=1e-7,bqt=new u,Nqt=new g,Sqt=new a,Gqt=new l,Rqt=new a,kqt=new a;let Fqt=null;const xqt=(t,i,s,e,A)=>t===yqt.usA_?new QUt({camera:i,plot:s,position:e,lookat:A}):t===yqt.asA_?new kUt({camera:i,plot:s,position:e,lookat:A}):t===yqt.W_?new NFt:t===yqt.gsA_?new bUt({camera:i,plot:s,position:e,lookat:A}):new t({camera:i,plot:s,position:e,lookat:A}),Lqt=(()=>{const t=[];for(let i=0;i<8;i++)t.push(new a);const i=new a;return(s,e,A)=>{t[0].set(s.min.x,s.min.y,s.min.z);t[1].set(s.max.x,s.min.y,s.min.z);t[2].set(s.max.x,s.max.y,s.min.z);t[3].set(s.max.x,s.max.y,s.max.z);t[4].set(s.max.x,s.min.y,s.max.z);t[5].set(s.min.x,s.max.y,s.min.z);t[6].set(s.min.x,s.max.y,s.max.z);t[7].set(s.min.x,s.min.y,s.max.z);let n=-1,h=-1,r=Number.MAX_VALUE,o=-Number.MAX_VALUE;for(let s=0;s<8;s++){const l=i.subVectors(t[s],e).dot(A);if(l<r){n=s;r=l}if(l>o){h=s;o=l}}return{min:t[n],IsA_:r,max:t[h],fsA_:o}}})(),Uqt=t=>t.visible,Yqt=(t,i)=>{if(t==null)return;if(!t.visible&&!i)return;t.matrixAutoUpdate===!0&&t.updateMatrix();if(t.matrixWorldNeedsUpdate===!0||i===!0){t.parent===void 0?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(t.parent.matrixWorld,t.matrix);i=!0;t.matrixWorldNeedsUpdate=!1}const s=t.children.length;for(let e=0;e<s;e++)Yqt(t.children[e],i)};var Tqt=Ci(function(){var i;let s=i=class t extends $n{constructor(t){super();t=t||{};this.Kis_=Pi(t,{container:null,autoupdate:!0,autoupdateinterval:0,autoupdatemodellimits:!0,scale:new a(1,1,1),translation:new a(0,0,0),applyorigintranslation:!1,stats:!1,camera:{type:pqt.i1e_,orthoresize:mqt.lsA_,position:new a(0,-500,500),lookat:new a(0,0,0),up:new a(0,vqt,1),fov:50,near:"auto",far:"auto",minnear:1,minfar:100,nearfarscale:null,movewithscale:!1,controller:{type:yqt.usA_,autorotate:!1}},compass:{enabled:!0},ambientlighting:{color:"#1c1c1c",enabled:!0},cameralighting:{color:"white",enabled:!0,intensity:1},renderer:{parameters:{precision:"highp",logarithmicDepthBuffer:!0,antialias:!1},devicepixelratio:Is(),clearcolor:"black",clearcoloralpha:1},postprocessing:{enabled:!0,depthpeeling:{enabled:!0,peelinglevel:je.ss_()?2:5},antialias:{enabled:!0,mode:eFt.R4t_},highlight:{enabled:!0,mode:Dqt.st_,edgestrength:4,edgeglow:0,edgethickness:1,pulseperiod:0,visiblecolor:new l("red"),hiddencolor:new l(11167591),hiddenline:!1,highlightedges:!0}},picking:{usecache:!0,cachetimelimit:1e3/30}});if(this.Kis_["camera"]["controller"]["type"]===yqt.W_){this.Kis_["renderer"]["parameters"]["antialias"]=!0;this.Kis_["postprocessing"]["enabled"]=!1}this.M7e_=new D(this.Kis_["renderer"]["parameters"]);this.M7e_.debug["onShaderError"]=RFt;mKt.m6e_(this.M7e_);if(!mKt.G6e_())throw new Error("WebGL is not supported by this browser");mKt.R6e_()&&ki("Detected Intel Graphics - rendering performance may be poor");this._D_=this.Kis_["container"];if(this._D_==null){this.Jp_=this.M7e_.domElement.width;this.Pp_=this.M7e_.domElement.height;this._D_=this.M7e_.domElement.parentNode}else{this.Jp_=this._D_.offsetWidth;this.Pp_=this._D_.offsetHeight;this._D_.appendChild(this.M7e_.domElement)}this.M7e_.setSize(this.Jp_,this.Pp_);this.M7e_.setPixelRatio(this.Kis_["renderer"]["devicepixelratio"]);this.v7e_=new M;this._root=new fUt;this._root.matrixWorldNeedsUpdate=!0;this.v7e_.add(this._root);this.CsA_=new fUt;this.CsA_.name="ROOT";this._root.add(this.CsA_);this.Sxt_=[];this.$$t_=this.Kis_["autoupdate"];this.dsA_=this.Kis_["autoupdateinterval"];this.BsA_=this.Kis_["autoupdatemodellimits"];this.wsA_=this.Kis_["applyorigintranslation"];this.Qis_=!1;this.QsA_=null;this.EsA_=null;this.psA_=!0;this.Fm_=!0;this.msA_=16;this.ysA_=new a;this.uXe_=this.DsA_(this.Kis_["camera"]);this.v7e_.add(this.uXe_);const i=this.Kis_["camera"]["controller"]["type"],s=this.OiA_(this.Kis_["camera"]["position"].clone()),e=this.OiA_(this.Kis_["camera"]["lookat"].clone());if(this.MsA_==null){this.MsA_=xqt(i,this.uXe_,this,s,e);this.vsA_(this.MsA_)}this.bsA_(s,e);this.v7e_.userData["plot"]=this;this.v7e_.updateMatrixWorld();this.v7e_.add(this.NsA_=new yKt);this.invalidateObject(new iUt({source:this,type:tUt.Add,args:[this.v7e_]}));this.SsA_=fHt.IO_();this.setOptions(this.Kis_);this.$$t_&&this.startRendering();return this}bZe_(){if(this.wsA_){this._root.position.sub(this.ysA_);this.uXe_.position.sub(this.ysA_);if(this.EZe_().localClippingEnabled){this.ysA_.negate();this._root.traverse((t=>{const i=t.material;if(i!=null)if(Array.isArray(i))for(let t=0;t<i.length;t++){const s=i[t].clippingPlanes;if(s!=null)for(let t=0;t<s.length;t++)s[t].translate(this.ysA_)}else{const t=i.clippingPlanes;if(t!=null)for(let i=0;i<t.length;i++)t[i].translate(this.ysA_)}}))}this.ysA_.set(0,0,0)}this.uXe_.updateProjectionMatrix();this.uXe_.updateMatrixWorld();Yqt(this._root,!0)}GsA_(t){kqt.copy(this.uXe_.position);this.RsA_(Rqt);const i=Lqt(t,kqt,Rqt),s=i.IsA_,e=i.fsA_,A=(i.fsA_-i.IsA_)/100,n=(e+s)/2,h=n/4;let r=s-A,o=e+A;if(o-r<h){r=n-h;o=n+h}this.ksA_&&r<o/this.ksA_&&(r=o/this.ksA_);this.uXe_.near=this.FsA_?Math.max(r,this.xsA_):this.uXe_.near;this.uXe_.far=this.LsA_?Math.max(o,this.UsA_):this.uXe_.far;this.uXe_.updateProjectionMatrix()}YsA_(){if(!Fqt){Fqt=[];for(let t=0;t<8;t++)Fqt.push(new a)}const t=Fqt;t[0].set(-1,-1,-1);t[1].set(-1,-1,+1);t[2].set(-1,+1,-1);t[3].set(-1,+1,+1);t[4].set(+1,-1,-1);t[5].set(+1,-1,+1);t[6].set(+1,+1,-1);t[7].set(+1,+1,+1);const i=new C;for(let s=0;s<8;s++){t[s].unproject(this.uXe_);i.expandByPoint(t[s])}return i}static TsA_(t){if(t.max.x-t.min.x<.1){t.min.x-=.05;t.max.x+=.05}if(t.max.y-t.min.y<.1){t.min.y-=.05;t.max.y+=.05}if(t.max.z-t.min.z<.1){t.min.z-=.05;t.max.z+=.05}}MZe_(t){let s=null;if(t&&t._je_){s=t._je_.SZe_;i.TsA_(s);const e=fLt.jje_(s,this,this.uXe_,t);s.copy(e)}s||(s=this.rt_(!0,Uqt).clone());this.FsA_!==!0&&this.LsA_!==!0||this.GsA_(s);const e=this.YsA_();s.intersectsBox(e)&&s.intersect(e);i.TsA_(s);if(this.wsA_){s.getCenter(this.ysA_).negate();this._root.position.add(this.ysA_);this.uXe_.position.add(this.ysA_);s.min.add(this.ysA_);s.max.add(this.ysA_);this.EZe_().localClippingEnabled&&this._root.traverse((t=>{const i=t.material;if(i!=null)if(Array.isArray(i))for(let t=0;t<i.length;t++){const s=i[t].clippingPlanes;if(s!=null)for(let t=0;t<s.length;t++)s[t].translate(this.ysA_)}else{const t=i.clippingPlanes;if(t!=null)for(let i=0;i<t.length;i++)t[i].translate(this.ysA_)}}))}this.uXe_.updateMatrixWorld();Yqt(this._root,!0);this.KsA_()}render(){this.notify(tUt.RZe_,this);this.MZe_();this.v7e_.traverseVisible((t=>{t.beforeRender!=null&&t.beforeRender(this.v7e_,this.uXe_,this,this.M7e_)}));this.HsA_!=null&&this.HsA_.render(this.v7e_,this.uXe_);this.qsA_?this.JsA_.render():this.M7e_.render(this.v7e_,this.uXe_);if(this.K_e_){this.uXe_.position.sub(this.ysA_);this.MsA_.CXe_();this.uXe_.position.add(this.ysA_)}this.SsA_&&this.SsA_.w7e_();this.bZe_();this.v7e_.traverseVisible((t=>{t.afterRender!=null&&t.afterRender(this.v7e_,this.uXe_,this,this.M7e_)}));this.notify(tUt.kZe_,this)}setOptions(t){if(this.Df_())return this;t=t||{};this.Kis_=Pi(t,this.Kis_);if(this.PsA_==null){const t=this.Kis_["camera"]["lookat"].distanceTo(this.Kis_["camera"]["position"])*10,i=this.Kis_["camera"]["lookat"];this.Kis_["modellimits"]=new C(i.clone().addScalar(-t),i.clone().addScalar(t));this.PsA_=this.Kis_["modellimits"]}else t["modellimits"]&&(this.PsA_=t["modellimits"]);let i=!1;if(t["renderer"]&&(t["renderer"]["clearcolor"]!=null||t["renderer"]["clearcoloralpha"]!=null)){const s=t["renderer"]["clearcolor"]||this.M7e_.getClearColor(Gqt),e=t["renderer"]["clearcoloralpha"]||this.M7e_.getClearAlpha();this.M7e_.setClearColor(s,e);i=!0}if(t["ambientlighting"]){if(this.VsA_==null&&this.Kis_["ambientlighting"]["enabled"]){this.VsA_=new Xt;this.v7e_.add(this.VsA_)}else if(this.VsA_!=null&&!this.Kis_["ambientlighting"]["enabled"]){this.v7e_.remove(this.VsA_);this.VsA_=null}this.VsA_&&t["ambientlighting"]["color"]&&(this.VsA_.color=new l(t["ambientlighting"]["color"]))}if(t["cameralighting"]){if(this.OsA_==null&&this.Kis_["cameralighting"]["enabled"]){this.OsA_=new fqt(t["cameralighting"]["color"]);this.v7e_.add(this.OsA_)}else if(this.OsA_!=null&&!this.Kis_["cameralighting"]["enabled"]){this.v7e_.remove(this.OsA_);this.OsA_=null}this.OsA_!=null&&t["cameralighting"]["intensity"]&&(this.OsA_.intensity=t["cameralighting"]["intensity"]);this.OsA_!=null&&t["cameralighting"]["color"]&&(this.OsA_.color=new l(t["cameralighting"]["color"]))}let s=!1;if(t["translation"]&&!this.CsA_.position.equals(t["translation"])){this.CsA_.position.copy(t["translation"]);this.CsA_.matrixWorldNeedsUpdate=!0;s=!0}if(t["scale"]&&!this._root.scale.equals(t["scale"])){this._root.scale.copy(t["scale"]);this._root.matrixWorldNeedsUpdate=!0;s=!0}s&&Yqt(this._root);if(t["camera"]){this.DsA_(t["camera"]);(t["camera"]["position"]||t["camera"]["lookat"])&&this.bsA_(t["camera"]["position"],t["camera"]["lookat"]);if(t["camera"]["controller"]){const i=qi(t["camera"]["controller"],t["camera"]["controller"]["options"]);this.K_e_=i["autorotate"]&&this.Kis_["camera"]["controller"]["type"]===yqt.usA_;this.MsA_.setOptions(i)}}if(t["compass"])if(this.HsA_==null&&this.Kis_["compass"]["enabled"]){if(t["compass"]["container"]==null&&t["compass"]["canvas"]==null){const t=Math.min(this.Jp_,this.Pp_);this.WsA_=xs("div","__geotoolkit_compass");this.WsA_.style["position"]="absolute";this.WsA_.style["bottom"]="0px";this.WsA_.style["right"]="0px";this.WsA_.style["border"]="none";this.WsA_.style["width"]=Math.floor(t/6)+"px";this.WsA_.style["height"]=Math.floor(t/6)+"px";this.WsA_.style["pointerEvents"]="none";this._D_.appendChild(this.WsA_);this.zsA_=this.WsA_}else this.zsA_=t["compass"]["container"];this.HsA_=new BHt({container:this.zsA_,camera:this.uXe_,canvas:t["compass"]["canvas"]})}else if(this.HsA_!=null&&!this.Kis_["compass"]["enabled"]){this._D_.removeChild(this.WsA_);this.HsA_=this.WsA_=null}if(this.XsA_==null&&t["stats"]){this.XsA_=new QHt;this._D_.appendChild(this.XsA_.X7e_())}else if(this.XsA_!=null&&!t["stats"]){this._D_.removeChild(this.XsA_.X7e_());this.XsA_=null}if(t["postprocessing"]){if(!mKt.isWebGL2()){ki("geotoolkit3d: WebGL 2.0 is not supported by this browser. Effects such as highlighting is disabled.");t["postprocessing"]["enabled"]=!1}if(this.JsA_==null&&t["postprocessing"]["enabled"]){this.qsA_=!0;const t=Is(),s=this.Kis_["postprocessing"];s["highlight"]["edgethickness"]*=t;s["highlight"]["edgestrength"]*=t;s["antialias"]["mode"]===eFt.R4t_&&(s["antialias"]["mode"]=this.jsA_(t,Mi.screen));this.JsA_=new NHt(this.M7e_);const e=qi(s["highlight"],{scene:this.v7e_,camera:this.uXe_,clearcolor:this.M7e_.getClearColor(new l),resolution:new g(this.Jp_,this.Pp_)}),A=new FHt(e);this.JsA_.CtA_(A);const n=Pi(s,{scene:this.v7e_,camera:this.uXe_,unbiased:!0,clearcolor:this.M7e_.getClearColor(Gqt).getHex(),clearcoloralpha:this.M7e_.getClearAlpha()}),h=qi(this.Kis_["postprocessing"],n),r=new tqt(h);this.JsA_.CtA_(r);if(s["antialias"]["mode"]===eFt.bWe_){const t=qi(this.Kis_["postprocessing"]["antialias"],n),i=new eqt(t);this.JsA_.CtA_(i)}const o=new rqt(e);this.JsA_.CtA_(o);const u=new lqt({name:"HighlightTool",hover:this.Kis_["postprocessing"]["highlight"]["mode"]==="hover"});u.on(oqt.yOt_,((t,i,s)=>{const e=s["selection"];this.JsA_.wtA_().forEach((t=>{if(t instanceof RHt){t.ytA_();if(e[0]&&e[0]["object"]){let i=!1;if(this.Kis_["postprocessing"]["highlight"]["highlightedges"]){let t=e[0]["object"];while(t!=null&&!(t instanceof fUt))t=t.parent;if(t&&t.l_e_())return;i=t!=null&&t.u_e_()}(i&&t instanceof FHt||!i&&t instanceof rqt)&&t.DtA_(e[0]["object"])}this.invalidateObject()}}))}));this.vsA_(u);if(s["antialias"]["mode"]===eFt.NWe_){const t=new uqt;this.JsA_.CtA_(t)}i=!1}else if(this.JsA_!=null){const i=this.JsA_.wtA_();for(let s=0;s<i.length;s++)i[s].setOptions(t["postprocessing"])}}i&&this.JsA_!=null&&this.JsA_.wtA_().forEach((t=>{t.setOptions({clearcolor:this.M7e_.getClearColor(Gqt).getHex(),clearcoloralpha:this.M7e_.getClearAlpha()})}));this.invalidateObject();this.uvt_();return this}JV_(){return this.Kis_}startRendering(){const t=()=>{if(this.Qis_||this.K_e_){this.Qis_=!1;this.updateObject();this.render()}};let i=this.dsA_;Mi.requestAnimationFrame||(i=this.msA_);if(i===0){const i=()=>{this.XsA_!=null&&this.XsA_.Zb_();t();this.EsA_=Mi.requestAnimationFrame(i);this.XsA_!=null&&this.XsA_.end()};this.EsA_=Mi.requestAnimationFrame(i)}else{this.EsA_=new kw(i,t);this.EsA_.start()}}OiA_(t){Yqt(this._root);bqt.copy(this.CsA_.matrixWorld);return t.applyMatrix4(bqt)}fZe_(t){Yqt(this._root);bqt.copy(this.CsA_.matrixWorld).invert();return t.applyMatrix4(bqt)}DsA_(t){const i=Pi(t,this.Kis_["camera"]);this.ZsA_=i["orthoresize"];this.ksA_=i["nearfarscale"];this.xsA_=i["minnear"];this.UsA_=i["minfar"];if(i["near"]==="auto"){this.FsA_=!0;i["near"]=1}if(i["far"]==="auto"){this.LsA_=!0;i["far"]=1e5}if(this.uXe_==null)i["type"]===pqt.i1e_?this.uXe_=new Q(i["fov"],this.Jp_/this.Pp_,i["near"],i["far"]):this.uXe_=new v(-this.Jp_/2,this.Jp_/2,this.Pp_/2,-this.Pp_/2,i["near"],i["far"]);else{this.uXe_.near=i["near"];this.uXe_.far=i["far"];this.uXe_ instanceof Q&&(this.uXe_.fov=i["fov"])}this.uXe_.up=i["up"];this.uXe_.updateProjectionMatrix();return this.uXe_}e$e_(t){t==null?t=this.uXe_.position.clone():t.copy(this.uXe_.position);return this.fZe_(t)}ZiA_(t){t==null&&(t=new a);return this.MsA_ instanceof NFt?this.e$e_(t).add(this.RsA_(Sqt)):this.fZe_(t.copy(this.MsA_.akt_()))}_sA_(t,i){this.$sA_(new a(0,1,0),t,i);return this}$sA_(t,i,s,e,A){const n=this.rt_(),h=new a;n.getSize(h);A&&h.setZ(0);const r=new a;t==null&&(t=(t=this.fZe_(this.uXe_.position.clone()).sub(n.getCenter(r))).normalize());e=e||1;let o;if(this.uXe_ instanceof Q){const t=this.uXe_.fov,i=undefined;o=h.length()*.65/Math.sin(Math.PI/180*t*.5)}else{o=h.length()/2;const t=this.getSize().Ie_(),i=this.getSize().Ts_();this.uXe_.left=-o*t/i;this.uXe_.right=o*t/i;this.uXe_.top=o;this.uXe_.bottom=-o}o*=e;t.multiplyScalar(o).add(n.getCenter(r));this.bsA_(t,r,i,s);return this}RsA_(t){t==null?t=new a(0,0,-1):t.set(0,0,-1);return t.applyEuler(this.uXe_.rotation)}teA_(t){t==null&&(t=new u);this.uXe_.updateMatrix();return t.copy(this.uXe_.matrix)}ieA_(t,i,s){this.bsA_(t,null,i,s);return this}s$e_(t,i,s){this.bsA_(null,t,i,s);return this}bsA_(t,i,s,e){if(this.seA_!=null){this.seA_.stop();this.V$e_().x6e_(this.seA_);this.seA_=null}if(t==null&&i==null)return this;if(s===!0){this.seA_=new cqt({plot:this,position:t,lookat:i,duration:e});this.V$e_().O$e_(this.seA_)}else{t!=null&&this.uXe_.position.copy(this.OiA_(t.clone()));i!=null&&this.uXe_.lookAt(this.OiA_(i.clone()));this.MsA_!=null&&this.MsA_.setOptions({position:t!=null?this.OiA_(t.clone()):void 0,lookat:i!=null?this.OiA_(i.clone()):void 0});this.invalidateObject(new iUt({type:tUt.Camera,source:this.uXe_,args:[]}))}return this}eeA_(t,i){t!=null&&this.uXe_.position.copy(this.OiA_(t.clone()));i!=null&&this.uXe_.lookAt(this.OiA_(i.clone()));this.MsA_.setOptions({position:t!=null?this.OiA_(t.clone()):void 0,lookat:i!=null?this.OiA_(i.clone()):void 0});this.invalidateObject(new iUt({type:tUt.Camera,source:this.uXe_,args:[]}));return this}getRoot(){return this.CsA_}pZe_(){return this.v7e_}V$e_(){return this.NsA_}AeA_(){return this.HsA_}updateObject(){const t=this.v7e_,i=this.uXe_;this.v7e_.traverse((s=>{s.updateObject!=null&&s.updateObject(t,i)}))}setSize(t,i,s){const e=this.M7e_.getSize(Nqt),A=this.M7e_.getPixelRatio();s=isNaN(s)?Is():s;if(e.width===t&&e.height===i&&s===A)return this;if(this.uXe_ instanceof Q)this.uXe_.aspect=t/i;else if(this.uXe_ instanceof v&&this.ZsA_===mqt.lsA_){if(e.width!==t){const i=(this.uXe_.right-this.uXe_.left)/2,s=this.uXe_.left+i,A=i/e.width*t;this.uXe_.left=s-A;this.uXe_.right=s+A}if(e.height!==i){const t=(this.uXe_.top-this.uXe_.bottom)/2,s=this.uXe_.bottom+t,A=t/e.height*i;this.uXe_.bottom=s-A;this.uXe_.top=s+A}}this.uXe_.updateProjectionMatrix();this.M7e_.setSize(t,i);this.qsA_&&this.JsA_.setSize(t,i);isNaN(s)||this.M7e_.setPixelRatio(s);if(this.HsA_!=null){const e=Math.min(t,i);this.HsA_.setSize(Math.floor(e/6),s)}const n=this.Jp_,h=this.Pp_;this.Jp_=t;this.Pp_=i;this.invalidateObject(new iUt({type:tUt.cJt_,source:this,args:{neA_:new xA(n,h),current:new xA(t,i)}}));return this}heA_(t){this.JsA_!=null&&t instanceof mHt&&this.JsA_.CtA_(t)}reA_(){return this.JsA_==null?[]:this.JsA_.wtA_()}jsA_(t,i){return t<2&&i.height<1440&&i.width<2560&&!je.ss_()?eFt.SWe_:eFt.NWe_}getSize(t){return t?t.setSize(this.Jp_,this.Pp_):new xA(this.Jp_,this.Pp_)}Ej_(){const t=new a;return this.rt_().getCenter(t)}rt_(t,i){i==null&&(i=Uqt);if(t||i!==Uqt){this._root.updateMatrixWorld(!0);let s=fLt.Oje_(this._root,i,t);s==null&&(s=new C);return s}this.psA_&&this.uvt_(i);return this.PsA_.clone()}project(t){this.uXe_.updateMatrixWorld();t.project(this.uXe_);return t}vsA_(t){this.Sxt_.push(t);t.setOptions({plot:this,domelement:this.M7e_.domElement});return this}C5_(t){for(let i=0;i<this.Sxt_.length;i++)if(this.Sxt_[i].dn_()===t)return this.Sxt_[i];return null}oeA_(t){const i=this.Sxt_.indexOf(t);i!==-1&&this.Sxt_.splice(i,1)[0].dispose();t===this.MsA_&&(this.MsA_=null);return this}leA_(){return this.Sxt_}invalidateObject(t){const i=tUt;this.Qis_=!0;if(this.Fm_)if(t instanceof iUt){const s=t.getType();s!==i.Add&&s!==i.mt_&&s!==i.IWt_||!this.BsA_||(this.psA_=!0);this.HsA_==null||s!==i.Camera&&s!==i.cJt_||this.HsA_.invalidateObject(t);this.notify(s,this,{source:t.gkt_(),args:t.LZe_()});t.dispose()}else this.notify(i.sC_,this);return this}uvt_(t,i){t=t||Uqt;this._root.updateMatrixWorld(!0);const s=fLt.Oje_(this._root,t,i);if(s==null){if(this.PsA_==null){const t=this.ZiA_().distanceTo(this.uXe_.position)*10,i=this.ZiA_();this.PsA_=new C(i.clone().addScalar(-t),i.clone().addScalar(t))}}else{this.fZe_(s.min);this.fZe_(s.max);this.PsA_.copy(s)}this.psA_=!1;return this}EZe_(){return this.M7e_}ueA_(){return this.M7e_.info}vZe_(){if(this.QsA_==null){const t=new Ft(this.Jp_,this.Pp_,jt);this.QsA_=new Rt(this.Jp_,this.Pp_,{depthTexture:t})}this.QsA_.width===this.Jp_&&this.QsA_.height===this.Pp_||this.QsA_.setSize(this.Jp_,this.Pp_);return this.QsA_}dispose(){if(!this.Df_()){eh.Ai_().qf_(this._root);this.EsA_&&(this.EsA_ instanceof kw?this.EsA_.stop():Mi.cancelAnimationFrame(this.EsA_));this.Sxt_.forEach((t=>{t.dispose()}));this.Sxt_=[];this.HsA_!=null&&this.HsA_.dispose();this.HsA_=null;this.v7e_!=null&&fLt.dispose(this.v7e_.children);this.v7e_=null;this.NsA_!=null&&this.NsA_.dispose();this.NsA_=null;this.QsA_!=null&&this.QsA_.dispose();if(this.M7e_!=null){this._D_.removeChild(this.M7e_.domElement);this.M7e_.dispose!=null&&this.M7e_.dispose();const t=this.M7e_.getContext().getExtension("WEBGL_lose_context");t&&t.loseContext();this.M7e_=null}if(this.JsA_!=null){this.JsA_.dispose();this.JsA_=null}this._D_=null;this._root=null;this.uXe_=null;this.VsA_=null;this.OsA_=null;this.MsA_=null;this.zsA_=null;this.SsA_=null;super.dispose()}}gXe_(){return this.uXe_}jiA_(){return this.MsA_}GZe_(){return this._root}iM_(){return this._D_}DZe_(){return this.Qis_}O3_(t){eh.Ai_().Pf_(this._root,t);return this}Vf_(){return eh.Ai_().Vf_(this._root)}NZe_(t){this.wsA_=t}KsA_(){const t=this.Vf_();if(t!=null){if(this.aeA_==null){this.aeA_=new Eqt;this.aeA_.osA_()["opacity"]=.3;this.v7e_.add(this.aeA_)}this.aeA_.rsA_()!==t&&this.aeA_.nsA_(t,null,this.Pp_*Is())}}};s=i=t([_s("geotoolkit3d.Plot")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwicm9vdFNjYWxlIjoiT2lBXyIsInJvb3RTY2FsZUludiI6ImZaZV8iLCJnZXRDYW1lcmFMb2NhdGlvbiI6ImUkZV8iLCJnZXRDYW1lcmFMb29rQXQiOiJaaUFfIiwicmVzZXRDYW1lcmEiOiJfc0FfIiwiZml0Q2FtZXJhIjoiJHNBXyIsInNldENhbWVyYUxvY2F0aW9uIjoiaWVBXyIsInNldENhbWVyYUxvb2tBdCI6InMkZV8iLCJtb3ZlQ2FtZXJhIjoiYnNBXyIsImdldFNjZW5lIjoicFplXyIsImdldEFuaW1hdGlvbk1hbmFnZXIiOiJWJGVfIiwiZ2V0Q29tcGFzcyI6IkFlQV8iLCJhZGRNdWx0aXBhc3MiOiJoZUFfIiwiZ2V0TXVsdGlwYXNzIjoicmVBXyIsImdldERlZmF1bHRBQSI6ImpzQV8iLCJnZXRNb2RlbE9yaWdpbiI6IkVqXyIsImdldE1vZGVsTGltaXRzIjoicnRfIiwiYWRkVG9vbCI6InZzQV8iLCJnZXRUb29sQnlOYW1lIjoiQzVfIiwicmVtb3ZlVG9vbCI6Im9lQV8iLCJsaXN0VG9vbCI6ImxlQV8iLCJ1cGRhdGVNb2RlbExpbWl0cyI6InV2dF8iLCJnZXRSZW5kZXJlciI6IkVaZV8iLCJnZXRVc2FnZVN0YXRpc3RpY3MiOiJ1ZUFfIiwiZ2V0Q2FtZXJhIjoiZ1hlXyIsImdldENvbnRhaW5lciI6ImlNXyIsInNldFdhdGVybWFyayI6Ik8zXyIsInNldE9yaWdpblRyYW5zbGF0aW9uIjoiTlplXyJ9fX0g");Zt.enabled=!1;const Kqt="24px Arial",Hqt="rgba(255, 255, 255, 1.0)",qqt=Fa.z_,Jqt=ka.JQ_,Pqt=new a,Vqt=new a,Oqt=new a,Wqt=new xA,zqt=new a,Xqt=new a,jqt=new B,Zqt=t=>{const i=new r(t);i.needsUpdate=!0;i.minFilter=o;i.generateMipmaps=!1;return new R({map:i})};var _qt=Ci(function(){let i=class t extends E{constructor(t,i){const s=Ls(0,0,!0);super(Zqt(s));i=i||{};this.ojt_=s;this.dS_=this.ojt_.getContext("2d");this._q_=t;this.li_=i["style"]||new qa({font:i["font"]||Kqt,color:i["color"]||Hqt,alignment:qqt,baseline:Jqt});i["outline"]!=null&&this.tF_(i["outline"]);this.kls_();this.geA_=!1;this.NTt_=i["issizeindevice"]!==!1;this.ceA_=i["dontmanuallyupdate"]===!0;this.IeA_=this.material.map.image.width;this.feA_=this.material.map.image.height;this.scale.set(this.IeA_,this.feA_,1);this.CeA_=new a(0,0,0);this.deA_=new g(0,0);this.visible=!0;this.BeA_=new a(0,0,0);this.Owt_=new a(0,0,0);this.renderOrder=1}tF_(t){if(t!=null)if(t["enable"]!==!1){this.Xk_=qi(t,{enable:!0,innercolor:"white",outlinecolor:"black",thickness:4});this.Xk_["innercolor"]instanceof nA&&(this.Xk_["innercolor"]=this.Xk_["innercolor"].Es_());this.Xk_["outlinecolor"]instanceof nA&&(this.Xk_["outlinecolor"]=this.Xk_["outlinecolor"].Es_());this.kls_()}else{this.Xk_=null;this.kls_()}}SG_(){return this._q_}a_(t){if(t===this._q_)return this;this._q_=t;this.kls_();return this}FE_(){return this.li_}g_(t){if(this.li_===t)return this;this.li_=t;this.kls_();return this}kls_(){const t=$o.measureText(this._q_,this.li_);let i=t.Ie_(),s=t.Ts_();const e=(this._q_+"").split(Uo.Ly_);let A=0;if(this.Xk_!=null){A=this.Xk_["thickness"];i+=A*2;s+=A*2*e.length}const n=s/e.length;this.dS_.clearRect(0,0,this.ojt_.width,this.ojt_.height);this.ojt_.width=i;this.ojt_.height=s;this.dS_.font=this.li_.Zy_();if(this.Xk_!=null){this.dS_.strokeStyle=this.Xk_["outlinecolor"];this.dS_.lineWidth=A;this.dS_.lineJoin="miter";this.dS_.miterLimit=3}else this.dS_.fillStyle=this.li_.getColor();this.dS_.textBaseline=Jqt;this.dS_.textAlign=qqt;let h=n;for(let t=0;t<e.length;t++){if(this.Xk_!=null){this.dS_.strokeText(e[t],A,h-A);this.dS_.fillStyle=this.Xk_["innercolor"];this.dS_.fillText(e[t],A,h-A)}else this.dS_.fillText(e[t],0,h);h+=n}this.geA_=!1;if(this.material!=null){this.material.map.dispose();this.material.map=new Dt(this.ojt_);this.material.map.needsUpdate=!0}}weA_(t){this.CeA_.copy(t);return this}QeA_(t){this.deA_.copy(t);return this}EeA_(t,i,s){if(this.NTt_){let e;const A=this.scale.y/this.scale.x,n=t.distanceTo(i.position);if(i instanceof Q){const t=i.fov*Math.PI/180;e=2*Math.tan(t/2)*n}else i instanceof v&&(e=i.top-i.bottom);const h=undefined,r=this.scale.y/e*s.userData["plot"].getSize(Wqt).Ts_(),o=this.scale.y/r;this.scale.y*=o;this.scale.x=this.scale.y/A;const l=this.deA_.x!==0?this.deA_.y/this.deA_.x:1,u=this.deA_.y*o;Pqt.set(u/l,u/l,u)}else Pqt.set(this.deA_.x,this.deA_.x,this.deA_.y);Vqt.set(this.scale.x,this.scale.x,this.scale.y).add(Pqt);const e=Vqt.multiplyScalar(.75).multiply(this.CeA_),A=this.parent.matrixWorld.elements;Oqt.set(NA.sign(A[0]),NA.sign(A[5]),NA.sign(A[10]));e.multiply(Oqt);let n=t.add(e);n=this.parent.worldToLocal(n);return n}beforeRender(t,i,s,e,A){if(!this.visible||this.ceA_&&!A)return;fUt.prototype.beforeRender.call(this,t,i,s,e);if(this.geA_)this.position.equals(this.BeA_)?this.position.copy(this.Owt_):this.Owt_.copy(this.position);else{fUt.prototype.invalidateObject.call(this);this.Owt_.copy(this.position);this.BeA_.copy(this.position);this.IeA_=this.material.map.image.width;this.feA_=this.material.map.image.height;this.geA_=!0}this.scale.set(this.IeA_,this.feA_,1);const n=this.parent.localToWorld(Xqt.copy(this.Owt_)),h=this.EeA_(n,i,t);this.position.copy(h);this.BeA_.copy(h);this.parent.matrixWorld.decompose(Xqt,jqt,zqt);this.scale.multiply(Xqt.set(1,1,1).divide(zqt))}Nwt_(){return this.Owt_}Wje_(){return this.geA_}OC_(){return!1}dispose(){this.material.dispose();this.material=null;this.ojt_=null;this.dS_=null;this.li_=null;this.CeA_=null;this.deA_=null;this.Owt_=null;this.BeA_=null}};i=t([_s("geotoolkit3d.scene.Text2d")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRPdXRsaW5lIjoidEZfIiwiZ2V0VGV4dCI6IlNHXyIsInNldFRleHQiOiJhXyIsImdldFRleHRTdHlsZSI6IkZFXyIsInNldFRleHRTdHlsZSI6ImdfIiwic2V0QW5jaG9yT2Zmc2V0UmF0aW8iOiJ3ZUFfIiwic2V0QW5jaG9yT2Zmc2V0IjoiUWVBXyJ9fX0g");var $qt=Ci(function(){let i=class t extends z{constructor(){super();const t=new _t;t.moveTo(0,0);const i=yu.tS_(0,0,1,1);let s=i[0];t.moveTo(s.xN_(),s.LN_());for(let e=0;e<i.length;++e){s=i[e];t.bezierCurveTo(s.UN_(),s.YN_(),s.TN_(),s.KN_(),s.HN_(),s.qN_())}t.closePath();const e=t.extractPoints(12).shape,A=[];for(let t=0;t<e.length;t++)A.push(new a(e[t].x,e[t].y,0));this.setFromPoints(A)}peA_(){const t=this.getAttribute("position").array,i=[];for(let s=0;s<t.length/3-1;s++)i.push(t[s*3],t[s*3+1],t[s*3+2],t[(s+1)*3],t[(s+1)*3+1],t[(s+1)*3+2]);return i}};i=t([_s("geotoolkit3d.scene.ellipse.EllipseGeometry")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJleHRyYWN0U2VnbWVudFBvaW50cyI6InBlQV8ifX19");function tJt(t){return t?.geometry!=null}var iJt=Ci({ne_:"center",meA_:"closest"},2,"eyJDZW50ZXIiOiJuZV8iLCJDbG9zZXN0IjoibWVBXyJ9");let sJt;const eJt=[],AJt=[];for(let t=0;t<8;t++){eJt.push(new a);AJt.push(new a)}const nJt=new a,hJt=new a,rJt=new a;var oJt=Ci(function(){let i=class t extends fUt{constructor(t){super();this.KC_(!1);t=t||{};this.pZ_=new _qt("Missing Label!!!",t.hasOwnProperty("titlestyle")?null:{style:new qa({font:"12px Arial",color:"white"})});this.pZ_.visible=!0;this.add(this.pZ_);this.yeA_=1;this.S4i_=new cUt({data:{positions:[0,0,0,1,1,1]},linestyle:t["linestyle"]||new hl});this.add(this.S4i_);const i=undefined,s={x:[],y:[],z:[],line:!0},e=(new $qt).getAttribute("position");for(let t=0;t<e.count;t++){s["x"].push(e.getX(t));s["y"].push(e.getY(t));s["z"].push(e.getZ(t))}this.DeA_=new cUt({data:s,linestyle:t["linestyle"]||new hl});this.DeA_.scale.set(0,0,0);this.add(this.DeA_);this.d4_=iJt.ne_;this.abt_=null;this.MeA_=50;this.Lc_=new C;this.veA_=new a;this.beA_=null;this.setOptions(t)}beforeRender(t,i,s,e){if(!this.visible)return;super.beforeRender(t,i,s,e);this.abt_==null&&this.NeA_();eJt[0].set(this.Lc_.min.x,this.Lc_.min.y,this.Lc_.min.z);eJt[1].set(this.Lc_.min.x,this.Lc_.min.y,this.Lc_.max.z);eJt[2].set(this.Lc_.min.x,this.Lc_.max.y,this.Lc_.min.z);eJt[3].set(this.Lc_.min.x,this.Lc_.max.y,this.Lc_.max.z);eJt[4].set(this.Lc_.max.x,this.Lc_.min.y,this.Lc_.min.z);eJt[5].set(this.Lc_.max.x,this.Lc_.min.y,this.Lc_.max.z);eJt[6].set(this.Lc_.max.x,this.Lc_.max.y,this.Lc_.min.z);eJt[7].set(this.Lc_.max.x,this.Lc_.max.y,this.Lc_.max.z);let A,n=0;for(A=0;A<AJt.length;A++)fLt.sZe_(eJt[A],i,s.getSize(),AJt[A]);hJt.set(0,0,1).applyEuler(i.rotation);switch(this.pZ_.FE_().vF_()){case Fa.z_:nJt.set(-hJt.y,hJt.x,0);rJt.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(A=0;A<AJt.length;A++)if(rJt.x<AJt[A].x&&rJt.z<AJt[A].z){rJt.x=AJt[A].x;rJt.y=AJt[A].y;n=A}break;case Fa.X_:nJt.set(hJt.y,-hJt.x,0);rJt.set(Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE);for(A=0;A<AJt.length;A++)if(rJt.x>AJt[A].x&&rJt.z<AJt[A].z){rJt.x=AJt[A].x;rJt.y=AJt[A].y;n=A}break}this.pZ_.weA_(nJt.normalize());if(this.yeA_!==1){hJt.subVectors(this.beA_||eJt[n],this.veA_);hJt.setLength(hJt.length()*this.yeA_);hJt.add(this.veA_);this.pZ_.position.copy(hJt)}else this.pZ_.position.copy(this.beA_||eJt[n]);this.pZ_.beforeRender(t,i,s,e);this.DeA_.visible=this.DeA_.scale.x>0&&this.mV_().length>0;if(this.d4_===iJt.meA_&&!this.DeA_.visible){sJt=sJt||new Mt;rJt.copy(this.veA_);this.parent.localToWorld(rJt);hJt.subVectors(rJt,i.position).normalize();sJt.set(i.position,hJt);const t=sJt.intersectObject(this.parent,!0);if(t.length>0){let i=Number.MAX_VALUE;n=0;for(A=0;A<t.length;A++){const s=t[A];if(s.face!=null&&i>s.distance){i=s.distance;n=A}}this.SeA_(this.parent.worldToLocal(t[n].Tgt_));return}}this.SeA_(this.veA_)}E__(t){this.pZ_.a_(t);return this}mV_(){return this.pZ_.SG_()}GeA_(t){this.yeA_=t;return this}ReA_(){return this.yeA_}keA_(t){this.pZ_.g_(t);return this}FeA_(){return this.pZ_.FE_()}rB_(t){this.S4i_.setOptions({linestyle:t});this.DeA_.setOptions({linestyle:t});return this}gt_(){return this.S4i_.material.userData.Jvt_}TZt_(t){this.d4_=t;return this}KZt_(){return this.d4_}xeA_(t){this.abt_=t;this.pZ_.position.copy(t);this.S4i_.position.copy(t);this.DeA_.position.copy(t);this.u0i_();return this}Ye_(){this.abt_==null&&this.NeA_();return this.abt_}tF_(t){this.pZ_.tF_(t);return this}setOptions(t){if(t==null)return this;super.setOptions(t);t.hasOwnProperty("title")&&this.E__(t["title"]);t.hasOwnProperty("titledistancefactor")&&this.GeA_(t["titledistancefactor"]);t.hasOwnProperty("titlestyle")&&this.keA_(t["titlestyle"]);t.hasOwnProperty("linestyle")&&this.rB_(t["linestyle"]);t.hasOwnProperty("mode")&&this.TZt_(t["mode"]);t.hasOwnProperty("anchorpoint")&&this.xeA_(t["anchorpoint"]);t.hasOwnProperty("outline")&&this.tF_(t["outline"]);t.hasOwnProperty("circle")&&this.LeA_(t["circle"]["diameter"],t["circle"]["angle"]);return this}JV_(){return Pi({title:this.mV_(),titledistancefactor:this.ReA_(),titlestyle:this.FeA_(),linestyle:this.gt_(),mode:this.KZt_(),anchorpoint:this.Ye_(),circle:{diameter:new g(this.DeA_.scale.x,this.DeA_.scale.y),angle:this.DeA_.rotation}},super.JV_())}LeA_(t,i){t instanceof a?this.DeA_.scale.copy(t):t instanceof g?this.DeA_.scale.set(t.x,t.y,1):typeof t=="number"&&this.DeA_.scale.set(t,t,1);i instanceof f&&this.DeA_.rotation.copy(i);return this}UeA_(t){this.beA_=t;return this}u0i_(){this.Lc_.min.x=this.abt_.x-this.MeA_-this.DeA_.scale.x;this.Lc_.min.y=this.abt_.y-this.MeA_-this.DeA_.scale.y;this.Lc_.min.z=this.abt_.z-this.MeA_;this.Lc_.max.x=this.abt_.x+this.MeA_+this.DeA_.scale.x;this.Lc_.max.y=this.abt_.y+this.MeA_+this.DeA_.scale.y;this.Lc_.max.z=this.abt_.z+this.MeA_;this.Lc_.getCenter(this.veA_)}SeA_(t){rJt.copy(t);const i=.75;if(this.DeA_.visible){this.DeA_.position.copy(t);hJt.set(0,0,1);hJt.applyEuler(this.DeA_.rotation);const s=Math.asin(hJt.x),e=Math.asin(hJt.y),A=Math.sign(this.pZ_.Nwt_().x-t.x),n=Math.sign(this.pZ_.Nwt_().y-t.y),h=this.DeA_.scale.x*i*.5,r=this.DeA_.scale.y*i*.5;hJt.set(A*h*Math.cos(s),n*r*Math.cos(e),-A*h*Math.sin(s)-n*r*Math.sin(e));rJt.add(hJt);this.pZ_.Nwt_().add(hJt)}this.S4i_.position.copy(rJt);hJt.subVectors(this.pZ_.position,this.pZ_.Nwt_()).multiplyScalar(i);hJt.subVectors(this.pZ_.position,hJt);this.S4i_.scale.copy(rJt.sub(hJt)).negate()}NeA_(){if(this.parent.getBoundingBox)this.Lc_.copy(this.parent.getBoundingBox()).getCenter(this.veA_);else if(tJt(this.parent)){this.parent.geometry.boundingBox==null&&this.parent.geometry.computeBoundingBox();this.Lc_.copy(this.parent.geometry.boundingBox).getCenter(this.veA_)}this.abt_=this.abt_||(new a).copy(this.veA_)}};i=t([_s("geotoolkit3d.scene.AnnotationBase")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRUaXRsZSI6IkVfXyIsImdldFRpdGxlIjoibVZfIiwic2V0VGl0bGVEaXN0YW5jZUZhY3RvciI6IkdlQV8iLCJnZXRUaXRsZURpc3RhbmNlRmFjdG9yIjoiUmVBXyIsInNldFRpdGxlU3R5bGUiOiJrZUFfIiwiZ2V0VGl0bGVTdHlsZSI6IkZlQV8iLCJzZXRMaW5lU3R5bGUiOiJyQl8iLCJnZXRMaW5lU3R5bGUiOiJndF8iLCJzZXRNb2RlIjoiVFp0XyIsImdldE1vZGUiOiJLWnRfIiwic2V0QW5jaG9yUG9pbnQiOiJ4ZUFfIiwiZ2V0QW5jaG9yUG9pbnQiOiJZZV8iLCJzZXRPdXRsaW5lIjoidEZfIiwiZ2V0T3B0aW9ucyI6IkpWXyIsInNldENpcmNsZSI6IkxlQV8ifX19");var lJt=function(){let i=class t extends fUt{constructor(t){super();const i=qi(t,{zaxiscolor:new l(255),yaxiscolor:new l(65280),xaxiscolor:new l(16711680)},!0),s=new a(0,0,0);let e=new a(0,0,1);this.add(new $t(e,s,8,i["zaxiscolor"],2,1));e=new a(0,1,0);this.add(new $t(e,s,8,i["yaxiscolor"],2,1));e=new a(1,0,0);this.add(new $t(e,s,8,i["xaxiscolor"],2,1))}};i=t([_s("geotoolkit3d.scene.compass.CompassAxis")],i);return i}();const uJt=new g,aJt=new g,gJt=new g;var cJt=function(){var i;let s=i=class t{static YeA_(t,s,e){const A=e+1,n=t.length;if(n<=A)return{x:new Float32Array(t),y:new Float32Array(s)};const h=n-2,r=new Float32Array(h);for(let i=0;i<h;i++){uJt.set(t[i],s[i]);aJt.set(t[i+1],s[i+1]);gJt.set(t[i+2],s[i+2]);r[i]=kxt.gje_(uJt,aJt,gJt)}const o=new Uint8Array(h),l=n-A;for(let e=0;e<l;e++){const e=i.TeA_(r,o,h);o[e]=1;i.KeA_(e,r,o,h,t,s)}const u=new Float32Array(A),a=new Float32Array(A);let g=0;u[g]=t[0];a[g]=s[0];g++;for(let i=0;i<h;i++)if(o[i]===0){const e=i+1;u[g]=t[e];a[g]=s[e];g++}u[A-1]=t[n-1];a[A-1]=s[n-1];return{x:u,y:a}}static TeA_(t,i,s){let e=Number.POSITIVE_INFINITY,A=Number.POSITIVE_INFINITY;for(let n=0;n<s;n++)if(i[n]===0&&t[n]<A){e=n;A=t[n]}return e}static KeA_(t,s,e,A,n,h){let r=-1,o=-1;for(let i=t-1;i>=0;i--)if(e[i]===0){r=i;break}for(let i=t+1;i<A;i++)if(e[i]===0){o=i;break}r!==-1&&i.HeA_(r,s,e,A,n,h);o!==-1&&i.HeA_(o,s,e,A,n,h)}static HeA_(t,i,s,e,A,n){const h=t+1;let r=-1,o=-1;for(let i=t-1;i>=0;i--)if(s[i]===0){r=i+1;break}r===-1&&(r=0);for(let i=t+1;i<e;i++)if(s[i]===0){o=i+1;break}o===-1&&(o=e+1);uJt.set(A[r],n[r]);aJt.set(A[h],n[h]);gJt.set(A[o],n[o]);i[t]=kxt.gje_(uJt,aJt,gJt)}static qeA_(t,i,s){const e=s+1,A=t.length;if(A<=e)return{x:new Float32Array(t),y:new Float32Array(i)};const n=new Float32Array(e),h=new Float32Array(e);for(let e=0;e<s;e++){const r=A/s*e,o=Math.floor(r);n[e]=t[o];h[e]=i[o]}n[s]=t[A-1];h[s]=i[A-1];return{x:n,y:h}}};s=i=t([_s("geotoolkit3d.scene.curtain.CurtainDecimationUtil")],s);return s}();var IJt=Ci({rj_:"Fixed",JeA_:"AdjustToIntersection",PeA_:"FitToIntersections"},2,"eyJGaXhlZCI6InJqXyIsIkFkanVzdFRvSW50ZXJzZWN0aW9ucyI6IkplQV8iLCJGaXRUb0ludGVyc2VjdGlvbnMiOiJQZUFfIn0g");const fJt=2048;var CJt=Ci(function(){var i;let s=i=class t extends fUt{constructor(t){super();if(t==null||t["data"]==null||t["data"]["x"]==null||t["data"]["y"]==null){ki("PlaneCurtain constructor options is missing mandatory data.x or data.y parameters.");return}t["zmin"]!=null&&t["zmax"]!=null||ki("PlaneCurtain constructor options is missing mandatory zmin or zmax parameters."+" Default values -100 / 100 will be used instead.");t=qi(t,{shading:!0,fillstyle:"#800000",verticalmode:IJt.JeA_,zmin:-100,zmax:100,resolution:fJt});const i=qi(t["decimation"],{enabled:!0,maxsegments:10}),s=i["enabled"],e=i["maxsegments"];this.VeA_=t["zmin"];this.OeA_=t["zmax"];this.WeA_=t["zmin"];this.zeA_=t["zmax"];this.XeA_=t["shading"];this.jeA_=t["verticalmode"];this.FSt_=t["fillstyle"];this.ZeA_=t["resolution"];this.ZeA_=Math.floor(this.ZeA_/2)*2;this._eA_=!0;this.$eA_=!0;this.tAA_=(new C).makeEmpty();this.iAA_=new Map;if(s){const i=cJt.YeA_(t["data"]["x"],t["data"]["y"],e);this.sAA_=i["x"];this.eAA_=i["y"]}else{this.sAA_=new Float32Array(t["data"]["x"]);this.eAA_=new Float32Array(t["data"]["y"])}this.AAA_=this.sAA_.length-1;this.nAA_=[]}setOptions(t){let i=!1;t.hasOwnProperty("zmin")&&(this.VeA_=t["zmin"]);t.hasOwnProperty("zmax")&&(this.OeA_=t["zmax"]);t.hasOwnProperty("verticalmode")&&(this.jeA_=t["verticalmode"]);this.hAA_();if(t.hasOwnProperty("resolution")&&this.ZeA_!==t["resolution"]){this.ZeA_=t["resolution"];this._eA_=!0}if(t.hasOwnProperty("shading")){this.XeA_=t["shading"];i=!0}if(t.hasOwnProperty("fillstyle")){this.FSt_=t["fillstyle"];i=!0}i&&this.nAA_!=null&&this.rAA_({lights:this.XeA_,overlayoptions:{backgroundfillstyle:this.FSt_}});(this._eA_||i)&&this.invalidateObject();return super.setOptions(t)}JV_(){const t=super.JV_();return qi({shading:this.XeA_,fillstyle:this.FSt_,verticalmode:this.jeA_,zmax:this.OeA_,zmin:this.VeA_,resolution:this.ZeA_},t)}W9e_(t,i){let s;if(this.iAA_.has(t.uuid))s=this.iAA_.get(t.uuid);else{s={obj:t,Bti_:null,oAA_:{}};this.iAA_.set(t.uuid,s)}s.oAA_=qi(i,s.oAA_);this.hAA_();this.$eA_?this.invalidateObject():this.lAA_(t,s.oAA_)}uAA_(t,i){if(!this.aAA_(t))return;if(!this.iAA_.has(t.uuid)){ki("This object has no existing intersection to update yet. Please call PlaneCurtain.generateIntersection first.");return}const s=this.iAA_.get(t.uuid);s.oAA_=qi(i,s.oAA_);if(this.$eA_)this.invalidateObject();else{const s=fHt.IO_();this.nAA_.forEach((e=>{s.f7e_(e,t,i)}))}}c7e_(t){this.gAA_(t,!0);this.hAA_();this.invalidateObject()}gAA_(t,i){i&&this.iAA_.delete(t.uuid);if(this.nAA_==null||this.Df_())return;const s=fHt.IO_();this.nAA_.forEach((i=>{s.c7e_(i,t)}))}cAA_(){this.tAA_.makeEmpty();this.iAA_.forEach((t=>{t.Bti_=fLt.Oje_(t.obj);this.tAA_=this.tAA_.union(t.Bti_)}));if(this.IAA_!=null){this.tAA_.min.divide(this.IAA_);this.tAA_.max.divide(this.IAA_)}}hAA_(){this.cAA_();const t=this.WeA_,i=this.zeA_;switch(this.jeA_){case IJt.rj_:this.WeA_=this.VeA_;this.zeA_=this.OeA_;break;default:case IJt.JeA_:this.WeA_=Math.min(this.VeA_,this.tAA_.min.z);this.zeA_=Math.max(this.OeA_,this.tAA_.max.z);break;case IJt.PeA_:this.WeA_=this.tAA_.min.z;this.zeA_=this.tAA_.max.z;break}if(!Number.isFinite(this.tAA_.min.z)||!Number.isFinite(this.tAA_.max.z)){this.WeA_=this.VeA_;this.zeA_=this.OeA_}t===this.WeA_&&i===this.zeA_||(this._eA_=!0)}fAA_(){this.CAA_(!1);this.dAA_();const t=new a,s=new a,e=new a,A=this.sAA_,n=this.eAA_,h=this.WeA_,r=this.zeA_,o=this.IAA_.z*2/(this.IAA_.x+this.IAA_.y),l=this.ZeA_,u=l/(o*(r-h));for(let i=0;i<this.AAA_;i++){t.set(A[i],n[i],r);s.set(A[i+1],n[i+1],r);e.set(A[i],n[i],h);const o=undefined;let a=t.distanceTo(s)*u;a=Math.ceil(a/2)*2;a>this.ZeA_&&(a=this.ZeA_);const g=new nHt({overlayoptions:{height:l,width:a,backgroundfillstyle:this.FSt_},createfrompoints:{a:t,b:s,c:e},lights:this.XeA_});this.nAA_.push(g);this.add(g)}i.BAA_(this.nAA_)}rAA_(t){this.nAA_.forEach((i=>{i.setOptions(t)}))}aAA_(t){if(this.nAA_==null||this.Df_())return!1;if(t.Df_()){this.c7e_(t);return!1}return!0}beforeRender(t,i,s,e){super.beforeRender(t,i,s,e);if(this._eA_||this.$eA_){this.IAA_=s.JV_()["scale"];this.hAA_();this.fAA_();this.iAA_.forEach((t=>{this.lAA_(t.obj,t.oAA_)}));this._eA_=!1}return this}afterRender(t,i,s,e){super.afterRender(t,i,s,e);this.$eA_=!1;return this}lAA_(t,i){if(!this.aAA_(t))return;const s=fHt.IO_();this.nAA_.forEach((e=>{s.W9e_(e,t,i)}))}dAA_(){if(this.nAA_!=null&&this.nAA_.length>0)for(let t=0;t<this.nAA_.length;t++){const i=this.nAA_[t];this.remove(i);i.dispose()}this.nAA_=[]}static BAA_(t){if(t.length<2)return;const i=new a,s=new a,e=new a;for(let A=0;A<t.length-1;A++){const n=t[A].a9e_()["geometry"].getAttribute("normal"),h=t[A+1].a9e_()["geometry"].getAttribute("normal");i.set(n.getX(1),n.getY(1),n.getZ(1));s.set(h.getX(0),h.getY(0),h.getZ(0));e.addVectors(i,s).divideScalar(2);n.setXYZ(1,e.x,e.y,e.z);h.setXYZ(0,e.x,e.y,e.z);i.set(n.getX(3),n.getY(3),n.getZ(3));s.set(h.getX(2),h.getY(2),h.getZ(2));e.addVectors(i,s).divideScalar(2);n.setXYZ(3,e.x,e.y,e.z);h.setXYZ(2,e.x,e.y,e.z)}}CAA_(t){this.iAA_.forEach((i=>{this.gAA_(i.obj,t)}))}dispose(){if(!this.Df_()){this.CAA_(!0);this.dAA_();super.dispose();this.nAA_=null;this.sAA_=null;this.eAA_=null;this.children=[];this.iAA_=null}}};s=i=t([_s("geotoolkit3d.scene.curtain.PlaneCurtain")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiZ2VuZXJhdGVJbnRlcnNlY3Rpb24iOiJXOWVfIiwic2V0SW50ZXJzZWN0aW9uUHJvcGVydGllcyI6InVBQV8iLCJyZW1vdmVJbnRlcnNlY3Rpb24iOiJjN2VfIn19fSAg");var dJt=function(){let i=class t extends cUt{constructor(t){super(t);if(t["geometry"]!=null){this.geometry.dispose();this.geometry=t["geometry"]}if(t["material"]!=null){this.material.dispose();this.material=t["material"]}}};i=t([_s("geotoolkit3d.scene.CustomLineSegments")],i);return i}();var BJt=function(){let i=class t extends ti{constructor(){const t=new _t,i=yu.tS_(0,0,1,1);let s=i[0];t.moveTo(s.xN_(),s.LN_());for(let e=0;e<i.length;++e){s=i[e];t.bezierCurveTo(s.UN_(),s.YN_(),s.TN_(),s.KN_(),s.HN_(),s.qN_())}super(t)}};i=t([_s("geotoolkit3d.scene.ellipse.FilledEllipseGeometry")],i);return i}();var wJt=function(){var t=class{static wAA_(t,i){t.x=i.x!==0?i.x:t.x;t.y=i.y!==0?i.y:t.y;t.z=i.z!==0?i.z:t.z}};t.QAA_=new a(.5,.5,.5);t.EAA_={x:{start:new a(-1,-1,-1),end:new a(-1,1,1)},y:{start:new a(-1,-1,-1),end:new a(1,-1,1)},z:{start:new a(-1,-1,-1),end:new a(1,1,-1)}};t.Plane={right:{normal:new a(-1,0,0),axis:{y:"y",z:"z"}},left:{normal:new a(1,0,0),axis:{y:"y",z:"z"}},top:{normal:new a(0,0,-1),axis:{x:"x",y:"y"}},bottom:{normal:new a(0,0,1),axis:{x:"x",y:"y"}},front:{normal:new a(0,1,0),axis:{x:"x",z:"z"}},back:{normal:new a(0,-1,0),axis:{x:"x",z:"z"}}};return t}(),QJt={x:"x",y:"y",z:"z"};var EJt=function(){let i=class t extends z{constructor(t){super();this.Fwt_=t["axis"];const i=t["counts"],s=t["normal"],e=wJt.EAA_[this.Fwt_]["start"].clone(),A=wJt.EAA_[this.Fwt_]["end"].clone(),n=s.clone().negate();wJt.wAA_(e,n);wJt.wAA_(A,n);const h=(new a).multiplyVectors(wJt.QAA_,e),r=(new a).multiplyVectors(wJt.QAA_,A),o=t["isaxis"]?0:1;h[this.Fwt_]+=o/(i[this.Fwt_]-1);r[this.Fwt_]+=o/(i[this.Fwt_]-1);const l=[];for(let t=o;t<i[this.Fwt_]-o;t+=1){l.push(h.clone());l.push(r.clone());h[this.Fwt_]+=1/(i[this.Fwt_]-1);r[this.Fwt_]+=1/(i[this.Fwt_]-1)}if(l.length===0){l.push(h.clone());l.push(h.clone())}this.setFromPoints(l)}_1t_(){return this.Fwt_}};i=t([_s("geotoolkit3d.scene.grid.GridAxisGeometry")],i);return i}();var pJt=function(){let i=class t extends fUt{constructor(t){super();this.KC_(!1);this.Kis_=qi(t,{});this.Fwt_=this.Kis_["axis"];this.pAA_(this.Kis_);this.name="GRIDTEXTS"}pAA_(t){const i=t["axis"],s=t["textstyles"][i],e=t["start"],A=t["end"],n=t["formatters"][i],h=t["labeldistance"]||3,r=wJt.EAA_[i]["start"].clone(),o=wJt.EAA_[i]["end"].clone(),l=A[i]-e[i],u=t["counts"][i],c=(A[i]-e[i])/(u-1),I=t["plane"].normal.clone().negate();wJt.wAA_(r,I);wJt.wAA_(o,I);const f=(new a).multiplyVectors(wJt.QAA_,r),C=(new a).multiplyVectors(wJt.QAA_,o),d=f.clone(),B=C.clone(),w=[],Q=[],E=[];this.mAA_=[];this.yAA_=[];this.DAA_=[];let p=0;for(let t=0;t<u;t+=1){const s=t*c,A=n(e[i]+s,l)+"";p=Math.max(p,A.length);E.push(A)}for(let e=0;e<u;e+=1){const A=e===0||e+1>=u;let n=1/(u-1);u-e<2&&(n*=u-e-1);const r=this.MAA_(i,sFt.start,E[e],s,d,n,t["outlines"][i]),o=this.MAA_(i,sFt.end,E[e],s,B,n,t["outlines"][i]),l=h*Math.pow(p/E[e].length,1.2);r.QeA_(new g(l,h));o.QeA_(new g(l,h));w.push(r);Q.push(o);A?this.yAA_.push(r,o):this.DAA_.push(r,o)}this.vAA_(t,w,f,C);this.bAA_(w);this.bAA_(Q)}vAA_(t,i,s,e){const A=t["axis"],n=t["title"]["texts"][A];if(n.length===0)return;const h=t["title"]["textstyles"][A],r=t["title"]["distance"],o=i.length/2;let l=new a(1,1,1);if(Math.floor(o)!==Math.ceil(o)){const t=i[Math.floor(o)],s=i[Math.ceil(o)];if(t!=null&&s!=null){l=t.scale.clone();l.add(s.scale.clone())}l.multiplyScalar(1.5*r)}else{let t=-1,s=Number.NEGATIVE_INFINITY;for(let e=0;e<i.length;e++){const A=i[e].scale.lengthSq();if(A>s){t=e;s=A}}const e=i[t];e!=null&&(l=e.scale.clone());l.multiplyScalar(2*r)}const u=s.clone();u[A]=0;const c=this.MAA_(A,sFt.start,n,h,u,Number.NaN,t["title"]["outlines"][A]);c.QeA_(new g(l.x,l.y));this.add(c);const I=e.clone();I[A]=0;const f=this.MAA_(A,sFt.end,n,h,I,Number.NaN,t["title"]["outlines"][A]);f.QeA_(new g(l.x,l.y));this.add(f);this.mAA_.push(c,f)}bAA_(t){if(t.length>=2){this.add(t[0]);this.add(t[t.length-1]);t.splice(0,1);t.splice(t.length-1,1)}if(t.length%2!=0){this.add(t[Math.floor(t.length/2)]);t.splice(Math.floor(t.length/2),1)}for(let i=0;i<t.length/2;i++){this.add(t[i]);this.add(t[t.length-1-i])}}NAA_(t,i,s){this.I_e_(s);if(this.f_e_())for(let e=0;e<this.children.length;e++)if(t!=null&&this.children[e].userData.anchor!==t||i==null)this.children[e].visible=!1;else{this.children[e].visible=s;this.children[e].weA_(i)}}SAA_(t,i,s,e){if(!this.visible)return null;for(let A=0;A<this.children.length;A++)this.children[A].beforeRender(t,i,s,e,!0);return{titles:this.mAA_,extremities:this.yAA_,marks:this.DAA_}}MAA_(t,i,s,e,A,n,h){const r=new _qt(s,{style:e,dontmanuallyupdate:!0,outline:h});r.position.copy(A);r.userData.anchor=i;r.visible=!1;isNaN(n)||(A[t]+=n);return r}_1t_(){return this.Kis_["axis"]}FE_(){return this.Kis_["textstyles"][this.Fwt_]}DF_(){return this.Kis_["outlines"][this.Fwt_]}mV_(){return this.Kis_["title"]["texts"][this.Fwt_]}ReA_(){return this.Kis_["title"]["distance"]}v__(){return this.Kis_["title"]["textstyles"][this.Fwt_]}GAA_(){return this.Kis_["title"]["outlines"][this.Fwt_]}i7i_(){return this.Kis_["formatters"][this.Fwt_]}hc_(){return this.Kis_["start"]}nc_(){return this.Kis_["end"]}RAA_(){return this.Kis_["counts"]}};i=t([_s("geotoolkit3d.scene.grid.GridAxisTexts")],i);return i}();const mJt=new l(16777215);var yJt=Ci(function(){let i=class t extends RYt{constructor(t){const i=undefined;super(qi(t,{vertexShader:ixt.OXe_,fragmentShader:ixt.WXe_,uniforms:N.clone(S["basic"].uniforms)}));const s=qi(t,{aoMapIntensity:1,color:mJt,wireframe:!1,wireframeLinecap:"round",wireframeLinejoin:"round"});this["isMeshBasicMaterial"]=!0;this.type="MeshColorMapBasicMaterial";this.kAA_(s)}kAA_(t){t.hasOwnProperty("alphaMap")&&(this.alphaMap=t["alphaMap"]);t.hasOwnProperty("aoMap")&&(this.aoMap=t["aoMap"]);t.hasOwnProperty("aoMapIntensity")&&(this.aoMapIntensity=t["aoMapIntensity"]);t.hasOwnProperty("map")&&(this.map=t["map"]);t.hasOwnProperty("wireframe")&&(this.wireframe=t["wireframe"]);t.hasOwnProperty("wireframeLinecap")&&(this.wireframeLinecap=t["wireframeLinecap"]);t.hasOwnProperty("wireframeLinejoin")&&(this.wireframeLinejoin=t["wireframeLinejoin"])}setOptions(t){super.setOptions(t);this.kAA_(t);return this}JV_(){return qi({alphaMap:this.alphaMap,aoMap:this.aoMap,aoMapIntensity:this.aoMapIntensity,map:this.map,wireframe:this.wireframe,wireframeLinecap:this.wireframeLinecap,wireframeLinejoin:this.wireframeLinejoin},super.JV_())}dispose(){super.dispose();this.map=null;this.alphaMap=null;this.aoMap=null}};i=t([_s("geotoolkit3d.scene.MeshColorMapBasicMaterial")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");$Lt.yZe_(yJt.D_(),yLt);const DJt="GRIDLINE",MJt="AXISLINE",vJt=new a(2,2,2),bJt=1.0018;var NJt=function(){let i=class t extends fUt{constructor(t){super();this.KC_(!1);this.FAA_=[];this.xAA_(t)}setOptions(t){super.setOptions(t);this.xAA_(t);return this}hc_(){let t=null;this.traverse((i=>{i instanceof pJt&&(t=i.hc_())}));return t}RAA_(){let t=null;this.traverse((i=>{i instanceof pJt&&(t=i.RAA_())}));return t}LAA_(){const t={};this.traverse((i=>{i instanceof cUt&&i.name===DJt&&(t[i.userData["axis"]]=i.userData["linestyle"])}));return t}UAA_(){const t={};this.traverse((i=>{i instanceof cUt&&i.name===MJt&&(t[i.userData["axis"]]=i.userData["linestyle"])}));return t}Oys_(){const t={};this.traverse((i=>{i instanceof pJt&&(t[i._1t_()]=i.FE_())}));return t}YAA_(){const t={};this.traverse((i=>{i instanceof pJt&&(t[i._1t_()]=i.DF_())}));return t}cIs_(){const t={};this.traverse((i=>{i instanceof pJt&&(t[i._1t_()]=i.mV_())}));return t}ReA_(){let t;this.traverse((i=>{i instanceof pJt&&(t=i.ReA_())}));return t}TAA_(){const t={};this.traverse((i=>{i instanceof pJt&&(t[i._1t_()]=i.v__())}));return t}KAA_(){const t={};this.traverse((i=>{i instanceof pJt&&(t[i._1t_()]=i.GAA_())}));return t}HAA_(){const t={};this.traverse((i=>{i instanceof pJt&&(t[i._1t_()]=i.i7i_())}));return t}KZt_(){return this.qAA_}nc_(){let t=null;this.traverse((i=>{i instanceof pJt&&(t=i.nc_())}));return t}NAA_(t,i,s,e){for(let A=0;A<this.children.length;A++){if(!(this.children[A]instanceof pJt))continue;const n=this.children[A];t!=null&&n._1t_()!==t||n.NAA_(i,s,e)}}n5t_(t,i){const s=this.qAA_(this,t,i);for(let t=0;t<this.children.length;t++)this.children[t]instanceof pJt||(this.children[t].visible=s)}JAA_(t,i,s,e){const A=[],n=[],h=[];for(let r=0;r<this.children.length;r++)if(this.children[r]instanceof pJt){const o=this.children[r].SAA_(t,i,s,e);if(o==null)continue;for(let t=0;t<o["titles"].length;t++)A.push(o["titles"][t]);for(let t=0;t<o["extremities"].length;t++)n.push(o["extremities"][t]);for(let t=0;t<o["marks"].length;t++)h.push(o["marks"][t])}return{titles:A,extremities:n,marks:h}}dispose(){super.dispose();for(let t=0;t<this.children.length;t++)this.children[t]&&fLt.dispose(this.children[t])}xAA_(t){this.Z$e_=t["plane"];this.qAA_=t["mode"];const i=wJt.Plane[this.Z$e_],s=t["counts"],e=t["axis"]["linestyles"],A=t["grid"]["linestyles"],n=Object.keys(i.axis),h=t["opacity"]>0;let r;for(r=0;r<this.FAA_.length;r++)if(this.FAA_[r]){this.remove(this.FAA_[r]);fLt.dispose(this.FAA_[r])}this.FAA_=[];for(r=0;r<n.length;r++){this.FAA_.push(this.PAA_(n[r],vJt,i,e[n[r]],MJt,h));this.FAA_.push(this.PAA_(n[r],s,i,A[n[r]],DJt,h));this.FAA_.push(this.VAA_(n[r],i,t,s))}h&&this.FAA_.push(this.OAA_(i,t["color"],t["opacity"]));for(r=0;r<this.FAA_.length;r++)this.add(this.FAA_[r]);this.name="GRIDPLANE";this.userData.plane=this.Z$e_}VAA_(t,i,s,e){return new pJt({axis:t,plane:i,start:s["start"],end:s["end"],counts:e,textstyles:s["axis"]["textstyles"],formatters:s["axis"]["formatters"],title:s["title"],labeldistance:s["axis"]["distance"],outlines:s["axis"]["outlines"]})}PAA_(t,i,s,e,A,n){const h=new EJt({axis:t,counts:i,normal:s.normal,isaxis:A===MJt}),r=RA.cs_(e.getColor());let o=e.$w_();Array.isArray(o)&&!o.length&&(o=null);const u=new cUt({data:{positions:h.getAttribute("position").array},linewidth:e.Ie_(),color:new l(r.Is_()/255,r.Cs_()/255,r.fs_()/255),opacity:r.ds_()/255,dashscale:250,dashsize:o?o[0]:1,gapsize:o?o[1]:1,dashed:!!o,polygonoffset:n,polygonoffsetfactor:.75});u.userData["axis"]=t;u.userData["linestyle"]=e;u.name=A;u.computeLineDistances();u.raycast=()=>{};return u}OAA_(t,i,s){i instanceof l||(i=new l(i));const e=t["axis"],A=new W(new bt,new yJt({color:i,opacity:s,transparent:s<1}));A.scale.set(bJt,bJt,1);e["x"]&&e["z"]?A.rotation.set(Math.PI*.5,0,0):e["y"]&&e["z"]&&A.rotation.set(0,Math.PI*.5,0);A.position.copy(t["normal"]).multiplyScalar(-.5*bJt);return A}};i=t([_s("geotoolkit3d.scene.grid.GridPlane")],i);return i}();const SJt=new g;var GJt=Ci(function(){var i;let s=i=class t{constructor(){this._x0=0;this._y0=0;this._x1=0;this._y1=0;this._x2=0;this._y2=0;this._x3=0;this._y3=0;this._z0=0}validate(t){if(this._x0==null){const t=kxt.Eje_(this._x1,this._y1,this._x2,this._y2,this._x3,this._y3);if(t==null)throw new Error("Given XY values do not belong to a rectangle");this._x0=t.x;this._y0=t.y}else if(this._x1==null){const t=kxt.Eje_(this._x0,this._y0,this._x2,this._y2,this._x3,this._y3);if(t==null)throw new Error("Given XY values do not belong to a rectangle");this._x1=t.x;this._y1=t.y}else if(this._x2==null){const t=kxt.Eje_(this._x1,this._y1,this._x0,this._y0,this._x3,this._y3);if(t==null)throw new Error("Given XY values do not belong to a rectangle");this._x2=t.x;this._y2=t.y}else if(this._x3==null){const t=kxt.Eje_(this._x1,this._y1,this._x2,this._y2,this._x0,this._y0);if(t==null)throw new Error("Given XY values do not belong to a rectangle");this._x3=t.x;this._y3=t.y}this._z0==null&&(this._z0=0)}WAA_(t){this._x0=t["x0"];this._y0=t["y0"];this._x1=t["x1"];this._y1=t["y1"];this._x2=t["x2"];this._y2=t["y2"];this._x3=t["x3"];this._y3=t["y3"];this._z0=t["z0"]!=null?t["z0"]:0;this._z1=t["z1"]!=null?t["z1"]:this._z0;this.validate();return this}zAA_(t){this._x0=t["p0"]!=null?t["p0"].x:null;this._y0=t["p0"]!=null?t["p0"].y:null;this._x1=t["p1"]!=null?t["p1"].x:null;this._y1=t["p1"]!=null?t["p1"].y:null;this._x2=t["p2"]!=null?t["p2"].x:null;this._y2=t["p2"]!=null?t["p2"].y:null;this._x3=t["p3"]!=null?t["p3"].x:null;this._y3=t["p3"]!=null?t["p3"].y:null;this._z0=t["z0"]!=null?t["z0"]:0;this._z1=t["z1"]!=null?t["z1"]:this._z0;this.validate();return this}XAA_(){return new C(new a(Math.min(Math.min(this._x0,this._x1),Math.min(this._x2,this._x3)),Math.min(Math.min(this._y0,this._y1),Math.min(this._y2,this._y3)),this._z0),new a(Math.max(Math.max(this._x0,this._x1),Math.max(this._x2,this._x3)),Math.max(Math.max(this._y0,this._y1),Math.max(this._y2,this._y3)),this._z1))}jAA_(){return new C(new a(Math.min(Math.min(this._x0,this._x1),Math.min(this._x2,this._x3)),Math.min(Math.min(this._y0,this._y1),Math.min(this._y2,this._y3)),-this._z1),new a(Math.max(Math.max(this._x0,this._x1),Math.max(this._x2,this._x3)),Math.max(Math.max(this._y0,this._y1),Math.max(this._y2,this._y3)),-this._z0))}static ZAA_(t,i,s){SJt.subVectors(s,t);const e=undefined;return i.dot(SJt)<0}static getNormal(t,i,s){SJt.subVectors(i,t);const e=s.clone();e.x=-s.y;e.y=s.x;if(e.dot(SJt)<0){e.x=-e.x;e.y=-e.y}return e}_AA_(t){const s=Math.min(this._z0,this._z1),e=Math.max(this._z0,this._z1),A=new g(t.x,t.y);if(t.z<s||t.z>e)return!1;if(this.qz_==null){this.qz_=new g(0,0);this.qz_.x=(this._x0+this._x1+this._x2+this._x3)/4;this.qz_.y=(this._y0+this._y1+this._y2+this._y3)/4}let n;if(this.$AA_==null){n=new g(this._x1-this._x0,this._y1-this._y0);this.tnA_=new g(this._x0,this._y0);this.$AA_=i.getNormal(this.tnA_,this.qz_,n)}if(this.inA_==null){n=new g(this._x2-this._x1,this._y2-this._y1);this.ggt_=new g(this._x1,this._y1);this.inA_=i.getNormal(this.ggt_,this.qz_,n)}if(this.snA_==null){n=new g(this._x3-this._x2,this._y3-this._y2);this.cgt_=new g(this._x2,this._y2);this.snA_=i.getNormal(this.cgt_,this.qz_,n)}if(this.enA_==null){n=new g(this._x3-this._x0,this._y3-this._y0);this.enA_=i.getNormal(this.tnA_,this.qz_,n)}return!i.ZAA_(this.tnA_,this.$AA_,A)&&(!i.ZAA_(this.ggt_,this.inA_,A)&&(!i.ZAA_(this.cgt_,this.snA_,A)&&!i.ZAA_(this.tnA_,this.enA_,A)))}AnA_(){return-this._z0}nnA_(){return-this._z1}hnA_(t){return(t||new a).set(this._x0,this._y0,this._z0)}Ike_(){return new a(this._x1,this._y1,this._z0)}fke_(){return new a(this._x2,this._y2,this._z0)}rnA_(){return new a(this._x3,this._y3,this._z0)}};s=i=t([_s("geotoolkit3d.transformation.XYCoordinates")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJmcm9tSlNPTlhZIjoiV0FBXyIsImZyb21KU09OUG9pbnRzIjoiekFBXyIsImFzQm94MyI6IlhBQV8iLCJhc0VsZXZhdGlvbkJveDMiOiJqQUFfIiwiaXNQb2ludEluc2lkZSI6Il9BQV8ifX0sImdldENsYXNzTmFtZSI6IkRfIn0g");var RJt=function(){let i=class t{constructor(t,i){this.onA_=t;this.lnA_=i}unA_(t){const i=this.onA_.AnA_(),s=this.onA_.nnA_(),e=this.lnA_.AnA_(),A=this.lnA_.nnA_(),n=[new a(this.onA_.hnA_().x,this.onA_.hnA_().y,i),new a(this.onA_.Ike_().x,this.onA_.Ike_().y,i),new a(this.onA_.fke_().x,this.onA_.fke_().y,s),new a(this.onA_.rnA_().x,this.onA_.rnA_().y,i)],h=[new a(this.lnA_.hnA_().x,this.lnA_.hnA_().y,e),new a(this.lnA_.Ike_().x,this.lnA_.Ike_().y,e),new a(this.lnA_.fke_().x,this.lnA_.fke_().y,A),new a(this.lnA_.rnA_().x,this.lnA_.rnA_().y,e)];t.updateMatrix();t.applyMatrix4(kxt.vje_(n,h))}};i=t([_s("geotoolkit3d.transformation.XYToXY")],i);return i}();const kJt=new a,FJt=new a,xJt=new a;var LJt=Ci(function(){var t;return class{static box(){return!0}static anA_(t,i,s){t.worldToLocal(kJt.copy(s.position));FJt.copy(wJt.Plane[t.userData.plane].normal);xJt.copy(wJt.QAA_).multiply(FJt.negate());FJt.copy(wJt.Plane[t.userData.plane].normal);return FJt.dot(kJt)>=FJt.dot(xJt)}static back(t,i,s){t.worldToLocal(kJt.copy(s.position));const e=wJt.Plane[t.userData.plane].normal.dot(kJt);return t.userData.plane==="bottom"||t.userData.plane==="left"?e>=-.01:e>.01}}}(),2,"eyJvcGVuYm94IjoiYW5BXyJ9");const UJt={x:new hl("white",1.5),y:new hl("white",1.5),z:new hl("white",1.5),clone:()=>({x:UJt["x"],y:UJt["y"],z:UJt["z"]})},YJt={x:new hl("grey",2),y:new hl("grey",2),z:new hl("grey",2),clone:()=>({x:YJt["x"],y:YJt["y"],z:YJt["z"]})},TJt={x:new qa({color:"white",font:"11px Arial"}),y:new qa({color:"white",font:"11px Arial"}),z:new qa({color:"white",font:"11px Arial"}),clone:()=>({x:TJt["x"],y:TJt["y"],z:TJt["z"]})},KJt={x:null,y:null,z:null,clone:()=>({x:KJt["x"],y:KJt["y"],z:KJt["z"]})},HJt={x:new qa({color:"white",font:"13px Arial"}),y:new qa({color:"white",font:"13px Arial"}),z:new qa({color:"white",font:"13px Arial"}),clone:()=>({x:HJt["x"],y:HJt["y"],z:HJt["z"]})},qJt={x:null,y:null,z:null,clone:()=>({x:qJt["x"],y:qJt["y"],z:qJt["z"]})},JJt=(t,i)=>{let s=0;(i=Math.abs(i))<5&&(s=1);i<1&&(s=2);i<.5&&(s=3);return t.toFixed(s)},PJt={x:JJt,y:JJt,z:JJt,clone:()=>({x:PJt["x"],y:PJt["y"],z:PJt["z"]})},VJt={x:"X",y:"Y",z:"Z",clone:()=>({x:VJt["x"],y:VJt["y"],z:VJt["z"]})},OJt=new a(0,-1,-1),WJt=new a(1,0,-1),zJt=new a(-1,0,-1),XJt=new a(-1,0,1),jJt=new a(-1,-1,0),ZJt=new a(1,-1,0),_Jt=new a(0,-1,1),$Jt=new a(1,0,1),tPt=new a(-1,1,0),iPt=new a(0,1,-1),sPt=new a(0,1,1),ePt=new a(1,1,0);var APt=Ci(function(){let i=class t extends fUt{constructor(t){super();this.KC_(!1);t["axis"]==null&&(t["axis"]={});t["grid"]==null&&(t["grid"]={});t["title"]==null&&(t["title"]={});t["axis"]=qi(t["axis"],{textstyles:TJt,linestyles:UJt,formatters:PJt,outlines:KJt});t["title"]=qi(t["title"],{textstyles:HJt,texts:VJt,outlines:KJt});t["grid"]=qi(t["grid"],{linestyles:YJt});t["grid"]["linestyles"]=qi(t["grid"]["linestyles"],YJt["clone"]());t["axis"]["linestyles"]=qi(t["axis"]["linestyles"],UJt["clone"]());t["axis"]["textstyles"]=qi(t["axis"]["textstyles"],TJt["clone"]());t["axis"]["formatters"]=qi(t["axis"]["formatters"],PJt["clone"]());t["axis"]["distance"]=t["axis"]["distance"]||2;t["title"]["texts"]=qi(t["title"]["texts"],VJt["clone"]());t["title"]["textstyles"]=qi(t["title"]["textstyles"],HJt["clone"]());t["title"]["distance"]=t["title"]["distance"]||1;const i=qi(t,{start:new a(-1,-1,-1),end:new a(1,1,1),counts:new a(5,5,5),modelstart:t["start"]?t["start"]:new a(-1,-1,-1),modelend:t["end"]?t["end"]:new a(1,1,1),mode:LJt.back,planecolor:"transparent",planeopacity:0},!0);this.nAA_={};this.setOptions(i);this.name="GRID"}zje_(){return new C(new a(-.5,-.5,-.5),new a(.5,.5,.5)).applyMatrix4(this.matrixWorld)}setOptions(t){if(t==null)return this;super.setOptions(t);this.position.set(0,0,0);this.rotation.set(0,0,0);this.scale.set(1,1,1);this.updateMatrix();t["axis"]==null&&(t["axis"]={});t["grid"]==null&&(t["grid"]={});t["title"]==null&&(t["title"]={});t["axis"]=qi(t["axis"],{textstyles:this.Oys_(),linestyles:this.UAA_(),formatters:this.HAA_(),outlines:this.YAA_()});t["title"]=qi(t["title"],{textstyles:this.TAA_(),texts:this.cIs_(),distance:this.ReA_(),outlines:this.KAA_()});t["grid"]=qi(t["grid"],{linestyles:this.LAA_()});t["grid"]["linestyles"]=qi(t["grid"]["linestyles"],this.LAA_());t["axis"]["linestyles"]=qi(t["axis"]["linestyles"],this.UAA_());t["axis"]["textstyles"]=qi(t["axis"]["textstyles"],this.Oys_());t["axis"]["formatters"]=qi(t["axis"]["formatters"],this.HAA_());t.hasOwnProperty("planecolor")&&(this.gnA_=t["planecolor"]);t.hasOwnProperty("planeopacity")&&(this.cnA_=t["planeopacity"]);const i=qi(t,{start:this.hc_(),end:this.nc_(),counts:this.RAA_(),modelstart:this.InA_(),modelend:this.fnA_(),mode:this.KZt_(),planecolor:this.gnA_,planeopacity:this.cnA_}),s=i["start"],e=i["end"],A=i["counts"],n=Object.keys(wJt.Plane);for(let t=0;t<n.length;t++){const s={plane:n[t],start:i["modelstart"],end:i["modelend"],counts:A,axis:i["axis"],title:i["title"],grid:i["grid"],mode:i["mode"],color:i["planecolor"],opacity:i["planeopacity"]};if(this.nAA_[n[t]]==null){const i=new NJt(s);this.nAA_[n[t]]=i;this.add(i)}else this.nAA_[n[t]].setOptions(s)}const h=new GJt;h.zAA_({p0:new g(-wJt.QAA_.x,-wJt.QAA_.y),p1:new g(wJt.QAA_.x,-wJt.QAA_.y),p2:new g(wJt.QAA_.x,wJt.QAA_.y),z0:-wJt.QAA_.z,z1:wJt.QAA_.z});const r=new GJt;r.zAA_({p0:new g(s.x,s.y),p1:new g(e.x,s.y),p3:new g(s.x,e.y),z0:-Math.max(s.z,e.z),z1:-Math.min(s.z,e.z)});const o=undefined;new RJt(h,r).unA_(this);this.ib_=s;this.sb_=e;this.invalidateObject(new iUt({source:this,type:tUt.IWt_,args:[]}));return this}JV_(){return Pi({axis:{textstyles:this.Oys_(),formatters:this.HAA_(),linestyles:this.UAA_(),outlines:this.YAA_()},grid:{linestyles:this.LAA_()},title:{textstyles:this.TAA_(),texts:this.cIs_(),distance:this.ReA_(),outlines:this.KAA_()},start:this.hc_(),end:this.nc_(),counts:this.RAA_(),modelstart:this.InA_(),modelend:this.fnA_(),mode:this.KZt_(),planecolor:this.gnA_,planeopacity:this.cnA_},super.JV_())}LAA_(){return this.nAA_["right"]?qi(this.nAA_["right"].LAA_(),this.nAA_["top"].LAA_()):{}}UAA_(){return this.nAA_["right"]?qi(this.nAA_["right"].UAA_(),this.nAA_["top"].UAA_()):{}}Oys_(){return this.nAA_["right"]?qi(this.nAA_["right"].Oys_(),this.nAA_["top"].Oys_()):{}}YAA_(){return this.nAA_["right"]?qi(this.nAA_["right"].YAA_(),this.nAA_["top"].YAA_()):{}}HAA_(){return this.nAA_["right"]?qi(this.nAA_["right"].HAA_(),this.nAA_["top"].HAA_()):{}}cIs_(){return this.nAA_["right"]?qi(this.nAA_["right"].cIs_(),this.nAA_["top"].cIs_()):{}}ReA_(){return this.nAA_["right"]?this.nAA_["right"].ReA_():0}TAA_(){return this.nAA_["right"]?qi(this.nAA_["right"].TAA_(),this.nAA_["top"].TAA_()):{}}KAA_(){return this.nAA_["right"]?qi(this.nAA_["right"].KAA_(),this.nAA_["top"].KAA_()):{}}hc_(){return this.ib_}nc_(){return this.sb_}KZt_(){const t=Object.keys(wJt.Plane)[0];return this.nAA_[t]?this.nAA_[t].KZt_():null}RAA_(){const t=Object.keys(wJt.Plane)[0];return this.nAA_[t]?this.nAA_[t].RAA_():null}InA_(){const t=Object.keys(wJt.Plane)[0];return this.nAA_[t]?this.nAA_[t].hc_():null}fnA_(){const t=Object.keys(wJt.Plane)[0];return this.nAA_[t]?this.nAA_[t].nc_():null}CnA_(){return this.nAA_}dnA_(t){t.BnA_(this)}beforeRender(t,i,s,e){super.beforeRender(t,i,s,e);if(!this.visible)return this;this.worldToLocal(kJt.copy(i.position));let n;for(n=0;n<this.children.length;n++)this.children[n]instanceof NJt&&this.children[n].n5t_(t,i);const h=this.KZt_(),r=h(this.nAA_["bottom"],t,i),o=h(this.nAA_["back"],t,i),l=h(this.nAA_["left"],t,i),u=h(this.nAA_["right"],t,i);this.nAA_["top"].NAA_(null,null,null,!1);this.nAA_["bottom"].NAA_(null,null,null,!1);this.nAA_["front"].NAA_(null,null,null,!1);this.nAA_["back"].NAA_(null,null,null,!1);this.nAA_["left"].NAA_(null,null,null,!1);this.nAA_["right"].NAA_(null,null,null,!1);const a=sFt,g=QJt;if(o)if(r)if(l){this.nAA_["front"].NAA_(g.x,a.start,OJt,!0);this.nAA_["bottom"].NAA_(g.y,a.end,WJt,!0);this.nAA_["left"].NAA_(g.z,a.start,jJt,!0)}else{this.nAA_["front"].NAA_(g.x,a.start,OJt,!0);this.nAA_["bottom"].NAA_(g.y,a.start,zJt,!0);this.nAA_["front"].NAA_(g.z,a.end,ZJt,!0)}else if(l){this.nAA_["front"].NAA_(g.x,a.end,_Jt,!0);this.nAA_["top"].NAA_(g.y,a.end,$Jt,!0);this.nAA_["left"].NAA_(g.z,a.start,jJt,!0)}else{this.nAA_["front"].NAA_(g.x,a.end,_Jt,!0);this.nAA_["top"].NAA_(g.y,a.start,XJt,!0);this.nAA_["front"].NAA_(g.z,a.end,ZJt,!0)}else if(r)if(u){this.nAA_["back"].NAA_(g.x,a.start,iPt,!0);this.nAA_["bottom"].NAA_(g.y,a.start,zJt,!0);this.nAA_["back"].NAA_(g.z,a.end,ePt,!0)}else{this.nAA_["back"].NAA_(g.x,a.start,iPt,!0);this.nAA_["bottom"].NAA_(g.y,a.end,WJt,!0);this.nAA_["back"].NAA_(g.z,a.start,tPt,!0)}else if(u){this.nAA_["back"].NAA_(g.x,a.end,sPt,!0);this.nAA_["top"].NAA_(g.y,a.start,XJt,!0);this.nAA_["back"].NAA_(g.z,a.end,ePt,!0)}else{this.nAA_["back"].NAA_(g.x,a.end,sPt,!0);this.nAA_["top"].NAA_(g.y,a.end,$Jt,!0);this.nAA_["back"].NAA_(g.z,a.start,tPt,!0)}let c;const I=[],f=[],C=[];for(c in this.nAA_){const A=this.nAA_[c].JAA_(t,i,s,e);for(let t=0;t<A["titles"].length;t++)I.push(A["titles"][t]);for(let t=0;t<A["extremities"].length;t++)f.push(A["extremities"][t]);for(let t=0;t<A["marks"].length;t++)C.push(A["marks"][t])}fLt.hZe_(t,i,f,12,new A(0,4,0,0),I);const d=I.concat(f);fLt.hZe_(t,i,C,6,new A(0,4,0,0),d);return this}dispose(){super.dispose();for(let t=0;t<this.children.length;t++)this.children[t]&&fLt.dispose(this.children[t])}};i=t([_s("geotoolkit3d.scene.grid.Grid")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRXb3JsZEJvdW5kaW5nQm94IjoiemplXyIsImdldE9wdGlvbnMiOiJKVl8iLCJnZXRPdXRsaW5lcyI6IllBQV8iLCJnZXRUaXRsZU91dGxpbmVzIjoiS0FBXyIsImdldFN0YXJ0IjoiaGNfIiwiZ2V0RW5kIjoibmNfIiwiZ2V0TW9kZSI6IktadF8iLCJnZXRDb3VudHMiOiJSQUFfIiwiZ2V0TW9kZWxTdGFydCI6IkluQV8iLCJnZXRNb2RlbEVuZCI6ImZuQV8iLCJnZXRQbGFuZXMiOiJDbkFfIiwiYWRkTGVnZW5kIjoiZG5BXyJ9fX0g");var nPt=Ci({Top:"top",JQ_:"bottom",ne_:"center"},2,"eyJCb3R0b20iOiJKUV8iLCJDZW50ZXIiOiJuZV8ifSAg");const hPt=new a,rPt=new a,oPt=new a,lPt=(t,i,s,e)=>{oPt.set(0,0,0);t.min.x<i.min.x&&(oPt.x=(i.min.x-t.min.x)/s.x);t.max.x>i.max.x&&(oPt.x=(i.max.x-t.max.x)/s.x);t.min.y<i.min.y&&(oPt.y=(i.min.y-t.min.y)/s.y);t.max.y>i.max.y&&(oPt.y=(i.max.y-t.max.y)/s.y);t.min.z<i.min.z&&(oPt.z=(i.min.z-t.min.z)/s.z);t.max.z>i.max.z&&(oPt.z=(i.max.z-t.max.z)/s.z);e.add(oPt)};var uPt=function(){let i=class t extends fUt{constructor(){super();this.wnA_=new a;this.QnA_=!0;this.EnA_=!0}setOptions(t){super.setOptions(t);if(t["legendlabel"]!==this.pnA_){if(this.pnA_){this.remove(this.pnA_);fLt.dispose(this.pnA_)}this.pnA_=t["legendlabel"];this.add(this.pnA_)}this.fNt_=t["grid"];this.wnA_.copy(t["position"]);this.position.copy(this.wnA_);this.scale.copy(t["scale"]);this.QnA_=t["hideiftoolarge"];this.EnA_=t["centerbeforehiding"];return this}beforeRender(t,i,s,e){super.beforeRender(t,i,s,e);if(!this.fNt_||!this.pnA_||!this.visible)return this;this.position.copy(this.wnA_);this.updateMatrixWorld();this.pnA_.nf_(!0,!0);if(!this.QnA_)return this;this.pnA_.beforeRender(t,i,s,e);this.pnA_.afterRender(t,i,s,e);this.pnA_.computeBoundingBox();const A=this.pnA_.getBoundingBox();A.getSize(hPt);const n=this.fNt_.zje_();n.getSize(rPt);this.pnA_.nf_(!1,!0);if(hPt.x>rPt.x||hPt.y>rPt.y||hPt.z>rPt.z)return this;if(n.containsBox(A)){this.pnA_.nf_(!0,!0);return this}if(this.EnA_){lPt(A,n,rPt,this.position);this.updateMatrixWorld();this.pnA_.nf_(!0,!0)}return this}dispose(){super.dispose();fLt.dispose(this.pnA_);this.pnA_=null;this.fNt_=null}};i=t([_s("geotoolkit3d.scene.grid.legend.PlaneLegendContainer")],i);return i}();const aPt=t=>{if(!t.defines.hasOwnProperty("addedLabelShaders")){t.defines["addedLabelShaders"]=!0;t.uniforms["map"]={value:new r};t.uniforms["uColor"]={value:new l("white")}}};var gPt=Ci(function(){let i=class t{static setOptions(t,i){if(i!=null){aPt(t);i["map"]!=null&&(t.uniforms["map"].value=i["map"]);if(i["textcolor"]!=null){t.uniforms["uColor"].value=new l(i["textcolor"]);t.needsUpdate=!0}}}};i.mnA_=["attribute vec2 texcoord;","attribute vec2 texcoordInv;","varying vec2 vTexcoord;","varying vec2 vTexcoordInv;","#include <common>","#include <envmap_pars_vertex>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>","void main() {","    vTexcoord = texcoord;","    vTexcoordInv = texcoordInv;","    #include <color_vertex>","    #include <skinbase_vertex>","    vec4 mvPosition = vec4( position, 1.0 );","    mvPosition = modelViewMatrix * mvPosition;","    gl_Position = projectionMatrix * mvPosition;","    #include <logdepthbuf_vertex>","    #include <clipping_planes_vertex>","    #include <envmap_vertex>","    #include <fog_vertex>","}"].join("\n");i.ynA_=["uniform vec3 uColor;","uniform vec3 diffuse;","uniform float opacity;","uniform sampler2D map;","varying vec2 vTexcoord;","varying vec2 vTexcoordInv;","#include <common>","#include <dithering_pars_fragment>","#include <color_pars_fragment>","#include <uv_pars_fragment>","#include <alphamap_pars_fragment>","#include <aomap_pars_fragment>","#include <lightmap_pars_fragment>","#include <envmap_common_pars_fragment>","#include <envmap_pars_fragment>","#include <cube_uv_reflection_fragment>","#include <fog_pars_fragment>","#include <specularmap_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <clipping_planes_pars_fragment>","void main() {","    #include <clipping_planes_fragment>","    #include <logdepthbuf_fragment>","    #include <color_fragment>","    #include <alphamap_fragment>","    #include <alphatest_fragment>","    #include <specularmap_fragment>","    #include <aomap_fragment>","    #include <envmap_fragment>","    vec4 textColor = vec4(uColor, 1);","    if (gl_FrontFacing) {","        gl_FragColor = textColor * texture2D(map, vTexcoord);","    } else {","        gl_FragColor = textColor * texture2D(map, vTexcoordInv);","    }","    #include <tonemapping_fragment>","    #include <encodings_fragment>","    #include <fog_fragment>","    #include <premultiplied_alpha_fragment>","    #include <dithering_fragment>","}"].join("\n");i=t([_s("geotoolkit3d.util.shaders.LabelShaders")],i);return i}(),2,"eyJnZXRDbGFzc05hbWUiOiJEXyJ9");var cPt=function(){let i=class t extends d{constructor(t){super();this.type="LabelMaterial";const i=qi(t,{opacity:1,renderside:e},!0);this.side=t["renderside"];this.opacity=i["opacity"];this.transparent=!0;this.vertexShader=gPt.mnA_;this.fragmentShader=gPt.ynA_;this.map=i["map"];this.setOptions(i)}setOptions(t){t.hasOwnProperty("renderside")&&(this.side=t["renderside"]);t.hasOwnProperty("opacity")&&(this.opacity=t["opacity"]);gPt.setOptions(this,t)}DnA_(t){this.map.dispose();this.map=new Dt(t);this.setOptions({map:this.map})}};i=t([_s("geotoolkit3d.scene.label.LabelMaterial")],i);return i}();const IPt=1,fPt=1;var CPt=function(){let i=class t extends z{constructor(t,i){super();Object.assign(this,{type:"LabelGeometry"});const s=t/2,e=i/2,A=IPt+1,n=fPt+1,h=t/IPt,r=i/fPt,o=[],l=[],u=[],a=[],g=[];for(let t=0;t<n;t++){const i=t*r-e;for(let e=0;e<A;e++){const A=e*h-s;l.push(A,-i,0);u.push(0,0,1);a.push(e/IPt);a.push(1-t/fPt);g.push(1-e/IPt);g.push(1-t/fPt)}}for(let t=0;t<IPt;t++)for(let i=0;i<fPt;i++){const s=i+A*i,e=i+A*(t+1),n=i+1+A*(t+1),h=i+1+A*t;o.push(s,e,h);o.push(e,n,h)}this.setIndex(o);this.setAttribute("position",new V(l,3));this.setAttribute("normal",new V(u,3));this.setAttribute("texcoord",new V(a,2));this.setAttribute("texcoordInv",new V(g,2))}};i=t([_s("geotoolkit3d.scene.label.LabelGeometry")],i);return i}();let dPt;const BPt={c:null,u:[new a,new a,new a],e:[]},wPt={c:null,u:[new a,new a,new a],e:[]},QPt=[[],[],[]],EPt=[[],[],[]],pPt=[],mPt=new a,yPt=new a,DPt=new a,MPt=new a,vPt=new a,bPt=new Array(8);for(let t=0;t<bPt.length;t++)bPt[t]=new a;var NPt=Ci(function(){var i;let s=i=class t{constructor(t,i,s){this.qz_=t!=null?t:new a;this.MnA_=i!=null?i:new a;this.vnA_=s!=null?s:new I}set(t,i,s){this.qz_=t;this.MnA_=i;this.vnA_=s;return this}me_(t){this.qz_=t;return this}bnA_(t){this.MnA_=t;return this}NnA_(t){this.vnA_=t;return this}copy(t){this.qz_.copy(t.getCenter());this.MnA_.copy(t.SnA_());this.vnA_.copy(t.GnA_());return this}clone(){return new i(this.qz_.clone(),this.MnA_.clone(),this.vnA_.clone())}equals(t){return t.getCenter().equals(this.qz_)&&t.SnA_().equals(this.MnA_)&&t.GnA_().equals(this.vnA_)}containsPoint(t){MPt.subVectors(t,this.qz_);this.vnA_.extractBasis(mPt,yPt,DPt);return Math.abs(MPt.dot(mPt))<=this.MnA_.x&&Math.abs(MPt.dot(yPt))<=this.MnA_.y&&Math.abs(MPt.dot(DPt))<=this.MnA_.z}RnA_(t){t.getCenter(this.qz_);t.getSize(this.MnA_).multiplyScalar(.5);this.vnA_.identity();return this}knA_(t){dPt==null&&(dPt=new i);dPt.RnA_(t);return this.FnA_(dPt)}intersectsPlane(t){this.vnA_.extractBasis(mPt,yPt,DPt);const i=this.MnA_.x*Math.abs(t.normal.dot(mPt))+this.MnA_.y*Math.abs(t.normal.dot(yPt))+this.MnA_.z*Math.abs(t.normal.dot(DPt)),s=t.normal.dot(this.qz_)-t.constant;return Math.abs(s)<=i}FnA_(t,i){i==null&&(i=Number.EPSILON);BPt.c=this.qz_;BPt.e[0]=this.MnA_.x;BPt.e[1]=this.MnA_.y;BPt.e[2]=this.MnA_.z;this.vnA_.extractBasis(BPt.u[0],BPt.u[1],BPt.u[2]);wPt.c=t.getCenter();const s=t.SnA_();wPt.e[0]=s.x;wPt.e[1]=s.y;wPt.e[2]=s.z;t.GnA_().extractBasis(wPt.u[0],wPt.u[1],wPt.u[2]);let e,A,n,h;for(e=0;e<3;e++)for(A=0;A<3;A++)QPt[e][A]=BPt.u[e].dot(wPt.u[A]);MPt.subVectors(wPt.c,BPt.c);pPt[0]=MPt.dot(BPt.u[0]);pPt[1]=MPt.dot(BPt.u[1]);pPt[2]=MPt.dot(BPt.u[2]);for(e=0;e<3;e++)for(A=0;A<3;A++)EPt[e][A]=Math.abs(QPt[e][A])+i;for(e=0;e<3;e++){n=BPt.e[e];h=wPt.e[0]*EPt[e][0]+wPt.e[1]*EPt[e][1]+wPt.e[2]*EPt[e][2];if(Math.abs(pPt[e])>n+h)return!1}for(e=0;e<3;e++){n=BPt.e[0]*EPt[0][e]+BPt.e[1]*EPt[1][e]+BPt.e[2]*EPt[2][e];h=wPt.e[e];if(Math.abs(pPt[0]*QPt[0][e]+pPt[1]*QPt[1][e]+pPt[2]*QPt[2][e])>n+h)return!1}n=BPt.e[1]*EPt[2][0]+BPt.e[2]*EPt[1][0];h=wPt.e[1]*EPt[0][2]+wPt.e[2]*EPt[0][1];if(Math.abs(pPt[2]*QPt[1][0]-pPt[1]*QPt[2][0])>n+h)return!1;n=BPt.e[1]*EPt[2][1]+BPt.e[2]*EPt[1][1];h=wPt.e[0]*EPt[0][2]+wPt.e[2]*EPt[0][0];if(Math.abs(pPt[2]*QPt[1][1]-pPt[1]*QPt[2][1])>n+h)return!1;n=BPt.e[1]*EPt[2][2]+BPt.e[2]*EPt[1][2];h=wPt.e[0]*EPt[0][1]+wPt.e[1]*EPt[0][0];if(Math.abs(pPt[2]*QPt[1][2]-pPt[1]*QPt[2][2])>n+h)return!1;n=BPt.e[0]*EPt[2][0]+BPt.e[2]*EPt[0][0];h=wPt.e[1]*EPt[1][2]+wPt.e[2]*EPt[1][1];if(Math.abs(pPt[0]*QPt[2][0]-pPt[2]*QPt[0][0])>n+h)return!1;n=BPt.e[0]*EPt[2][1]+BPt.e[2]*EPt[0][1];h=wPt.e[0]*EPt[1][2]+wPt.e[2]*EPt[1][0];if(Math.abs(pPt[0]*QPt[2][1]-pPt[2]*QPt[0][1])>n+h)return!1;n=BPt.e[0]*EPt[2][2]+BPt.e[2]*EPt[0][2];h=wPt.e[0]*EPt[1][1]+wPt.e[1]*EPt[1][0];if(Math.abs(pPt[0]*QPt[2][2]-pPt[2]*QPt[0][2])>n+h)return!1;n=BPt.e[0]*EPt[1][0]+BPt.e[1]*EPt[0][0];h=wPt.e[1]*EPt[2][2]+wPt.e[2]*EPt[2][1];if(Math.abs(pPt[1]*QPt[0][0]-pPt[0]*QPt[1][0])>n+h)return!1;n=BPt.e[0]*EPt[1][1]+BPt.e[1]*EPt[0][1];h=wPt.e[0]*EPt[2][2]+wPt.e[2]*EPt[2][0];if(Math.abs(pPt[1]*QPt[0][1]-pPt[0]*QPt[1][1])>n+h)return!1;n=BPt.e[0]*EPt[1][2]+BPt.e[1]*EPt[0][2];h=wPt.e[0]*EPt[2][1]+wPt.e[1]*EPt[2][0];return!(Math.abs(pPt[1]*QPt[0][2]-pPt[0]*QPt[1][2])>n+h)}xnA_(t){MPt.set(0,0,0).sub(this.SnA_());vPt.copy(this.SnA_());const i=this.GnA_(),s=this.getCenter();bPt[0].set(MPt.x,MPt.y,MPt.z).applyMatrix3(i).add(s);bPt[1].set(MPt.x,vPt.y,MPt.z).applyMatrix3(i).add(s);bPt[2].set(vPt.x,vPt.y,MPt.z).applyMatrix3(i).add(s);bPt[3].set(vPt.x,MPt.y,MPt.z).applyMatrix3(i).add(s);bPt[4].set(MPt.x,MPt.y,vPt.z).applyMatrix3(i).add(s);bPt[5].set(MPt.x,vPt.y,vPt.z).applyMatrix3(i).add(s);bPt[6].set(vPt.x,vPt.y,vPt.z).applyMatrix3(i).add(s);bPt[7].set(vPt.x,MPt.y,vPt.z).applyMatrix3(i).add(s);const e=t||new C;e.setFromPoints(bPt);return e}getCenter(){return this.qz_}SnA_(){return this.MnA_}GnA_(){return this.vnA_}};s=i=t([_s("geotoolkit3d.util.OrientedBoundingBox")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRDZW50ZXIiOiJtZV8iLCJzZXRIYWxmU2l6ZSI6ImJuQV8iLCJzZXRSb3RhdGlvbiI6Ik5uQV8iLCJmcm9tQm94MyI6IlJuQV8iLCJpbnRlcnNlY3RzQm94MyI6ImtuQV8iLCJpbnRlcnNlY3RzT3JpZW50ZWRCb3VuZGluZ0JveCI6IkZuQV8iLCJ0b1RocmVlQm94IjoieG5BXyIsImdldEhhbGZTaXplIjoiU25BXyIsImdldFJvdGF0aW9uIjoiR25BXyJ9fSwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");const SPt=Fa.z_,GPt=ka.JQ_,RPt=new a(1,0,0),kPt=new a(0,1,0),FPt=new a(0,0,1),xPt=RPt,LPt=/<br\s*\/?>|\r\n|\n|\r/g,UPt=new xA,YPt=new a,TPt=new a,KPt=new B,HPt=new a,qPt=new a,JPt=new u,PPt=new B,VPt=new B,OPt=new B,WPt=new a,zPt=t=>{const i=new Dt(t);i.minFilter=o;i.generateMipmaps=!1;return new cPt({map:i})};var XPt=Ci(function(){let s=class t extends fUt{constructor(t){super();this.KC_(!1);t["canvas"]==null&&(t["canvas"]=Ls(0,0,!0));this.LnA_=new W(new CPt(1,1),zPt(t["canvas"]));this.add(this.LnA_);const i=Pi(t,{enabled:!0,style:new qa({font:"10px Arial",color:"rgba(0, 0, 0, 1.0)",alignment:SPt,baseline:GPt}),outline:{enabled:!1,innercolor:"white",outlinecolor:"black",thickness:6},issizeindevice:!0,renderside:e,opacity:1,scale:new a(1,1,1),normal:xPt,freeorientation:!1,enforcetextupright:!0,facingoffset:0,verticalanchor:nPt.ne_});t["origin"]==null&&ki("geotoolkit3d.scene.label.Label: origin cannot be null");this.ojt_=i["canvas"];this.dS_=this.ojt_.getContext("2d");this.onA_=i["origin"]instanceof a?i["origin"]:(new a).fromArray(i["origin"]);this._q_=(i["text"]||this.onA_.z)+"";this.S3e_=i["normal"]instanceof a?i["normal"].clone():(new a).fromArray(i["normal"]);this.UnA_(this.S3e_);this.YnA_=this.S3e_.clone();this.TnA_=i["freeorientation"];this.KnA_=i["enforcetextupright"];this.HnA_=i["facingoffset"];this.li_=i["style"];this.qnA_=i["verticalanchor"];this.LnA_.scale.copy(i["scale"]);this.JnA_=this.LnA_.scale.clone();this.visible=i["enabled"];this.boundingBox=null;this.boundingSphere=null;this.obb=null;this.PnA_=i["issizeindevice"];this.VnA_=i["outline"]["enabled"]||!1;this.OnA_=i["outline"];this.WnA_=!0;this.kls_();this.geA_=!1;this.PnA_=i["issizeindevice"];this.IeA_=this.ojt_.width;this.feA_=this.ojt_.height;this.znA_=new a(this.IeA_,this.feA_,1);this.XnA_=1;this.jnA_=new a(1,1,1);this.ZnA_=new B;this._nA_=new B;this.$nA_=new a;this.thA_=new u;this.ihA_=new a;this.shA_=new a;this.LnA_.material.setOptions({opacity:i["opacity"],renderside:i["renderside"],textcolor:this.li_.hB_().ys_()});this.position.copy(this.onA_);this.frustumCulled=!1;this.name="label";this.ehA_();this.computeBoundingSphere()}ehA_(){this.S3e_.normalize();this.YnA_.copy(this.S3e_);this.YnA_.z=0;this.YnA_.normalize();let t=RPt.angleTo(this.YnA_);qPt.crossVectors(RPt,this.YnA_);qPt.z<0&&(t=-t);PPt.setFromAxisAngle(FPt,t);const i=this.TnA_?FPt.angleTo(this.S3e_):Math.PI/2;VPt.setFromAxisAngle(kPt,i);OPt.setFromAxisAngle(FPt,Math.PI/2);this._nA_.copy(PPt).multiply(VPt).multiply(OPt).normalize();this.LnA_.quaternion.copy(this._nA_);OPt.setFromAxisAngle(FPt,-Math.PI/2);this.ZnA_.copy(PPt).multiply(VPt).multiply(OPt).normalize()}setOptions(t){t=t||{};super.setOptions(t);if(t["style"]!=null){this.li_=t["style"];this.LnA_.material.setOptions({textcolor:this.li_.hB_().ys_()});this.WnA_=!0}t["doublesided"]!=null&&(this.LnA_.material.side=t["doublesided"]?e:i);t["enforcetextupright"]!=null&&(this.KnA_=t["enforcetextupright"]);let s=!1;if(t["origin"]){Array.isArray(t["origin"])?this.onA_.fromArray(t["origin"]):this.onA_.copy(t["origin"]);this.position.copy(this.onA_);s=!0}let A=!1;if(t["normal"]){Array.isArray(t["normal"])?this.S3e_.fromArray(t["normal"]):this.S3e_.copy(t["normal"]);this.UnA_(this.S3e_);A=!0}if(t["freeorientation"]!=null&&t["freeorientation"]!==this.TnA_){this.TnA_=t["freeorientation"];A=!0}if(t["facingoffset"]!=null&&t["facingoffset"]!==this.HnA_){this.HnA_=t["facingoffset"];s=!0}A&&this.ehA_();(s||A)&&this.computeBoundingSphere();return this}kls_(){const t=$o.measureText(this._q_,this.li_);let i=t.Ie_(),s=t.Ts_();const e=(this._q_+"").split(LPt);let A=0;if(this.VnA_){A=this.OnA_["thickness"];i+=A*2;s+=A*2*e.length}const n=s/e.length;this.dS_.clearRect(0,0,this.ojt_.width,this.ojt_.height);this.ojt_.width=i;this.ojt_.height=s;this.dS_.font=this.li_.Zy_();if(this.VnA_){this.dS_.strokeStyle=this.OnA_["outlinecolor"];this.dS_.lineWidth=A;this.dS_.lineJoin="miter";this.dS_.miterLimit=3}else this.dS_.fillStyle="white";this.dS_.textBaseline=GPt;this.dS_.textAlign=SPt;let h=n;for(let t=0;t<e.length;t++){if(this.VnA_){this.dS_.strokeText(e[t],A,h-A);this.dS_.fillStyle=this.OnA_["innercolor"];this.dS_.fillText(e[t],A,h-A)}else this.dS_.fillText(e[t],0,h);h+=n}this.geA_=!1;this.position.copy(this.onA_);this.LnA_.material.DnA_(this.ojt_)}UnA_(t){if(t.x===0&&t.y===0){t.x+=.01;t.normalize()}}computeBoundingBox(){this.AhA_();this.boundingBox||(this.boundingBox=new C);this.nhA_().xnA_(this.boundingBox)}computeBoundingSphere(){this.computeBoundingBox();this.boundingSphere||(this.boundingSphere=new P);this.boundingBox.getBoundingSphere(this.boundingSphere)}AhA_(){this.obb||(this.obb=new NPt(new a,new a,new I));this.JnA_.copy(this.LnA_.scale);this.LnA_.scale.multiply(this.znA_);this.PnA_&&this.LnA_.scale.multiplyScalar(this.XnA_);this.updateMatrixWorld();this.LnA_.matrixWorld.decompose(HPt,KPt,TPt);this.obb.getCenter().copy(HPt);this.LnA_.geometry.boundingBox||this.LnA_.geometry.computeBoundingBox();const t=this.LnA_.geometry.boundingBox;this.obb.SnA_().copy(t.max).sub(t.min).divideScalar(2);this.obb.SnA_().multiply(TPt);JPt.makeRotationFromQuaternion(KPt);this.obb.GnA_().setFromMatrix4(JPt);this.LnA_.scale.copy(this.JnA_)}getBoundingBox(){this.boundingBox||this.computeBoundingBox();return this.boundingBox}getBoundingSphere(){this.boundingSphere||this.computeBoundingSphere();return this.boundingSphere}nhA_(){this.obb||this.AhA_();return this.obb}a_(t){if(this._q_!==t){this._q_=t;this.WnA_=!0}}SG_(){return this._q_}hhA_(t,i,s){let e;const A=t.distanceTo(i.position);if(i instanceof Q){const t=i.fov*Math.PI/180;e=2*Math.tan(t/2)*A}else e=i.top-i.bottom;const n=s.userData["plot"].getSize(UPt).Ts_();this.XnA_=e/n}rhA_(t){this.ohA_(t);return this.ihA_}RsA_(t){this.ohA_(t);return this.shA_}ohA_(t){if(!this.$nA_.equals(t.position)||!this.thA_.equals(t.projectionMatrix)){this.$nA_.copy(t.position);this.thA_.copy(t.projectionMatrix);t.getWorldDirection(this.shA_);this.ihA_.copy(this.shA_);this.ihA_.z=0;this.UnA_(this.ihA_);this.ihA_.normalize()}}beforeRender(t,i,s,e){if(!this.visible)return this;this.position.copy(this.onA_);super.beforeRender(t,i,s,e);this.JnA_.copy(this.LnA_.scale);if(this.WnA_){this.WnA_=!1;this.kls_()}if(!this.geA_){super.invalidateObject();this.IeA_=this.ojt_.width;this.feA_=this.ojt_.height;this.geA_=!0}this.znA_.set(this.IeA_,this.feA_,1);if(this.PnA_){const s=this.parent.localToWorld(YPt.copy(this.position));this.hhA_(s,i,t)}YPt.setFromMatrixScale(this.parent.matrixWorld);this.jnA_.set(1/YPt.x,1/YPt.y,1/YPt.z);const A=this.HnA_!==0||this.qnA_!==nPt.ne_;WPt.set(0,0,0);this.HnA_!==0&&(WPt.z=this.HnA_*this.znA_.y);if(this.qnA_!==nPt.ne_){WPt.y=this.znA_.y/2;this.qnA_===nPt.Top&&(WPt.y*=-1)}if(A){WPt.applyQuaternion(this.LnA_.quaternion);WPt.multiply(this.jnA_)}this.LnA_.scale.multiply(this.znA_);if(this.PnA_){A&&WPt.multiplyScalar(this.XnA_);this.LnA_.scale.multiplyScalar(this.XnA_)}this.position.add(WPt);if(this.KnA_){const t=this.RsA_(i),s=this.rhA_(i);YPt.copy(this.S3e_);YPt.angleTo(t)<Math.PI/2&&YPt.negate();const e=YPt.angleTo(s)<Math.PI/2;this.LnA_.quaternion.copy(e?this.ZnA_:this._nA_)}this.scale.copy(this.jnA_);return this}afterRender(t,i,s,e){if(!this.visible)return this;super.afterRender(t,i,s,e);this.LnA_.scale.copy(this.JnA_);return this}G9e_(){return new g(this.IeA_,this.feA_)}dispose(){super.dispose();fLt.dispose(this.LnA_);this.boundingBox=null;this.boundingSphere=null;this.obb=null}};s=t([_s("geotoolkit3d.scene.label.Label")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJjb21wdXRlT3JpZW50ZWRCb3VuZGluZ0JveCI6IkFoQV8iLCJnZXRPcmllbnRlZEJvdW5kaW5nQm94IjoibmhBXyIsInNldFRleHQiOiJhXyIsImdldFRleHQiOiJTR18iLCJnZXRUZXh0dXJlRGltZW5zaW9uIjoiRzllXyJ9fX0g");const jPt={front:{name:"front",arraypos:0,labelToGrid:(new u).set(-1,0,0,.5,0,0,1,0,0,1,0,-.5,0,0,0,1),normal:new a(0,1,0)},back:{name:"back",arraypos:1,labelToGrid:(new u).set(1,0,0,-.5,0,0,-1,0,0,1,0,-.5,0,0,0,1),normal:new a(0,-1,0)},left:{name:"left",arraypos:2,labelToGrid:(new u).set(0,0,1,0,1,0,0,-.5,0,1,0,-.5,0,0,0,1),normal:new a(1,0,0)},right:{name:"right",arraypos:3,labelToGrid:(new u).set(0,0,-1,0,-1,0,0,.5,0,1,0,-.5,0,0,0,1),normal:new a(-1,0,0)}},ZPt=new g(.5,.5),_Pt=nPt.ne_,$Pt=new A,tVt=new A,iVt=new A,sVt=new g(1,1);var eVt=Ci(function(){var t;return class{constructor(t){this.Kis_={};this.fNt_=null;this.lhA_=new Array(4);for(let t=0;t<4;t++)this.lhA_[t]=new uPt;this.ojt_=new Array(4);this.setOptions(t)}setOptions(t){this.Kis_=Pi(t,this.Kis_);this.Mzi_()}BnA_(t){const i=t["scale"]["x"],s=t["scale"]["y"];this.fNt_=t;sVt.x=Math.max(1,s/i);sVt.y=Math.max(1,i/s);this.Mzi_()}Mzi_(){if(this.Kis_["planes"]&&this.fNt_){const t=this.Kis_["planes"];t["front"]&&this.ZVt_(t["front"],jPt["front"],this.fNt_);t["back"]&&this.ZVt_(t["back"],jPt["back"],this.fNt_);t["left"]&&this.ZVt_(t["left"],jPt["left"],this.fNt_);t["right"]&&this.ZVt_(t["right"],jPt["right"],this.fNt_)}}ZVt_(t,s,e){const A=s["arraypos"],n=s["name"],h=e.CnA_()[n];h.remove(this.lhA_[A]);this.ojt_[A]||(this.ojt_[A]=Ls(0,0,!0));const r=t["textoffset"]?t["textoffset"]:ZPt,o=t["text"]?t["text"]:"Missing Text Option",l=t["enable"]==null||t["enable"],u=t["nearside"]!=null&&t["nearside"],g=t["hideiftoolarge"]==null||t["hideiftoolarge"];let c=t["textscale"]!=null?t["textscale"]:1;const I=t["centerbeforehiding"]==null||t["centerbeforehiding"],f=t["verticalanchor"]!=null?t["verticalanchor"]:_Pt;$Pt.set(r.x,r.y,.49,1);u||($Pt.z-=.98);tVt.set(0,0,$Pt.z,1);iVt.set(1,1,$Pt.z,1);$Pt.applyMatrix4(s["labelToGrid"]);tVt.applyMatrix4(s["labelToGrid"]);iVt.applyMatrix4(s["labelToGrid"]);const C=t["sizeindevice"]==null||t["sizeindevice"];if(!C){const t=undefined;c*=(Math.abs(e.scale.x)+Math.abs(e.scale.y)+Math.abs(e.scale.z)/3)/500}const d={canvas:this.ojt_[A],origin:new a(0,0,0),normal:s["normal"],text:o,enabled:l,issizeindevice:C,renderside:i,verticalanchor:f,scale:new a(c,c,1)};t["style"]&&(d["style"]=t["style"]);t["outline"]&&(d["outline"]=t["outline"]);let B=1,w=1;switch(s["name"]){case"front":case"back":B*=sVt.x;break;case"left":case"right":w*=sVt.y;break;default:break}this.lhA_[A].setOptions({legendlabel:new XPt(d),grid:e,position:new a($Pt.x,$Pt.y,$Pt.z),scale:new a(B,w,1),hideiftoolarge:g,centerbeforehiding:I});h.add(this.lhA_[A]);this.lhA_[A].invalidateObject();e.invalidateObject()}dispose(){if(this.lhA_)for(let t=0;t<this.lhA_.length;t++)fLt.dispose(this.lhA_[t]);this.ojt_=null}}}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJhZGRUb0dyaWQiOiJCbkFfIn19fSAg");const AVt="POLAR_AXIS",nVt="POLAR_GRID",hVt="POLAR_HORIZON",rVt="POLAR_VERTICAL",oVt=new hl("white"),lVt=new hl("grey"),uVt=new qa({color:"white",font:"11px Arial"}),aVt=t=>t.toFixed(0),gVt=(t,i)=>{const s=i.hB_();return new cUt({data:{positions:t},color:new l(s.Is_()/255,s.Cs_()/255,s.fs_()/255),linewidth:i.Ie_(),opacity:s.ds_()/255,polygonoffset:!0,polygonoffsetfactor:.75})},cVt=(t,i,s)=>{const e=new _qt(t,{style:i});e.tF_(s);return e};var IVt=Ci(function(){let i=class t extends fUt{constructor(t){super();this.KC_(!1);t["axis"]==null&&(t["axis"]={});t["grid"]==null&&(t["grid"]={});t["axis"]=qi(t["axis"],{textstyle:uVt,linestyle:oVt,formatter:aVt,outline:null});t["grid"]=qi(t["grid"],{linestyle:lVt});const i=qi(t,{count:3,modelcenter:0,modelsize:10});this.fX_=null;this.ZF_=null;this.Xk_=null;this.setOptions(i);this.name=nVt}setOptions(t){if(t==null)return this;super.setOptions(t);for(let t=this.children.length-1;t>=0;t--)this.remove(this.children[t]);t["axis"]==null&&(t["axis"]={});t["grid"]==null&&(t["grid"]={});t["axis"]=qi(t["axis"],{textstyle:this.Oys_(),linestyle:this.UAA_(),formatter:this.HAA_(),outline:this.DF_()});t["grid"]=qi(t["grid"],{linestyle:this.LAA_()});const i=qi(t,{count:this.jv_(),modelcenter:this.uhA_(),modelsize:this.ahA_()});this.ghA_=i["modelcenter"];this.ggs_=i["modelsize"];const s=t["axis"]["formatter"]!=null&&typeof t["axis"]["formatter"]=="function"?t["axis"]["formatter"]:t=>t+"",e=i["count"],A=(new $qt).peA_();for(let t=0;t<i["count"];t++){const s=t===0||t===e-1,n=s?i["axis"]["linestyle"]:i["grid"]["linestyle"],h=gVt(A,n);h.name=s?AVt:nVt;h.scale.set((e-t)/e,(e-t)/e,(e-t)/e);this.add(h)}const n=undefined,h=gVt([-.5,0,0,.5,0,0],i["grid"]["linestyle"]);h.name=hVt;this.add(h);const r=undefined,o=gVt([0,-.5,0,0,.5,0],i["grid"]["linestyle"]);o.name=rVt;this.add(o);this.ZF_=s;this.fX_=i["axis"]["textstyle"];this.Xk_=i["axis"]["outline"];const l=s(this.ggs_-this.ghA_),u=cVt(l,i["axis"]["textstyle"],i["axis"]["outline"]);u.position.set(0,-.5,0);u.weA_(new a(0,-1,0));const g=cVt(l,i["axis"]["textstyle"],i["axis"]["outline"]);g.position.set(0,.5,0);g.weA_(new a(0,1,0));const c=cVt(l,i["axis"]["textstyle"],i["axis"]["outline"]);c.position.set(.5,0,0);c.weA_(new a(1,0,0));const I=cVt(l,i["axis"]["textstyle"],i["axis"]["outline"]);I.position.set(-.5,0,0);I.weA_(new a(-1,0,0));this.add([u,g,c,I]);return this}JV_(){return Pi({axis:{textstyle:this.Oys_(),formatter:this.HAA_(),linestyle:this.UAA_(),outline:this.DF_()},grid:{linestyle:this.LAA_()},count:this.jv_(),modelcenter:this.uhA_(),modelsize:this.ahA_()},super.JV_())}LAA_(){let t=null;this.traverse((i=>{if(i.name===nVt){const s=i.material[0]||i.material;t=s.userData.Jvt_}}));return t}UAA_(){let t=null;this.traverse((i=>{if(i.name===AVt){const s=i.material[0]||i.material;t=s.userData.Jvt_}}));return t}Oys_(){return this.fX_}HAA_(){return this.ZF_}DF_(){return this.Xk_}jv_(){let t=0;this.traverse((i=>{i.name!==nVt&&i.name!==AVt||t++}));return t}uhA_(){return this.ghA_}ahA_(){return this.ggs_}};i=t([_s("geotoolkit3d.scene.grid.PolarGrid")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiZ2V0T3V0bGluZSI6IkRGXyIsImdldENvdW50IjoianZfIiwiZ2V0TW9kZWxDZW50ZXIiOiJ1aEFfIiwiZ2V0TW9kZWxTaXplIjoiYWhBXyJ9fX0g");var fVt=Ci(function(){var s;let e=s=class t extends U{constructor(t){super();this.FRAGMENT_SHADER=["#define LAMBERT","uniform vec3 diffuse;","uniform vec3 emissive;","varying float vOpacity;","varying float vVisible;","uniform float opacity;","#include <common>","#include <packing>","#include <dithering_pars_fragment>","#include <color_pars_fragment>","#include <uv_pars_fragment>","#include <map_pars_fragment>","#include <alphamap_pars_fragment>","#include <aomap_pars_fragment>","#include <lightmap_pars_fragment>","#include <emissivemap_pars_fragment>","#include <envmap_common_pars_fragment>","#include <envmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <normal_pars_fragment>","#include <lights_lambert_pars_fragment>","#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>","#include <specularmap_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <clipping_planes_pars_fragment>","void main() {","    if(vVisible < 0.5) discard;","    #include <clipping_planes_fragment>","    vec4 diffuseColor = vec4( diffuse, opacity * vOpacity );","    ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","    vec3 totalEmissiveRadiance = emissive;","    #include <logdepthbuf_fragment>","    #include <map_fragment>","    #include <color_fragment>","    #include <alphamap_fragment>","    #include <alphatest_fragment>","    #include <specularmap_fragment>","    #include <normal_fragment_begin>","    #include <normal_fragment_maps>","    #include <emissivemap_fragment>","    #include <lights_lambert_fragment>","    #include <lights_fragment_begin>","    #include <lights_fragment_maps>","    #include <lights_fragment_end>","    #include <aomap_fragment>","    vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;","    #include <envmap_fragment>","    gl_FragColor = vec4( outgoingLight, diffuseColor.a );","    #include <tonemapping_fragment>","    #include <encodings_fragment>","    #include <fog_fragment>","    #include <premultiplied_alpha_fragment>","    #include <dithering_fragment>","}"].join("\n");this.VERTEX_SHADER=["uniform bool isSizeInDevice;","uniform vec3 inversePlotScale;","attribute vec3 aPointCenter;","attribute float aPointSize;","attribute vec4 aPointColor;","attribute float aVisible;","varying float vOpacity;","varying float vVisible;","#define LAMBERT","varying vec3 vViewPosition;","#include <common>","#include <uv_pars_vertex>","#include <displacementmap_pars_vertex>","#include <envmap_pars_vertex>","varying vec3 vColor;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>","void main() {","    #include <uv_vertex>","    #include <color_vertex>","    vec3 geometryPositions = position;","    vColor = aPointColor.rgb;","    vOpacity = aPointColor.a;","    vVisible = aVisible;","    #include <beginnormal_vertex>","    #include <morphnormal_vertex>","    #include <skinbase_vertex>","    #include <skinnormal_vertex>","    objectNormal /= inversePlotScale;","    #include <defaultnormal_vertex>","    #include <normal_vertex>","    #include <begin_vertex>","    #include <morphtarget_vertex>","    #include <skinning_vertex>","    #include <displacementmap_vertex>","    #include <project_vertex>","    float shaderPointSize = aPointSize;","    if(isSizeInDevice){","        vec4 projectedPoint = projectionMatrix * modelViewMatrix * vec4( (aPointCenter), 1.0 );","        shaderPointSize *= "+s.chA_+" * projectedPoint.w;","    }","    vec4 tmpPosition = vec4(inversePlotScale * geometryPositions * shaderPointSize + aPointCenter, 1.);","    mvPosition = modelViewMatrix * tmpPosition;","    gl_Position = projectionMatrix * mvPosition;","    #include <logdepthbuf_vertex>","    #include <clipping_planes_vertex>","    vViewPosition = - mvPosition.xyz;","    #include <worldpos_vertex>","    #include <envmap_vertex>","    #include <shadowmap_vertex>","    #include <fog_vertex>","}"].join("\n");this.IhA_={};this.vertexColors=!0;this.side=i;this.fhA_=new h(!1);this.ChA_=new h(new a(1,1,1));this.onBeforeCompile=t=>{t.vertexShader=this.VERTEX_SHADER;t.fragmentShader=this.FRAGMENT_SHADER;t.uniforms["isSizeInDevice"]=this.fhA_;t.uniforms["inversePlotScale"]=this.ChA_;this.IhA_=qi(t.uniforms,this.IhA_)};this.Kis_={transparent:!1,sizeindevice:!1,opacity:1};this.setOptions(t)}setOptions(t){t||(t={});this.Kis_=qi(t,this.Kis_);this.userData.ntA_=!this.Kis_["transparent"];this.userData.i_e_=this.Kis_["transparent"];this.opacity=this.Kis_["opacity"];this.fhA_.value=this.Kis_["sizeindevice"]}dhA_(t){this.ChA_.value=t}JV_(){return qi(this.Kis_,{})}XXe_(){return this.VERTEX_SHADER}ZXe_(){return this.FRAGMENT_SHADER}z5e_(){return this.IhA_}};e.chA_=.001115;e=s=t([_s("geotoolkit3d.scene.pointset.PointsetMaterial")],e);return e}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRJbnZlcnNlUGxvdFNjYWxlIjoiZGhBXyJ9fSwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");$Lt.yZe_(fVt.D_(),IKt);const CVt=[],dVt={},BVt=t=>{if(dVt[t]==null){const i=new pt(1,Math.max(t*1.5,3),Math.max(t,2));dVt[t]=i;CVt.push(i)}return dVt[t]},wVt={},QVt=t=>{if(wVt[t]==null){const i=new ii(1,Math.max(Math.floor(t/3),0));wVt[t]=i;CVt.push(i)}return wVt[t]};let EVt=null;const pVt=()=>{if(EVt==null){EVt=new mt(1,1,1,1,1,1);CVt.push(EVt)}return EVt};let mVt=null;const yVt=()=>{if(mVt==null){mVt=new yt(1,1,4,1);mVt.rotateX(Math.PI/2);CVt.push(mVt)}return mVt},DVt=t=>t&&t.length!=null;var MVt=Ci(function(){var t=class{static get Sphere(){return this.BhA_}static get whA_(){return this.QhA_}static get EhA_(){return this.phA_}static get mhA_(){return this.yhA_}};t.BhA_=BVt;t.QhA_=QVt;t.phA_=pVt;t.yhA_=yVt;return t}(),2,"eyJJY29zYWhlZHJvbiI6IndoQV8iLCJDdWJlIjoiRWhBXyIsIlB5cmFtaWQiOiJtaEFfIn0g");const vVt="POINT",bVt=new A,NVt=new A,SVt=(t,i)=>{t.setAttribute("position",i["attributes"]["position"]);t.getAttribute("position").needsUpdate=!0;t.setAttribute("normal",i["attributes"]["normal"]);t.getAttribute("normal").needsUpdate=!0;t.setAttribute("uv",i["attributes"]["uv"]);t.getAttribute("uv").needsUpdate=!0;t["index"]=i["index"];i["index"]!=null&&(i["index"].needsUpdate=!0)};var GVt=function(){let i=class t extends W{constructor(t,i){super(t,i);this.frustumCulled=!1;this.name=vVt}zje_(){return this.parent.zje_()}};i=t([_s(null)],i);return i}(),RVt=Ci(function(){var i;let s=i=class t extends fUt{constructor(t){super();if(!(t["data"]&&DVt(t["data"]["x"])&&DVt(t["data"]["y"])&&DVt(t["data"]["z"]))){ki("options['data'] is not defined or complete, cannot create PointSet without point data!");return}const i=qi(t,{opacity:1,colorprovider:"red",symbol:MVt.Sphere,symbolminsize:1,symbolmaxsize:6,symbolsizeisindevice:!1,inverseplot:!0});i["precision"]==null&&(i["symbolsizeisindevice"]===!0?i["precision"]=i["symbolmaxsize"]+1:i["precision"]=10);this.DhA_=0;this.MhA_=1;this.vhA_=null;this.bhA_=null;this.ylt_=new A(1,0,0,1);this.NhA_=new a(1,1,1);this.ShA_=new a(1,1,1);this.pi_=null;this.Zui_={Joi_:null,GhA_:null,colors:null,visible:null,index:null};this.RhA_=null;this.khA_=null;this.FhA_=null;this.xhA_=null;this.LhA_=!1;this.C3e_=i["symbolminsize"];this.d3e_=i["symbolmaxsize"];this.UhA_=i["precision"];this.c3e_=i["colorprovider"];this.Rb_=i["opacity"];this.YhA_=!1;this.ThA_=i["symbolsizeisindevice"];this.KhA_=i["inverseplot"];this.HhA_=null;this.qhA_=null;this.qd_=null;this.x9e_=new fVt;this.DIt_=null;this.JhA_=-1;this.PhA_=new u;this.VhA_=!0;this.OhA_=!0;this.m$_=new C;this.WhA_=new C;this.setOptions(i)}setOptions(t){let s=!1,e=!1,A=!1,n=!1,h=!1,r=!1;if(t["data"]!=null){if(t["data"]["x"]!=null&&t["data"]["y"]!=null&&t["data"]["z"]!=null){s=!0;if(t["data"]["x"].length!==this.DhA_){e=!0;A=!0;r=!0;this.DhA_=t["data"]["x"].length}}if(t["data"]["values"]!=null){this.pi_=DVt(t["data"]["values"])?Float32Array.from(t["data"]["values"]):t["data"]["values"];e=!0}if(t["data"]["sizes"]!=null){this.MhA_=DVt(t["data"]["sizes"])?Float32Array.from(t["data"]["sizes"]):t["data"]["sizes"];A=!0}t["data"]["visible"]!=null&&(n=!0);if(t["data"]["sizemin"]!=null){this.vhA_=t["data"]["sizemin"];A=!0}if(t["data"]["sizemax"]!=null){this.bhA_=t["data"]["sizemax"];A=!0}}if(t["colorprovider"]){this.c3e_=t["colorprovider"];e=!0}if(t["symbolminsize"]!=null&&this.C3e_!==t["symbolminsize"]){this.C3e_=t["symbolminsize"];A=!0}if(t["symbolmaxsize"]!=null&&this.d3e_!==t["symbolmaxsize"]){this.d3e_=t["symbolmaxsize"];A=!0;this.OhA_=!0}if(t["symbol"]!=null){let s=t["symbol"];typeof s!="function"&&(s=i.zhA_(s));if(s!==this.DIt_){this.DIt_=s;h=!0}}if(t["precision"]!=null&&this.UhA_!==t["precision"]){this.UhA_=t["precision"];this.DIt_!==MVt.Sphere&&this.DIt_!==MVt.whA_||(h=!0)}h&&this.vW_();!r&&this.XhA_()||this.jhA_();e&&this.ZhA_();s&&this.A$_(t["data"]["x"],t["data"]["y"],t["data"]["z"]);A&&this._hA_();n&&this.b5t_(t["data"]["visible"]==null||t["data"]["visible"]);if(this.qhA_&&(s||A||n||r)){const t=this.JhA_;this.JhA_=-1;this.X8e_(t)}t["opacity"]!=null&&(this.Rb_=t["opacity"]);this.LhA_=this.YhA_||this.Rb_<1;t["symbolsizeisindevice"]!=null&&(this.ThA_=t["symbolsizeisindevice"]);const o={transparent:this.LhA_,sizeindevice:this.ThA_,opacity:this.Rb_};this.x9e_.setOptions(o);if(!this.HhA_){this.HhA_=new GVt(this.qd_,this.x9e_);this.clear();this.add(this.HhA_)}this.invalidateObject();if(s||A||n||r){this.$hA_();this.trA_()}return this}XhA_(){for(const t in this.Zui_)if(this.Zui_[t]==null)return!1;return!0}jhA_(){this.qd_.instanceCount=this.DhA_;this.Zui_.colors=new Float32Array(this.DhA_*4);this.khA_=new si(this.Zui_.colors,4);this.qd_.setAttribute("aPointColor",this.khA_);this.Zui_.Joi_=new Float32Array(this.DhA_*3);this.RhA_=new si(this.Zui_.Joi_,3);this.qd_.setAttribute("aPointCenter",this.RhA_);this.Zui_.GhA_=new Float32Array(this.DhA_);this.FhA_=new si(this.Zui_.GhA_,1);this.qd_.setAttribute("aPointSize",this.FhA_);this.Zui_.visible=new Float32Array(this.DhA_).fill(1);this.xhA_=new si(this.Zui_.visible,1);this.qd_.setAttribute("aVisible",this.xhA_);this.Zui_.index=new Float32Array(this.DhA_);this.irA_=new si(this.Zui_.index,1);this.qd_.setAttribute("cgpointindex",this.irA_);for(let t=0;t<this.DhA_;t++)this.Zui_.index[t]=t/this.DhA_;this.irA_.needsUpdate=!0}setColor(t,i){const s=t*4;if(i!=null&&Number.isFinite(i)&&this.c3e_ instanceof Mo){const t=this.c3e_.getColor(i);bVt.set(t.Is_(),t.Cs_(),t.fs_(),t.ds_());bVt.divideScalar(255)}else bVt.copy(this.ylt_);bVt.w<.9&&(this.YhA_=!0);this.Zui_.colors[s]=bVt.x;this.Zui_.colors[s+1]=bVt.y;this.Zui_.colors[s+2]=bVt.z;this.Zui_.colors[s+3]=bVt.w}ZhA_(){this.YhA_=!1;const t=DVt(this.pi_)&&this.DhA_===this.pi_.length,i=this.c3e_ instanceof Mo,s=!t&&Number.isFinite(this.pi_)?this.pi_:0;if(this.c3e_ instanceof l){const t=this.c3e_;this.ylt_.set(t.r,t.g,t.b,1)}else{let t;t=i?this.c3e_.getColor(s):RA.cs_(this.c3e_);this.ylt_.set(t.Is_(),t.Cs_(),t.fs_(),t.ds_());this.ylt_.divideScalar(255)}this.ylt_.w<1&&(this.YhA_=!0);for(let s=0;s<this.DhA_;s++)t&&i?this.setColor(s,this.pi_[s]):this.setColor(s,null);this.khA_.needsUpdate=!0}A$_(t,i,s){for(let e=0;e<this.DhA_;e++){const A=e*3;this.Zui_.Joi_[A]=t[e];this.Zui_.Joi_[A+1]=i[e];this.Zui_.Joi_[A+2]=s[e]}this.VhA_=!0;this.RhA_.needsUpdate=!0}_hA_(){const t=DVt(this.MhA_)?this.MhA_:[this.MhA_];if(this.vhA_==null||this.bhA_==null){this.vhA_==null&&(this.vhA_=Number.POSITIVE_INFINITY);this.bhA_==null&&(this.bhA_=Number.NEGATIVE_INFINITY);for(let i=0;i<t.length;i++)if(!isNaN(t[i])){this.vhA_=Math.min(this.vhA_,t[i]);this.bhA_=Math.max(this.bhA_,t[i])}}const i=kxt.y4s_(t,0,1,this.vhA_,this.bhA_),s=kxt.y4s_(i,this.C3e_,this.d3e_),e=s.length===this.DhA_;let A;for(A=0;A<this.DhA_;A++)this.Zui_.GhA_[A]=e?s[A]:s[0];this.FhA_.needsUpdate=!0}vW_(){const t=this.DIt_(this.UhA_);this.qd_=this.qd_||new H;SVt(this.qd_,t);this.qhA_&&SVt(this.qhA_.geometry,t);CVt.includes(t)||t.dispose()}b5t_(t){let i=t===!0||t===!1||DVt(t)&&t.length===1,s=DVt(t)?t[0]:t,e;if(!(i||DVt(t)&&t.length===this.DhA_)){i=!0;s=!0;ki("Invalid argument: Option 'data.visible' must be either a simple boolean, "+"or a boolean array of size equal to number of points.")}if(i){t=[];for(e=0;e<this.DhA_;e++)t[e]=s}for(e=0;e<this.DhA_;e++)this.Zui_.visible[e]=+t[e];this.xhA_.needsUpdate=!0}JV_(){const t={opacity:this.Rb_,colorprovider:this.c3e_,symbolminsize:this.C3e_,symbolmaxsize:this.d3e_};return Pi(t,super.JV_())}B3e_(t,i){if(!this.ofs_(t))return this;if(i["visible"]!=null){this.Zui_.visible[t]=+i["visible"];this.xhA_.needsUpdate=!0}if(i["size"]!=null){if(!DVt(this.MhA_)){const t=this.MhA_;this.MhA_=new Float32Array(this.DhA_).fill(t)}this.MhA_[t]=i["size"];let s;if(this.vhA_===this.bhA_||this.d3e_===this.C3e_)s=(this.d3e_+this.C3e_)/2;else{s=(i["size"]-this.vhA_)/(this.bhA_-this.vhA_);s=this.C3e_+(this.d3e_-this.C3e_)*s}this.Zui_.GhA_[t]=s;this.FhA_.needsUpdate=!0}if(i["value"]!=null){DVt(this.pi_)||(this.pi_=new Float32Array(this.DhA_).fill(this.pi_));this.pi_[t]=i["value"];this.setColor(t,i["value"]);this.khA_.needsUpdate=!0}return this}Z5e_(t){if(!this.ofs_(t))return null;const i=t*3,s=this.Zui_.Joi_;let e=1;this.pi_&&(e=DVt(this.pi_)?this.pi_[t]:this.pi_);return{visible:!!this.Zui_.visible[t],size:DVt(this.MhA_)?this.MhA_[t]:this.MhA_,value:e,position:[s[i],s[i+1],s[i+2]]}}beforeRender(t,i,s,e){super.beforeRender(t,i,s,e);if(this.visible){if(this.KhA_){const t=s.GZe_().scale;if(!this.ShA_.equals(t)){this.ShA_.copy(t);this.NhA_.set(1,1,1).divide(t);this.x9e_.dhA_(this.NhA_)}}if(this.qhA_&&this.qhA_.visible){const t=this.qhA_.userData.srA_;this.qhA_.scale.set(t,t,t);this.KhA_&&this.qhA_.scale.multiply(this.NhA_);if(this.ThA_){const t=this.qhA_.position;NVt.set(t.x,t.y,t.z,1);NVt.applyMatrix4(this.matrixWorld);NVt.applyMatrix4(i.matrixWorldInverse);NVt.applyMatrix4(i.projectionMatrix);const s=fVt.chA_*NVt.w;this.qhA_.scale.multiplyScalar(s)}}this.VhA_&&this.$hA_();if(this.VhA_||this.OhA_||!this.matrixWorld.equals(this.PhA_)){this.trA_();this.PhA_.copy(this.matrixWorld);this.VhA_=!1;this.OhA_=!1}}}erA_(){return this.qhA_}X8e_(t){if(!this.qhA_){const t=new z;SVt(t,this.DIt_(this.UhA_));this.qhA_=new W(t);this.qhA_.material.opacity=0;this.qhA_.visible=!1;this.add(this.qhA_)}if(!this.ofs_(t)){this.qhA_.visible=!1;this.JhA_=-1;return}if(t===this.JhA_)return;const i=this.Z5e_(t),s=this.Zui_.GhA_[t];this.qhA_.position.set(i["position"][0],i["position"][1],i["position"][2]);this.qhA_.scale.set(s,s,s);this.qhA_.userData.srA_=s;this.qhA_.visible=i["visible"];this.JhA_=t}trA_(){this.m$_.copy(this.WhA_);this.localToWorld(this.m$_.min);this.localToWorld(this.m$_.max);this.m$_.min.subScalar(this.d3e_);this.m$_.max.addScalar(this.d3e_);this.qd_.boundingBox||(this.qd_.boundingBox=new C);this.qd_.boundingBox.copy(this.m$_)}$hA_(){const t=this.WhA_.makeEmpty(),i=this.Zui_.Joi_;for(let s=0;s<this.DhA_;s++){const e=s*3,A=i[e],n=i[e+1],h=i[e+2];t.min.x=Math.min(t.min.x,A);t.min.y=Math.min(t.min.y,n);t.min.z=Math.min(t.min.z,h);t.max.x=Math.max(t.max.x,A);t.max.y=Math.max(t.max.y,n);t.max.z=Math.max(t.max.z,h)}}zje_(){return this.m$_}dispose(){this.qd_=null;this.HhA_&&fLt.dispose(this.HhA_);this.HhA_=null;if(this.qhA_){this.qhA_["geometry"]=null;fLt.dispose(this.qhA_)}this.qhA_=null;this.MhA_=null;this.pi_=null;this.Zui_.Joi_=null;this.Zui_.GhA_=null;this.Zui_.colors=null;this.Zui_.visible=null;this.c3e_=null;this.clear();super.dispose()}static zhA_(t){const i=MVt,s=KYt,e=undefined;switch(t.name||"default"){case s.cube.name:case s.fr_.name:return i.EhA_;case s.$5e_.name:return i.mhA_;case s.i3e_.name:case s.t3e_.name:case s._5e_.name:case s.Afi_.name:default:return i.Sphere}}ofs_(t){return Number.isFinite(t)&&t>=0&&t<this.DhA_}};s=i=t([_s("geotoolkit3d.scene.pointset.PointSet")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwic2V0UG9pbnRPcHRpb25zIjoiQjNlXyIsImdldFBvaW50T3B0aW9ucyI6Ilo1ZV8iLCJoaWdodGxpZ2h0U2hhcGUiOiJYOGVfIiwiZ2V0V29ybGRCb3VuZGluZ0JveCI6InpqZV8iLCJpc1ZhbGlkSW5kZXgiOiJvZnNfIn19fSAg");GHt.IO_().QtA_(RVt.D_(),(t=>t.erA_()));var kVt=Ci(function(){var i;let s=i=class t{constructor(t){const i=Pi(t,{majorstep:100,minorincrement:3});this.xDe_=null;this.mOe_=i["majorstep"];this.ArA_=i["minorincrement"]}setOptions(t){if(t==null)return this;t["contour"]&&(this.xDe_=t["contour"]);t["majorstep"]&&this.FOe_(t["majorstep"]);t["minorincrement"]&&this.nrA_(t["minorincrement"]);return this}JV_(){return{contour:this.xDe_,majorstep:this.mOe_,minorincrement:this.ArA_}}dt_(t){return this.setOptions(t)}N_(){return this.JV_()}FOe_(t){this.mOe_=t;return this}nrA_(t){this.ArA_=t;return this}equals(t){if(t==null||!(t instanceof i))return!1;const s=t.JV_();return s["majorstep"]===this.mOe_&&s["minorincrement"]===this.ArA_}stringify(){const t=this.JV_();return JSON.stringify(t)}clone(){const t=this.JV_();return new i({majorstep:t["majorstep"],minorincrement:t["minorincrement"]})}};s=i=t([_s("geotoolkit3d.scene.surface.contour.MajorMinorStrategy")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwic2V0UHJvcGVydGllcyI6ImR0XyIsImdldFByb3BlcnRpZXMiOiJOXyIsInNldE1ham9yU3RlcCI6IkZPZV8iLCJzZXRNaW5vckluY3JlbWVudCI6Im5yQV8ifX0sImdldENsYXNzTmFtZSI6IkRfIn0g");const FVt=t=>{if(t===0)return"0";let i=0;const s=Math.log10(Math.abs(t));s<0?i=2:s<1&&(i=1);t=Math.abs(t);const e=Math.pow(10,i);return(Math.round(t*e)/e).toString()},xVt=new a(1,0,0),LVt=new a(0,1,0),UVt=new a(0,0,1),YVt=.001,TVt=1.25,KVt=new l(0),HVt=new u,qVt=new g,JVt=new a,PVt=new a,VVt=new a,OVt=new a,WVt=new B,zVt=new a,XVt=new xA,jVt=new a,ZVt=new a,_Vt=new a;var $Vt=Ci(function(){var s;let A=s=class t extends DKt{constructor(t){super();if(!t["data"]||!t["data"]["surface"])throw new Error("Contour has no Data, parameter options.data.surface is mandatory");Object.assign(this,{type:"Contour"});let s=null;if(t["data"]["values"]!=null){s=t["data"]["values"];t["data"]["values"]=null}t["label"]!=null&&t["label"]["formatter"]!=null&&ki("Contour options.label.formatter is deprecated since 4.0, please use options.label.labelformatter instead.");this.Kis_=Pi(t,{opacity:1,surface:{enabled:!0},isoline:{useglline:!1,count:10,majorminorstrategy:new kVt,major:{visible:!0,color:"black",width:2},minor:{visible:!0,color:"darkgrey",width:1}},label:{major:{visible:!1,style:new qa({font:"10px Arial",color:"rgba(0, 0, 0, 1.0)"})},minor:{visible:!1,style:new qa({font:"10px Arial",color:"rgba(0, 0, 0, 1.0)"})},labelmaxglobalvisibleangle:70*Math.PI/180,labelmaxverticalvisibleangle:15*Math.PI/180,labelmaxverticalrotationangle:60*Math.PI/180,labelformatter:FVt,density:2}});if(s!=null){this.Kis_["data"]["values"]=s;t["data"]["values"]=s}const A=t["data"]["surface"].Uui_();this.hrA_=this.rrA_(A["zmin"]);this.orA_=this.rrA_(A["zmax"],!0);if(typeof this.Kis_["colorprovider"]=="string"){const t=this.Kis_["colorprovider"];this.Kis_["color"]=new l(t);this.Kis_["opacity"]=nA.cs_(t).ds_()/255;this.Kis_["colorprovider"]=null}else if(this.Kis_["colorprovider"]instanceof l){this.Kis_["color"]=this.Kis_["colorprovider"];this.Kis_["colorprovider"]=null}else if(this.Kis_["colorprovider"]instanceof bo&&this.Kis_["data"]["values"]==null&&A["values"]==null){const t=A["position"],i=t.count,s=new Float32Array(i);for(let e=0;e<i;e++)s[e]=t.getZ(e);this.Kis_["data"]["values"]=s;this.Kis_["colorprovider"].Hm_(A["zmin"],A["zmax"])}this.Kis_["label"]["density"]=NA.clamp(this.Kis_["label"]["density"],1,5);this.U9e_=new W(new aTt(this.Kis_),new UTt(this.Kis_));this.add(this.U9e_);this.lrA_=[];this.urA_=[];this.qz_=new a;this.Lc_=this.U9e_.geometry.boundingBox.clone();this.Lc_.getCenter(this.qz_);this.arA_=new M;this.grA_=new y;this.crA_=new F;this.crA_.depthTest=!0;this.crA_.depthWrite=!0;this.crA_.colorWrite=!1;this.crA_.transparent=!1;this.crA_.side=e;this.IrA_=new W(this.U9e_.geometry,this.crA_);this.grA_.add(this.IrA_);this.grA_.matrixAutoUpdate=!1;this.arA_.add(this.grA_);this.frA_=new y;this.CrA_=new Rt(1,1,{minFilter:j,magFilter:j,format:ei,depthBuffer:!0});this.drA_=new F;this.drA_.depthTest=!0;this.drA_.depthWrite=!1;this.drA_.transparent=!0;this.drA_.side=i;this.BrA_=new bt(2*TVt,2*TVt);this.arA_.add(this.frA_);this.wrA_=this.Kis_["isoline"]["count"]||10;this.QrA_=this.Kis_["isoline"]["useglline"];this.Tbt_=null;this.ErA_=!1;this.prA_=null;this.mrA_=null;this.yrA_=null;this.DrA_=null;this.MrA_=null;this.vrA_=null;this.brA_=new y;this.NrA_=new y;this.add(this.brA_);this.add(this.NrA_);this.geA_=!1;this.SrA_=null;this.GrA_=null;this.RrA_=new y;this.krA_=new y;this.RrA_.renderOrder=1;this.krA_.renderOrder=1;this.FrA_=null;this.xrA_=null;this.LrA_=null;this.UrA_=null;this.YrA_=!1;this.TrA_=!1;this.KrA_=this.Kis_["label"]["labelmaxglobalvisibleangle"];this.HrA_=this.Kis_["label"]["labelmaxverticalvisibleangle"];this.qrA_=this.Kis_["label"]["labelmaxverticalrotationangle"];this.add(this.RrA_);this.add(this.krA_);this.JrA_=new a;this.$nA_=new a;this.thA_=new u;this.PrA_=new l;this.VrA_=1;this.OrA_=0;delete this.Kis_["data"]["values"];this.setOptions(this.Kis_);this.Kis_["data"]["surface"]=null;this.name="CONTOUR"}setOptions(t){if(t==null)return this;super.setOptions(t);let i=!1,s=!1,e=!1,A=!1,n=!1;if(typeof t["colorprovider"]=="string"){const i=t["colorprovider"];t["color"]=new l(i);t["opacity"]=nA.cs_(i).ds_()/255;t["colorprovider"]=null}else if(t["colorprovider"]instanceof l){t["color"]=t["colorprovider"];t["colorprovider"]=null}if(t.hasOwnProperty("surface")){this.WrA_=t["surface"]["enabled"];this.U9e_.visible=this.WrA_}if(t.hasOwnProperty("isoline")){const e=t["isoline"];if(e.hasOwnProperty("useglline")&&e["useglline"]!==this.QrA_){this.QrA_=e["useglline"];i=s=!0}if(e.hasOwnProperty("zmin")&&e["zmin"]!==this.hrA_){this.hrA_=e["zmin"];n=!0}if(e.hasOwnProperty("zmax")&&e["zmax"]!==this.orA_){this.orA_=e["zmax"];n=!0}const A=this.ErA_;if(e.hasOwnProperty("majorminorstrategy")){const t=e["majorminorstrategy"];if(t instanceof kVt&&!t.equals(this.Tbt_)){this.Tbt_=t;this.ErA_=!0;n=!0}else if(t===null){this.Tbt_=null;this.ErA_=!1}}if(e.hasOwnProperty("count")&&this.wrA_!==e["count"]){this.wrA_=e["count"];this.ErA_||(n=!0)}A!==this.ErA_&&(n=!0);n&&(i=s=!0);(i||s)&&this.zrA_();if(e.hasOwnProperty("major")){const t=e["major"];if(t["width"]&&t["width"]!==this.prA_){this.prA_=t["width"];i=!0}if(t["color"]&&(this.yrA_==null||!new l(t["color"]).equals(this.yrA_))){this.yrA_=new l(t["color"]);i=!0}if(t["visible"]!=null&&t["visible"]!==this.MrA_){this.MrA_=t["visible"];i=!0}}if(e.hasOwnProperty("minor")){const t=e["minor"];if(t["width"]&&t["width"]!==this.mrA_){this.mrA_=t["width"];s=!0}if(t["color"]&&(this.DrA_==null||!new l(t["color"]).equals(this.DrA_))){this.DrA_=new l(t["color"]);s=!0}if(t["visible"]!=null&&t["visible"]!==this.vrA_){this.vrA_=t["visible"];s=!0}}}if(t.hasOwnProperty("label")){if(t["label"]["formatter"]!==this.Kis_["label"]["formatter"]){ki("Contour options.label.formatter is deprecated since 4.0, please use options.label.labelformatter instead.");e=A=!0}t["label"]["labelformatter"]!==this.Kis_["label"]["labelformatter"]&&(e=A=!0);if(t["label"]["density"]!==this.SrA_){this.SrA_=t["label"]["density"];e=A=!0}if(t["label"]["major"]!=null){const i=t["label"]["major"];if(i["visible"]!=null&&i["visible"]!==this.FrA_){this.FrA_=i["visible"];e=!0}if(i["style"]!=null&&i["style"]!==this.LrA_){e=!0;this.LrA_=i["style"];this.jVt_(lTt.B4e_)}}if(t["label"]["minor"]){const i=t["label"]["minor"];if(i["visible"]!=null&&i["visible"]!==this.xrA_){this.xrA_=i["visible"];A=!0}if(i["style"]!=null&&i["style"]!==this.UrA_){A=!0;this.UrA_=i["style"];this.jVt_(lTt.w4e_)}}if(t["label"]["labelmaxglobalvisibleangle"]!=null){this.KrA_=t["label"]["labelmaxglobalvisibleangle"];this.TrA_=!0}if(t["label"]["labelmaxverticalvisibleangle"]!=null){this.HrA_=t["label"]["labelmaxverticalvisibleangle"];this.TrA_=!0}if(t["label"]["labelmaxverticalrotationangle"]!=null){this.qrA_=t["label"]["labelmaxverticalrotationangle"];this.TrA_=!0}}if((i||s||this.GrA_==null)&&(this.FrA_||this.xrA_)){this.XrA_();e=A=!0}this.U9e_.material.setOptions(t);this.U9e_.geometry.setOptions(t);const h=t;h["data"]&&h["data"]["surface"]&&(h["data"]["surface"]=null);this.Kis_=Pi(t,this.Kis_);i&&this.jrA_(lTt.B4e_);s&&this.jrA_(lTt.w4e_);e&&this.ZrA_(lTt.B4e_);A&&this.ZrA_(lTt.w4e_);this.invalidateObject();return this}JV_(){const t=this.U9e_.material.JV_(),i=this.U9e_.geometry.JV_(),s={isoline:{useglline:this.QrA_,count:this.wrA_,zmin:this.hrA_,zmax:this.orA_,minor:{width:this.mrA_,visible:this.vrA_,color:this.DrA_},major:{width:this.prA_,visible:this.MrA_,color:this.yrA_},majorminorstrategy:this._rA_()},label:this.Kis_["label"],surface:this.Kis_["surface"]},e=[{name:"zmin",value:this.hrA_,alt:"Use isoline.zmin instead."},{name:"zmax",value:this.orA_,alt:"Use isoline.zmax instead."}];let A=Pi(super.JV_(),s);A=Pi(A,t);A=Pi(A,i);t["data"]!=null&&i["data"]!=null&&(A["data"]=qi(t["data"],i["data"]));A=Rs(A,e,"Contour.getOptions");return A}getData(){return this.U9e_.geometry.getData()}setData(t){this.U9e_.geometry.setData(t);return this}dt_(t){return this.setOptions(t)}N_(){return this.JV_()}$rA_(t,i){const s=t["userData"].toA_-this.qrA_,e=t["userData"].toA_+this.qrA_;_Vt.copy(t.position);this.localToWorld(_Vt);_Vt.negate().add(i);OVt.copy(_Vt);OVt.projectOnPlane(t["userData"].ioA_);JVt.copy(t["userData"].soA_);JVt.z=0;let A=this.eoA_(OVt,JVt);if(A+this.HrA_<s||A-this.HrA_>e){t.visible=!1;return}A<s&&(A=s);A>e&&(A=e);const n=Math.abs(A);n<YVt&&(A=YVt);n>Math.PI-YVt&&(A=Math.PI-YVt);OVt.copy(UVt);WVt.setFromAxisAngle(LVt,A);OVt.applyQuaternion(WVt);WVt.setFromAxisAngle(UVt,t["userData"].AoA_);OVt.applyQuaternion(WVt);const h=undefined;_Vt.angleTo(OVt)>this.KrA_?t.visible=!1:t.setOptions({normal:OVt})}noA_(t,i,s,e){this.frA_.clear();let A;for(A=0;A<t.length;A++){const i=t[A];if(!i.visible)continue;i["userData"].hoA_||(i["userData"].hoA_=new W(this.BrA_,this.drA_));e&&i.AhA_();const s=i.nhA_();i["userData"].hoA_.position.copy(s.getCenter());i["userData"].hoA_.scale.copy(s.SnA_());HVt.setFromMatrix3(s.GnA_());i["userData"].hoA_.rotation.setFromRotationMatrix(HVt);this.frA_.add(i["userData"].hoA_)}this.grA_.matrix.copy(this.matrixWorld);s.getSize(qVt);qVt.divideScalar(2);this.CrA_.setSize(qVt.x,qVt.y);s.setRenderTarget(this.CrA_);s.getClearColor(this.PrA_);s.setClearColor(KVt);s.clearColor();s.render(this.arA_,i);s.setRenderTarget(null);s.setClearColor(this.PrA_)}beforeRender(t,i,e,A){super.beforeRender(t,i,e,A);let n=!0;const h=this.roA_();if(this.VrA_!==this.scale.z||this.OrA_!==h||!this.geA_){this.VrA_=this.scale.z;this.OrA_=h;this.geA_=!0;this.zrA_(!0);this.jrA_(lTt.B4e_);this.jrA_(lTt.w4e_);this.ZrA_(lTt.B4e_);this.ZrA_(lTt.w4e_);this.TrA_=!0}if(!this.$nA_.equals(i.position)||!this.thA_.equals(i.projectionMatrix)){this.$nA_.copy(i.position);this.thA_.copy(i.projectionMatrix);this.TrA_=!0}const r=this.RrA_.children.concat(this.krA_.children);VVt.setFromMatrixScale(this.matrixWorld);if(this.YrA_||!VVt.equals(this.JrA_)){this.JrA_.copy(VVt);this.ooA_(r,VVt);this.TrA_=!0}if(this.TrA_){this.TrA_=!1;i.getWorldPosition(PVt);for(let t=0;t<r.length;t++){r[t].visible=!0;this.$rA_(r[t],PVt);r[t].visible&&r[t].computeBoundingBox()}n=!1;s.hZe_(t,i,r)}if(this.YrA_){this.YrA_=!1;this.TrA_=!0}this.noA_(r,i,A,n);return this}zrA_(t){let i=0,s=0,e=t===!0;const A=this.hrA_,n=this.orA_;if(this.Tbt_!=null||this.ErA_){const t=this.Tbt_.JV_(),h=t["majorstep"],r=t["minorincrement"],o=h/r,l=Math.ceil(A/h)*h,u=Math.floor(n/h)*h,a=undefined;for(let t=l-o;t>=A;t-=o){e||(e=t!==this.urA_[i]);this.urA_[i]=t;i++}const g=r-1;for(let t=l;t<=u;t+=h){e||(e=t!==this.lrA_[s]);this.lrA_[s]=t;s++;if(t+h<=u){let s=t;for(let t=1;t<=g;t++){s+=o;e||(e=s!==this.urA_[i]);this.urA_[i]=s;i++}}}const c=undefined;for(let t=u+o;t<=n;t+=o){e||(e=t!==this.urA_[i]);this.urA_[i]=t;i++}this.wrA_=s+i}else{const t=(n-A)/(this.wrA_-1);let i=A;for(let A=0;A<this.wrA_;A++){e||(e=i!==this.lrA_[s]);this.lrA_[s]=i;s++;i+=t}}e||(e=s!==this.lrA_.length||i!==this.urA_.length);if(e){for(let t=s;t<this.lrA_.length;t++)delete this.lrA_[t];this.lrA_.length=s;for(let t=i;t<this.urA_.length;t++)delete this.urA_[t];this.urA_.length=i;const t=this.roA_();this.U9e_.geometry.D4e_(this.lrA_,this.urA_,this.scale.z,t)}}jrA_(t){let i,s,e,A;if(t===lTt.B4e_){A=this.brA_;i=this.yrA_;s=this.prA_;e=this.MrA_}else{A=this.NrA_;i=this.DrA_;s=this.mrA_;e=this.vrA_}A.children=[];if(!e)return;const n=this.U9e_.geometry.R4e_(),h=[];for(let i=0;i<n.length;i++){const s=n[i];if(s.length===0||s.type!==t)continue;const e=s.N4e_;for(let t=0;t<e.length;t++){const i=e[t][3],s=e[t][4];i!=null&&s!=null&&h.push(i[0],i[1],i[2],s[0],s[1],s[2])}}let r;if(this.QrA_){const t=new z;t.setAttribute("position",new V(h,3));const e=new Y({color:i,linewidth:s});r=new Ct(t,e)}else{r=new cUt({data:{positions:h},color:i,linewidth:s,polygonoffset:!0,polygonoffsetfactor:1,selectable:!1});r.h_e_(this.CrA_.texture)}A.add(r)}ZrA_(t){if(!this.geA_||t==null)return;this.loA_(t);if(t===lTt.B4e_&&!this.FrA_)return;if(t===lTt.w4e_&&!this.xrA_)return;const s=this.U9e_.geometry.R4e_(),e=Math.pow(this.Kis_["label"]["density"],5);VVt.setFromMatrixScale(this.matrixWorld);const A=(new a).copy(this.U9e_.geometry.boundingBox.min).multiply(VVt),n=(new a).copy(this.U9e_.geometry.boundingBox.max).multiply(VVt),h=undefined,r=Math.min(n.x-A.x,n.y-A.y)/(e*3),o=s.map((t=>t.length)),l=Math.max.apply(null,o);let u,g;if(t===lTt.B4e_){g=this.Kis_["label"]["major"];u=this.RrA_}else if(t===lTt.w4e_){g=this.Kis_["label"]["minor"];u=this.krA_}const c=Pi(g,{canvas:null,origin:null,zmin:this.hrA_,zmax:this.orA_,renderside:i}),I=this.Kis_["label"]["labelformatter"],f=this.Kis_["label"]["formatter"];for(let i=0;i<s.length;i++){const A=s[i],n=undefined;if(t!==A.type)continue;const h=o[i],g=Math.floor(h/l*e),C=A.N4e_;if(C.length===0)continue;const d=undefined;let B=0;const w=h/g*.33,Q=[],E=this.GrA_[i];let p=null,m=null;const y=A.G4e_;let D;D=f!=null?f(y,1):I(y);for(let t=0,i=0;t<C.length&&i<g;t++){const s=C[t];if(s[1][2]<0){s[1][0]*=-1;s[1][1]*=-1;s[1][2]*=-1}const e=undefined,A=p==null;B+=s[2];if(B>=w){if(A){c["canvas"]=E;c["origin"]=s[0];c["normal"]=s[1];p=new XPt(c);m=p.getBoundingSphere().clone();m.radius*=r}else m["center"].fromArray(s[0]);let t=!1;for(let i=0;i<Q.length;i++)if(Q[i].intersectsSphere(m)){t=!0;break}if(!t&&p!=null){p.a_(D);A||p.setOptions({origin:s[0],normal:s[1]});p["userData"].soA_=(new a).fromArray(s[1]);JVt.copy(p["userData"].soA_);JVt.z=0;JVt.normalize();p["userData"].AoA_=xVt.angleTo(JVt);JVt.crossVectors(xVt,JVt);JVt.z<0&&(p["userData"].AoA_*=-1);p["userData"].ioA_=new a(s[4][0]-s[3][0],s[4][1]-s[3][1],s[4][2]-s[3][2]).normalize();p.setOptions({freeorientation:!0,facingoffset:1});i++;Q.push(m);u.add(p);p=null;m=null}}}p&&p.dispose()}this.YrA_=!0;this.TrA_=!0}roA_(){let t=this.position.z;this.traverseAncestors((i=>{t+=i.position.z}));return t}jVt_(t){if(!this.geA_||t==null)return;if(t===lTt.B4e_&&!this.FrA_)return;if(t===lTt.w4e_&&!this.xrA_)return;let i,s=[];if(t===lTt.B4e_){i=this.LrA_;s=this.RrA_.children}else if(t===lTt.w4e_){i=this.UrA_;s=this.krA_.children}for(let t=0;t<s.length;t++)s[t].setOptions({style:i});this.TrA_=!0}static uoA_(t,i,s){const e=s.userData["plot"].getSize(XVt);for(let s=0;s<t.length;s++){const A=t[s];if(!A.visible)continue;A["userData"].aoA_||(A["userData"].aoA_={goA_:new g});const n=A["userData"].aoA_,h=A.nhA_(),r=h.SnA_(),o=h.getCenter(),l=h.GnA_(),u=r.y,a=r.x*2,c=Math.ceil(a/(u*2)),I=a/c,f=I/u;zVt.set(u-a/2,0,0);if(!n.coA_||n.coA_.length!==c){n.coA_=[];for(let t=0;t<c;t++)n.coA_.push(new g)}for(let t=0;t<c;t++){jVt.copy(zVt).applyMatrix3(l).add(o);fLt.sZe_(jVt,i,e,jVt);n.coA_[t].set(jVt.x,jVt.y);zVt.x+=I}const C=o.clone();JVt.copy(r).applyMatrix3(l).add(o);fLt.sZe_(C,i,e,C);fLt.sZe_(JVt,i,e,JVt);C.z=0;JVt.z=0;const d=C.distanceTo(JVt);let B=d;if(c>2){const t=undefined;B=n.coA_[0].distanceTo(n.coA_[1])/f}n.goA_.set(C.x,C.y);n.IoA_=d;n.foA_=B}}static hZe_(t,i,e){if(t.userData["plot"]==null)return;this.CoA_(i,e);e.sort(((t,i)=>t["userData"].doA_-i["userData"].doA_));s.uoA_(e,i,t);const A=[];for(let t=0;t<e.length;t++){const i=e[t];if(!i.visible||i.parent==null)continue;if(A.length===0){A.push(i);continue}let s=!1;for(let t=0;t<A.length;t++){const e=A[t];if(this.BoA_(i,e)){s=!0;i.visible=!1;break}}s||A.push(i)}}XrA_(){this.GrA_=[];const t=this.lrA_.length+this.urA_.length;for(let i=0;i<t;i++){const t=Ls(0,0,!0);this.GrA_.push(t)}}dispose(){this.Kis_=null;this.GrA_=null;this.loA_();this.CrA_&&this.CrA_.dispose();this.drA_.dispose();this.BrA_.dispose();fLt.dispose(this.frA_);fLt.dispose(this.brA_);fLt.dispose(this.NrA_);fLt.dispose(this.U9e_);super.dispose()}loA_(t){if(t===lTt.B4e_||t==null){this.RrA_.children.forEach((t=>{t.dispose()}));this.RrA_.children=[]}if(t===lTt.w4e_||t==null){this.krA_.children.forEach((t=>{t.dispose()}));this.krA_.children=[]}}_rA_(){return this.Tbt_!=null?this.Tbt_.clone():this.Tbt_}woA_(){ki(`@int/geotoolkit3d/scene/surface/contour/Contour.getElevations is deprecated since 4.0,\n            use getMinElevations/getMajElevations instead.`);const t=[];let i=0,s=0;const e=this.lrA_.length,A=undefined,n=e+this.urA_.length;for(let A=0;A<n;A++)if(i<e&&this.lrA_[i]<=this.urA_[s]){t.push({major:this.lrA_[i]});i++}else{t.push({minor:this.urA_[s]});s++}return t}QoA_(){return this.lrA_}EoA_(){return this.urA_}poA_(){return this.wrA_}a9e_(){return this.U9e_}u_e_(){return!1}a_e_(){return[this.U9e_]}rrA_(t,i){i=i||!1;const s=Math.abs(Math.floor(t)).toString().length,e=s>2?Math.pow(10,s-2):1;let A=Math.floor(t/e)*e;if(!i)return A;while(A<t)A+=e;return A}eoA_(t,i){let s=UVt.angleTo(t);i.dot(t)<0&&(s*=-1);return s}ooA_(t,i){for(let s=0;s<t.length;s++){const e=t[s];ZVt.copy(e["userData"].soA_);ZVt.divide(i).normalize();JVt.copy(e["userData"].soA_);JVt.z=0;e["userData"].toA_=this.eoA_(ZVt,JVt)}}static CoA_(t,i){for(let s=0;s<i.length;s++){const e=i[s];JVt.copy(e.position);e.parent.localToWorld(JVt);JVt.sub(t.position);e["userData"].doA_=JVt.length()}}static BoA_(t,i){const s=t["userData"].aoA_,e=i["userData"].aoA_;if(s.goA_.distanceTo(e.goA_)>s.IoA_+e.IoA_)return!1;const A=s.foA_+e.foA_;for(let t=0;t<s.coA_.length;t++)for(let i=0;i<e.coA_.length;i++)if(s.coA_[t].distanceTo(e.coA_[i])<A)return!0;return!1}};A=s=t([_s("geotoolkit3d.scene.surface.contour.Contour")],A);return A}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwic2V0UHJvcGVydGllcyI6ImR0XyIsImdldFByb3BlcnRpZXMiOiJOXyIsImdldE1ham9yTWlub3JTdHJhdGVneSI6Il9yQV8iLCJnZXRFbGV2YXRpb25zIjoid29BXyIsImdldE1hakVsZXZhdGlvbnMiOiJRb0FfIiwiZ2V0TWluRWxldmF0aW9ucyI6IkVvQV8iLCJnZXRMaW5lQ291bnQiOiJwb0FfIn19fSAg");GHt.IO_().QtA_($Vt.D_(),(t=>t.a9e_()));var tOt=function(){let i=class t extends XPt{constructor(t){ki("ContourLabel is deprecated since 4.0, please use geotoolkit3d/scene/label/Label instead.");const i=Pi(t,{formatter:(t,i)=>Math.floor(Math.abs(t*i)/10)*10+"",surfacescale:new a(1,1,1)});super(i);this.ZF_=i["formatter"];this.moA_=i["surfacescale"];i.hasOwnProperty("text")?this.a_(i["text"]+""):this.a_(this.ZF_(this.onA_.z,this.moA_.z));this.name="contourlabel"}setOptions(t){let i=!1;if((t=t||{})["formatter"]!=null){this.ZF_=t["formatter"];i=!0}super.setOptions(t);if(t["surfacescale"]!=null){this.moA_=t["surfacescale"];this.a_(this.ZF_(this.onA_.z,this.moA_.z)+"");i=!0}i&&this.kls_();return this}};i=t([_s("geotoolkit3d.scene.surface.contour.ContourLabel")],i);return i}();const iOt=new a,sOt=new a,eOt=new a,AOt=new a;var nOt=Ci(function(){var i;let s=i=class t{constructor(t,i,s){this.onA_=t||new a;this.E1_=i||new a(0,1,0);this.yoA_=s||0}set(t,i){this.onA_.copy(t);this.E1_.copy(i);return this}clone(){return(new i).copy(this)}copy(t){this.onA_.copy(t.qj_());this.E1_.copy(t.oc_());return this}at(t,i){i==null&&(i=new a);return i.copy(this.E1_).multiplyScalar(t).add(this.onA_)}intersectTriangle(t,i,s,e,A,n){n==null&&(n=new a);iOt.subVectors(i,t);sOt.subVectors(s,t);eOt.crossVectors(iOt,sOt);n.copy(eOt);let h=this.E1_.dot(eOt),r;if(h>0){if(e)return null;r=1}else{if(!(h<0))return null;r=-1;h=-h}AOt.subVectors(this.onA_,t);const o=r*this.E1_.dot(sOt.crossVectors(AOt,sOt));if(o<0)return null;const l=r*this.E1_.dot(iOt.cross(AOt));if(l<0)return null;if(o+l>h)return null;const u=-r*AOt.dot(eOt);return u<0?null:this.at(u/h,A)}qj_(){return this.onA_}oc_(){return this.E1_}DoA_(){return this.yoA_}};s=i=t([_s("geotoolkit3d.scene.surface.contour.Ray")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcmlnaW4iOiJxal8iLCJnZXREaXJlY3Rpb24iOiJvY18iLCJnZXRDb250b3VyTGV2ZWwiOiJEb0FfIn19LCJnZXRDbGFzc05hbWUiOiJEXyJ9");var hOt=function(){let i=class t extends UTt{constructor(t){super(t);this.type="FaultMaterial";this.transparent=!0;this.polygonOffset=!0;this.polygonOffsetFactor=.1}};i=t([_s("geotoolkit3d.scene.surface.fault.FaultMaterial")],i);return i}();$Lt.yZe_(hOt.D_(),yLt);var rOt=Ci(function(){let i=class t extends DKt{constructor(t){super();Object.assign(this,{type:"Fault"});const i=qi(t,{colorprovider:"#bbdefb",opacity:1,fault:!0,lines:!0,points:!0,linescolor:["red","orange","blue","yellow","cyan","brown","grey","white"],pointscolor:["red","orange","blue","yellow","cyan","brown","grey","white"]});if(i["data"]==null||i["data"]["surface"]==null)throw new Error("Fault has no data");typeof i["colorprovider"]=="string"&&(i["colorprovider"]=new l(i["colorprovider"]));if(i["colorprovider"]instanceof l){i["color"]=i["colorprovider"];i["colorprovider"]=null}if(i["data"]["surface"].b8e_().length>1){this.U9e_=new W(new aTt(i),new hOt(i));this.add(this.U9e_)}this.Gz_=new fUt;this.add(this.Gz_);this.XO_=new fUt;this.add(this.XO_);const s=i["data"]["surface"];this.MoA_=null;this.voA_=null;this.position.copy(s.B$_());this.setOptions(i);const A=this.MoA_.Ww_(),n=this.voA_.Ww_();s.b8e_().forEach(((t,i)=>{for(let s=0;s<t["x"].length;s++){const A=new W(new mt(10,10,10),new F({side:e,color:n[i%n.length].ys_()}));A.position.set(t["x"][s],t["y"][s],t["z"][s]);A.userData.index=i;this.Gz_.add(A)}const s=t;s["line"]=!0;this.XO_.add(new cUt({data:s,color:A[i%A.length].ys_(),polygonoffset:!0}));delete s["line"]}))}setOptions(t){if(t==null)return this;super.setOptions(t);if(this.U9e_!=null){this.U9e_.material.setOptions(t);t.hasOwnProperty("fault")&&(this.U9e_.visible=t["fault"])}t.hasOwnProperty("lines")&&(this.XO_.visible=t["lines"]);t.hasOwnProperty("points")&&(this.Gz_.visible=t["points"]);if(t.hasOwnProperty("linescolor")){this.MoA_=this.Swt_(t["linescolor"]);if(this.XO_["children"].length>0){const t=this.MoA_.Ww_();this.XO_["children"].forEach(((i,s)=>{i.setOptions({color:new l(t[s%t.length].ys_())})}));this.XO_.invalidateObject()}}if(t.hasOwnProperty("pointscolor")){this.voA_=this.Swt_(t["pointscolor"]);if(this.Gz_["children"].length>0){const t=this.voA_.Ww_();this.Gz_["children"].forEach((i=>{i["material"]["color"].set(t[i["userData"]["index"]%t.length].ys_())}));this.Gz_.invalidateObject()}}return this}JV_(){return Pi(Pi(this.U9e_!=null?this.U9e_.material.JV_():null,{fault:this.U9e_!=null?this.U9e_.visible:null,lines:this.XO_.visible,points:this.Gz_.visible,linescolor:this.MoA_,pointscolor:this.voA_}),super.JV_())}u_e_(){return!0}a_e_(){return this.U9e_!=null?[this.U9e_]:[]}Swt_(t){if(ys(t,Mo))return t;let i;i=Array.isArray(t)?t:[t];const s=[],e=[],A=i.length;for(let t=0;t<A;t++){s.push(t);e.push(i[t]instanceof l?i[t].getHexString():i[t])}return new No(s,e,A)}};i=t([_s("geotoolkit3d.scene.surface.fault.Fault")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");const oOt=new a,lOt=new g,uOt=new g,aOt=new Ai,gOt=new u,cOt=new C,IOt=new a,fOt=new a;var COt=Ci(function(){let i=class t extends DKt{constructor(t){super();Object.assign(this,{type:"Surface"});const i=qi(t,{maxlod:10,minlod:0,extent:fLt.lZe_(),maplimits:fLt.lZe_(),opacity:1,maximumrequests:10,tilewidth:256,tileheight:256});if(!i["data"]["surface"])throw new Error("Surface has no Data");const s=i["data"]["surface"].Uui_();if(typeof i["colorprovider"]=="string"){i["color"]=new l(i["colorprovider"]);i["colorprovider"]=null}else if(i["colorprovider"]instanceof l){i["color"]=i["colorprovider"];i["colorprovider"]=null}else if(i["colorprovider"]instanceof bo&&i["texture"]==null&&i["data"]["values"]==null&&s["values"]==null&&i["geometry"]==null){const t=[],e=s["position"],A=e.count;for(let i=0;i<A;i++)t.push(e.getZ(i));i["data"]["values"]=t;i["colorprovider"].Hm_(s["zmin"],s["zmax"])}const e=i["data"]["surface"].n8e_()["material"],A=i["data"]["surface"].n8e_()["geometry"];this.U9e_=new W(new A(i),new e(i));this.add(this.U9e_);this.boA_=(new a).copy(this.scale);this.NoA_=this.SoA_(this.boA_);this.a8i_=new At;this.a8i_.crossOrigin="Anonymous";this._z=-1;this.uH_={};this.ess_=[];this.GoA_=0;this.RoA_={};this.E4e_=s["nullvalue"];this.hrA_=s["zmin"];this.orA_=s["zmax"];delete i["data"]["values"];this.setOptions(i);this.name="SURFACE"}setOptions(t){if(t==null)return this;super.setOptions(t);const i=qi(t,{});if(typeof i["colorprovider"]=="string"){i["color"]=new l(i["colorprovider"]);i["colorprovider"]=null}else if(i["colorprovider"]instanceof l){i["color"]=i["colorprovider"];i["colorprovider"]=null}if(t["maplimits"]!=null&&t["extent"]!=null){this.koA_=t["maplimits"];let i=new g;this.koA_.getCenter(i);const s=new g;i=i.sub(t["extent"].getCenter(s));const e=new g,A=new g;this.koA_.getSize(e);t["extent"].getSize(A);this.scale.set(e.x/A.x,e.y/A.y,1);this.position.set(i.x*this.scale.x,i.y*this.scale.y,0)}let s=!1;if(t["extent"]!=null&&t["extent"]!==this.FoA_){this.FoA_=t["extent"];s=!0}if(t["maxlod"]!=null&&t["maxlod"]!==this.Wtt_){this.Wtt_=t["maxlod"];s=!0}if(t["minlod"]!=null&&t["minlod"]!==this.Ott_){this.Ott_=t["minlod"];s=!0}if(t["geometry"]!=null&&!Bs(t["geometry"],this.RoA_["geometry"])){this.RoA_["geometry"]=qi(t["geometry"],this.RoA_["geometry"]);s=!0}if(t["material"]!=null&&!Bs(t["material"],this.RoA_["material"])){this.RoA_["material"]=qi(t["material"],this.RoA_["material"]);s=!0}if(t["tilewidth"]!=null&&t["tilewidth"]!==this.CK_){this.CK_=t["tilewidth"];s=!0}if(t["tileheight"]!=null&&t["tileheight"]!==this.dK_){this.dK_=t["tileheight"];s=!0}s&&this.clear();this.xoA_=t["maximumrequests"]||this.xoA_;this.U9e_.material.setOptions(i);this.U9e_.geometry.setOptions(i);this.invalidateObject();return this}JV_(){const t=this.U9e_.material.JV_(),i=this.U9e_.geometry.JV_();let s=Pi(super.JV_(),{maplimits:this.koA_,extent:this.FoA_,maxlod:this.Wtt_,minlod:this.Ott_,geometry:this.RoA_["geometry"],material:this.RoA_["material"],tilewidth:this.CK_,tileheight:this.dK_,maximumrequests:this.xoA_,nullvalue:this.E4e_,zmin:this.hrA_,zmax:this.orA_});s=Pi(s,t);s=Pi(s,i);t["data"]!=null&&i["data"]!=null&&(s["data"]=qi(t["data"],i["data"]));return s}getData(){return this.U9e_.geometry.getData()}setData(t){this.U9e_.geometry.setData(t);return this}SoA_(t){let i=0;t.x<0&&i++;t.y<0&&i++;t.z<0&&i++;return i%2}vW_(){const t=this.U9e_.geometry.index,i=Math.trunc(t.count/2),s=t.count-1;for(let e=0;e<i;e++){const i=s-e,A=t.getX(e),n=t.getX(i);t.setX(i,A);t.setX(e,n)}t.needsUpdate=!0}clear(){for(const t in this.uH_)delete this.uH_[t];this.ess_.length=0;return this}d8e_(t){if(!Ds(this.RoA_)){const i=Math.abs(this.U9e_.geometry.boundingBox.distanceToPoint(t.position));this.U9e_.geometry.boundingBox.getSize(oOt);let s=Math.ceil(Math.max(oOt.x,oOt.y)/i);s=NA.clamp(s,this.Ott_,this.Wtt_);this._z!==s&&this.clear();this._z=s;this.koA_.getSize(lOt);this.FoA_.getSize(uOt);const e=lOt.x/Math.pow(2,s),A=lOt.y/Math.pow(2,s),n=Math.floor((this.FoA_.min.x-this.koA_.min.x)/e),h=Math.ceil((this.FoA_.max.x-this.koA_.min.x)/e),r=Math.floor((this.FoA_.min.y-this.koA_.min.y)/A),o=Math.ceil((this.FoA_.max.y-this.koA_.min.y)/A),l=e*oOt.x/(this.CK_*uOt.x),u=A*oOt.y/(this.dK_*uOt.y),a=(Math.floor((this.FoA_.min.x-this.koA_.min.x)/e)*e+this.koA_.min.x-this.FoA_.min.x)*oOt.x/uOt.x,g=(Math.floor((this.FoA_.min.y-this.koA_.min.y)/A)*A+this.koA_.min.y-this.FoA_.min.y)*oOt.y/uOt.y;t.updateMatrix();t.updateMatrixWorld();aOt.setFromProjectionMatrix(gOt.identity().multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse));for(let t=n;t<h;t++)for(let i=r;i<o;i++)if(!this.uH_[t+"x"+i]){IOt.set(this.U9e_.geometry.boundingBox.min.x+a+this.CK_*l*(t-n),this.U9e_.geometry.boundingBox.min.y+g+this.dK_*u*(i-r),this.U9e_.geometry.boundingBox.min.z);fOt.set(this.U9e_.geometry.boundingBox.min.x+a+this.CK_*l*(t-n+1),this.U9e_.geometry.boundingBox.min.y+g+this.dK_*u*(i-r+1),this.U9e_.geometry.boundingBox.max.z);cOt.set(IOt,fOt);if(aOt.intersectsBox(this.U9e_.geometry.boundingBox)){for(const e in this.RoA_)this.RoA_.hasOwnProperty(e)&&this.RoA_[e]["server"]&&this.RoA_[e]["formatterfunction"]&&this.ess_.push({url:this.RoA_[e]["server"]+this.RoA_[e]["formatterfunction"](s,i,t),offsetX:a+this.CK_*l*(t-n),offsetY:g+this.dK_*u*(i-r),q8_:l,J8_:u,LoA_:e});this.uH_[t+"x"+i]=!0}}this.UoA_()}}UoA_(){while(this.ess_.length>0&&this.GoA_<this.xoA_){const t=this.ess_.shift();this.YoA_(t.url,t.offsetX,t.offsetY,t.q8_,t.J8_,t.LoA_);this.GoA_++}}a9e_(){return this.U9e_}YoA_(t,i,s,e,A,n){this.a8i_.load(t,(t=>{if(this.U9e_.material!=null){this.U9e_.material.d8e_(t,i,s,e,A,n);t.dispose();this.GoA_--;this.invalidateObject();this.UoA_()}else t.dispose()}))}beforeRender(t,i,s,e){super.beforeRender(t,i,s,e);this.d8e_(i);if(!this.boA_.equals(this.scale)){const t=this.SoA_(this.scale);t!==this.NoA_&&this.vW_();this.boA_.copy(this.scale);this.NoA_=t}return this}u_e_(){return!(this.U9e_.geometry instanceof JTt)}a_e_(){return this.u_e_()?[this.U9e_]:[]}dispose(){super.dispose();this.U9e_!=null&&this.U9e_.geometry!=null&&this.U9e_.geometry.dispose();this.U9e_=null;this.RoA_=null;this.a8i_=null;this.uH_=null}};i=t([_s("geotoolkit3d.scene.surface.Surface")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");var dOt=Ci(function(){let i=class t extends lr{constructor(t){super(t,new nr({id:function(t){return t.id},uuid:function(t){return t.uuid},name:function(t){return t.name},class:function(t){return typeof t.D_=="function"?t.D_():t instanceof dt?"THREE.Line":t instanceof wt?"THREE.Points":t instanceof E?"THREE.Sprite":t instanceof W?"THREE.Mesh":t instanceof m?"THREE.Object3D":null},visible:function(t){return t.visible}}))}bB_(t,i){const s=t;for(let t=0;t<s.children.length;t++)i(s.children[t],t,s,this)}};i=t([_s("geotoolkit3d.selection.NodeQueryBuilder")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJlbnVtZXJhdGVOb2RlcyI6ImJCXyJ9fX0g");const BOt=t=>new dOt(t);var wOt=Ci({Hmt_:"selected",Mk_:"movestart",agt_:"move",End:"moveend"},2,"eyJTZWxlY3RlZCI6IkhtdF8iLCJTdGFydCI6Ik1rXyIsIk1vdmUiOiJhZ3RfIn0g"),QOt=Ci(function(){let i=class t extends vFt{constructor(t){const i=undefined;super(qi(t,{name:"AbstractMoveTool",enabled:!0,pickenabled:!0,armingkey:17}));this.JUe_=[];this.xmt_=null}setOptions(t){const i=qi(t,{plot:this.E8_,enabled:this.xv_,pickenabled:this.ToA_,object:t["object"]!==void 0?null:this.xmt_});this.xmt_!==i["object"]&&this.KoA_(wOt.Hmt_,i["object"],null);this.xmt_=i["object"];this.xv_=i["enabled"];this.ToA_=i["pickenabled"];super.setOptions(i);return this}JV_(){const t=super.JV_();t["object"]=this.xmt_;t["enabled"]=this.xv_;t["pickenabled"]=this.ToA_;return t}pOt_(t){this.xv_&&this.ToA_&&this.pO_(t)}KoA_(t,i,s){for(let e=0;e<this.JUe_.length;e++)this.JUe_[e](t,i,s)}HoA_(t){this.JUe_.indexOf(t)===-1&&this.JUe_.push(t);return this}qoA_(t){const i=this.JUe_.indexOf(t);i!==-1&&this.JUe_.splice(i,1);return this}Nze_(t){this.eXe_&&t["keyCode"]===this.Pze_&&this.KoA_(wOt.End,this.xmt_,null)}Lze_(t){if(this.xv_){this.xmt_==null&&this.pOt_(t);this.xmt_!=null&&(this.JoA_=this.xmt_.position.clone());this.KoA_(wOt.Mk_,this.xmt_,null)}}aWt_(t){this.xv_&&(this.xmt_!=null?this.move(t,wOt.agt_):this.KoA_(wOt.agt_,this.xmt_,null))}Uze_(t){if(this.xv_)if(this.xmt_!=null){this.move(t,wOt.End);this.ToA_&&this.setOptions({object:null})}else this.KoA_(wOt.End,this.xmt_,null)}Gze_(t){return $i()}Sze_(t){return $i()}vze_(t){return $i()}bze_(t){return $i()}Rze_(t){return $i()}jFt_(t){return $i()}kze_(t){return $i()}Fze_(t){return $i()}xze_(t){return $i()}Yze_(t){return $i()}Tze_(t){return $i()}Kze_(t){return $i()}Hze_(t){return $i()}qze_(t){return $i()}dispose(){this.JUe_=null;this.xmt_=null;super.dispose()}};i=t([_s("geotoolkit3d.tool.AbstractMoveTool")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwib25QaWNrIjoicE90XyIsImFkZE1vdmVMaXN0ZW5lciI6IkhvQV8iLCJyZW1vdmVTZWxlY3Rpb25MaXN0ZW5lciI6InFvQV8iLCJvbktleUVuZCI6Ik56ZV8iLCJvbkRyYWdTdGFydCI6Ikx6ZV8iLCJvbkRyYWciOiJhV3RfIiwib25EcmFnRW5kIjoiVXplXyIsIm9uVGFwIjoiR3plXyIsIm9uQ3Vyc29yTW92ZSI6IlN6ZV8iLCJvbktleVN0YXJ0IjoidnplXyIsIm9uS2V5IjoiYnplXyIsIm9uRG91YmxlVGFwIjoiUnplXyIsIm9uTW91c2VXaGVlbCI6ImpGdF8iLCJvblBpbmNoU3RhcnQiOiJremVfIiwib25QaW5jaCI6IkZ6ZV8iLCJvblBpbmNoRW5kIjoieHplXyIsIm9uU2xpZGVTdGFydCI6Ill6ZV8iLCJvblNsaWRlIjoiVHplXyIsIm9uU2xpZGVFbmQiOiJLemVfIiwib25WaXNpYmlsaXR5R2FpbmVkIjoiSHplXyIsIm9uVmlzaWJpbGl0eUxvc3QiOiJxemVfIn19fSAg");const EOt=new C(new a(-1/0,-1/0,-1/0),new a(1/0,1/0,1/0));var pOt=Ci(function(){let i=class t extends fUt{constructor(){super();this.KC_(!1)}zje_(){return EOt}};i.prototype.PoA_=Zi;i=t([_s("geotoolkit3d.tool.cursor.AbstractCursor")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRDdXJzb3JQb3NpdGlvbiI6IlBvQV8ifX19");var mOt=Ci(function(){let i=class t extends pOt{constructor(t){super();const i=qi(t,{});for(let t=0;t<i["cursors"].length;t++)this.add(i["cursors"][t])}PoA_(t){for(let i=0;i<this.children.length;i++)this.children[i].PoA_(t);return this}};i=t([_s("geotoolkit3d.tool.cursor.CompositeCursor")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRDdXJzb3JQb3NpdGlvbiI6IlBvQV8ifX19");var yOt=Ci(function(){let i=class t extends pOt{constructor(t){super();const i=qi(t,{linestyle:new hl({color:"red"}),cursorsize:5}),s=new z;s.setAttribute("position",new ut(new Float32Array([-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1,0,0,1]),3));s.setIndex(new ut(new Uint32Array([0,1,2,3,4,5]),1));this.add(new Ct(s,null));this.setOptions(i)}PoA_(t){this.position.copy(t);this.invalidateObject();return this}setOptions(t){if(t==null)return this;super.setOptions(t);const i=this.children[0];if(i==null)return this;const s=qi(t,{cursorsize:i.userData.VoA_,linestyle:i.material!=null?i.material.userData.Jvt_:null});i.material=NYt.F5e_(s["linestyle"]);i.userData.VoA_=s["cursorsize"];this.invalidateObject();return this}JV_(){const t={},i=this.children[0];if(i!=null){i.material!=null&&(t["linestyle"]=i.material.userData.Jvt_);t["cursorsize"]=i.userData.VoA_}return Pi(t,super.JV_())}beforeRender(t,i,s,e){super.beforeRender(t,i,s,e);if(this.visible){for(let t=0;t<this.children.length;t++){const i=this.children[t];i.scale.set(i.userData.VoA_,i.userData.VoA_,i.userData.VoA_)}fLt.Pje_(this,i,t)}}};i=t([_s("geotoolkit3d.tool.cursor.CrossCursor")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRDdXJzb3JQb3NpdGlvbiI6IlBvQV8iLCJnZXRPcHRpb25zIjoiSlZfIn19fSAg");const DOt=(t,i,s)=>{const e=new a;s.getCenter(e);const A=new a;s.getSize(A);t[0].position.copy(e);t[0].children[0].position.set(0,-A.y/2,i.z-e.z);t[0].children[1].position.set(i.x-e.x,-A.y/2,0);t[1].position.copy(e);t[1].children[0].position.set(0,A.y/2,i.z-e.z);t[1].children[1].position.set(i.x-e.x,A.y/2,0);t[2].position.copy(e);t[2].children[0].position.set(-A.x/2,0,i.z-e.z);t[2].children[1].position.set(-A.x/2,i.y-e.y,0);t[3].position.copy(e);t[3].children[0].position.set(A.x/2,0,i.z-e.z);t[3].children[1].position.set(A.x/2,i.y-e.y,0);t[4].position.copy(e);t[4].children[1].position.set(i.x-e.x,0,-A.z/2);t[4].children[0].position.set(0,i.y-e.y,-A.z/2);t[5].position.copy(e);t[5].children[1].position.set(i.x-e.x,0,A.z/2);t[5].children[0].position.set(0,i.y-e.y,A.z/2)};var MOt=Ci(function(){var i;let s=i=class t extends pOt{constructor(t){super();const s=qi(t,{limits:null,linestyle:new hl({color:"red"}),mode:LJt.back});this.add(i.OoA_("front",[-.5,0,0,.5,0,0],[0,0,-.5,0,0,.5]));this.add(i.OoA_("back",[-.5,0,0,.5,0,0],[0,0,-.5,0,0,.5]));this.add(i.OoA_("left",[0,-.5,0,0,.5,0],[0,0,-.5,0,0,.5]));this.add(i.OoA_("right",[0,-.5,0,0,.5,0],[0,0,-.5,0,0,.5]));this.add(i.OoA_("bottom",[-.5,0,0,.5,0,0],[0,-.5,0,0,.5,0]));this.add(i.OoA_("top",[-.5,0,0,.5,0,0],[0,-.5,0,0,.5,0]));this.setOptions(s)}static OoA_(t,s,e){const A=new fUt;A.userData.plane=t;A.add(i.WoA_(s));A.add(i.WoA_(e));return A}static WoA_(t){const i=new z;i.setAttribute("position",new ut(new Float32Array(t),3));i.setIndex(new ut(new Uint32Array([0,1]),1));return new Ct(i,null)}PoA_(t){DOt(this.children,t,this.WH_);this.invalidateObject();return this}setOptions(t){if(t==null)return this;super.setOptions(t);const i=this.children[0].children[0];if(i==null)return this;const s=qi(t,{limits:this.WH_,cursorsize:i.userData.VoA_,linestyle:i.material!=null?i.material.userData.Jvt_:null,mode:this.mode});this.mode=s["mode"];this.WH_=s["limits"];for(let i=0;i<this.children.length;i++)for(let e=0;e<this.children[i].children.length;e++){this.WH_.getSize(this.children[i].children[e].scale);t["linestyle"]!=null&&(this.children[i].children[e].material=NYt.F5e_(s["linestyle"]))}this.invalidateObject();return this}JV_(){const t=this.children[0].children[0],i={};i["mode"]=this.mode;i["limits"]=this.WH_;t!=null&&t.material!=null&&(i["linestyle"]=t.material.userData.Jvt_);return Pi(i,super.JV_())}beforeRender(t,i,s,e){super.beforeRender(t,i,s,e);if(!this.visible)return this;for(let s=0;s<this.children.length;s++){this.children[s].scale.copy(this.children[s].children[0].scale);this.children[s].updateMatrixWorld();this.children[s].visible=this.mode(this.children[s],t,i);this.children[s].scale.set(1,1,1);this.children[s].updateMatrixWorld()}return this}};s=i=t([_s("geotoolkit3d.tool.cursor.CrossHair2DCursor")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRDdXJzb3JQb3NpdGlvbiI6IlBvQV8iLCJnZXRPcHRpb25zIjoiSlZfIn19fSAg");const vOt=(t,i)=>{t[0].position.set(t[0].position.x,i.y,i.z);t[1].position.set(i.x,t[1].position.y,i.z);t[2].position.set(i.x,i.y,t[2].position.z)};var bOt=Ci(function(){var i;let s=i=class t extends pOt{constructor(t){super();const s=qi(t,{visiblelinestyle:new hl({color:"red"}),hiddenlinestyle:new hl({color:"rgba(255,0,0,0.99)",pattern:el.Dot})});this.zoA_=t["hiddenlinestyle"]!==!1;this.XoA_=new fUt;this.add(this.XoA_);this.XoA_.add(i.WoA_([-.5,0,0,.5,0,0]));this.XoA_.add(i.WoA_([0,-.5,0,0,.5,0]));this.XoA_.add(i.WoA_([0,0,-.5,0,0,.5]));this.setOptions(s)}static WoA_(t){const i=new z;i.setAttribute("position",new ut(new Float32Array(t),3));i.setIndex(new ut(new Uint32Array([0,1]),1));return new Ct(i,null)}PoA_(t){vOt(this.XoA_.children,t);this.invalidateObject();return this}setOptions(t){if(t==null)return this;super.setOptions(t);const i=this.XoA_.children[0];if(i==null)return this;const s=qi(t,{limits:this.WH_,visiblelinestyle:i.material!=null?i.material.userData.Jvt_:null});this.WH_=s["limits"];this.zoA_=t["hiddenlinestyle"]!==!1;const e=this.zoA_?s["hiddenlinestyle"]:s["visiblelinestyle"];for(let t=0;t<this.XoA_.children.length;t++){const i=this.XoA_.children[t];this.WH_.getSize(i.scale);this.WH_.getCenter(i.position);if(e!=null){i.material=NYt.F5e_(e);i.renderOrder=this.zoA_?1:0;i.material.depthTest=!this.zoA_}}this.invalidateObject();return this}JV_(){const t=this.XoA_.children[0],i={};i["limits"]=this.WH_;this.zoA_&&t&&t.material&&(i["hiddenlinestyle"]=t.material.userData.Jvt_);t&&t.material&&(i["visiblelinestyle"]=t.material.userData.Jvt_);return Pi(i,super.JV_())}};s=i=t([_s("geotoolkit3d.tool.cursor.CrossHairCursor")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRDdXJzb3JQb3NpdGlvbiI6IlBvQV8iLCJnZXRPcHRpb25zIjoiSlZfIn19fSAg");var NOt=Ci(function(){let i=class t extends vFt{constructor(t){const i=qi(t,{name:"CursorTool",enabled:!0,cursor:new yOt,picking:$Lt});super(i);this.JUe_=[];this.PiA_=i["picking"]}setOptions(t){const i=qi(t,{enabled:this.xv_,cursor:this.aFi_,picking:this.PiA_});this.xv_=i["enabled"];if(i["cursor"]!==this.aFi_){fLt.dispose(this.aFi_);this.aFi_=i["cursor"]}this.aFi_.visible=this.xv_;this.PiA_=i["picking"];super.setOptions(i);return this}JV_(){const t=super.JV_();t["enabled"]=this.xv_;t["cursor"]=this.aFi_;t["picking"]=this.PiA_;return t}joA_(t){this.aFi_.visible=t!=null;this.aFi_.parent==null&&this.E8_.getRoot().add(this.aFi_);t!=null&&this.aFi_.PoA_(t);this.aFi_.invalidateObject()}KoA_(t,i){for(let s=0;s<this.JUe_.length;s++)this.JUe_[s](t,i);if(this.E8_!=null&&this.aFi_!=null){const t=i.length!==0?i[0]["point"]:null;this.joA_(t)}}HoA_(t){this.JUe_.indexOf(t)===-1&&this.JUe_.push(t);return this}ZoA_(t){const i=this.JUe_.indexOf(t);i!==-1&&this.JUe_.splice(i,1);return this}Nze_(t){this.eXe_&&t.keyCode===this.Pze_&&this.KoA_(t,[])}Gze_(t){if(!this.xv_)return;const i=this.PiA_.pO_(this.E8_,t["plotX"],t["plotY"],this.Xz_,this.Xz_);this.KoA_(t,i)}Sze_(t){if(!this.xv_)return;const i=this.PiA_.pO_(this.E8_,t["plotX"],t["plotY"],this.Xz_,this.Xz_);this.KoA_(t,i)}Lze_(t){return $i()}aWt_(t){return $i()}Uze_(t){return $i()}vze_(t){return $i()}bze_(t){return $i()}Rze_(t){return $i()}jFt_(t){return $i()}kze_(t){return $i()}Fze_(t){return $i()}xze_(t){return $i()}Yze_(t){return $i()}Tze_(t){return $i()}Kze_(t){return $i()}Hze_(t){return $i()}qze_(t){return $i()}dispose(){this.JUe_=null;super.dispose()}_oA_(){return this.aFi_}};i=t([_s("geotoolkit3d.tool.cursor.CursorTool")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwibW92ZUN1cnNvciI6ImpvQV8iLCJhZGRNb3ZlTGlzdGVuZXIiOiJIb0FfIiwicmVtb3ZlTW92ZUxpc3RlbmVyIjoiWm9BXyIsIm9uS2V5RW5kIjoiTnplXyIsIm9uVGFwIjoiR3plXyIsIm9uQ3Vyc29yTW92ZSI6IlN6ZV8iLCJvbkRyYWdTdGFydCI6Ikx6ZV8iLCJvbkRyYWciOiJhV3RfIiwib25EcmFnRW5kIjoiVXplXyIsIm9uS2V5U3RhcnQiOiJ2emVfIiwib25LZXkiOiJiemVfIiwib25Eb3VibGVUYXAiOiJSemVfIiwib25Nb3VzZVdoZWVsIjoiakZ0XyIsIm9uUGluY2hTdGFydCI6Imt6ZV8iLCJvblBpbmNoIjoiRnplXyIsIm9uUGluY2hFbmQiOiJ4emVfIiwib25TbGlkZVN0YXJ0IjoiWXplXyIsIm9uU2xpZGUiOiJUemVfIiwib25TbGlkZUVuZCI6Ikt6ZV8iLCJvblZpc2liaWxpdHlHYWluZWQiOiJIemVfIiwib25WaXNpYmlsaXR5TG9zdCI6InF6ZV8iLCJnZXRDdXJzb3IiOiJfb0FfIn19fSAg");var SOt=function(){let i=class t{static $oA_(t,i){if(!t.defines.hasOwnProperty("addedScatterShaders")){t.defines["addedScatterShaders"]=!0;t.uniforms["cgpointTexture"]=new h(null);t.uniforms["cgpointColor"]=new h(new l(1,1,1));t.uniforms["cgpointOpacity"]=new h(1);t.uniforms["cgpixelScale"]=new h(Is());t.uniforms["ishighlight"]=new h(!1)}if(i.hasOwnProperty("symbol")){i["symbol"].wrapS=k;i["symbol"].wrapT=k;t.uniforms["cgpointTexture"].value=i["symbol"]}i.hasOwnProperty("opacity")&&(t.uniforms["cgpointOpacity"].value=i["opacity"])}static tlA_(t,i){if(!t.defines.hasOwnProperty("addedProjectionShaders")){t.defines["addedProjectionShaders"]=!0;t.uniforms["cgpointTexture"]=new h(null);t.uniforms["cgpointColor"]=new h(new l(1,1,1));t.uniforms["cgpointOpacity"]=new h(1);t.uniforms["cgpixelScale"]=new h(Is())}i.hasOwnProperty("color")&&(typeof i["color"]=="string"?t.uniforms["cgpointColor"].value=new l(i["color"]):i["color"]instanceof l&&(t.uniforms["cgpointColor"].value=i["color"]));if(i.hasOwnProperty("symbol")){i["symbol"].wrapS=k;i["symbol"].wrapT=k;t.uniforms["cgpointTexture"].value=i["symbol"]}i.hasOwnProperty("opacity")&&(t.uniforms["cgpointOpacity"].value=i["opacity"])}static ilA_(t){return{symbol:t.uniforms["cgpointTexture"].value,color:t.uniforms["cgpointColor"].value,opacity:t.uniforms["cgpointOpacity"].value,alphatest:t.uniforms["cgalphaTest"].value,pixelscale:t.uniforms["cgpixelScale"].value}}static slA_(t){return{projection_color:t.uniforms["cgpointColor"].value,projection_opacity:t.uniforms["cgpointOpacity"].value}}};i.VERTEX_SHADER=["attribute float cgpointSize;","attribute float cgpointVisible;","varying float vcgpointVisible;","uniform float cgpixelScale;","#include <common>","#include <logdepthbuf_pars_vertex>","#ifdef CG_USE_COLOR_MAP","    attribute float cgcolormapValue;","    varying float vcgcolormapValue;","    uniform vec4 cgcolormapParams;","    uniform int cgcolormapLogValue;","    float Shaders_norm(float value, float srcmin, float srcmax, float dstmin, float dstmax) {","        float norm = dstmin + (dstmax - dstmin) * (clamp(value, srcmin, srcmax) - srcmin)  / (srcmax - srcmin);","        if (norm < 0.0 || norm >= 0.0) {","            return norm;","        }","        return 0.0;","    }","    float normValueForColorMap(float value) {","        if(cgcolormapLogValue == 1)","        {","            value = log2(value)/log2(10.0);","        }","        return Shaders_norm(value - cgcolormapParams.x, 0.0, cgcolormapParams.y, 0.0, 1.0);","    }","#endif","void main() {","    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);","    #ifdef CG_USE_COLOR_MAP","        vcgcolormapValue = normValueForColorMap(cgcolormapValue);","    #endif","    vcgpointVisible = cgpointVisible;","    gl_PointSize = cgpointSize * cgpixelScale * 2.0;","    gl_Position = projectionMatrix * mvPosition;","    #include <logdepthbuf_vertex>","}"].join("\n");i.FRAGMENT_SHADER=["uniform sampler2D cgpointTexture;","uniform vec3 cgpointColor;","uniform float cgpointOpacity;","uniform bool ishighlight;","#include <logdepthbuf_pars_fragment>","#ifdef CG_USE_COLOR_MAP","    varying float vcgcolormapValue;","    uniform sampler2D cgcolormapTexture;","    vec4 getColorFromColorMap(float normValue) {","        return texture2D(cgcolormapTexture, vec2(normValue, 0.5));","    }","#endif","varying float vcgpointVisible;","void main() {","    if(vcgpointVisible < 0.1) {","        discard;","    }","    vec4 diffuseColor = vec4(cgpointColor, 1.0);","    #ifdef CG_USE_COLOR_MAP","        diffuseColor *= getColorFromColorMap(vcgcolormapValue);","    #endif","    vec4 finalColor = texture2D(cgpointTexture, gl_PointCoord);","    if(finalColor.a < 0.5) {","        discard;","    }","    gl_FragColor = diffuseColor * finalColor;","    if (ishighlight == true) {","        gl_FragColor.a = cgpointOpacity;","    }","    #include <logdepthbuf_fragment>","}"].join("\n");i.elA_=["uniform sampler2D cgpointTexture;","uniform vec3 cgpointColor;","uniform float cgpointOpacity;","#include <logdepthbuf_pars_fragment>","varying float vcgpointVisible;","void main() {","    if(vcgpointVisible < 0.1) {","        discard;","    }","    vec4 diffuseColor = vec4(cgpointColor, 1.0);","    vec4 finalColor = texture2D(cgpointTexture, gl_PointCoord);","    if(finalColor.a < 0.5) {","        discard;","    }","    gl_FragColor = diffuseColor * finalColor;","    #include <logdepthbuf_fragment>","}"].join("\n");i=t([_s("geotoolkit3d.util.shaders.Scatter")],i);return i}();const GOt=new C,ROt=new a;var kOt=Ci(function(){let i=class t extends fUt{constructor(t){super();this.KC_(!1);this.Kis_=qi(t,{multiplier:1.7,opacity:.4});this.qd_=new z;this.AlA_=null}setOptions(t){if(t==null)return this;super.setOptions(t);this.Kis_=qi(t,this.Kis_);return this}PoA_(){}nlA_(t,i){t!=null&&(t instanceof wt?this.hlA_(t,i):t instanceof W&&this.rlA_(t))}hlA_(t,i){if(this.AlA_!=null)return;const s=t.parent.w3e_(t["name"],i);this.qd_.setAttribute("position",s["position"]);this.qd_.setAttribute("cgpointVisible",s["cgpointvisible"]);this.qd_.setAttribute("cgpointSize",s["cgpointsize"]);this.qd_.setAttribute("cgcolormapValue",s["cgcolormapvalue"]);const e=t.material;this.x9e_=new RYt({vertexShader:SOt.VERTEX_SHADER,fragmentShader:SOt.FRAGMENT_SHADER,transparent:!0,uniforms:{cgpointTexture:e.uniforms["cgpointTexture"],cgpointColor:e.uniforms["cgpointColor"],cgpixelScale:e.uniforms["cgpixelScale"],cgpointOpacity:new h(this.Kis_["opacity"]),ishighlight:new h(!0)}});ixt.MXe_(this.x9e_,{colorprovider:e.userData.pXe_});this.AlA_=new wt(this.qd_,this.x9e_);this.AlA_.frustumCulled=!1;const A=this.qd_.getAttribute("cgpointSize");A.setX(0,A.getX(0)*this.Kis_["multiplier"]);this.add(this.AlA_)}rlA_(t){if(this.AlA_!=null||t.geometry==null||t.material==null)return;const i=t.userData;t.userData={};this.AlA_=t.clone();t.userData=i;this.AlA_.OC_=()=>!1;GOt.makeEmpty();GOt.expandByObject(t);const s=GOt.getCenter(ROt),e=t.position;this.AlA_.position.subVectors(e,s).multiplyScalar(this.Kis_["multiplier"]).addVectors(this.AlA_.position,s);this.AlA_.scale.multiplyScalar(this.Kis_["multiplier"]);this.AlA_.userData={};this.add(this.AlA_)}dispose(){if(this.AlA_!=null){fLt.dispose(this.AlA_);this.AlA_=null}}};i=t([_s("geotoolkit3d.tool.Highlighter")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRQaWNrZWRPYmplY3QiOiJubEFfIn19fSAg");var FOt=function(){let i=class t extends W{OC_(){return!1}};i=t([_s(null)],i);return i}(),xOt=Ci({HZt_:"DistanceChanged"},2,"eyJEaXN0YW5jZUNoYW5nZWQiOiJIWnRfIn0g"),LOt=Ci(function(){let i=class t extends vFt{constructor(t){const i=qi(t,{name:"measuretool",enabled:!0,armingkey:17,anchorsize:10,pointersize:10,picking:$Lt});super(i);this.Bgt_=!1;this.olA_=new a(0,0,0);this.llA_=new a(0,0,0);const s=new mt(1,1,1);this.cms_=new FOt(s,new F({color:"#00ff00"}));this._at_=new FOt(s,new F({color:"#00ff00"}));this.ulA_=new cUt({data:{positions:[this.olA_.x,this.olA_.y,this.olA_.z,this.llA_.x,this.llA_.y,this.llA_.z]},color:"blue"});this.ulA_.frustumCulled=!1;this.ulA_.OC_=()=>!1;this.alA_=!1;this.Bgt_=!0;this.glA_(i)}clA_(t){this.cms_.visible=t;this._at_.visible=t;this.ulA_.visible=t;return this}setOptions(t){this.glA_(t);super.setOptions(t);return this}glA_(t){if(this.Bgt_&&t!=null){t.hasOwnProperty("enabled")&&(this.xv_=t["enabled"]);if(t.hasOwnProperty("plot")&&this.getPlot()!==t["plot"]){const i=t["plot"];if(i!=null){i.getRoot().add(this.cms_);i.getRoot().add(this._at_);i.getRoot().add(this.ulA_)}}t.hasOwnProperty("pointersize")&&this.cms_.scale.setScalar(t["pointersize"]);t.hasOwnProperty("anchorsize")&&this._at_.scale.setScalar(t["anchorsize"]);t.hasOwnProperty("pointercolor")&&(this.cms_["material"]["color"]=new l(t["pointercolor"]));t.hasOwnProperty("anchorcolor")&&(this._at_["material"]["color"]=new l(t["anchorcolor"]));t.hasOwnProperty("lineoptions")&&this.ulA_.setOptions(t["lineoptions"]);t.hasOwnProperty("picking")&&(this.PiA_=t["picking"])}}JV_(){const t=super.JV_();t["enabled"]=this.xv_;return t}Sze_(t){this.eXe_&&this.IlA_(this.PiA_.pO_(this.E8_,t["plotX"],t["plotY"],this.Xz_,this.Xz_))}Gze_(t){this.xv_}zFt_(t){super.Ct_(t);this.eXe_&&(this.alA_=!0)}Ss_(){return this.olA_.distanceTo(this.llA_)}IlA_(t){if(t.length>0){if(this.alA_){this.alA_=!1;this.llA_=t[0]["point"].clone();this._at_.position.set(this.llA_.x,this.llA_.y,this.llA_.z)}this.olA_=t[0]["point"].clone();this.cms_.position.set(this.olA_.x,this.olA_.y,this.olA_.z);this.ulA_.setOptions({data:{positions:[this.olA_.x,this.olA_.y,this.olA_.z,this.llA_.x,this.llA_.y,this.llA_.z]}});this.E8_.invalidateObject();this.ulA_.geometry.attributes.position.needsUpdate=!0;this.notify("DistanceChanged",this,this.Ss_())}else this.alA_=!1}vze_(t){return $i()}bze_(t){return $i()}Nze_(t){return $i()}Rze_(t){return $i()}jFt_(t){return $i()}kze_(t){return $i()}Fze_(t){return $i()}xze_(t){return $i()}Lze_(t){return $i()}aWt_(t){return $i()}Uze_(t){return $i()}Yze_(t){return $i()}Tze_(t){return $i()}Kze_(t){return $i()}Hze_(t){return $i()}qze_(t){return $i()}dispose(){fLt.dispose(this.cms_);fLt.dispose(this._at_);fLt.dispose(this.ulA_);this.cms_=null;this._at_=null;this.ulA_=null;super.dispose()}};i=t([_s("geotoolkit3d.tool.MeasuringTool")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRDaGlsZHJlblZpc2liaWxpdHkiOiJjbEFfIiwiZ2V0T3B0aW9ucyI6IkpWXyIsIm9uQ3Vyc29yTW92ZSI6IlN6ZV8iLCJvblRhcCI6Ikd6ZV8iLCJvbk1vdXNlRG93biI6InpGdF8iLCJnZXREaXN0YW5jZSI6IlNzXyIsIm9uS2V5U3RhcnQiOiJ2emVfIiwib25LZXkiOiJiemVfIiwib25LZXlFbmQiOiJOemVfIiwib25Eb3VibGVUYXAiOiJSemVfIiwib25Nb3VzZVdoZWVsIjoiakZ0XyIsIm9uUGluY2hTdGFydCI6Imt6ZV8iLCJvblBpbmNoIjoiRnplXyIsIm9uUGluY2hFbmQiOiJ4emVfIiwib25EcmFnU3RhcnQiOiJMemVfIiwib25EcmFnIjoiYVd0XyIsIm9uRHJhZ0VuZCI6IlV6ZV8iLCJvblNsaWRlU3RhcnQiOiJZemVfIiwib25TbGlkZSI6IlR6ZV8iLCJvblNsaWRlRW5kIjoiS3plXyIsIm9uVmlzaWJpbGl0eUdhaW5lZCI6Ikh6ZV8iLCJvblZpc2liaWxpdHlMb3N0IjoicXplXyJ9fX0g");var UOt=Ci(function(){var i;let s=i=class t extends fUt{constructor(t){super();Object.assign(this,{type:"MeshNormalsHelper"});const s=qi(t,{showsmoothnormals:!0,smoothnormalsscale:10,smoothnormalscolor:"red",showflatnormals:!1,flatnormalsscale:10,flatnormalscolor:"green"}),e=t["geometry"];if(s["showsmoothnormals"]){const t=i.flA_(e.index,e.attributes.position,e.attributes.normal,s["smoothnormalsscale"]),A=i.m3e_(s["smoothnormalscolor"],t);this.add(A)}if(s["showflatnormals"]){const t=i.ClA_(e.index,e.attributes.position,s["flatnormalsscale"]),A=i.m3e_(s["flatnormalscolor"],t);this.add(A)}}static m3e_(t,i){return new cUt({data:{positions:i},color:t,linewidth:1})}static flA_(t,i,s,e){const A=[];let n,h,r,o,l,u,g,c,I;const f=new a(0,0,0),C=new a(0,0,0);for(let a=0;a<t.count;a+=3){g=t.getX(a);c=t.getY(a);I=t.getZ(a);n=s.getX(g);h=s.getY(g);r=s.getZ(g);n+=s.getX(c);h+=s.getY(c);r+=s.getZ(c);n+=s.getX(I);h+=s.getY(I);r+=s.getZ(I);if(Number.isFinite(n)&&Number.isFinite(h)&&Number.isFinite(r)){o=i.getX(g);l=i.getY(g);u=i.getZ(g);o+=i.getX(c);l+=i.getY(c);u+=i.getZ(c);o+=i.getX(I);l+=i.getY(I);u+=i.getZ(I);if(Number.isFinite(o)&&Number.isFinite(l)&&Number.isFinite(u)){f.set(o/3,l/3,u/3);C.set(n,h,r);C.normalize();C.multiplyScalar(e);A.push(f.x,f.y,f.z,f.x+C.x,f.y+C.y,f.z+C.z)}}}return A}static ClA_(t,i,s){const e=[];let A,n,h,r,o,l,u,g,c,I,f,C;const d=new a(0,0,0),B=new a(0,0,0),w=new a(0,0,0);for(let a=0;a<t.count;a+=3){I=t.getX(a);f=t.getY(a);C=t.getZ(a);A=i.getX(I);n=i.getX(f);h=i.getX(C);r=i.getY(I);o=i.getY(f);l=i.getY(C);u=i.getZ(I);g=i.getZ(f);c=i.getZ(C);w.set((A+n+h)/3,(r+o+l)/3,(u+g+c)/3);if(Number.isFinite(w.x)&&Number.isFinite(w.y)&&Number.isFinite(w.z)){d.set(n-A,o-r,g-u);B.set(h-A,l-r,c-u);d.cross(B);d.normalize();d.multiplyScalar(s);e.push(w.x,w.y,w.z,w.x+d.x,w.y+d.y,w.z+d.z)}}return e}};s=i=t([_s("geotoolkit3d.tool.MeshNormalsHelper")],s);return s}(),2,"eyJjcmVhdGVMaW5lc0Zyb21TbW9vdGhzaGFkaW5nTm9ybWFscyI6ImZsQV8iLCJjcmVhdGVMaW5lc0Zyb21GbGF0c2hhZGluZ05vcm1hbHMiOiJDbEFfIn0g");var YOt=Ci(function(){let i=class t extends QOt{constructor(t){const i=qi(t,{name:"planarmovetool",filter:null});super(i);this.gp_=i["filter"];this.dlA_=null}BlA_(){let t=this.wlA_;t==null&&tJt(this.xmt_)&&(t=this.xmt_.localToWorld(this.xmt_.geometry.boundingBox.getCenter(this.Z$e_.position)));this.Z$e_.position.copy(t);const i=this.E8_.e$e_(),s=this.E8_.ZiA_();s.sub(i).negate().add(this.Z$e_.position);this.Z$e_.lookAt(s)}setOptions(t){const i=qi(t,{plot:this.E8_,enabled:this.xv_,pickenabled:this.ToA_,object:t["object"]!==void 0?null:this.xmt_,pickingplanecenter:t["pickingplanecenter"]!==void 0?null:this.wlA_,filter:t["filter"]});this.gp_=i["filter"];if(this.xmt_!==i["object"]){i["object"]==null&&this.E8_.getRoot().remove(this.Z$e_);this.KoA_(wOt.Hmt_,i["object"],null)}this.xmt_=i["object"];this.wlA_=null;if(this.E8_==null&&i["plot"]!=null){this.E8_=i["plot"];this.Z$e_=new W(new bt(2e6,2e6,2,2),new F({color:"white",opacity:.3,transparent:!0}));this.Z$e_.name="PICKING_PLANE";this.Z$e_.material.visible=!1}if(this.Z$e_!=null&&this.xmt_!=null&&this.E8_!=null){this.E8_.getRoot().add(this.Z$e_);tJt(this.xmt_)&&this.xmt_.geometry.computeBoundingBox();this.wlA_=i["pickingplanecenter"];this.BlA_()}this.xv_=i["enabled"];this.ToA_=i["pickenabled"];this.E8_==null||this.xmt_!=null&&this.xv_!==!1||this.E8_.getRoot().remove(this.Z$e_);super.setOptions(i);return this}JV_(){const t=super.JV_();t["filter"]=this.gp_;t["pickingplanecenter"]=this.wlA_;return t}pO_(t){const i=$Lt.pO_(this.E8_,t["plotX"],t["plotY"],this.Xz_,this.Xz_,this.gp_);let s=i.length>0?i[0]:null;s!=null&&s["object"]===this.Z$e_&&(s=i.length>1?i[1]:null);this.setOptions({object:s!=null?s["object"]:null,pickingplanecenter:s!=null?s["point"]:null})}move(t,i){if(this.Z$e_.parent==null)return;const s=EKt.E6e_(this.E8_,t["plotX"],t["plotY"],this.Z$e_);let e=null,A=0;for(;A<s.length;A++)if(s[A]["object"]===this.Z$e_){e=s[A]["point"];break}if(e==null){this.KoA_(i,this.xmt_,new a);return}const n=this.xmt_.parent.worldToLocal(e.clone()).sub(this.xmt_.parent.worldToLocal(this.wlA_.clone()));this.wlA_=s[A]["point"].clone();this.dlA_!=null&&this.dlA_(this.xmt_,n);n.length()>1e-5&&this.xmt_.position.add(n);this.KoA_(i,this.xmt_,n);this.BlA_();this.xmt_.invalidateObject!=null?this.xmt_.invalidateObject():fUt.prototype.invalidateObject.call(this.xmt_);i===wOt.End&&this.setOptions({object:null})}QlA_(t){this.dlA_=t;return this}};i=t([_s("geotoolkit3d.tool.PlanarMoveTool")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwic2V0QWRqdXN0RnVuY3Rpb24iOiJRbEFfIn19fSAg");var TOt=Ci(function(){let i=class t extends QOt{constructor(t){const i=undefined;super(qi(t,{name:"SliderMoveTool"}));this.dlA_=null}setOptions(t){if(t==null)return this;this.ElA_=t["initialpoint"];super.setOptions(t);return this}JV_(){const t=super.JV_();t["initialpoint"]=this.ElA_;return t}pO_(t){const i=$Lt.pO_(this.E8_,t["plotX"],t["plotY"],this.Xz_,this.Xz_);this.setOptions({object:i.length>0?i[0]["object"]:null,initialpoint:new g(t["plotX"],t["plotY"])});return this}move(t,i){if(this.ElA_==null)return this;const s=new g(t["plotX"]-this.ElA_.x,t["plotY"]-this.ElA_.y);if(this.dlA_!=null){this.dlA_(this.xmt_,s,this.ElA_.clone())===!0&&this.ElA_.set(t["plotX"],t["plotY"]);this.xmt_.invalidateObject!=null?this.xmt_.invalidateObject():fUt.prototype.invalidateObject.call(this.xmt_)}this.KoA_(i,this.xmt_,s);return this}plA_(t){this.dlA_=t;return this}dispose(){this.dlA_=null;super.dispose()}};i=t([_s("geotoolkit3d.tool.SliderMoveTool")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwic2V0TW92ZUZ1bmN0aW9uIjoicGxBXyJ9fX0g");var KOt=Ci(function(){let i=class t extends vFt{constructor(t){const i=qi(t,{name:"tooltip",enabled:!0,cursor:new kOt,opacity:1,innerhtml:t=>t["object"].type,picking:$Lt},!0);super(i);this.Kis_=i;this.JUe_=[];this._D_=null;i["divelement"]!=null&&(typeof i["divelement"]=="string"?this.mlA_=Mi.document.getElementById(i["divelement"]):this.mlA_=i["divelement"]);let s=null;this.HoA_(((t,i)=>{const e=this.mlA_["style"];if(i.length===0||i[0]["object"]["uuid"]!==s){e["display"]="none";s=null;this.aFi_!=null&&this.aFi_.dispose()}if(i.length!==0){s=i[0]["object"]["uuid"];this.aFi_ instanceof kOt&&this.aFi_.nlA_(i[0]["object"],i[0]["pointindex"]);e["display"]="block";e["opacity"]=this.Kis_["opacity"]+"";this.mlA_.innerHTML=this.Kis_["innerhtml"](i[0]);const A=this.mlA_.offsetWidth,n=this.mlA_.offsetHeight;e["left"]=t["clientX"]-A/2+"px";e["top"]=t["clientY"]-n-15+"px"}}))}setOptions(t){this.Kis_=qi(t,this.Kis_);this.xv_=this.Kis_["enabled"];this.aFi_=this.Kis_["cursor"];super.setOptions(this.Kis_);if(this.E8_!=null&&this._D_==null){this._D_=this.E8_.iM_();if(this.mlA_==null){this.mlA_=Mi.document.createElement("div");const t=this.mlA_["style"];t["position"]="fixed";t["minWidth"]="40px";t["textAlign"]="left";t["padding"]="5px 10px 5px 10px";t["backgroundColor"]="#000000";t["display"]="none";t["opacity"]="0";t["color"]="#ffffff";t["borderRadius"]="6px";t["zIndex"]="999"}this._D_.appendChild(this.mlA_)}return this}JV_(){let t=super.JV_();t=Pi(t,this.Kis_);return t}I0t_(){return this.mlA_}joA_(t){this.aFi_.visible=t!=null;this.aFi_.parent==null&&this.E8_.getRoot().add(this.aFi_);t!=null&&(this.aFi_ instanceof kOt||this.aFi_ instanceof pOt)&&this.aFi_.PoA_(t);this.aFi_.invalidateObject()}KoA_(t,i){for(let s=0;s<this.JUe_.length;s++)this.JUe_[s](t,i);if(this.E8_!=null&&this.aFi_!=null){const t=i.length!==0?i[0]["point"]:null;this.joA_(t)}}HoA_(t){this.JUe_.indexOf(t)===-1&&this.JUe_.push(t)}Sze_(t){if(!this.xv_)return;const i=this.Kis_["picking"].pO_(this.E8_,t["plotX"],t["plotY"],this.Xz_,this.Xz_);this.KoA_(t,i)}Gze_(t){if(!this.xv_)return;const i=this.Kis_["picking"].pO_(this.E8_,t["plotX"],t["plotY"],this.Xz_,this.Xz_);this.KoA_(t,i)}Nze_(t){return $i()}Lze_(t){return $i()}aWt_(t){return $i()}Uze_(t){return $i()}vze_(t){return $i()}bze_(t){return $i()}Rze_(t){return $i()}jFt_(t){return $i()}kze_(t){return $i()}Fze_(t){return $i()}xze_(t){return $i()}Yze_(t){return $i()}Tze_(t){return $i()}Kze_(t){return $i()}Hze_(t){return $i()}qze_(t){return $i()}dispose(){this.JUe_=null;super.dispose()}};i=t([_s("geotoolkit3d.tool.ToolTip")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiZ2V0RGl2RWxlbWVudCI6IkkwdF8iLCJhZGRNb3ZlTGlzdGVuZXIiOiJIb0FfIiwib25DdXJzb3JNb3ZlIjoiU3plXyIsIm9uVGFwIjoiR3plXyIsIm9uS2V5RW5kIjoiTnplXyIsIm9uRHJhZ1N0YXJ0IjoiTHplXyIsIm9uRHJhZyI6ImFXdF8iLCJvbkRyYWdFbmQiOiJVemVfIiwib25LZXlTdGFydCI6InZ6ZV8iLCJvbktleSI6ImJ6ZV8iLCJvbkRvdWJsZVRhcCI6IlJ6ZV8iLCJvbk1vdXNlV2hlZWwiOiJqRnRfIiwib25QaW5jaFN0YXJ0Ijoia3plXyIsIm9uUGluY2giOiJGemVfIiwib25QaW5jaEVuZCI6Inh6ZV8iLCJvblNsaWRlU3RhcnQiOiJZemVfIiwib25TbGlkZSI6IlR6ZV8iLCJvblNsaWRlRW5kIjoiS3plXyIsIm9uVmlzaWJpbGl0eUdhaW5lZCI6Ikh6ZV8iLCJvblZpc2liaWxpdHlMb3N0IjoicXplXyJ9fX0g");var HOt=Ci(function(){let i=class t extends GJt{constructor(){super();this.ylA_=1;this.DlA_=1;this.MlA_=1}validate(t){super.validate();this.ylA_==null&&(this.ylA_=1);this._z1==null&&(this._z1=this._z0+(t!=null?this.ylA_*(t-1):0))}f4s_(){return this.ylA_}vlA_(){return this.DlA_}blA_(){return this.MlA_}NlA_(){const t=this.XAA_();t.min.z=0;t.max.z=(this._z1-this._z0)/this.ylA_;return t}SlA_(t){this._x0=t["i0"];this._y0=t["j0"];this._x1=t["i0"]+(t["icount"]-1)*t["istep"];this._y1=t["j0"];this._x2=t["i0"]+(t["icount"]-1)*t["istep"];this._y2=t["j0"]+(t["jcount"]-1)*t["jstep"];this._x3=null;this._y3=null;this._z0=t["z0"]!=null?t["z0"]:0;this._z1=t["z1"]!=null?t["z1"]:null;this.ylA_=t["samplerate"];this.DlA_=t["istep"];this.MlA_=t["jstep"];this.validate(t["samplecount"]);return this}};i=t([_s("geotoolkit3d.transformation.IndexCoordinates")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRTYW1wbGVSYXRlIjoiZjRzXyIsImdldElTdGVwIjoidmxBXyIsImdldEpTdGVwIjoiYmxBXyIsImZyb21KU09OSW5kZXgiOiJTbEFfIn19fSAg");var qOt=function(){let i=class t{constructor(t,i){this.Ndt_=t;this._xy=i}unA_(t){const i=this.Ndt_.AnA_(),s=this.Ndt_.nnA_(),e=[new a(this.Ndt_.hnA_().x,this.Ndt_.hnA_().y,i),new a(this.Ndt_.Ike_().x,this.Ndt_.Ike_().y,i),new a(this.Ndt_.fke_().x,this.Ndt_.fke_().y,s),new a(this.Ndt_.rnA_().x,this.Ndt_.rnA_().y,i)],A=[new a(this._xy.hnA_().x,this._xy.hnA_().y,i),new a(this._xy.Ike_().x,this._xy.Ike_().y,i),new a(this._xy.fke_().x,this._xy.fke_().y,s),new a(this._xy.rnA_().x,this._xy.rnA_().y,i)];t.updateMatrix();t.applyMatrix4(kxt.vje_(e,A))}};i=t([_s("geotoolkit3d.transformation.IndexToXY")],i);return i}();var JOt=Ci(function(){let i=class t{};i.prototype.ihi_=Zi;i=t([_s("geotoolkit3d.util.interpolators.AbstractInterpolator")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnRlcnBvbGF0ZSI6ImloaV8ifX0sImdldENsYXNzTmFtZSI6IkRfIn0g");const POt=new a,VOt=new a,OOt=new a;var WOt=Ci(function(){let i=class t extends JOt{ihi_(t,i,s,e,n,h){const r=new Float32Array(i.x*i.y*i.z);let o=0;OOt.subVectors(t.max,t.min).set(OOt.x/i.x,OOt.y/i.y,OOt.z/i.z);for(let l=.5;l<i.x;l++)for(let u=.5;u<i.y;u++)for(let a=.5;a<i.z;a++){let i=!1;POt.copy(t.min).set(POt.x+OOt.x*l,POt.y+OOt.y*u,POt.z+OOt.z*a);let g=0,c=0;for(let t=0;t<s.length;t++){const l=s[t];l instanceof A?VOt.set(l.x,l.y,l.z):VOt.set(l,e[t],n[t]);const u=1/VOt.distanceTo(POt);if(!Number.isFinite(u)){r[o]=l instanceof A?l.w:h[t];i=!0;break}g+=l instanceof A?u*l.w:u*h[t];c+=u}i||(r[o]=g/c);o++}return r}};i=t([_s("geotoolkit3d.util.interpolators.InverseDistanceWeighting")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnRlcnBvbGF0ZSI6ImloaV8ifX19");const zOt="#000000",XOt=[[0,2],[0,1],[2,3],[1,3],[1,5],[3,7],[5,7],[6,7],[4,5],[4,6],[2,6],[0,4]],jOt=new a,ZOt=new vt,_Ot=new C,$Ot=new a,tWt=new a,iWt=new a,sWt=new a,eWt=new a,AWt=new a;var nWt=Ci(function(){let i=class t{constructor(){ki("AbstractIntersection is deprecated since 4.0 and was not meant to be exposed to the public API."+" Please use geotoolkit3d/util/intersection/IntersectionManager instead.")}W9e_(t,i,s){let e=!1,A=!1;i.traverse((t=>{if(t.D_)if(t.D_()==="geotoolkit3d.scene.reservoir.hexahedral.ReservoirGrid"){e=!0;i=t}else if(t instanceof DKt||t.D_()==="geotoolkit3d.scene.seismic.Horizon"){A=!0;i=t}}));typeof i.JV_!="function"||s.hasOwnProperty("preservecolor")||(s["preservecolor"]=i.JV_()["colorprovider"]!=null);let n=[];e?n=this.z9e_(t,i,s):A?n=this.X9e_(t,i,s):ki("geotoolkit3d.util.intersection.AbstractIntersection: does not support this type of object.");return n}h9e_(t,i,s){const e=t.normal.clone().normalize(),A=(new a).subVectors(s,i).normalize(),n=e.clone().cross(A),h=(new u).set(i.x,i.x+A.x,i.x+n.x,i.x+e.x,i.y,i.y+A.y,i.y+n.y,i.y+e.y,i.z,i.z+A.z,i.z+n.z,i.z+e.z,1,1,1,1),r=undefined;return(new u).set(0,0,1,0,0,1,0,0,0,0,0,1,1,1,1,1).multiply(h.invert())}GlA_(t,i){const s=new a,e=new a,A=new a,n=new b,h=t.geometry,r=h.getAttribute("position"),o=h.getIndex(),l=o.getX(0),u=o.getY(0),g=o.getZ(0);t.localToWorld(s.set(r.getX(l),r.getY(l),r.getZ(l)));t.localToWorld(e.set(r.getX(u),r.getY(u),r.getZ(u)));t.localToWorld(A.set(r.getX(g),r.getY(g),r.getZ(g)));i.worldToLocal(s);i.worldToLocal(e);i.worldToLocal(A);n.setFromCoplanarPoints(s,e,A);return n}V9e_(t){if(t.length===0)return null;const i=new Fo({startcolor:t[0][1]||zOt,endcolor:t[t.length-1][1]||zOt,startpoint:new lA(0,0),endpoint:new lA(1,0)});for(let s=1;s<t.length-1;s++)i.LQ_(t[s][0],t[s][1]||zOt);return i}mR_(t,i,s,e){e=e==null||e;let A=i.x8_(),n,h;A==null&&(A=new sI);const r=t["coordinates"]["x"],o=t["coordinates"]["y"];if(e)h=new ap({x:r,y:o,visible:!0,linestyle:new hl({width:t["linewidth"],fill:t["fillstyle"]})});else{h=new Cp;for(n=0;n<r.length-1;n+=2){const t=n,i=n+1;h.add([r[t],r[i]],[o[t],o[i]])}h.rB_(new hl({width:t["linewidth"],fill:t["fillstyle"]}))}A.Gq_(h);i.H9e_(A);i.DH_&&i.DH_(null,!0);return[h]}ER_(t,i,s){let e=i.x8_();e==null&&(e=new sI);const A=[],n=t["coordinates"]["x"],h=t["coordinates"]["y"],r=t["fillstyle"];for(let t=0;t<n.length;t++){if(n[t].length<3)continue;n[t].length>3&&NA.cA_(n[t],h[t]);const i=new oE({x:n[t],y:h[t],fillstyle:r[t]});e.Gq_(i);A.push(i)}i.H9e_(e);i.DH_&&i.DH_(null,!0);return A}u9e_(t,i,s){let e;const A=i.getData(),n=i.JV_()["colorprovider"];A!=null&&A["values"]!=null?e=A["values"]:s=!1;const h=[],r=[],o=i.a9e_(),l=o["geometry"].getIndex(),u=o["geometry"].getAttribute("position"),a=[[0,1],[1,2],[2,0]],g=(t,i,A,o,l)=>{for(let u=0;u<a.length;u++){const g=a[u];if(t[g[0]]!==t[g[1]]){ZOt.start.set(t[g[0]],i[g[0]],A[g[0]]);ZOt.end.set(t[g[1]],i[g[1]],A[g[1]]);if(l.intersectsLine(ZOt)){l.intersectLine(ZOt,jOt);h.push([jOt.x,jOt.y,jOt.z]);if(s){const i=(e[o[g[1]]]*(jOt.x-t[g[0]])+e[o[g[0]]]*(t[g[1]]-jOt.x))/(t[g[1]]-t[g[0]]);r.push(n.getColor(i).Es_())}}}}};for(let i=0;i<l.count;i+=3){const s=l.getX(i),e=l.getY(i),A=l.getZ(i),n=undefined,h=undefined,r=undefined,o=undefined;g([u.getX(s),u.getX(e),u.getX(A)],[u.getY(s),u.getY(e),u.getY(A)],[u.getZ(s),u.getZ(e),u.getZ(A)],[s,e,A],t)}return{coordinates:h,colors:r}}RlA_(t,i){const s=t.length/3;if(s<=3)return t;tWt.set(0,0,0);for(let i=0;i<s;i++){const s=i*3;tWt.x+=t[s];tWt.y+=t[s+1];tWt.z+=t[s+2]}tWt.divideScalar(s);$Ot.set(t[0],t[1],t[2]);sWt.subVectors($Ot,tWt);eWt.copy(sWt).applyAxisAngle(i,Math.PI/2);const e=[];for(let i=1;i<s;i++){const s=i*3;iWt.set(t[s],t[s+1],t[s+2]);AWt.subVectors(iWt,tWt);const A=eWt.dot(AWt);let n;if(A===0)n=sWt.dot(AWt)>0?0:Math.PI;else{n=sWt.angleTo(AWt);A<0&&(n=2*Math.PI-n)}e.push([iWt.x,iWt.y,iWt.z,n])}e.sort(((t,i)=>t[3]-i[3]));const A=[t[0],t[1],t[2]];for(let t=0;t<e.length;t++){const i=e[t];A.push(i[0],i[1],i[2])}return A}A9e_(t,i,s,e,A){const n=t["x"],h=t["y"],r=t["z"],o=[];for(let t=0;t<XOt.length;++t){ZOt.start.set(n[XOt[t][0]],h[XOt[t][0]],r[XOt[t][0]]);ZOt.end.set(n[XOt[t][1]],h[XOt[t][1]],r[XOt[t][1]]);if(i.intersectsLine(ZOt)){i.intersectLine(ZOt,jOt);o.push(jOt.x,jOt.y,jOt.z)}}const l=this.RlA_(o,i.normal);s.push(l);e&&A.push(t["value"])}g9e_(t,i,s){const e=i.getData(),A=e.L4e_();A.K8e_()||A.L8e_();const n=A.r4e_(t),h=[],r=[];for(let A=0;A<n.length;++A){const o=n[A];if(i.I9e_(o))continue;const l=e.f9e_(o,_Ot);_Ot.intersectsPlane(t)&&this.A9e_(l,t,h,s,r)}return{coordinates:h,colors:r}}};i.prototype.z9e_=Zi;i.prototype.X9e_=Zi;i=t([_s("geotoolkit3d.util.intersection.AbstractIntersection")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJkcmF3UmVzZXJ2b2lySW50ZXJzZWN0aW9uIjoiejllXyIsImRyYXdTdXJmYWNlSW50ZXJzZWN0aW9uIjoiWDllXyIsImdlbmVyYXRlSW50ZXJzZWN0aW9uIjoiVzllXyIsImdlbmVyYXRlSGVscGVyUGxhbmVMb2NhbCI6IkdsQV8iLCJnZW5lcmF0ZUZpbGxlZExpbmVzdHlsZSI6IlY5ZV8iLCJkcmF3UG9seWxpbmUiOiJtUl8iLCJkcmF3UG9seWdvbiI6IkVSXyIsImdldFN1cmZhY2VJbnRlcnNlY3RlZFBvaW50cyI6InU5ZV8iLCJnZXRSZXNlcnZvaXJJbnRlcnNlY3RlZFBvaW50cyI6Imc5ZV8ifX0sImdldENsYXNzTmFtZSI6IkRfIn0g");var hWt=Ci(function(){let i=class t extends nWt{constructor(){ki("AbstractSeismicIntersection is deprecated since 4.0 and was not meant to be exposed to the public API."+" Please use geotoolkit3d/util/intersection/IntersectionManager instead.");super()}klA_(t,i){const s=new a,e=new a,A=new a,n=t.geometry,h=n.getAttribute("position"),r=n.getIndex(),o=r.getX(0),l=r.getY(0),u=r.getZ(0);s.set(h.getX(o),h.getY(o),h.getZ(o));e.set(h.getX(l),h.getY(l),h.getZ(l));A.set(h.getX(u),h.getY(u),h.getZ(u));t.localToWorld(s);t.localToWorld(e);t.localToWorld(A);i.worldToLocal(s);i.worldToLocal(e);i.worldToLocal(A);return{p1:s,p2:e,p3:A}}};i=t([_s("geotoolkit3d.util.intersection.AbstractSeismicIntersection")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJ0cmFuc2Zvcm1Cb3VuZGluZ0JveENvb3JkaW5hdGUiOiJrbEFfIn19fSAg");const rWt=new a;let oWt;var lWt=Ci(function(){var i;let s=i=class t extends hWt{constructor(){ki("FenceIntersection is deprecated since 4.0 and was not meant to be exposed to the public API."+" Please use geotoolkit3d/util/intersection/IntersectionManager instead.");super()}static Ai_(){oWt==null&&(oWt=new i);return oWt}z9e_(t,i,s){const e=this.klA_(t.a9e_(),i);if(e["p1"]==null){ki("geotoolkit3d.util.intersection.FenceIntersection: cannot get bounding box.");return null}const A=s["preservecolor"],n=e["p1"].distanceTo(e["p3"]),h=e["p1"].distanceTo(e["p2"]),r=[],o=[],l=this.GlA_(t.a9e_(),i),u=this.g9e_(l,i,A),a=u["coordinates"],g=u["colors"],c=t.G9e_(),I=c.Ie_(),f=c.Ts_();let C,d;const B=this.h9e_(l,e["p1"],e["p2"]);for(C=0;C<a.length;C++){const t=[],i=[];for(d=0;d<a[C].length;d+=3){const s=a[C];rWt.set(s[d],s[d+1],s[d+2]);rWt.applyMatrix4(B);const e=rWt.x/n,A=rWt.y/h;t.push(e*I+c.getX());i.push(A*f+c.getY())}if(t.length!==0&&i.length!==0){r.push(t);o.push(i)}}let w;if(A&&Array.isArray(g)&&g.length>0){const t=i.JV_()["colorprovider"],s=[];for(let i=0;i<r.length;++i){const e=new wr(t.getColor(g[i]));s.push(e)}w=s}else w=new Array(r.length).fill(s["fillstyle"]);const Q={coordinates:{x:r,y:o},fillstyle:w};return this.ER_(Q,t,i)}X9e_(t,i,s){const e=this.klA_(t.a9e_(),i);if(e["p1"]==null){ki("geotoolkit3d.util.intersection.FenceIntersection: cannot get bounding box.");return[]}const A=s["preservecolor"],n=e["p1"].distanceTo(e["p3"]),h=e["p1"].distanceTo(e["p2"]),r=[],o=[],l=this.GlA_(t.a9e_(),i),u=this.u9e_(l,i,A),a=u["coordinates"],g=u["colors"],c=t.G9e_(),I=c.Ie_(),f=c.Ts_(),C=this.h9e_(l,e["p1"],e["p2"]);for(let t=0;t<a.length;t++){const i=a[t];rWt.set(i[0],i[1],i[2]);rWt.applyMatrix4(C);const s=rWt.x/n,e=rWt.y/h;r.push(s*I+c.getX());o.push(e*f+c.getY())}const d={coordinates:{x:r,y:o},fillstyle:s["fillstyle"],linewidth:s["linewidth"]};if(A&&u["colors"]!==void 0){const t=[];for(let i=0;i<r.length;i++)t.push([(r[i]-r[0])/(r[r.length-1]-r[0]),g[i]]);d["fillstyle"]=this.V9e_(t)}return this.mR_(d,t,i)}};s=i=t([_s("geotoolkit3d.util.intersection.FenceIntersection")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJkcmF3UmVzZXJ2b2lySW50ZXJzZWN0aW9uIjoiejllXyIsImRyYXdTdXJmYWNlSW50ZXJzZWN0aW9uIjoiWDllXyJ9fX0g");const uWt=new a,aWt=new g;let gWt;var cWt=Ci(function(){var i;let s=i=class t extends nWt{constructor(){ki("PlaneIntersection is deprecated since 4.0 and was not meant to be exposed to the public API."+" Please use geotoolkit3d/util/intersection/IntersectionManager instead.");super()}static Ai_(){gWt==null&&(gWt=new i);return gWt}z9e_(t,i,s){const e=this.klA_(t,i),A=s["preservecolor"],n=e["p1"].distanceTo(e["p3"]),h=e["p1"].distanceTo(e["p2"]),r=[],o=[],l=this.GlA_(t.a9e_(),i),u=this.g9e_(l,i,A),a=u["coordinates"],g=u["colors"];t.M9e_();t.R9e_(aWt);const c=aWt.x,I=aWt.y;let f,C;const d=this.h9e_(l,e["p1"],e["p2"]);for(f=0;f<a.length;f++){const t=[],i=[];for(C=0;C<a[f].length;C+=3){const s=a[f];uWt.set(s[C],s[C+1],s[C+2]);uWt.applyMatrix4(d);const e=uWt.x/n,A=uWt.y/h;t.push(e*c);i.push(A*I)}if(t.length!==0&&i.length!==0){r.push(t);o.push(i)}}let B;if(A&&Array.isArray(g)&&g.length>0){const t=i.JV_()["colorprovider"],s=[];for(let i=0;i<r.length;++i){const e=new wr(t.getColor(g[i]));s.push(e)}B=s}else B=new Array(r.length).fill(s["fillstyle"]);const w={coordinates:{x:r,y:o},fillstyle:B};return this.ER_(w,t,i)}X9e_(t,i,s){const e=this.klA_(t,i),A=s["preservecolor"],n=e["p1"].distanceTo(e["p3"]),h=e["p1"].distanceTo(e["p2"]),r=[],o=[],l=this.GlA_(t.a9e_(),i),u=this.u9e_(l,i,A),a=u["coordinates"],g=u["colors"];t.M9e_();t.R9e_(aWt);const c=aWt.x,I=aWt.y,f=Math.abs(l.normal.z)<NA.Je_,C=this.h9e_(l,e["p1"],e["p2"]);for(let t=0;t<a.length;t++){const i=a[t];uWt.set(i[0],i[1],i[2]);uWt.applyMatrix4(C);const s=uWt.x/n,e=uWt.y/h;r.push(s*c);o.push(e*I)}const d={coordinates:{x:r,y:o},fillstyle:s["fillstyle"],linewidth:s["linewidth"]};if(A&&u["colors"]!==void 0){const t=[];for(let i=0;i<r.length;i++)t.push([(r[i]-r[0])/(r[r.length-1]-r[0]),g[i]]);d["fillstyle"]=this.V9e_(t)}return this.mR_(d,t,i,f)}klA_(t,i){const s=t.getBoundingBox();let e=new a(s.min.x,s.max.y,s.max.z);e=t.localToWorld(e);const A=t.localToWorld(s.min),n=t.localToWorld(s.max);i.worldToLocal(e);i.worldToLocal(A);i.worldToLocal(n);return{p1:e,p2:A,p3:n}}};s=i=t([_s("geotoolkit3d.util.intersection.PlaneIntersection")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJkcmF3UmVzZXJ2b2lySW50ZXJzZWN0aW9uIjoiejllXyIsImRyYXdTdXJmYWNlSW50ZXJzZWN0aW9uIjoiWDllXyIsInRyYW5zZm9ybUJvdW5kaW5nQm94Q29vcmRpbmF0ZSI6ImtsQV8ifX19");const IWt=new a,fWt=new u;let CWt;var dWt=Ci(function(){var i;let s=i=class t extends hWt{constructor(){ki("SeismicIntersection is deprecated since 4.0 and was not meant to be exposed to the public API."+" Please use geotoolkit3d/util/intersection/IntersectionManager instead.");super()}static Ai_(){CWt==null&&(CWt=new i);return CWt}z9e_(t,i,s){const e=s["preservecolor"],A=undefined,n=t.FlA_().hasOwnProperty("z"),h=t.a9e_();h.geometry.boundingBox==null&&h.geometry.computeBoundingBox();const r=h.geometry.boundingBox.clone(),o=h.localToWorld(r.min.clone()),l=h.localToWorld(r.max.clone());i.worldToLocal(o);i.worldToLocal(l);const u=t.JV_()["data"]["limits"],a=[],g=[],c=this.GlA_(h,i),I=this.g9e_(c,i,e),f=I["coordinates"],C=I["colors"],d=u.Ie_(),B=u.Ts_();let w,Q,E,p,m,y;if(n){fWt.copy(h.matrixWorld).invert();for(w=0;w<f.length;++w){p=[];m=[];for(Q=0;Q<f[w].length;Q+=3){E=f[w];IWt.set(E[Q],E[Q+1],E[Q+2]);IWt.applyMatrix4(i.matrixWorld);IWt.applyMatrix4(fWt);const t=IWt.x/(r.max.x-r.min.x)-r.min.x,s=IWt.y/(r.max.y-r.min.y)-r.min.y;p.push(t*d);m.push((1-s)*B)}a.push(p);g.push(m)}}else{const i=Math.abs(l.x-o.x)>Math.abs(l.y-o.y),s=i?d/(l.x-o.x):d/(l.y-o.y),e=B/(l.z-o.z)/t.xlA_().f4s_();for(w=0;w<f.length;++w){p=[];m=[];for(Q=0;Q<f[w].length;Q+=3){E=f[w];p.push((i?E[Q+0]-o.x:E[Q+1]-o.y)*s);m.push((l.z-E[Q+2])*e)}a.push(p);g.push(m)}}if(e&&Array.isArray(C)&&C.length>0){const t=i.JV_()["colorprovider"],s=[];for(let i=0;i<a.length;++i){const e=new wr(t.getColor(C[i]));s.push(e)}y=s}else y=new Array(a.length).fill(s["fillstyle"]);const D={coordinates:{x:a,y:g},fillstyle:y};return this.ER_(D,t,i)}X9e_(t,i,s){const e=s["preservecolor"],A=t.FlA_(),n=A.hasOwnProperty("z"),h=t.a9e_();h.geometry.boundingBox==null&&h.geometry.computeBoundingBox();const r=h.geometry.boundingBox.clone(),o=h.localToWorld(r.min.clone()),l=h.localToWorld(r.max.clone());i.worldToLocal(o);i.worldToLocal(l);const u=t.JV_()["data"]["limits"];let g=[],c=[],I,f=!1;if(n){const t=new a,s=new a,A=h.geometry,n=A.getAttribute("position"),o=A.getIndex().getX(0);h.localToWorld(t.set(n.getX(o),n.getY(o),n.getZ(o)));const l=i.JV_();if(Number.isFinite(l["zmin"])&&Number.isFinite(l["zmax"])){const s=i.localToWorld(new a(0,0,l["zmin"])).z,e=i.localToWorld(new a(0,0,l["zmax"])).z;if(t.z<s||t.z>e)return[]}const C=this.LlA_(t.z,i,e),d=C["coordinates"];f=C["colors"]!=null;I=C["colors"];for(let i=0;i<d.length;i++){s.set(d[i].x,d[i].y,t.z);h.worldToLocal(s);const e=s.x/(r.max.x-r.min.x)-r.min.x,A=s.y/(r.max.y-r.min.y)-r.min.y;g.push(e*u.width);c.push((1-A)*u.height)}}else{const s=this.GlA_(h,i),n=this.u9e_(s,i,e),r=n["coordinates"];f=n["colors"]!=null;I=n["colors"];const a=u.Ie_(),C=u.Ts_(),d=t.parent.parent.JV_()["displaymode"],B=Math.abs(l.x-o.x)>Math.abs(l.y-o.y),w=B?a/(l.x-o.x):a/(l.y-o.y),Q=C/(l.z-o.z)/t.xlA_().f4s_();for(let t=0;t<r.length;t++){const i=r[t];g.push((B?i[0]-o.x:i[1]-o.y)*w);c.push((l.z-i[2])*Q)}A.hasOwnProperty("j")&&d===_kt.ij&&g.reverse();const E=[];for(let t=0;t<g.length;t++){const i=[g[t],c[t]];e&&(i[2]=I[t]);E.push(i)}E.sort(((t,i)=>t[0]-i[0]));g=[];c=[];I=[];let p,m;for(let t=0;t<E.length;t++)if(p!==E[t][0]&&m!==E[t][1]){g.push(E[t][0]);c.push(E[t][1]);e&&I.push(E[t][2]);p=E[t][0];m=E[t][1]}}const C={coordinates:{x:g,y:c},fillstyle:s["fillstyle"],linewidth:s["linewidth"]};if(e&&f){const t=[];for(let i=0;i<g.length;i++)t.push([(g[i]-g[0])/(g[g.length-1]-g[0]),I[i]]);C["fillstyle"]=this.V9e_(t)}return this.mR_(C,t,i,!n)}LlA_(t,i,s){const e=[],A=i.JV_()["colorprovider"];let n;const h=i.getData();h!=null&&h["values"]!=null?n=h["values"]:s=!1;const r=i.a9e_()["geometry"],o=r.attributes.position,l=o.array;let u=[];if(o instanceof J){const t=o.data.stride,i=o.offset,s=o.itemSize;for(let e=0;e<l.length;e++)e%t<i||e%t>=i+s||u.push(l[e])}else u=l;const g=[],c=r.index.array,I=r.getIndex();for(let h=0;h<c.length;h+=3){const r=c[h]*3,o=c[h+1]*3,l=c[h+2]*3,f=new a(u[r],u[r+1],u[r+2]),C=new a(u[o],u[o+1],u[o+2]),d=new a(u[l],u[l+1],u[l+2]);i.localToWorld(f);i.localToWorld(C);i.localToWorld(d);const B=new VYt([f.x,f.y,f.z],[C.x,C.y,C.z],[d.x,d.y,d.z],t);if(B.x3e_()&&B.L3e_()){g.push(B.H3e_(),B.q3e_());if(s){const t=I.getX(h),i=undefined,s=A.getColor(n[t]).Es_();e.push(s,s)}}}return{coordinates:g,colors:e}}};s=i=t([_s("geotoolkit3d.util.intersection.SeismicIntersection")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJkcmF3UmVzZXJ2b2lySW50ZXJzZWN0aW9uIjoiejllXyIsImRyYXdTdXJmYWNlSW50ZXJzZWN0aW9uIjoiWDllXyJ9fX0g");var BWt=function(){let i=class t{};i.VERTEX_SHADER=["#version 300 es","layout(std140, column_major) uniform;","layout(location=0) in vec4 position;","uniform mat4 uModel;","uniform mat4 uViewProj;","void main() {","    gl_Position = uViewProj * uModel * position;","}"].join("\n");i.FRAGMENT_SHADER=["#version 300 es","precision highp float;","layout(std140, column_major) uniform;","out vec4 fragColor;","void main() {","    fragColor = vec4(1.0, 1.0, 1.0, 1.0);","}"].join("\n");i=t([_s("geotoolkit3d.util.shaders.BoundingBox")],i);return i}();let wWt;const QWt=BWt;let EWt,pWt,mWt,yWt;const DWt=new a,MWt=new a,vWt=new u,bWt=(t,i)=>{DWt.copy(t.userData["bboxCenter"]);MWt.copy(i.userData["bboxCenter"]);vWt.copy(mWt).multiply(t.matrixWorld);DWt.applyMatrix4(vWt);vWt.copy(mWt).multiply(i.matrixWorld);MWt.applyMatrix4(vWt);return MWt.z-DWt.z};var NWt=Ci(function(){var i;let s=i=class t{constructor(){this.name="AbstractOcclusionManager";this.UlA_=Ls(1,1,!0);wWt=this.UlA_.getContext("webgl2");if(!wWt){ki("WebGL 2 not available in current browser. Occlusion cannot be enabled!");return null}const t=wWt.createShader(wWt.VERTEX_SHADER);wWt.shaderSource(t,QWt.VERTEX_SHADER);wWt.compileShader(t);wWt.getShaderParameter(t,wWt.COMPILE_STATUS)||ki(wWt.getShaderInfoLog(t));const i=wWt.createShader(wWt.FRAGMENT_SHADER);wWt.shaderSource(i,QWt.FRAGMENT_SHADER);wWt.compileShader(i);wWt.getShaderParameter(i,wWt.COMPILE_STATUS)||ki(wWt.getShaderInfoLog(i));const s=wWt.createProgram();wWt.attachShader(s,t);wWt.attachShader(s,i);wWt.linkProgram(s);wWt.useProgram(s);wWt.getProgramParameter(s,wWt.LINK_STATUS)||ki(wWt.getProgramInfoLog(s));EWt=wWt.getUniformLocation(s,"uModel");pWt=wWt.getUniformLocation(s,"uViewProj");this.T2_=1;this.YlA_=0;this._objects=[];this.TlA_=!1;this.xv_=!0;return this}KlA_(t){this.xv_=t;return this}HlA_(){if(this._objects.length<1)return;const t=[];for(let i=0;i<this._objects.length;i++){const s=this._objects[i];s.geometry.boundingBox==null&&s.geometry.computeBoundingBox();const e=s.geometry.boundingBox?.clone(),A=new a,n=fLt.uZe_(e,this.T2_);t.push(n);s.userData["query"]=wWt.createQuery();s.userData["queryInProgress"]=!1;s.userData["occluded"]=!1;s.userData["bboxNumVertices"]=n.length;s.userData["bboxCenter"]=e.getCenter(A);s.userData["isvalid"]=!0}i.qlA_(t.flat())}render(t,i){if(!this.xv_){if(this.TlA_){this._objects.forEach((t=>{t.visible=!0}));this.TlA_=!1}return}if(!this.TlA_){if(!wWt)return;if(this._objects.length<=1)return;this.HlA_();this.TlA_=!0}const s=this._objects,e=i.getSize();this.resize(e.Ie_(),e.Ts_());wWt.clearColor(0,0,0,1);wWt.enable(wWt.DEPTH_TEST);wWt.colorMask(!0,!0,!0,!0);wWt.depthMask(!0);wWt.clear(wWt.COLOR_BUFFER_BIT|wWt.DEPTH_BUFFER_BIT);mWt=t.matrixWorldInverse.clone();yWt=t.projectionMatrix.clone();const A=yWt.multiply(mWt);s.sort(bWt);wWt.colorMask(!1,!1,!1,!1);wWt.depthMask(!1);let n=0;for(let t=0;t<s.length;t++){const i=s[t].userData;wWt.uniformMatrix4fv(EWt,!1,s[t].matrixWorld.elements);wWt.uniformMatrix4fv(pWt,!1,A.elements);if(i.JlA_&&wWt.getQueryParameter(i.query,wWt.QUERY_RESULT_AVAILABLE)){i.PlA_=!wWt.getQueryParameter(i.query,wWt.QUERY_RESULT);i.JlA_=!1;i.PlA_&&n++}let e=!0;if(i.hasOwnProperty("isvalid")&&!i["isvalid"]){e=!1;i.PlA_=!1}if(!i.JlA_&&e){const t=i.VlA_*i.OlA_/3;wWt.beginQuery(wWt.ANY_SAMPLES_PASSED_CONSERVATIVE,i.query);wWt.drawArrays(wWt.TRIANGLES,t,i.OlA_/3);wWt.endQuery(wWt.ANY_SAMPLES_PASSED_CONSERVATIVE);i.JlA_=!0}if(i.PlA_)s[t].visible=!1;else{s[t].visible=!0;wWt.colorMask(!0,!0,!0,!0);wWt.depthMask(!0)}}wWt.flush();this.YlA_!==n&&(this.YlA_=n)}static qlA_(t){let i;Array.isArray(t)&&(i=new Float32Array(t));const s=wWt.createVertexArray();wWt.bindVertexArray(s);const e=wWt.createBuffer();wWt.bindBuffer(wWt.ARRAY_BUFFER,e);wWt.bufferData(wWt.ARRAY_BUFFER,i,wWt.STATIC_DRAW);wWt.vertexAttribPointer(0,3,wWt.FLOAT,!1,0,0);wWt.enableVertexAttribArray(0)}resize(t,i){if(this.UlA_.width!==t||this.UlA_.height!==i){this.UlA_.width=t;this.UlA_.height=i;wWt.viewport(0,0,t,i)}}WlA_(){return this.YlA_}};s.prototype.zlA_=Zi;s=i=t([_s("geotoolkit3d.util.occlusion.AbstractOcclusionManager")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRPYmplY3RzIjoiemxBXyIsInNldFVzYWJpbGl0eSI6IktsQV8iLCJnZXROdW1iZXJPZk9jY2x1ZGVkT2JqZWN0cyI6IldsQV8ifX0sImdldENsYXNzTmFtZSI6IkRfIn0g");const SWt={},GWt="addedCurveShaders",RWt="addedNormScaleShaders",kWt="cgnormalScaleMat",FWt="cgwellRadius",xWt="cgcurveOffset",LWt="cgcurveMin",UWt="cgcurveMax",YWt="cgoffsetMode",TWt="cgopacity",KWt=function(t){if(!t.defines.hasOwnProperty(RWt)){t.defines[RWt]=!0;t.uniforms[kWt]=new h(new I)}},HWt=function(t){if(!t.defines.hasOwnProperty(GWt)){t.defines[GWt]=!0;t.uniforms[FWt]=new h(0);t.uniforms[xWt]=new h(0);t.uniforms[YWt]=new h(0);t.uniforms[TWt]=new h(0);t.uniforms[LWt]=new h(0);t.uniforms[UWt]=new h(0)}};var qWt=function(){var i;let s=i=class t{static XlA_(t,i){if(i!=null){HWt(t);i.hasOwnProperty("radius")&&(t.uniforms[FWt].value=i["radius"]);i.hasOwnProperty("offset")&&(t.uniforms[xWt].value=i["offset"]);i.hasOwnProperty("offsetmode")&&(t.uniforms[YWt].value=i["offsetmode"]);i.hasOwnProperty("opacity")&&(t.uniforms[TWt].value=i["opacity"]);i.hasOwnProperty("normalizedcurvemin")&&(t.uniforms[LWt].value=i["normalizedcurvemin"]);i.hasOwnProperty("normalizedcurvemax")&&(t.uniforms[UWt].value=i["normalizedcurvemax"])}}static jlA_(t){HWt(t);return{radius:t.uniforms[FWt].value,offset:t.uniforms[xWt].value,offsetmode:t.uniforms[YWt].value,normalizedcurvemin:t.uniforms[LWt].value,normalizedcurvemax:t.uniforms[UWt].value,opacity:t.uniforms[TWt].value}}static ZlA_(t,s){if(s!=null){KWt(t);s.hasOwnProperty("normscale")&&(t.uniforms[i._lA_].value=s["normscale"])}}static $lA_(t){KWt(t);SWt["normscale"]=t.uniforms[i._lA_].value;return SWt}};s.tuA_=TWt;s._lA_=kWt;s.iuA_=FWt;s.suA_=xWt;s.euA_=LWt;s.AuA_=UWt;s.nuA_=YWt;s.huA_="cgprevDirection";s.ruA_="cgnextDirection";s.ouA_="cgnormVal";s.luA_="#include <lights_lambert_pars_fragment>";s.uuA_=`\n    void RE_Direct_Lambert_Double_Side( const in IncidentLight directLight, const in GeometricContext geometry,`+`const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\n        float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n        float dotNLBack = saturate( dot(-geometry.normal, directLight.direction ) );\n        vec3 irradiance = max(dotNL, dotNLBack) * directLight.color;\n\n        reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\n    }\n    #undef RE_Direct\n    #define RE_Direct RE_Direct_Lambert_Double_Side\n    `;s.auA_="#include <lights_lambert_fragment>";s.guA_="normal = normalize(vTransformedNormal);";s.cuA_=["uniform float "+FWt+";","uniform float "+xWt+";","uniform float "+LWt+";","uniform float "+UWt+";","uniform float "+YWt+";"].join("\n");s=i=t([_s("geotoolkit3d.util.shaders.WellShaders")],s);return s}();const JWt=YFt,PWt="addedCylinderLogShaders",VWt=["    vec4 pos = (modelViewMatrix * vec4(position, 1.0)); ","    vec3 v0 = mat3(modelViewMatrix) * "+qWt.huA_+"; ","    vec3 v1 = mat3(modelViewMatrix) * "+qWt.ruA_+"; ","    vec2 n0 = normalize(vec2(-v0.y, v0.x)); ","    vec2 n2 = normalize(vec2(-v1.y, v1.x)); ","    vec2 n1 = normalize(n0 + n2); ","    vec2 d = vec2(1.0 / length(v0), 1.0 / length(v1)); ","    d = min(vec0dot5, 0.125 * d); ","    vec3 trajectoryPos = pos.xyz;","    pos.xyz += cgweight.z * d.y * v1 - cgweight.x * d.x * v0; ","    vec2 smoothedNorm = normalize(cgweight.x * n0 + cgweight.y * n1 + cgweight.z * n2); ","    float vRadius; float vmin; float vmax; float radiusScale;","    if(cgradiusNorm.x > cgradiusNorm.y) {","        vRadius = 1.0 - "+qWt.ouA_+";","        vmin = cgradiusNorm.y;","        vmax = cgradiusNorm.x;","    } else {","        vRadius = "+qWt.ouA_+";","        vmin = cgradiusNorm.x;","        vmax = cgradiusNorm.y;","    }","    radiusScale = clamp(vRadius, vmin, vmax);","    vRadius = (radiusScale-vmin) / (vmax - vmin);","    if(vmax == vmin) vRadius = 0.5;","    float transform = ((cgradiusRange.y - cgradiusRange.x) * vRadius + cgradiusRange.x);","    vec3 bezierNormal = normalize(cross(v0 + v1, vec3(smoothedNorm, 0.0)));","    pos.xyz = pos.xyz + transform * (cgangle.x * vec3(smoothedNorm, 0.0) + cgangle.y * bezierNormal); ","    gl_Position = projectionMatrix * pos; ","    vec4 mvPosition = pos;","    vec3 normal = normalize(pos.xyz - trajectoryPos);","    transformedNormal = normal;"].join("\n"),OWt=["uniform mat3 "+qWt._lA_+";","uniform vec2 cgradiusNorm;","uniform vec2 cgradiusRange;","attribute vec2 cgangle;","attribute vec3 "+qWt.huA_+";","attribute vec3 "+qWt.ruA_+";","attribute float "+qWt.ouA_+";","attribute vec3 cgweight;","const vec2 vec0dot5 = vec2(0.5, 0.5);","varying vec3 vTransformedNormal;"].join("\n"),WWt=function(t){if(!t.defines.hasOwnProperty(PWt)){t.defines[PWt]=!0;t.uniforms["cgradiusNorm"]=new h(new g(0,1));t.uniforms["cgradiusRange"]=new h(new g(5,10))}};var zWt=function(){let i=class t{static IuA_(t,i){if(i!=null){WWt(t);i.hasOwnProperty("radiusmin")&&t.uniforms["cgradiusRange"].value.setX(i["radiusmin"]);i.hasOwnProperty("radiusmax")&&t.uniforms["cgradiusRange"].value.setY(i["radiusmax"]);i.hasOwnProperty("radiuslogmin")&&t.uniforms["cgradiusNorm"].value.setX(i["radiuslogmin"]);i.hasOwnProperty("radiuslogmax")&&t.uniforms["cgradiusNorm"].value.setY(i["radiuslogmax"])}}static fuA_(t){WWt(t);return{radiusmin:t.uniforms["cgradiusRange"].value.width,radiusmax:t.uniforms["cgradiusRange"].value.height,radiuslogmin:t.uniforms["cgradiusNorm"].value.width,radiuslogmax:t.uniforms["cgradiusNorm"].value.height}}};i.CuA_=function(t){t=JWt.EXe_(t,ixt.xXe_,VWt,!0);t=JWt.EXe_(t,ixt.RXe_,ixt.KXe_,!1,!1);t=JWt.EXe_(t,ixt.GXe_,[ixt.HXe_,OWt].join("\n"),!1,!0);return t=JWt.EXe_(t,ixt.LXe_,"vTransformedNormal = transformedNormal;",!1,!1)}(n.meshlambert_vert);i.duA_=function(t){t=JWt.EXe_(t,ixt.GXe_,ixt.JXe_,!1,!0);t=JWt.EXe_(t,ixt.kXe_,ixt.qXe_,!1,!1);t=JWt.EXe_(t,ixt.GXe_,"varying vec3 vTransformedNormal;",!1,!0);t=JWt.EXe_(t,qWt.luA_,qWt.uuA_,!1,!1);return t=JWt.EXe_(t,qWt.auA_,qWt.guA_,!1,!0)}(n.meshlambert_frag);i=t([_s("geotoolkit3d.util.shaders.CylinderLog")],i);return i}();const XWt=100,jWt="darkgrey";var ZWt=function(){let i=class t{static BuA_(t,i){if(i["color"]!=null){const s=i["color"];t["userData"].wuA_=s;if(typeof s=="string")t.uniforms["outlineColor"]={value:new l(s)};else if(s instanceof l)t.uniforms["outlineColor"]={value:s};else{t.uniforms["outlineColor"]={value:new l(jWt)};t["userData"].wuA_=jWt}}if(i["linewidth"]!=null){t.uniforms["lineWidth"]={value:i["linewidth"]/XWt||.005};t["userData"].QuA_=i["linewidth"]}}static EuA_(t,i){if(t!=null&&i!=null){i.hasOwnProperty("skeleton")&&this.BuA_(t,i["skeleton"]);if(i.hasOwnProperty("mode")){t.uniforms["seeThrough"]={value:!i["mode"][0]};t.uniforms["hideSkeleton"]={value:!i["mode"][1]};t["userData"].mode=i["mode"]}}}static puA_(t){const i=t["userData"].QuA_,s=t["userData"].mode;return{skeleton:{color:t["userData"].wuA_,linewidth:i},mode:s}}static muA_(t,i){i==null||isNaN(i)||(t.uniforms["lineWidth"].value=i/XWt)}};i.VERTEX_SHADER=["attribute vec3 barycentric;","attribute vec3 positionA;","attribute vec3 positionB;","attribute vec3 positionC;","attribute vec3 positionD;","attribute vec3 positionE;","attribute vec3 positionF;","attribute vec3 positionG;","attribute vec3 positionH;","varying vec3 vBarycentric;","#include <common>","#include <uv_pars_vertex>","#include <envmap_pars_vertex>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>","#ifdef CG_USE_COLOR_MAP","    attribute float cgcolormapValue;","    varying float vcgcolormapValue;","    uniform vec4 cgcolormapParams;","    uniform int cgcolormapLogValue;","    float Shaders_norm(float value, float srcmin, float srcmax, float dstmin, float dstmax) {","        float norm = dstmin + (dstmax - dstmin) * (clamp(value, srcmin, srcmax) - srcmin)  / (srcmax - srcmin);","        return (norm < 0.0 || norm >= 0.0) ? norm : 0.0;","    }","    float normValueForColorMap(float value) {","        if (cgcolormapLogValue == 1) value = log2(value)/log2(10.0);","        return Shaders_norm(value - cgcolormapParams.x, 0.0, cgcolormapParams.y, 0.0, 1.0);","    }","#endif","void main() {","    #include <uv_vertex>","    #include <color_vertex>","    #include <skinbase_vertex>","    #ifndef "+AFt,"        vBarycentric = barycentric;","        #ifdef CG_USE_COLOR_MAP","            vcgcolormapValue = normValueForColorMap(cgcolormapValue);","        #endif","    #endif","    #ifdef USE_ENVMAP","        #include <beginnormal_vertex>","        #include <morphnormal_vertex>","        #include <skinnormal_vertex>","        #include <defaultnormal_vertex>","    #endif","    vec3 transformed = positionA;","    transformed = position == vec3(1., 0., 1.) ? positionB : transformed;","    transformed = position == vec3(0., 1., 1.) ? positionC : transformed;","    transformed = position == vec3(1., 1., 1.) ? positionD : transformed;","    transformed = position == vec3(0., 0., 0.) ? positionE : transformed;","    transformed = position == vec3(1., 0., 0.) ? positionF : transformed;","    transformed = position == vec3(0., 1., 0.) ? positionG : transformed;","    transformed = position == vec3(1., 1., 0.) ? positionH : transformed;","    #include <morphtarget_vertex>","    #include <skinning_vertex>","    #include <project_vertex>","    #include <logdepthbuf_vertex>","    #include <clipping_planes_vertex>","    #include <worldpos_vertex>","    #include <envmap_vertex>","    #include <fog_vertex>","}"].join("\n");i.FRAGMENT_SHADER=["uniform float lineWidth;","uniform float opacity;","uniform int useDiffuseAsColor;","uniform bool seeThrough;","uniform bool hideSkeleton;","uniform vec3 diffuse;","uniform vec3 outlineColor;","varying vec3 vBarycentric;","#include <common>","#include <color_pars_fragment>","#include <uv_pars_fragment>","#include <map_pars_fragment>","#include <alphamap_pars_fragment>","#include <aomap_pars_fragment>","#include <lightmap_pars_fragment>","#include <envmap_common_pars_fragment>","#include <envmap_pars_fragment>","#include <cube_uv_reflection_fragment>","#include <fog_pars_fragment>","#include <specularmap_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <clipping_planes_pars_fragment>","#ifdef CG_USE_COLOR_MAP","    varying float vcgcolormapValue;","    uniform sampler2D cgcolormapTexture;","    vec4 getColorFromColorMap(float normValue) {","        return texture2D(cgcolormapTexture, vec2(normValue, 0.5));","    }","#endif","float aastep (float threshold, float dist) {","    float afwidth = fwidth(dist) * 0.5;","    return smoothstep(threshold - afwidth, threshold + afwidth, dist);","}","vec4 getStyledOutline (vec3 barycentric, vec4 diffusecolor) {","    float d = min( min( barycentric.x, barycentric.y ), barycentric.z );","    float edge = 1.0 - aastep(lineWidth, d);","    vec4 outColor;","    if (seeThrough) {","        if (edge == 0.0) {","            discard;","        }","        outColor = vec4(outlineColor, edge);","    } else {","        vec3 stroke = mix(diffusecolor.rgb, outlineColor, edge);","        outColor = vec4(stroke, diffusecolor.a);","    }","    return outColor;","}","void main() {","    if( hideSkeleton && seeThrough ) discard;","    #include <clipping_planes_fragment>","    vec4 diffuseColor = vec4( diffuse, opacity );","    ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","    #include <logdepthbuf_fragment>","    #include <map_fragment>","    #include <color_fragment>","    #ifdef CG_USE_COLOR_MAP","        diffuseColor *= getColorFromColorMap(vcgcolormapValue);","    #endif","    #include <alphamap_fragment>","    #include <alphatest_fragment>","    #include <specularmap_fragment>","    #ifdef USE_LIGHTMAP","        vec4 lightMapTexel= texture2D( lightMap, vUv2 );","        reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;","    #else","        reflectedLight.indirectDiffuse += vec3( 1.0 );","    #endif","    #include <aomap_fragment>","    reflectedLight.indirectDiffuse *= diffuseColor.rgb;","    vec3 outgoingLight = reflectedLight.indirectDiffuse;","    #include <envmap_fragment>","    if (!hideSkeleton) {","        gl_FragColor = getStyledOutline( vBarycentric, diffuseColor );","    } else {","        gl_FragColor = vec4( outgoingLight, diffuseColor.a );","    };","    #include <premultiplied_alpha_fragment>","    #include <tonemapping_fragment>","    #include <encodings_fragment>","    #include <fog_fragment>","}"].join("\n");i=t([_s("geotoolkit3d.util.shaders.InstancedReservoir")],i);return i}();var _Wt=Ci({yuA_:0,eG_:1,Up:2},2,"eyJVcE5vcnRoIjoieXVBXyIsIk5vcnRoIjoiZUdfIn0g"),$Wt=Ci(function(){let i=class t{};i=t([_s("geotoolkit3d.util.well.logarray.LogArrayUtil")],i);return i}(),2,"eyJnZXRDbGFzc05hbWUiOiJEXyJ9");const tzt="addedLogArrayShaders",izt="#include <begin_vertex>",szt="#include <defaultnormal_vertex>",ezt="cgwellPosition",Azt="cgwellPathVector",nzt="cgarray",hzt="cgradiusMin",rzt="cgradiusDelta",ozt="cgarrayMin",lzt="cgarrayMax",uzt="cgarrayNullValue",azt="cgcolorNullValue",gzt="cgReferenceMode",czt=["attribute vec3 "+ezt+";","attribute vec3 "+Azt+";","attribute float "+nzt+";","uniform mat3 "+qWt._lA_+";","uniform float "+ozt+";","uniform float "+lzt+";","uniform float "+hzt+";","uniform float "+rzt+";","uniform float "+uzt+";","uniform float "+azt+";","uniform int "+gzt+";","varying float "+ixt.YXe_+";","varying vec3 vTransformedNormal;"].join("\n"),Izt=["    float normValue = ("+nzt+" - min("+ozt+", "+lzt+")) / abs("+lzt+" - "+ozt+");","    normValue = clamp(normValue, 0.0, 1.0);","    vec3 path = "+Azt+";","    vec3 scale = vec3("+hzt+" + normValue * "+rzt+", "+hzt+" + normValue * "+rzt+", 1.0);","    vec3 valuedPosition = position * vec3(2.0, 2.0, 1.0) * scale;","    vec3 target = vec3(path.x, path.y, path.z);","    vec3 targetScale = vec3(1.0, 1.0, 1.0) * "+qWt._lA_+";","    target = vec3(target.x / targetScale.x, target.y / targetScale.y, target.z / targetScale.z);"].join("\n"),fzt=["    vec3 zzz = normalize(-target);","    if(length(zzz) == 0.0) {","        zzz.z = 1.0;","    }","    vec3 xxx = normalize(cross(up, zzz));","    if(length(xxx) == 0.0) {","        zzz.x = zzz.x + 0.0001;","        xxx = normalize(cross(up, zzz));","    }","    vec3 yyy = cross(zzz, xxx);","    mat3 rotationMatrix = mat3(xxx, yyy, zzz);","    vec3 rotatedPos = rotationMatrix * valuedPosition;","    vec3 finalPos = (rotatedPos * "+qWt._lA_+") + "+ezt+";"].join("\n"),Czt=["#ifdef "+ixt.UXe_,"    "+ixt.YXe_+" = "+ixt.TXe_+" == "+azt+" ? 1.0 : 0.0;","#else","    "+ixt.YXe_+" = 0.0;","#endif","    "+ixt.YXe_+" = "+nzt+" == "+uzt+" ? 1.0 : "+ixt.YXe_+";"].join("\n"),dzt=["varying float "+ixt.YXe_+";"].join("\n"),Bzt=[" if("+ixt.YXe_+" > 0.0) discard;"].join("\n"),wzt=function(t){if(!t.defines.hasOwnProperty(tzt)){t.defines[tzt]=!0;t.uniforms[ozt]=new h(1);t.uniforms[lzt]=new h(1);t.uniforms[hzt]=new h(1);t.uniforms[rzt]=new h(1);t.uniforms[uzt]=new h(1);t.uniforms[azt]=new h(1);t.uniforms[gzt]=new h(_Wt.yuA_)}};var Qzt=function(){let i=class t{static DuA_(t,i){if(i!=null){wzt(t);i.hasOwnProperty("logarraymin")&&(t.uniforms[ozt].value=i["logarraymin"]);i.hasOwnProperty("logarraymax")&&(t.uniforms[lzt].value=i["logarraymax"]);i.hasOwnProperty("radiusmin")&&(t.uniforms[hzt].value=i["radiusmin"]);i.hasOwnProperty("radiusdelta")&&(t.uniforms[rzt].value=i["radiusdelta"]);i.hasOwnProperty("logarraynullvalue")&&(t.uniforms[uzt].value=i["logarraynullvalue"]);i.hasOwnProperty("valuesnullvalue")&&(t.uniforms[azt].value=i["valuesnullvalue"]);i.hasOwnProperty("referencemode")&&(t.uniforms[gzt].value=i["referencemode"])}}static MuA_(t){wzt(t);return{logarraymin:t.uniforms[ozt].value,logarraymax:t.uniforms[lzt].value,radiusmin:t.uniforms[hzt].value,radiusdelta:t.uniforms[rzt].value,logarraynullvalue:t.uniforms[uzt].value,valuesnullvalue:t.uniforms[azt].value,referencemode:t.uniforms[gzt].value}}};i.vuA_=ezt;i.buA_=Azt;i.NuA_=nzt;i.SuA_=function(t){t=YFt.EXe_(t,ixt.GXe_,[czt,ixt.GXe_,Izt,"    vec3 up = vec3(0.0, 0.0, 1.0);","if( "+gzt+" == 0) { ","    float angle = atan((path.x * path.x + path.y * path.y), (path.z * path.z));","    if(angle > 0.1745 ) up = vec3(0.0, 0.0, 1.0);","    else up = vec3(0.0, 1.0, 0.0);","} else if( "+gzt+" == 1) { ","    up = vec3(0.0, 1.0, 0.0);","}",fzt].join("\n"),!0);t=YFt.EXe_(t,ixt.FXe_,Czt,!1,!1);t=YFt.EXe_(t,izt,"\nvec3 transformed = vec3( finalPos );\n",!0);t=YFt.EXe_(t,szt,"   vec3 transformedNormal = normalMatrix * normalize(rotatedPos * "+qWt._lA_+");",!0);return t=YFt.EXe_(t,ixt.LXe_,"vTransformedNormal = transformedNormal;",!1,!1)}(ixt.PXe_);i.GuA_=function(t){t=YFt.EXe_(t,ixt.GXe_,[dzt,ixt.GXe_,Bzt].join("\n"),!0);t=YFt.EXe_(t,ixt.GXe_,"varying vec3 vTransformedNormal;",!1,!0);t=YFt.EXe_(t,qWt.luA_,qWt.uuA_,!1,!1);return t=YFt.EXe_(t,qWt.auA_,qWt.guA_,!1,!0)}(ixt.VXe_);i=t([_s("geotoolkit3d.util.shaders.LogArray")],i);return i}();const Ezt=`\n    attribute vec3 normalx;\n    attribute vec3 normaly;\n    attribute vec2 coordinate;\n    uniform float radius;\n    uniform mat3 ${qWt._lA_};\n`,pzt=`\n    vec3 pos = (modelMatrix * vec4(position, 1.0)).xyz;\n    vec3 normx = coordinate.x != 0.0 ? (modelMatrix * vec4(normalx, 0.0)).xyz * coordinate.x * radius : vec3(0.0);\n    vec3 normy = coordinate.y != 0.0 ? (modelMatrix * vec4(normaly, 0.0)).xyz * coordinate.y * radius : vec3(0.0);\n    gl_Position = projectionMatrix * viewMatrix * vec4(pos + (normx + normy) * ${qWt._lA_}, 1.0);\n`,mzt=t=>{if(!t.defines.hasOwnProperty("addedLogArray2dOptions")){t.defines["addedLogArray2dOptions"]=!0;t.uniforms=N.merge([t.uniforms,{radius:new h(100)}])}};var yzt=function(){let i=class t{static RuA_(t,i){if(i!=null){mzt(t);i.hasOwnProperty("radius")&&(t.uniforms["radius"].value=i["radius"])}}static kuA_(t){mzt(t);return{radius:t.uniforms["radius"].value}}};i.FuA_=YFt.EXe_(YFt.EXe_(ixt.PXe_,ixt.GXe_,Ezt,!1,!0),ixt.LXe_,pzt,!1,!0);i.xuA_=YFt.EXe_(ixt.VXe_,qWt.luA_,qWt.uuA_,!1,!1);i=t([_s("geotoolkit3d.util.shaders.LogArray2D")],i);return i}();const Dzt=["attribute float instanceValueStart;","attribute float instanceValueEnd;","attribute vec3 instancePrevDirStart;","attribute vec3 instancePrevDirEnd;","attribute vec3 instanceNextDirStart;","attribute vec3 instanceNextDirEnd;","varying float instanceInvalid;"].join("\n"),Mzt=["\tmat3 mv = mat3(modelViewMatrix);","\tvec3 v0Start = mv * instancePrevDirStart;","\tvec3 v1Start = mv * instanceNextDirStart;","\tvec3 v0End = mv * instancePrevDirEnd;","\tvec3 v1End = mv * instanceNextDirEnd;","\tvec4 n = vec4(normalize(normalize(vec2(-v0Start.y, v0Start.x)) + normalize(vec2(-v1Start.y, v1Start.x))), "+"normalize(normalize(vec2(-v0End.y, v0End.x)) + normalize(vec2(-v1End.y, v1End.x))));","\tvec4 curveValue = clamp(vec4(instanceValueStart, instanceValueStart, instanceValueEnd, instanceValueEnd), 0.0, 1.0);","\tif("+qWt.nuA_+" == 0.0){ ","\t\tcurveValue = "+qWt.suA_+" > 0.0 ? curveValue : 1.0 - curveValue;","\t}","\tcurveValue = "+qWt.AuA_+" > "+qWt.euA_+" ? curveValue : 1.0 - curveValue;","\tcurveValue -= 0.5;","\tvec4 logCurveOffset = ((curveValue + "+qWt.suA_+") * "+qWt.iuA_+") * -n;","\tstart.xy += logCurveOffset.xy;","\tend.xy += logCurveOffset.zw;","\tinstanceInvalid = (instanceValueStart == "+ixt.NXe_+" || "+"instanceValueEnd == "+ixt.NXe_+") ? 1.0 : 0.0;"].join("\n"),vzt=["varying float instanceInvalid;"].join("\n"),bzt=["\tif (instanceInvalid == 1.0) {","\t\tdiscard;","\t}"].join("\n");var Nzt=function(){let i=class t{static LuA_(t,i){if(i){qWt.ZlA_(t,i);nUt.PZe_(t,i)}}static UuA_(t){return qi(qWt.$lA_(t),nUt.VZe_(t))}};i.YuA_=YFt.EXe_(YFt.EXe_(YFt.EXe_(nUt.$Ze_+"","uniform vec2 resolution;",qWt.cuA_,!1,!1),"uniform vec2 resolution;",Dzt,!1,!1),"    vec4 clipStart = projectionMatrix * start;",Mzt,!1,!0);i.TuA_=YFt.EXe_(YFt.EXe_(nUt.t_e_+"","varying float vLineDistance;",vzt,!1,!0),"void main() {",bzt,!1,!1);i=t([_s("geotoolkit3d.util.shaders.LogCurve2D")],i);return i}();const Szt="cgpositiveColor",Gzt="cgnegativeColor",Rzt=function(t){if(!t.defines.hasOwnProperty("addedLogFill2DShaders")){t.defines["addedLogFill2DShaders"]=!0;t.uniforms[Szt]=new h(new l("red"));t.uniforms[Gzt]=new h(new l("red"))}},kzt=[qWt.cuA_,"attribute vec3 "+qWt.huA_+";","attribute vec3 "+qWt.ruA_+";","attribute float "+qWt.ouA_+";","#ifdef USE_COLOR","\tvarying vec3 vertexColor;","#endif"].join("\n"),Fzt=["\t#ifdef USE_COLOR","\t\tvertexColor = color;","\t#endif","\tvec4 pos = modelViewMatrix * vec4(position, 1.0);","\t","\tvec3 v0 = mat3(modelViewMatrix) * "+qWt.huA_+"; ","\tvec3 v1 = mat3(modelViewMatrix) * "+qWt.ruA_+"; ","\t","\tvec2 n0 = normalize(vec2(-v0.y, v0.x));","\tvec2 n2 = normalize(vec2(-v1.y, v1.x));","\tvec2 n1 = normalize(n0 + n2);","\t","\tfloat curveValue = ("+qWt.ouA_+" - min("+qWt.euA_+", "+qWt.AuA_+")) / abs("+qWt.AuA_+" - "+qWt.euA_+");","\tcurveValue = clamp(curveValue, 0.0, 1.0);","\tif("+qWt.nuA_+" == 0.0){ ","\t\tcurveValue = "+qWt.suA_+" > 0.0 ? curveValue : 1.0 - curveValue;","\t}","\tcurveValue = "+qWt.AuA_+" > "+qWt.euA_+" ? curveValue : 1.0 - curveValue;","\tcurveValue -= 0.5;","\tpos.xyz = pos.xyz + ((curveValue + "+qWt.suA_+") * "+qWt.iuA_+") * -vec3(n1, 0.0);","\tgl_Position = projectionMatrix * pos;"].join("\n");var xzt=function(){var t=class{static KuA_(t,i){if(i){Rzt(t);i.hasOwnProperty("positivecolor")&&(t.uniforms[Szt].value=new l(i["positivecolor"]));i.hasOwnProperty("negativecolor")&&(t.uniforms[Gzt].value=new l(i["negativecolor"]))}}static HuA_(t){Rzt(t);return{positivecolor:t.vertexColors?null:t.uniforms[Szt].value,negativecolor:t.vertexColors?null:t.uniforms[Gzt].value}}};t.quA_="cgposnegFlag";t.JuA_=["#include <common>","#include <logdepthbuf_pars_vertex>",kzt,"attribute float "+t.quA_+";","varying float v"+t.quA_+";","",ixt.GXe_,Fzt,"\tv"+t.quA_+" = "+t.quA_+";","#include <logdepthbuf_vertex>","}"].join("\n");t.PuA_=["uniform vec3 "+Szt+";","uniform vec3 "+Gzt+";","uniform float "+qWt.tuA_+";","#include <logdepthbuf_pars_fragment>","varying vec3 vertexColor;","varying float v"+t.quA_+";",ixt.GXe_,"\t#ifdef USE_COLOR","\t\tgl_FragColor = vec4(vertexColor.rgb, "+qWt.tuA_+");","\t#else","\t\tgl_FragColor = vec4(v"+t.quA_+" >= 0.0 ? "+Szt+" : "+Gzt+", "+qWt.tuA_+");","\t#endif","#include <logdepthbuf_fragment>","}"].join("\n");return t}();var Lzt=Ci({z_:"Left",X_:"Right",v6_:"Both"},2,"eyJMZWZ0Ijoiel8iLCJSaWdodCI6IlhfIiwiQm90aCI6InY2XyJ9");const Uzt=`\n    attribute vec3 instancePrevDirStart;\n    attribute vec3 instancePrevDirEnd;\n    attribute vec3 instanceNextDirStart;\n    attribute vec3 instanceNextDirEnd;\n    attribute float offsetDirectionStart;\n    attribute float offsetDirectionEnd;\n    uniform float radius;\n    uniform float leftSideOn;\n    uniform float rightSideOn;\n`,Yzt=`\n    mat3 mv = mat3(modelViewMatrix);\n    vec3 v0Start = mv * instancePrevDirStart;\n    vec3 v1Start = mv * instanceNextDirStart;\n    vec3 v0End = mv * instancePrevDirEnd;\n    vec3 v1End = mv * instanceNextDirEnd;\n    vec4 n = vec4(normalize(normalize(vec2(-v0Start.y, v0Start.x)) + normalize(vec2(-v1Start.y, v1Start.x))),\n    normalize(normalize(vec2(-v0End.y, v0End.x)) + normalize(vec2(-v1End.y, v1End.x))));\n    float offsetStart = offsetDirectionStart;\n    float offsetEnd = offsetDirectionEnd;\n    if (leftSideOn == 0.0) {\n        if (offsetStart < 0.0) {\n            offsetStart = 0.0;\n        }\n        if (offsetEnd < 0.0) {\n            offsetEnd = 0.0;\n        }\n    }\n    if (rightSideOn == 0.0) {\n        if (offsetStart > 0.0) {\n            offsetStart = 0.0;\n        }\n        if (offsetEnd > 0.0) {\n            offsetEnd = 0.0;\n        }\n    }\n    vec4 logGridLineOffset = radius * vec4(offsetStart, offsetStart, offsetEnd, offsetEnd) * -n;\n    start.xy += logGridLineOffset.xy;\n    end.xy += logGridLineOffset.zw;\n`,Tzt=`\n    attribute vec3 instancePrevDir;\n    attribute vec3 instanceNextDir;\n    attribute float offsetDirection;\n    uniform float radius;\n    uniform float leftSideOn;\n    uniform float rightSideOn;\n`,Kzt=`\n    mat3 mv = mat3(modelViewMatrix);\n    vec3 v0 = mv * instancePrevDir;\n    vec3 v1 = mv * instanceNextDir;\n    vec2 n = normalize(normalize(vec2(-v0.y, v0.x)) + normalize(vec2(-v1.y, v1.x)));\n    float offsetDir = offsetDirection;\n    if (leftSideOn == 0.0 && offsetDir < 0.0) {\n        offsetDir = 0.0;\n    }\n    if (rightSideOn == 0.0 && offsetDir > 0.0) {\n        offsetDir = 0.0;\n    }\n    vec2 logGridLineOffset = radius * offsetDir * n;\n    mvPosition.xy += logGridLineOffset.xy;\n    mvPosition.z -= 1.0;\n    gl_Position = projectionMatrix * mvPosition;\n`,Hzt=t=>{if(!t.defines.hasOwnProperty("addedLogGrid2dLineOptions")){t.defines["addedLogGrid2dLineOptions"]=!0;t.uniforms=N.merge([t.uniforms,{radius:new h(100),leftSideOn:new h(1),rightSideOn:new h(1)}])}},qzt=t=>{if(!t.defines.hasOwnProperty("addedLogGrid2dBackgroundOptions")){t.defines["addedLogGrid2dBackgroundOptions"]=!0;t.uniforms=N.merge([t.uniforms,N.clone(S["basic"].uniforms),{radius:new h(100),leftSideOn:new h(1),rightSideOn:new h(1)}])}},Jzt=t=>t["leftSideOn"].value===1&&t["rightSideOn"].value===0?Lzt.z_:t["leftSideOn"].value===0&&t["rightSideOn"].value===1?Lzt.X_:Lzt.v6_,Pzt=(t,i)=>{switch(i){case Lzt.z_:t["leftSideOn"].value=1;t["rightSideOn"].value=0;break;case Lzt.X_:t["leftSideOn"].value=0;t["rightSideOn"].value=1;break;case Lzt.v6_:t["leftSideOn"].value=1;t["rightSideOn"].value=1;break}};var Vzt=function(){let i=class t{static VuA_(t,i){if(i!=null){nUt.PZe_(t,i);Hzt(t);i.hasOwnProperty("radius")&&(t.uniforms["radius"].value=+i["radius"]);i.hasOwnProperty("alignment")&&Pzt(t.uniforms,i["alignment"])}}static OuA_(t){return qi({radius:t.uniforms["radius"].value,alignment:Jzt(t.uniforms)},nUt.VZe_(t))}static WuA_(t,i){if(i!=null){qzt(t);i.hasOwnProperty("radius")&&(t.uniforms["radius"].value=+i["radius"]);i.hasOwnProperty("alignment")&&Pzt(t.uniforms,i["alignment"])}}static zuA_(t){return{radius:t.uniforms["radius"].value,alignment:Jzt(t.uniforms)}}};i.XuA_=YFt.EXe_(YFt.EXe_(nUt.$Ze_+"","uniform vec2 resolution;",Uzt,!1,!1),"    vec4 clipStart = projectionMatrix * start;",Yzt,!1,!0);i.juA_=nUt.t_e_+"";i.ZuA_=YFt.EXe_(YFt.EXe_(n.meshbasic_vert+"","void main()",Tzt,!1,!0),"#include <project_vertex>",Kzt,!1,!1);i._uA_=n.meshbasic_frag+"";i=t([_s("geotoolkit3d.util.shaders.LogGrid2D")],i);return i}();const Ozt=YFt,Wzt="addedPipeShaders",zzt="cgRadius",Xzt="cgScale",jzt="cgUseGlobalRadius",Zzt="cgGlobalRadius",_zt=["attribute float "+zzt+";","uniform mat3 "+qWt._lA_+";","uniform float "+Xzt+";","uniform float "+jzt+";","uniform float "+Zzt+";"].join("\n"),$zt=["vec3 vecPos = (modelMatrix * vec4(position, 1.0)).xyz;","vec3 vecNormal = normalize(normal * "+qWt._lA_+");","float localscale = "+Xzt+";","if("+jzt+" > 0.0) {","    localscale *= "+Zzt+";","} else {","    localscale *= "+zzt+";","}","gl_Position = projectionMatrix * viewMatrix * vec4(vecPos + (vecNormal * localscale), 1.0);"].join("\n"),tXt=function(t){if(!t.defines.hasOwnProperty(Wzt)){t.defines[Wzt]=!0;t.uniforms[Xzt]=new h(1);t.uniforms[jzt]=new h(0);t.uniforms[Zzt]=new h(0)}};var iXt=function(){let i=class t{static $uA_(t,i){if(i!=null){tXt(t);i.hasOwnProperty("radiusscale")&&(t.uniforms[Xzt].value=i["radiusscale"]);if(i.hasOwnProperty("globalradius"))if(i["globalradius"]===0){t.uniforms[Zzt].value=i["globalradius"];t.uniforms[jzt].value=0}else{t.uniforms[Zzt].value=i["globalradius"];t.uniforms[jzt].value=1}}}static taA_(t){tXt(t);return{radiusscale:t.uniforms[Xzt].value,globalradius:t.uniforms[Zzt].value}}};i.iaA_=zzt;i.saA_=ixt.VXe_;i.eaA_=function(t){t=Ozt.EXe_(t,ixt.GXe_,_zt,!1,!0);return t=Ozt.EXe_(t,ixt.LXe_,$zt,!1,!0)}(ixt.PXe_);i=t([_s("geotoolkit3d.util.shaders.Pipe")],i);return i}();const sXt=t=>{if(!t.defines.hasOwnProperty("addedProjectionWidgetShaders")){t.uniforms["tDiffuse"]=new h(null);t.defines["addedProjectionWidgetShader"]=!0}};var eXt=function(){let i=class t{static setTexture(t,i){sXt(t);t.defines["textureLoaded"]=!0;t.uniforms["tDiffuse"].value=i}};i.VERTEX_SHADER=["varying vec2 vUv;","#include <common>","#include <envmap_pars_vertex>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>","","void main() {","    vUv = uv;","    #include <color_vertex>","    #include <skinbase_vertex>","    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","    #include <logdepthbuf_vertex>","    #include <clipping_planes_vertex>","    #include <envmap_vertex>","    #include <fog_vertex>","}"].join("\n");i.FRAGMENT_SHADER=["varying vec2 vUv;","","uniform sampler2D tDiffuse;","#include <common>","#include <dithering_pars_fragment>","#include <color_pars_fragment>","#include <uv_pars_fragment>","#include <alphamap_pars_fragment>","#include <aomap_pars_fragment>","#include <lightmap_pars_fragment>","#include <envmap_common_pars_fragment>","#include <envmap_pars_fragment>","#include <cube_uv_reflection_fragment>","#include <fog_pars_fragment>","#include <specularmap_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <clipping_planes_pars_fragment>","","void main () {","    #include <clipping_planes_fragment>","    #include <logdepthbuf_fragment>","    #include <color_fragment>","    #include <alphamap_fragment>","    #include <alphatest_fragment>","    #include <specularmap_fragment>","    #include <aomap_fragment>","    #include <envmap_fragment>","    #ifndef textureLoaded","        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);","    #else","        gl_FragColor = vec4(0.5, 0.5, 0.5, texture2D(tDiffuse, vUv).a * 0.5);","    #endif","    #include <tonemapping_fragment>","    #include <encodings_fragment>","    #include <fog_fragment>","    #include <premultiplied_alpha_fragment>","    #include <dithering_fragment>","}"].join("\n");i=t([_s("geotoolkit3d.util.shaders.ProjectionWidget")],i);return i}();const AXt="overlayMap";var nXt=function(){let i=class t{static AaA_(t){t.uniforms[AXt]||(t.uniforms[AXt]=new h(null))}static p9e_(t,i){i.hasOwnProperty("overlaymap")&&(t.uniforms[AXt].value=i["overlaymap"])}static naA_(t){return t.uniforms.hasOwnProperty(AXt)?{overlaymap:t.uniforms[AXt].value}:{}}static dispose(t){if(t.uniforms[AXt].value!=null){fLt.$je_(t.uniforms[AXt].value);t.uniforms[AXt].value=null}}};i.haA_="#define USE_UV\n"+n.meshbasic_vert;i.raA_=function(){let t=n.meshbasic_frag;const i="uniform sampler2D "+AXt+";",s=["#ifdef USE_UV","#ifndef "+AFt,"    vec4 overlayColor = texture2D("+AXt+", vMapUv);","    diffuseColor.rgb *= diffuseColor.a;","    diffuseColor.rgb = diffuseColor.rgb * (1.0 - overlayColor.a) + overlayColor.rgb * overlayColor.a;","    diffuseColor.a = min(1.0, diffuseColor.a + overlayColor.a);","    diffuseColor.rgb /= diffuseColor.a;","#endif","#endif"].join("\n");t="#define USE_UV\n"+t;t=YFt.EXe_(t,ixt.SXe_,i,!1,!0);t=YFt.EXe_(t,ixt.kXe_,s,!1,!0);return t}();i=t([_s("geotoolkit3d.util.shaders.SliceTileShaders")],i);return i}();const hXt=YFt,rXt="addedTrajectoryTubeShaders",oXt="cgtubeSize",lXt=["uniform float "+oXt+";","uniform mat3 "+qWt._lA_+";"].join("\n"),uXt=["vec3 vecPos = (modelMatrix * vec4(position, 1.0)).xyz;","vec3 vecNormal = normalize(normal * "+qWt._lA_+");","gl_Position = projectionMatrix * viewMatrix * vec4(vecPos + (vecNormal * vec3("+oXt+", "+oXt+", "+oXt+")), 1.0);"].join("\n"),aXt=function(t){if(!t.defines.hasOwnProperty(rXt)){t.defines[rXt]=!0;t.uniforms[oXt]=new h(1)}};var gXt=function(){let i=class t{static oaA_(t,i){if(i!=null){aXt(t);if(t.uniforms[oXt]!=null&&i["size"]){t.uniforms[oXt].value=i["size"];t.userData["size"]=i["size"]}}}static laA_(t){aXt(t);return{size:t.uniforms[oXt].value}}};i.uaA_=function(t){t=hXt.EXe_(t,ixt.GXe_,lXt,!1,!0);return t=hXt.EXe_(t,ixt.LXe_,uXt,!1,!0)}(ixt.PXe_);i.aaA_=ixt.VXe_;i=t([_s("geotoolkit3d.util.shaders.TrajectoryTube")],i);return i}();const cXt=["varying vec3 localCubeCoords;","varying vec4 projectedCoords;","varying mat4 mMatrix;"].join("\n"),IXt=["uniform sampler2D tex;","uniform float alphaCorrection;","uniform int textureSize;","uniform int textureArea;","uniform float minData;","uniform float maxData;","uniform vec3 sizeData;","uniform vec3 sizeInScene;","uniform vec3 scale;","uniform sampler2D transfertTex;","uniform sampler2D dataTex[12];","uniform bool flipZ;  ","uniform bool switchLights;","uniform float delta;","uniform int maxStep;","const int MAX_STEPS = 4096;"].join("\n"),fXt=["vec3 floorSpecial(vec3 a){","    return max(min(floor(a), sizeData -0.5) , 0.);","}"].join("\n"),CXt=["float getIntensity(vec3 pos) {","    pos.z = flipZ ? pos.z : sizeData.z - pos.z;","    vec3 position_1 = floorSpecial(pos);","    float intensity = 0.0;","    int textureIndex = 0;","    int sizeDataX = int(sizeData.x);","    int sizeDataZ = int(sizeData.z);","    int pos1Y = int(position_1.y);","    textureIndex += (sizeDataZ * sizeDataX / textureSize) * pos1Y / textureSize;","    int ypart = sizeDataZ * sizeDataX * pos1Y - textureIndex * textureArea;","    int xpart =  sizeDataZ * int(position_1.x);","    int totalCoord = int(position_1.z) + xpart + ypart;","    int textureIndex2 = totalCoord / textureArea;","    totalCoord = totalCoord - (textureIndex2 * (textureArea));","    textureIndex += textureIndex2;","    int Ycomp = totalCoord / textureSize;","    int Xcomp = totalCoord - Ycomp * textureSize;","    float coordX = float(Xcomp) / float(textureSize);","    float coordY = float(Ycomp) / float(textureSize);","    if(textureIndex == 0)","        intensity = float(texture2D(dataTex[0], vec2(coordX, coordY)).r);","    else if(textureIndex == 1)","        intensity = float(texture2D(dataTex[1], vec2(coordX, coordY)).r);","    else if(textureIndex == 2)","        intensity = float(texture2D(dataTex[2], vec2(coordX, coordY)).r);","    else if(textureIndex == 3)","        intensity = float(texture2D(dataTex[3], vec2(coordX, coordY)).r);","    else if(textureIndex == 4)","        intensity = float(texture2D(dataTex[4], vec2(coordX, coordY)).r);","    else if(textureIndex == 5)","        intensity = float(texture2D(dataTex[5], vec2(coordX, coordY)).r);","    else if(textureIndex == 6)","        intensity = float(texture2D(dataTex[6], vec2(coordX, coordY)).r);","    else if(textureIndex == 7)","        intensity = float(texture2D(dataTex[7], vec2(coordX, coordY)).r);","    else if(textureIndex == 8)","        intensity = float(texture2D(dataTex[8], vec2(coordX, coordY)).r);","    else if(textureIndex == 9)","        intensity = float(texture2D(dataTex[9], vec2(coordX, coordY)).r);","    else if(textureIndex == 10)","        intensity = float(texture2D(dataTex[10], vec2(coordX, coordY)).r);","    else if(textureIndex == 11)","        intensity = float(texture2D(dataTex[11], vec2(coordX, coordY)).r);","    else","        intensity = 0.0;","    return intensity;","}"].join("\n"),dXt=["vec3 transfromCoordinates(vec3 position_2) {","    return (((position_2)/ sizeInScene + 0.5) * (sizeData));","}"].join("\n"),BXt=["void neighbor(in vec3 pos, out vec3 inf, out vec3 supp){","    if (pos.x == 0. ) {","        inf.x = getIntensity(vec3(pos.x,pos.y,pos.z));","        supp.x = getIntensity(vec3(pos.x +1.,pos.y,pos.z));","    } else if (pos.x == sizeData.x -1.) {","        inf.x = getIntensity(vec3(pos.x - 1.,pos.y,pos.z));","        supp.x = getIntensity(vec3(pos.x,pos.y,pos.z));","    } else {","        inf.x = getIntensity(vec3(pos.x -1.,pos.y,pos.z));","        supp.x = getIntensity(vec3(pos.x +1.,pos.y,pos.z));","    }","    if (pos.y == 0. ) {","        inf.y = getIntensity(vec3(pos.x,pos.y,pos.z));","        supp.y = getIntensity(vec3(pos.x,pos.y +1.,pos.z));","    } else if (pos.y == sizeData.y -1.) {","        inf.y = getIntensity(vec3(pos.x,pos.y - 1.,pos.z));","        supp.y = getIntensity(vec3(pos.x,pos.y,pos.z));","    } else {","        inf.y = getIntensity(vec3(pos.x,pos.y -1.,pos.z));","        supp.y = getIntensity(vec3(pos.x,pos.y +1.,pos.z));","    }","    if (pos.z == 0. ) {","        inf.z = getIntensity(vec3(pos.x,pos.y,pos.z));","        supp.z = getIntensity(vec3(pos.x,pos.y,pos.z +1.));","    } else if (pos.z == sizeData.z -1.) {","        inf.z = getIntensity(vec3(pos.x,pos.y,pos.z - 1.));","        supp.z = getIntensity(vec3(pos.x,pos.y,pos.z));","    } else {","        inf.z = getIntensity(vec3(pos.x,pos.y,pos.z -1.));","        supp.z = getIntensity(vec3(pos.x,pos.y,pos.z +1.));","    }","}"].join("\n"),wXt=["vec3 inf;","vec3 supp;","neighbor(currentPositionTransformed,inf,supp);","vec4 addedLights = vec4(0.0,0.0,0.0, 0.0);","#if NUM_POINT_LIGHTS > 1","    for(int l = 0; l < NUM_POINT_LIGHTS; l++) {","        PointLight pointLight = pointLights[ l ];","        vec3 lightDirection = normalize((mMatrix*vec4(currentPosition,1.) - mMatrix*vec4(pointLight.position,1.) ).xyz);","        addedLights.rgb += clamp(-dot(-lightDirection, -normalize(supp-inf)), 0.0, 1.0) * pointLight.color;","        addedLights.rgb += clamp(-dot(-normalize(currentPosition - frontPos), -normalize(supp-inf)), 0.0, 1.0) * addedLights.rgb;","    }","#elif NUM_POINT_LIGHTS == 1","    PointLight pointLight = pointLights[ 0 ];","    vec3 lightDirection = normalize((mMatrix*vec4(currentPosition,1.) - mMatrix*vec4(pointLight.position,1.) ).xyz);","    addedLights.rgb += clamp(-dot(-lightDirection, -normalize(supp-inf)), 0.0, 1.0) * pointLight.color;","    addedLights.rgb += clamp(-dot(-normalize(currentPosition - frontPos), -normalize(supp-inf)), 0.0, 1.0) * addedLights.rgb;","#endif","colorSample = vec4(mix(colorSample, addedLights, addedLights).rgb,colorSample.a);"].join("\n"),QXt=["vec4 transform(float intensity){","    return texture2D(transfertTex,vec2(intensity,0.5));","}"].join("\n"),EXt=["vec4 transform(float intensity){","    return texture2D(transfertTex,vec2((intensity-minData)/(maxData-minData),0.5));","}"].join("\n"),pXt=[cXt,IXt,"#include <common>","#include <packing>","#include <aomap_pars_fragment>","#include <lightmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>"].join("\n"),mXt=[fXt,CXt,dXt,BXt,"void main() {","    vec2 texc = ((projectedCoords.xy / projectedCoords.ww) + 1.0) / 2.0;","    vec3 backPos = texture2D(tex, texc).xyz;","    vec3 frontPos = localCubeCoords;","    vec3 dir = backPos - frontPos;","    vec3 deltaDirection = dir * delta;","    vec3 dirTransformed = transfromCoordinates(backPos) - transfromCoordinates(frontPos);","    vec3 deltaDirectionTransformed = dirTransformed * delta;","    vec3 currentPosition = frontPos;","    vec3 currentPositionTransformed = transfromCoordinates(currentPosition);","    vec3 accumulatedColor = vec3(0.0);","    float accumulatedAlpha = 0.0;","    vec4 colorSample;","    float alphaSample;","    for (int i = 0; i < MAX_STEPS; i++) {","        colorSample = transform(getIntensity(currentPositionTransformed));","        if (switchLights) {","            if (colorSample.a > 0.2 && switchLights) {",wXt,"            }","            currentPosition += deltaDirection;","        }","        if (colorSample.a > 0.0) {","            alphaSample = colorSample.a * alphaCorrection;","            alphaSample *= (1.0 - accumulatedAlpha);","            accumulatedColor += colorSample.rgb * alphaSample;","            accumulatedAlpha += alphaSample ;","            if(accumulatedAlpha >= 0.9999) {","                break;","            }","        }","        if(i >= maxStep) {","            break;","        }","        currentPositionTransformed += deltaDirectionTransformed;","    }","    gl_FragColor = vec4(accumulatedColor,accumulatedAlpha);","}"].join("\n"),yXt=t=>{if(!t.defines.hasOwnProperty("addedRenderingVolumeShaders")){t.defines["addedRenderingVolumeShaders"]=!0;t.uniforms=N.merge([O["lights"],{tex:{type:"t",value:void 0},alphaCorrection:{type:"1f",value:void 0},sizeInScene:{type:"v3",value:void 0},sizeData:{type:"v3",value:void 0},dataTex:{type:"tv",value:void 0},textureSize:{type:"1i",value:mKt.N6e_()},textureArea:{type:"1i",value:mKt.N6e_()*mKt.N6e_()},minData:{type:"1f",value:void 0},maxData:{type:"1f",value:void 0},flipZ:{type:"b",value:!1},switchLights:{type:"b",value:!1},scale:{type:"v3",value:new a(1,1,1)},transfertTex:{type:"t",value:void 0},delta:{type:"1f",value:void 0},maxStep:{type:"1i",value:4096}}])}};var DXt=function(){let i=class t{static gaA_(t,i){if(!i)return!1;yXt(t);let s=!1;const e=t.uniforms;if(i["alphaCorrection"]!=null&&i["alphaCorrection"]!==e["alphaCorrection"].value){e["alphaCorrection"].value=i["alphaCorrection"];s=!0}if(i["flipZ"]!=null&&i["flipZ"]!==e["flipZ"].value){e["flipZ"].value=i["flipZ"];s=!0}if(i["switchLights"]!=null&&i["switchLights"]!==e["switchLights"].value){e["switchLights"].value=i["switchLights"];s=!0}if(i["minData"]!=null&&i["minData"]!==e["minData"].value){e["minData"].value=i["minData"];s=!0}if(i["maxData"]!=null&&i["maxData"]!==e["maxData"].value){e["maxData"].value=i["maxData"];s=!0}i["tex"]!=null&&(e["tex"].value=i["tex"]);i["sizeInScene"]!=null&&(e["sizeInScene"].value=i["sizeInScene"]);i["sizeData"]!=null&&(e["sizeData"].value=i["sizeData"]);i["textureSize"]!=null&&(e["textureSize"].value=i["textureSize"]);i["textureArea"]!=null&&(e["textureArea"].value=i["textureArea"]);i["scale"]!=null&&(e["scale"].value=i["scale"]);i["transfertTex"]!=null&&(e["transfertTex"].value=i["transfertTex"]);i["delta"]!=null&&(e["delta"].value=i["delta"]);i["maxStep"]!=null&&(e["maxStep"].value=i["maxStep"]);if(i["dataTex"]!=null){if(t.uniforms["dataTex"].value!=null)for(const i in t.uniforms["dataTex"].value){const s=t.uniforms["dataTex"].value[i];if(s!=null){delete s.image.data;s.dispose()}}e["dataTex"].value=i["dataTex"]}return s}static caA_(t){yXt(t);const i=t.uniforms;return{alphaCorrection:i["alphaCorrection"].value,dataTex:i["dataTex"].value,delta:i["delta"].value,flipZ:i["flipZ"].value,maxData:i["maxData"].value,maxStep:i["maxStep"].value,minData:i["minData"].value,scale:i["scale"].value,sizeData:i["sizeData"].value,sizeInScene:i["sizeInScene"].value,switchLights:i["switchLights"].value,tex:i["tex"].value,textureArea:i["textureArea"].value,textureSize:i["textureSize"].value,transfertTex:i["transfertTex"].value}}};i.IaA_=["varying vec3 localCubeCoords;","void main() {","    localCubeCoords = (modelMatrix * vec4(position , 0.0)).xyz ;","    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n");i.faA_=["varying vec3 localCubeCoords;","void main() {","    gl_FragColor = vec4(localCubeCoords.x , localCubeCoords.y, localCubeCoords.z, 1);","}"].join("\n");i.CaA_=[cXt,"void main() {","    localCubeCoords = (modelMatrix * vec4(position , 0.0)).xyz;","    mMatrix = modelMatrix;","    projectedCoords = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","    gl_Position = projectedCoords;","}"].join("\n");i.daA_=[pXt,QXt,mXt].join("\n");i.BaA_=[pXt,EXt,mXt].join("\n");i=t([_s("geotoolkit3d.util.shaders.Volumetric")],i);return i}();const MXt=function(t,i){const s=new g;t.getSize(s);const e=(i.min.x-t.min.x)/s.x,A=(i.min.y-t.min.y)/s.y,n=(i.max.x-t.min.x)/s.x,h=(i.max.y-t.min.y)/s.y;return[[[new g(e,h),new g(e,A),new g(n,h)],[new g(e,A),new g(n,A),new g(n,h)]]]},vXt=new xA,bXt=new g,NXt=new g,SXt=new g,GXt=new g;let RXt=new a(-.5,-.5,0),kXt=new a(-.5,.5,0),FXt=new a(.5,.5,0),xXt=new a(.5,-.5,0);const LXt=new u;var UXt=function(){let i=class t extends fUt{constructor(t){super();this.waA_=new bt(1,1,1,1);this.GEs_=t["maxlod"];this.SEs_=t["minlod"];this.QaA_=0;this.EaA_=t["formatterfunction"];this.paA_=new Ai;this.maA_=new u;this.a8i_=new At;this.a8i_.crossOrigin="Anonymous";this.FoA_=t["extent"];this.yaA_=t["server"];this.DaA_=fLt.lZe_();this.MaA_=[];this.Rb_=1;this.vaA_=new F({side:e,color:11184810});this.qhA_=new W(new bt,new F);this.qhA_.geometry.setDrawRange(0,0);this.qhA_.parent=this;this.baA_()}NaA_(){if(Array.isArray(this.yaA_)===!1)return this.yaA_;this.QaA_=(this.QaA_+1)%this.yaA_.length;return this.yaA_[this.QaA_]}_I_(t){if(this.Rb_!==t){const i=t<1,s=function(e){if(e.material!=null){const s=undefined;(Array.isArray(e.material)?e.material:[e.material]).forEach((function(s){s.opacity=t;s.transparent=i}))}e.userData.SaA_!=null&&e.userData.SaA_.forEach(s)};this.Rb_=t;s(this._root);this.vaA_.opacity=t;this.vaA_.transparent=i}}Kb_(){return this.Rb_}OoA_(t){let i;const s=t.GaA_,A=t.RaA_,n=t.kaA_,h=this.EaA_(s,A,n),r=new a;if(kxt.containsBox(this.FoA_,t.FaA_)){i=new W(this.waA_);t.FaA_.getCenter(i.position);i.position.z=0;t.FaA_.getSize(r);i.scale.set(r.x,r.y,1);i.userData.xaA_=!0}else{i=new W(new bt(1,1,1,1));const s=kxt.yje_(this.FoA_,t.FaA_);s.getCenter(i.position);i.position.z=0;s.getSize(r);i.scale.set(r.x,r.y,1);i.geometry.faceVertexUvs=MXt(t.FaA_,s);i.geometry.uvsNeedUpdate=!0}i.material=this.vaA_;i.parent=this;const o=this.Rb_;s>=this.SEs_&&this.a8i_.load(this.NaA_()+h,(function(t){if(i!=null&&i.parent!=null){i.material=new F({map:t,side:e,opacity:o,transparent:o<1});Uxt.addResource(i,t);i.parent.children.indexOf(i)!==-1&&fUt.prototype.invalidateObject.call(i)}else t.dispose()}),{});i.userData.FaA_=t.FaA_;i.userData.depth=s;i.userData.x=A;i.userData.y=n;return i}LaA_(t){if(t!=null){if(t.userData.SaA_!=null)for(let i=0;i<t.userData.SaA_.length;i++)this.LaA_(t.userData.SaA_[i]);t.parent!=null&&t.parent.remove(t);if(t instanceof m){Uxt.disposeResources(t);fLt.dispose(t.children)}t.dispose!=null&&t.dispose();if(t.geometry!=null&&t.userData.xaA_!==!0){t.geometry.dispose();t.geometry=null}fLt.tZe_(t.material);t.material=null}}UaA_(t){const i=[],s=t.userData.FaA_.clone(),e=new a;s.getCenter(e);const A=[Math.round(s.min.x),Math.round(e.x),Math.round(s.max.x)],n=[Math.round(s.max.y),Math.round(e.y),Math.round(s.min.y)];for(let s=0;s<2;s++)for(let e=0;e<2;e++){const h={FaA_:new c(new g(A[s],n[e+1]),new g(A[s+1],n[e])),RaA_:t.userData.x*2+e,kaA_:t.userData.y*2+s,GaA_:t.userData.depth+1};if(kxt.intersectBox(this.FoA_,h.FaA_)){const s=this.OoA_(h);i.push(s);s.userData.YaA_=t}}return i}baA_(){if(this.yaA_!=null&&this.EaA_!=null){this.LaA_(this._root);const t={FaA_:this.DaA_.clone(),RaA_:0,kaA_:0,GaA_:0};this._root=this.OoA_(t);this.add(this._root);this.invalidateObject();this.qhA_.scale.copy(this._root.scale);this.qhA_.rotation.copy(this._root.rotation);this.qhA_.position.copy(this._root.position)}}TaA_(t){if(!t.equals(this.FoA_)){this.FoA_=t;this.baA_()}return this}KaA_(){return this.FoA_}HaA_(t){if(t!==this.GEs_){this.GEs_=t;this.baA_()}return this}Ess_(){return this.GEs_}qaA_(t){if(t!==this.SEs_){this.SEs_=t;this.baA_()}return this}Qss_(){return this.SEs_}JaA_(t){if(t!==this.yaA_){this.yaA_=t;this.baA_()}return this}PaA_(){return this.yaA_}VaA_(t){if(t!==this.EaA_){this.EaA_=t;this.baA_()}return this}OaA_(){return this.EaA_}WaA_(t){t.userData.SaA_==null&&t.userData.depth<this.GEs_&&(t.userData.SaA_=this.UaA_(t))}add(t){if(t instanceof m){t.parent!==void 0&&t.parent.remove(t);t.parent=this;this.children.push(t)}return this}remove(t){const i=this.children.indexOf(t);if(i!==-1){t.parent=void 0;this.children.splice(i,1)}return this}beforeRender(t,i,s){const e=[];this._root!=null&&e.push(this._root);let A;this.MaA_=[];i.matrixWorldInverse.copy(i.matrixWorld).invert();LXt.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse);this.paA_.setFromProjectionMatrix(LXt);const n=this;function h(){n.WaA_(A,!0);if(A.userData.SaA_!=null)for(let t=0;t<A.userData.SaA_.length;t++)e.push(A.userData.SaA_[t]);else n.MaA_.push(A)}s.getSize(vXt);while(e.length>0){A=e.shift();{if(A.userData.depth<this.SEs_){h();continue}A.updateMatrixWorld();if(!this.paA_.intersectsObject(A))continue;RXt.set(A.userData.FaA_.min.x,A.userData.FaA_.min.y,0);kXt.set(A.userData.FaA_.min.x,A.userData.FaA_.max.y,0);FXt.set(A.userData.FaA_.max.x,A.userData.FaA_.max.y,0);xXt.set(A.userData.FaA_.max.x,A.userData.FaA_.min.y,0);RXt=this.localToWorld(RXt);kXt=this.localToWorld(kXt);FXt=this.localToWorld(FXt);xXt=this.localToWorld(xXt);fLt.eZe_(RXt,i,vXt,bXt);fLt.eZe_(kXt,i,vXt,NXt);fLt.eZe_(FXt,i,vXt,SXt);fLt.eZe_(xXt,i,vXt,GXt);const t=undefined,s=undefined,e=(NXt.distanceTo(SXt)+bXt.distanceTo(GXt))/2,n=bXt.distanceTo(NXt),r=SXt.distanceTo(GXt),o=undefined;e>341||(n+r)/2>341?h():this.MaA_.push(A)}}this.children=this.MaA_.slice();this.children.push(this.qhA_)}u_e_(){return!0}a_e_(){return[this.qhA_]}};i=t([_s("geotoolkit3d.scene.map.MapTile")],i);return i}();var YXt=Ci(function(){let i=class t extends fUt{constructor(t){super();const i=qi(t,{maxlod:10,minlod:0,extent:fLt.lZe_(),maplimits:fLt.lZe_(),opacity:1});this.zaA_=new UXt(i);this.add(this.zaA_);this.setOptions(i)}setOptions(t){if(t==null)return this;super.setOptions(t);if(t["maplimits"]!=null&&t["extent"]!=null){this.jCt_=t["maplimits"];let i=new g;this.jCt_.getCenter(i);const s=new g;i=i.sub(t["extent"].getCenter(s));const e=new g,A=new g;this.jCt_.getSize(e);t["extent"].getSize(A);this.scale.set(e.x/A.x,e.y/A.y,1);this.position.set(i.x*this.scale.x,i.y*this.scale.y,0)}t["extent"]!=null&&this.zaA_.TaA_(t["extent"]);t["maxlod"]!=null&&this.zaA_.HaA_(t["maxlod"]);t["minlod"]!=null&&this.zaA_.qaA_(t["minlod"]);t["server"]!=null&&this.zaA_.JaA_(t["server"]);t["formatterfunction"]!=null&&this.zaA_.VaA_(t["formatterfunction"]);t["opacity"]!=null&&this.zaA_._I_(t["opacity"]);this.invalidateObject();return this}JV_(){return Pi({maplimits:this.jCt_,extent:this.zaA_.KaA_(),minlod:this.zaA_.Qss_(),maxlod:this.zaA_.Ess_(),server:this.zaA_.PaA_(),formatterfunction:this.zaA_.OaA_(),opacity:this.zaA_.Kb_()},super.JV_())}zje_(){return new C(new a(this.jCt_.min.x,this.jCt_.min.y,-.5),new a(this.jCt_.max.x,this.jCt_.max.y,.5))}};i=t([_s("geotoolkit3d.scene.map.TiledMap")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");var TXt=Ci(function(){let i=class t{constructor(t){this.Us_=[];t["data"]!=null&&t["data"].length!==0?this.Us_=t["data"]:ki("There is no data in options['data']")}XaA_(){return this.Us_}jaA_(t){if(t>this.Us_.length-1||t<0){ki("The index is invalid");return null}return this.Us_[t]}ZaA_(t){if(t>this.Us_.length-1||t<0){ki("The index is invalid");return null}this.Us_.splice(t,1);return this}};i=t([_s("geotoolkit3d.data.well.MultiLateralPipeData")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRQaXBlQXJyYXkiOiJYYUFfIiwiZ2V0UGlwZSI6ImphQV8iLCJyZW1vdmVQaXBlIjoiWmFBXyJ9fSwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");var KXt=Ci(function(){let i=class t{constructor(t){this.Us_=[];this._aA_=!1;if(t["data"]!=null&&t["data"].length!==0)if(t["data"][0].hasOwnProperty("radii")){ki("deprecated since 4.0, use MultiLateralPipeData instead");this._aA_=!0;this.Us_=t["data"]}else t["data"].forEach((t=>this.$aA_(t)));else ki("There is no data in options['data']")}tgA_(){return this.Us_}JV_(){const t=[],i=[],s=[],e=[],A=[],n=[];this.Us_.forEach((h=>{A.push(t.length);Array.prototype.push.apply(t,h["x"]);Array.prototype.push.apply(i,h["y"]);Array.prototype.push.apply(s,h["z"]);Array.prototype.push.apply(e,h["values"]);n.push(t.length-1)}));return{x:t,y:i,z:s,values:e,tops:A,bots:n,num:this.Us_.length}}$aA_(t){if(t==null||t["x"]==null||t["y"]==null||t["z"]==null){ki("The data in options['data'] is incomplete");return this}const i={x:t["x"],y:t["y"],z:t["z"]};t["values"]!=null?i["values"]=t["values"]:i["values"]=Array.apply(null,Array(t["x"].length)).map((()=>NaN));this.Us_.push(i);return this}igA_(t){if(t>this.Us_.length-1||t<0){ki("The index is invalid");return null}return this.Us_[t]}sgA_(t){if(t>this.Us_.length-1||t<0){ki("The index is invalid");return null}this.Us_.splice(t,1);return this}};i=t([_s("geotoolkit3d.data.well.MultiLateralWellData")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRXZWxsQXJyYXkiOiJ0Z0FfIiwiZ2V0T3B0aW9ucyI6IkpWXyIsImFkZFdlbGwiOiIkYUFfIiwiZ2V0V2VsbCI6ImlnQV8iLCJyZW1vdmVXZWxsIjoic2dBXyJ9fSwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");var HXt=Ci(function(){var i;let s=i=class t{static initialize(){i.egA_=new Float32Array(i.AgA_*i.ngA_*2);i.hgA_=new Float32Array(i.AgA_*i.ngA_*3);let t,s,e,A;t=0;for(s=0;s<i.AgA_;++s){i.egA_[t++]=1;i.egA_[t++]=0;for(e=1;e<i.ngA_;e++){i.egA_[t++]=Math.cos(e*(2*Math.PI)/i.ngA_);i.egA_[t++]=Math.sin(e*(2*Math.PI)/i.ngA_)}}t=0;for(s=0;s<i.AgA_;++s){const e=s/(i.AgA_-1),n=(1-e)*(1-e),h=2*e*(1-e),r=e*e;for(A=0;A<i.ngA_;A++){i.hgA_[t++]=n;i.hgA_[t++]=h;i.hgA_[t++]=r}}}static rgA_(t,s){if(t<3)throw new Error("cornerCount must be at least 3");if(s<2)throw new Error("diskCount must be at least 2");i.egA_=null;i.hgA_=null;i.ngA_=t;i.AgA_=s}static ogA_(){i.egA_==null&&i.initialize();return i.egA_}static lgA_(){i.hgA_==null&&i.initialize();return i.hgA_}};s.ngA_=-1;s.AgA_=-1;s.egA_=null;s.hgA_=null;s=i=t([_s("geotoolkit3d.util.well.CylinderLog")],s);return s}(),2,"eyJzZXRDeWxpbmRlclByZWNpc2lvbiI6InJnQV8iLCJnZXRDbGFzc05hbWUiOiJEXyJ9");HXt.rgA_(12,3);var qXt=function(){let i=class t extends z{constructor(t){super();Object.assign(this,{type:"CylinderGeometry"});const i=Pi(t,{data:{values:[1],valuesnullvalue:-999.25,radiusnullvalue:-999.25}});this.ugA_=()=>{const t=HXt.ngA_,i=HXt.AgA_,s=this.getAttribute("position").count,e=s/(i*t),A=this.agA_;if(A!=null){const n=new Float32Array(s);let h,r,o,l=0;for(h=0;h<e;++h)for(r=0;r<i;++r)for(o=0;o<t;o++)n[l++]=A[h%A.length];this.setAttribute(ixt.TXe_,new ut(n,1))}};this.ggA_(i);this.setOptions(i)}ggA_(t){const i=HXt.ngA_,s=HXt.AgA_,e=t["data"]["x"],A=t["data"]["y"],n=t["data"]["z"],h=n.length,r=h*s*i,o=new Float32Array(r*3),l=new Float32Array(r*2),u=new Float32Array(r*3),a=new Float32Array(r*3),g=new Float32Array(r*3);let c,I,f,C;c=0;for(I=0;I<h;++I)for(f=0;f<s;++f)for(C=0;C<i;C++){o[c++]=e[I];o[c++]=A[I];o[c++]=n[I]}const d=HXt.ogA_();c=0;for(I=0;I<h;++I){l.set(d,c);c+=d.length}c=0;let B=e[1]-e[0],w=A[1]-A[0],Q=n[1]-n[0];for(f=0;f<s;++f)for(C=0;C<i;C++){u[c++]=B;u[c++]=w;u[c++]=Q}for(I=1;I<h;++I){B=e[I]-e[I-1];w=A[I]-A[I-1];Q=n[I]-n[I-1];for(f=0;f<s;++f)for(C=0;C<i;C++){u[c++]=B;u[c++]=w;u[c++]=Q}}c=0;for(I=0;I<h-1;++I)for(f=0;f<s;++f)for(C=0;C<i;C++){a[c++]=e[I+1]-e[I];a[c++]=A[I+1]-A[I];a[c++]=n[I+1]-n[I]}for(f=0;f<s;++f)for(C=0;C<i;C++){a[c++]=e[h-1]-e[h-2];a[c++]=A[h-1]-A[h-2];a[c++]=n[h-1]-n[h-2]}c=0;for(f=0;f<s;++f)for(C=0;C<i;C++){g[c++]=0;g[c++]=1;g[c++]=0}const E=HXt.lgA_();for(I=1;I<h-1;++I){g.set(E,c);c+=E.length}for(f=0;f<s;++f)for(C=0;C<i;C++){g[c++]=0;g[c++]=1;g[c++]=0}this.setAttribute("position",new ut(o,3));this.setAttribute("cgangle",new ut(l,2));this.setAttribute(qWt.huA_,new ut(u,3));this.setAttribute(qWt.ruA_,new ut(a,3));this.setAttribute("cgweight",new ut(g,3))}cgA_(t){const i=HXt.ngA_,s=HXt.AgA_;let e,A;const n=t["data"]["radius"],h=t["data"]["radiusdatamin"],r=t["data"]["radiusdatamax"],o=t["data"]["radiusnullvalue"],l=t["data"]["values"],u=t["data"]["valuesnullvalue"];let a=0,g=-1;const c=[],I=[];for(e=0;e<n.length;e++){const t=l[e%l.length]!==u&&!isNaN(l[e%l.length]),i=undefined;if(n[e]!==o&&!isNaN(n[e])&&t){a===0&&(g=e);a++}else{if(a>1){I.push(a);c.push(g)}a=0}}if(a>1){I.push(a);c.push(g)}let f;const C=[];for(let t=0;t<c.length;t++){const n=(I[t]-2)*s+2;f=c[t]*i*s+(s-1)*i;e=0;let h;while(e<n-1){h=e+1;for(A=0;A<i-1;A++){C.push(f+i*e+A+1);C.push(f+i*h+A+1);C.push(f+i*e+A);C.push(f+i*h+A+1);C.push(f+i*h+A);C.push(f+i*e+A)}C.push(f+i*e);C.push(f+i*h);C.push(f+i*e+A);C.push(f+i*h);C.push(f+i*h+A);C.push(f+i*e+A);e=h}}const d=this.getAttribute("position").count,B=d/(s*i),w=kxt.y4s_(n,null,null,h,r,o,0),Q=new Float32Array(d);f=0;for(e=0;e<B;++e)for(A=0;A<s;++A)for(let t=0;t<i;t++)Q[f++]=w[e];this.setIndex(new ut(new Uint32Array(C),1));this.setAttribute(qWt.ouA_,new ut(Q,1))}setOptions(t){let i=!1,s=!1;t["data"]=qi(t["data"],{values:this.agA_,valuesnullvalue:this.IgA_,radius:this.Xz_,radiusnullvalue:this.fgA_});const e=qi(t,{});if(t["data"]==null)t["data"]={};else{s=t["data"]["x"]!=null&&t["data"]["y"]!=null&&t["data"]["z"]!=null;i=s||this.agA_!==e["data"]["values"]||this.IgA_!==e["data"]["valuesnullvalue"]||this.Xz_!==e["data"]["radius"]||this.fgA_!==e["data"]["radiusnullvalue"]}this.agA_=e["data"]["values"];this.IgA_=e["data"]["valuesnullvalue"];this.Xz_=e["data"]["radius"];this.fgA_=e["data"]["radiusnullvalue"];s&&this.ggA_(e);if(i){this.cgA_(e);this.ugA_()}return this}JV_(){return{data:{values:this.agA_,valuesnullvalue:this.IgA_,radius:this.Xz_,radiusnullvalue:this.fgA_}}}};i=t([_s("geotoolkit3d.scene.well.CylinderLogGeometry")],i);return i}();var JXt=Ci(function(){let i=class t extends xTt{constructor(t){super(t);this.vertexShader=zWt.CuA_;this.fragmentShader=zWt.duA_;this.type="CylinderLogMaterial";this.lights=!0;zWt.IuA_(this,t)}setOptions(t){super.setOptions(t);zWt.IuA_(this,t);return this}JV_(){return Pi(zWt.fuA_(this),super.JV_())}};i=t([_s("geotoolkit3d.scene.well.CylinderLogMaterial")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");$Lt.yZe_(JXt.D_(),yLt);const PXt=function(t,i){let s=Number.MAX_VALUE,e=-Number.MAX_VALUE,A;for(A=0;A<t.length;A++)if(!isNaN(t[A])&&t[A]!=null&&t[A]!==i){s=Math.min(s,t[A]);e=Math.max(e,t[A])}return{min:s,max:e}};var VXt=Ci(function(){let i=class t extends fUt{constructor(t){super();const i=qi(t,{radiusmin:5,radiusmax:10});if(typeof i["colorprovider"]=="string"){i["color"]=new l(i["colorprovider"]);i["colorprovider"]=null}else if(i["colorprovider"]instanceof l){i["color"]=i["colorprovider"];i["colorprovider"]=null}this.CgA_=new W(new qXt(i),new JXt(i));this.add(this.CgA_);this.boA_=new a;this.setOptions(i)}setOptions(t){if(t==null)return this;super.setOptions(t);const i=qi(t,{radiuslogmin:this.dgA_,radiuslogmax:this.BgA_});if(t["data"]!=null&&t["data"]["radius"]!=null){const i=t["data"]["radius"],s=t["data"]["radiusnullvalue"],e=PXt(i,s);this.u3e_=e.max;this.a3e_=e.min}(isNaN(+i["radiuslogmin"])||i["radiuslogmin"]==null)&&(i["radiuslogmin"]=this.a3e_);(isNaN(+i["radiuslogmax"])||i["radiuslogmax"]==null)&&(i["radiuslogmax"]=this.u3e_);this.dgA_=+i["radiuslogmin"];this.BgA_=+i["radiuslogmax"];let s,e;const A=this.u3e_-this.a3e_;if(A===0){s=0;e=1}else{s=(this.dgA_-this.a3e_)/A;e=(this.BgA_-this.a3e_)/A}i["radiuslogmin"]=s;i["radiuslogmax"]=e;if(typeof i["colorprovider"]=="string"){i["color"]=new l(i["colorprovider"]);i["colorprovider"]=null}else if(i["colorprovider"]instanceof l){i["color"]=i["colorprovider"];i["colorprovider"]=null}else i["color"]==null&&i["colorprovider"]!=null&&(i["color"]=new l(16777215));this.CgA_.geometry.setOptions(i);this.CgA_.material.setOptions(i);this.invalidateObject();return this}JV_(){const t=Pi(this.CgA_.geometry.JV_(),this.CgA_.material.JV_());t["radiuslogmin"]=this.dgA_;t["radiuslogmax"]=this.BgA_;return Pi(t,super.JV_())}beforeRender(t,i,s,e){super.beforeRender(t,i,s,e);const A=s.GZe_().scale;this.boA_.equals(A)||qWt.$lA_(this.CgA_.material)["normscale"].set(1/A.x,0,0,0,1/A.y,0,0,0,1/A.z);this.boA_.copy(A);return this}};i=t([_s("geotoolkit3d.scene.well.CylinderLog")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");var OXt=Ci({wgA_:0,W8_:1},2,"eyJNaXJyb3IiOiJ3Z0FfIiwiUmVndWxhciI6Ilc4XyJ9");const WXt=function(t){return isNaN(t)||!isFinite(t)},zXt=function(t,i,s){return t[i-1]+(t[i]-t[i-1])*s},XXt=function(t,i,s){while(1){while(t<i.length&&(WXt(i[t])||WXt(s[t%s.length])))t++;if(!(t<i.length))break;if(!(t<i.length-1)){t++;break}if(!WXt(i[t+1])&&!WXt(s[(t+1)%s.length]))break;t++}return t};var jXt=Ci(function(){var t=class{static QgA_(t,i){if(t==null)return{min:0,max:1};if(!Array.isArray(t)||!Array.isArray(i))return{min:Math.min(t,i),max:Math.max(t,i)};let s=Number.POSITIVE_INFINITY,e=Number.NEGATIVE_INFINITY;for(let A=0;A<t.length;A++){s=Math.min(s,t[A],i[A]);e=Math.max(e,t[A],i[A])}return{min:s,max:e}}static EgA_(i,s,e,A,n,h){Array.isArray(i)||(i=i==null?[1]:[i]);Array.isArray(s)||(s=s==null?i:[s]);const r=t.pgA_(i,s,e,A,n,h);return{w:r.mgA_,h:r.ygA_}}static DgA_(t,i,s,e,A,n){const h=i.length/3+e;for(let t=0;t<n;t++){const i=t+h-n,e=(t+1)%n+h-n,A=t+h-2*n,r=(t+1)%n+h-2*n;s.push(A,i,e);s.push(A,e,r)}}static pgA_(t,i,s,e,A,n){let h=A,r=n,o=0;if(h==null||r==null){h=Number.MAX_VALUE;r=-Number.MAX_VALUE;for(;o<t.length;o++){h=Math.min(h,t[o]);r=Math.max(r,t[o]);h=Math.min(h,i[o]);r=Math.max(r,i[o])}if(r===h)return{mgA_:[e],ygA_:[e]}}t=t.slice();i=i.slice();for(o=0;o<t.length;o++){t[o]=s+(e-s)*((t[o]-h)/(r-h));i[o]=s+(e-s)*((i[o]-h)/(r-h))}return{mgA_:t,ygA_:i}}static MgA_(t){const i=new _t;i.moveTo(0,0);const s=yu.tS_(0,0,1,1);let e=s[0];i.moveTo(e.xN_(),e.LN_());for(let t=0;t<s.length;++t){e=s[t];i.bezierCurveTo(e.UN_(),e.YN_(),e.TN_(),e.KN_(),e.HN_(),e.qN_())}i.closePath();return i.extractPoints(t).shape}static vgA_(t,i,s,e,n,h){let r=h||0;for(;r<e.length-1;++r)if(e[r]<=t&&t<=e[r+1])break;const o=e[r],l=undefined,u=(t-o)/(e[r+1]-o),a=(1-u)*i[r]+u*i[r+1],g=(1-u)*s[r]+u*s[r+1],c=(1-u)*n[r]+u*n[r+1];return(new A).set(a,g,c,t)}static bgA_(i,s,e,A,n,h){const r=[],o=[],l=[],u=[],a=[];let g=0,c=0;if(i[i.length-1]>=n[0]){while(g<i.length&&i[g]<n[0])++g;const I=s.length>0&&typeof s[0]=="number"?Number.NaN:null;while(n[c]<i[g]){l.push(e[c]);u.push(A[c]);o.push(h[c]);r.push(n[c]);a.push(I);++c}const f=n[n.length-1];let C,d;for(;g<i.length&&i[g]<=f;++g){C=i[g];if(n[c]!=null&&!isNaN(n[c])&&C!=null&&!isNaN(C))if(C<=n[c]){d=t.vgA_(C,e,A,n,h,c-1);l.push(d.x);u.push(d.y);o.push(d.z);r.push(d.w);a.push(s[g])}else{++c;--g}}for(;c<n.length;++c){l.push(e[c]);u.push(A[c]);o.push(h[c]);r.push(n[c]);a.push(Number.NaN)}}r.length!==a.length&&Gi("Re-sampling Error!");return{x:l,y:u,tvds:o,mds:r,values:a}}};t.NgA_=function(){const t=new g,i=new g,s=new g,e=new g,A=.001;return function(n,h,r,o,l,u,a,g,c,I,f){n=kxt.y4s_(n,0,1,o,l,a);h=kxt.y4s_(h,0,1,o,l,g);let C=NA.sign(h[0]-n[0]);const d=r.length===c.length,B=.5;for(let o=0;o<n.length;o++){const l=h[o],u=n[o];if(WXt(u)||WXt(l)||WXt(r[o%r.length])){if(C!=null){C=null;d&&r.splice(o,0,zXt(r,o,A));c.splice(o,0,zXt(c,o,A));I.splice(o,0,zXt(I,o,A));f.splice(o,0,zXt(f,o,A));h.splice(o,0,B);n.splice(o,0,B);o++}const t=XXt(o+1,n,r),i=XXt(o+1,h,r),s=Math.max(t,i);if(s<n.length){c.splice(s,0,zXt(c,s+1,-A));I.splice(s,0,zXt(I,s+1,-A));f.splice(s,0,zXt(f,s+1,-A));n.splice(s,0,B);h.splice(s,0,B);d&&r.splice(o,0,zXt(r,s+1,-A))}c.splice(o,s-o);I.splice(o,s-o);f.splice(o,s-o);n.splice(o,s-o);h.splice(o,s-o);d&&r.splice(o,s-o)}else if(C==null)C=NA.sign(l-u);else{const A=NA.sign(l-u);if(A!==C&&A!==0&&C!==0){t.set(n[o-1],f[o-1]);i.set(u,f[o]);s.set(h[o-1],f[o-1]);e.set(l,f[o]);const A=kxt.intersect(t,i,s,e),a=t.distanceTo(A)/i.distanceTo(t);d&&r.splice(o,0,r[o-1]+(r[o]-r[o-1])*a);c.splice(o,0,c[o-1]+(c[o]-c[o-1])*a);I.splice(o,0,I[o-1]+(I[o]-I[o-1])*a);f.splice(o,0,f[o-1]+(f[o]-f[o-1])*a);h.splice(o,0,A.x);n.splice(o,0,A.x)}C=A}}return{mgA_:n,ygA_:h}}}();t.SgA_=function(){const t=new g,i=new g,s=new g,e=new g,A=.001;return function n(h,r,o,l,u,a,g,c,I,f){h=l<=u?kxt.y4s_(h,0,1,l,u,g):kxt.y4s_(h,1,0,u,l,g);const C=o.length===c.length;let d=null;for(let n=0;n<h.length;n++){const l=h[n];if(WXt(l)||WXt(o[n%o.length])){if(d!=null){d=null;if(h[n-1]!==r){C&&o.splice(n,0,zXt(o,n,A));c.splice(n,0,zXt(c,n,A));I.splice(n,0,zXt(I,n,A));f.splice(n,0,zXt(f,n,A));h.splice(n,0,r);n++}}const t=XXt(n+1,h,o);if(t<h.length&&h[t]!==r){c.splice(t,0,zXt(c,t+1,-A));I.splice(t,0,zXt(I,t+1,-A));f.splice(t,0,zXt(f,t+1,-A));h.splice(t,0,r);C&&o.splice(n,0,zXt(o,t+1,-A))}c.splice(n,t-n);I.splice(n,t-n);f.splice(n,t-n);h.splice(n,t-n);C&&o.splice(n,t-n)}else if(d==null)d=NA.sign(r-l);else{const A=NA.sign(r-l);if(A!==d&&A!==0&&d!==0){t.set(h[n-1],f[n-1]);i.set(l,f[n]);s.set(r,f[n-1]);e.set(r,f[n]);const A=kxt.intersect(t,i,s,e),u=t.distanceTo(A)/i.distanceTo(t);c.splice(n,0,zXt(c,n,u));I.splice(n,0,zXt(I,n,u));f.splice(n,0,zXt(f,n,u));h.splice(n,0,A.x);C&&o.splice(n,0,zXt(o,n,u))}d=A}}return h}}();return t}(),2,"eyJjb21wdXRlTGluZWFySW50ZXJwb2xhdGlvblRyYWplY3RvcnlQb2ludCI6InZnQV8iLCJyZXNhbXBsZUxpbmVhciI6ImJnQV8ifSAg");const ZXt=new u;var _Xt=function(){let i=class t extends z{constructor(t){super();Object.assign(this,{type:"DynamicTubeGeometry"});const i=qi(t,{radiusmin:0,radiusmax:1,tubeprecision:3,openended:!1,startbuffersize:1e3,bufferresizefactor:.1});this.GgA_=i["startbuffersize"];this.Us_={xs:[],ys:[],zs:[],values:[],$7t_:[],RgA_:[],kgA_:[]};this.FgA_=0;this.setOptions(i)}setOptions(t){const i=qi(t,{radiusmin:this.xgA_,radiusmax:this.LgA_,axismin:this.UgA_,axismax:this.YgA_,tubeprecision:this.TgA_,openended:this.KgA_,bufferresizefactor:this.HgA_});this.HgA_=i["bufferresizefactor"];const s=undefined;if(!(i["radiusmin"]!==this.xgA_||this.LgA_!==i["radiusmax"]||this.TgA_!==i["tubeprecision"]||this.KgA_!==i["openended"]||this.UgA_!==i["axismin"]||this.YgA_!==i["axismax"]))return this;this.xgA_=i["radiusmin"];this.LgA_=i["radiusmax"];this.UgA_=i["axismin"];this.YgA_=i["axismax"];if(this.TgA_!==i["tubeprecision"]){this.TgA_=i["tubeprecision"];this.qgA_=jXt.MgA_(this.TgA_)}this.KgA_=i["openended"];this.FgA_=0;this.JgA_([],[],[]);return this}JV_(){return{radiusmin:this.xgA_,radiusmax:this.LgA_,axismin:this.UgA_,axismax:this.YgA_,tubeprecision:this.TgA_,openended:this.KgA_,bufferresizefactor:this.HgA_}}PgA_(){this.VgA_.fill(0);this.kks_.needsUpdate=!0;this.Us_.xs=[];this.Us_.ys=[];this.Us_.zs=[];this.Us_.values=[];this.Us_.$7t_=[];this.Us_.RgA_=[];this.Us_.kgA_=[];this.FgA_=0;return this}getData(){return{xs:this.Us_.xs.slice(),ys:this.Us_.ys.slice(),zs:this.Us_.zs.slice(),values:this.Us_.values.slice(),widths:this.Us_.$7t_.slice(),heights:this.Us_.RgA_.slice(),rolls:this.Us_.kgA_.slice()}}OgA_(){const t=this.qgA_.length-1,i=this.GgA_*t+(this.KgA_?0:2),s=(this.GgA_-1)*t*2+(this.KgA_?0:t*2);if(this.WgA_==null){this.WgA_=new Float32Array(i*3);this.VgA_=new Uint32Array(s*3);this.zgA_=new Float32Array(i);this.XgA_=new Float32Array(i*3)}else{this.dispose();const t=new Float32Array(i*3),e=new Uint32Array(s*3),A=new Float32Array(i),n=new Float32Array(i*3);t.set(this.WgA_);e.set(this.VgA_);A.set(this.zgA_);n.set(this.XgA_);this.WgA_=t;this.VgA_=e;this.zgA_=A;this.XgA_=n}this.jgA_=new ut(this.WgA_,3).setUsage(ni);this.kks_=new ut(this.VgA_,1).setUsage(ni);this.ZgA_=new ut(this.XgA_,3).setUsage(ni);this._gA_=new ut(this.zgA_,1).setUsage(ni)}$gA_(t){const i=t;if(this.WgA_!=null&&i<=this.GgA_){this.jgA_.needsUpdate=!0;this.kks_.needsUpdate=!0;this.ZgA_.needsUpdate=!0;this._gA_.needsUpdate=!0}else{i>this.GgA_&&(this.GgA_=Math.floor(i*(1+this.HgA_)));this.OgA_();this.setAttribute("position",this.jgA_);this.setIndex(this.kks_);this.setAttribute("normal",this.ZgA_);this.setAttribute(ixt.TXe_,this._gA_)}}JgA_(t,i,s,e,A,n,h){if(t==null||i==null||s==null)return this;e==null&&(e=[]);A==null&&(A=[]);n==null&&(n=[]);h==null&&(h=[]);let r=t,o=i,l=s,u=e,g=A,c=n,I=h,f=null;this.FgA_>0&&(f=new a(this.Us_.xs[this.Us_.xs.length-1],this.Us_.ys[this.Us_.ys.length-1],this.Us_.zs[this.Us_.zs.length-1]));if(this.FgA_!==this.Us_.xs.length){r=this.Us_.xs;o=this.Us_.ys;l=this.Us_.zs;u=this.Us_.values;g=this.Us_.$7t_;c=this.Us_.RgA_;I=this.Us_.kgA_}let C=0;for(;C<t.length;C++){this.Us_.xs.push(t[C]);this.Us_.ys.push(i[C]);this.Us_.zs.push(s[C]);this.Us_.values.push(e[C]!=null?h[C]:Number.NaN);this.Us_.$7t_.push(A[C]);this.Us_.RgA_.push(n[C]);this.Us_.kgA_.push(h[C]!=null?h[C]:0)}if(f==null&&r.length<2)return this;const d=[],B=jXt.EgA_(g,c,this.xgA_,this.LgA_,this.UgA_,this.YgA_),w=B.w,Q=B.h;for(C=0;C<r.length;C++)d.push(new a(r[C],o[C],l[C]));const E=[],p=[],m=[],y=[];let D;const M=this.qgA_.length,v=M-1;let b=this.FgA_*v+(this.KgA_?0:1),N=(this.FgA_-1)*v*2+(this.KgA_?0:v);if(this.FgA_===0){b=0;N=0}const S=new a(1,1,1);let G=0;const R=new a(0,0,-1),k=new a,F=k.clone(),x=k.clone(),L=d.length;let U=1;if(!this.KgA_&&this.FgA_===0){const t=0;E.push(d[0].x,d[0].y,d[0].z);const i=d[0].clone().sub(d[1]).normalize();p.push(i.x,i.y,i.z);const s=u!=null?u[0]:Number.NaN;y.push(s);for(D=0;D<v;D++)m.push(t,U+D,U+(D+1)%v)}for(C=0;C<L;C++){if(C>0&&d[C].equals(d[C-1]))continue;S.x=w[C%w.length]*2;S.y=Q[C%Q.length]*2;let t=!1,i;if(S.x===0&&S.y===0){S.x=1;S.y=1;t=!0}I[Math.min(C,L-1)]!=null&&(G=I[Math.min(C,L-1)]);i=C>0?F.copy(d[C]).sub(d[C-1]).normalize():f!=null?F.copy(d[C]).sub(f).normalize():F.copy(d[C+1]).sub(d[C]).normalize();ZXt.lookAt(k,i,x.set(-i.y,-i.z,0));for(D=1;D<M;D++){F.set(this.qgA_[D].x,this.qgA_[D].y,0);F.multiply(S);F.applyAxisAngle(R,G);F.applyMatrix4(ZXt);F.add(d[C]);t?E.push(d[C].x,d[C].y,d[C].z):E.push(F.x,F.y,F.z);F.sub(d[C]).normalize();p.push(F.x,F.y,F.z);const i=u&&u[C]!=null?u[C]:Number.NaN;y.push(i)}(C>0||f!=null)&&jXt.DgA_(this,E,m,b,L,v)}if(!this.KgA_){const t=E.length/3-1+b,i=E.length/3+b;E.push(d[d.length-1].x,d[d.length-1].y,d[d.length-1].z);const s=d.length<2?f:d[d.length-2],e=d[d.length-1].clone().sub(s).normalize();p.push(e.x,e.y,e.z);const A=u&&u[t]!=null?u[t]:Number.NaN;y.push(A);U=t-(v-1);for(D=0;D<v;D++)m.push(i,U+(D+1)%v,U+D)}this.FgA_+=d.length;this.boundingBox=null;this.boundingSphere=null;this.$gA_(this.FgA_);this.WgA_.set(E,b*3);this.VgA_.set(m,N*3);this.XgA_.set(p,b*3);this.zgA_.set(y,b);this.computeBoundingBox();return this}};i=t([_s("geotoolkit3d.scene.well.DynamicTubeGeometry")],i);return i}();var $Xt=function(){let i=class t extends xTt{constructor(t){super({});this.type="DynamicTubeMaterial";t=qi(t,{opacity:.85,transparent:!0,color:new l("blue"),name:"well"},!0);this.setOptions(t)}};i=t([_s("geotoolkit3d.scene.well.DynamicTubeMaterial")],i);return i}();$Lt.yZe_($Xt.D_(),yLt);var tjt=Ci(function(){let i=class t extends fUt{constructor(t){super();this.tcA_(t);this.U9e_=new W(new _Xt(t),new $Xt(t));this.add(this.U9e_)}setOptions(t){if(t==null)return this;this.tcA_(t);super.setOptions(t);this.U9e_.geometry.setOptions(t);this.U9e_.material.setOptions(t);return this}JV_(){const t=Pi(Pi(this.U9e_.geometry.JV_(),this.U9e_.material.JV_()),super.JV_()),i={name:"unlit",value:t["lights"]?0:1,alt:"Please use DynamicTube.getOptions.lights instead."};Rs(t,[i],"DynamicTube.getOptions");return t}PgA_(){this.U9e_.geometry.PgA_();return this}getData(){return this.U9e_.geometry.getData()}JgA_(t,i,s,e,A,n,h){this.U9e_.geometry.JgA_(t,i,s,e,A,n,h);return this}tcA_(t){if(t.hasOwnProperty("unlit")){ki("DynamicTube.Options.unlit is deprecated since 4.0, please use MeshColorMapLambertMaterial.SetOptions.lights instead.");t["lights"]=t["unlit"]===0}}};i=t([_s("geotoolkit3d.scene.well.DynamicTube")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwicmVzZXREYXRhIjoiUGdBXyIsImFkZEdlb21ldHJ5IjoiSmdBXyJ9fX0g");const ijt=new a,sjt=new a;var ejt=function(){let i=class t extends z{constructor(t){super();ki("geotoolkit3d.scene.well.LineGeometry is deprecated since 4.0, use geotoolkit3d.scene.LineSegments instead");Object.assign(this,{type:"LineGeometry"});const i=qi(t,{colorprovider:"blue"});this.Us_=i["data"];this.Us_.xs=i["data"]["x"];this.Us_.ys=i["data"]["y"];this.Us_.zs=i["data"]["z"];this.Us_.values=i["data"]["values"];Array.isArray(this.Us_.values)||(this.Us_.values==null?this.Us_.values=[0]:this.Us_.values=[this.Us_.values]);const s=Array(3*this.Us_.xs.length);for(let t=0;t<this.Us_.xs.length;t++){const i=t*3;s[i]=this.Us_.xs[t];s[i+1]=this.Us_.ys[t];s[i+2]=this.Us_.zs[t]}this.khA_=new ut(new Float32Array(3*this.Us_.xs.length),3);this.icA_(i["colorprovider"]);this.setAttribute("color",this.khA_);this.setAttribute("position",new ut(new Float32Array(s),3));const e=i["data"]["values"],A=Array.isArray(e)?kxt.y4s_(e,0,1,this.a3e_,this.u3e_,i["data"]["nullvalue"],ixt.NXe_):[e],n=new Float32Array(this.Us_.xs.length*3),h=new Float32Array(this.Us_.xs.length*3),r=new Float32Array(this.Us_.xs.length);if(this.Us_.xs.length>0){const t=(t,i)=>new a(this.Us_.xs[t]-this.Us_.xs[i],this.Us_.ys[t]-this.Us_.ys[i],this.Us_.zs[t]-this.Us_.zs[i]);n.set(t(0,1).toArray(),0);h.set(t(0,1).toArray(),0);r[0]=A[0];let i;for(i=1;i<this.Us_.xs.length-1;i++){n.set(t(i-1,i).toArray(),i*3);h.set(t(i,i+1).toArray(),i*3);r[i]=A[i%A.length]}n.set(t(this.Us_.xs.length-2,this.Us_.xs.length-1).toArray(),(this.Us_.xs.length-1)*3);h.set(t(this.Us_.xs.length-2,this.Us_.xs.length-1).toArray(),(this.Us_.xs.length-1)*3);r[i]=A[A.length-1]}this.setAttribute(qWt.huA_,new ut(n,3));this.setAttribute(qWt.ruA_,new ut(h,3));this.setAttribute(qWt.ouA_,new ut(r,1))}icA_(t){const i=t instanceof Mo;let s;const e=this.khA_.array;i||(s=new l(t).toArray());for(let A=0;A<this.Us_.xs.length;A++){const n=A*3;if(i){const i=t.getColor(this.Us_.values[A%this.Us_.values.length]);s=[i.Is_()/255,i.Cs_()/255,i.fs_()/255]}e[n]=s[0];e[n+1]=s[1];e[n+2]=s[2]}this.khA_.needsUpdate=!0}setOptions(t){if(t==null)return this;t.hasOwnProperty("colorprovider")&&this.icA_(t["colorprovider"]);return this}e_e_(t){this.A_e_||this.n_e_((this.Us_.zs[this.Us_.zs.length-1]+this.Us_.zs[0])/2,t);return this.A_e_}n_e_(t,i){if(this.xm_&&this.xm_.equals(i)&&t===this.X9_)return this;this.xm_||(this.xm_=i);this.X9_||(this.X9_=t);this.xm_.equals(i)||this.xm_.copy(i);this.abt_=this.abt_||new a;this.A_e_=this.A_e_||new f;let s=NA.findIndex(t,this.Us_.zs,null,null,(function(t,i){return i-t}))||1;s<0&&(s=~s);ijt.set(this.Us_.xs[s-1],this.Us_.ys[s-1],this.Us_.zs[s-1]);sjt.set(this.Us_.xs[s],this.Us_.ys[s],this.Us_.zs[s]);const e=(t-this.Us_.zs[s-1])/(this.Us_.zs[s]-this.Us_.zs[s-1]);this.abt_.copy(sjt).sub(ijt).multiplyScalar(e).add(ijt);ijt.multiply(this.xm_);ijt.multiply(this.xm_);sjt.multiply(this.xm_);sjt.multiply(this.xm_);sjt.sub(ijt).normalize();ijt.set(-1,0,0);ijt.crossVectors(sjt,ijt).normalize();this.A_e_=kxt.Sje_(ijt,sjt,this.A_e_);return this}Ye_(t){this.abt_||this.n_e_((this.Us_.zs[this.Us_.zs.length-1]+this.Us_.zs[0])/2,t);return this.abt_}dispose(){this.khA_=null;super.dispose()}};i=t([_s("geotoolkit3d.scene.well.LineGeometry")],i);return i}();const Ajt=function(t){const i=new _t;i.moveTo(0,0);const s=yu.tS_(0,0,1,1);let e=s[0];i.moveTo(e.xN_(),e.LN_());for(let t=0;t<s.length;++t){e=s[t];i.bezierCurveTo(e.UN_(),e.YN_(),e.TN_(),e.KN_(),e.HN_(),e.qN_())}i.closePath();return i.extractPoints(t).shape},njt=function(t,i,s){const e=t.length/3;for(let t=0;t<s;t++){const A=t+e-s,n=(t+1)%s+e-s,h=t+e-2*s,r=(t+1)%s+e-2*s;i.push(h,A,n);i.push(h,n,r)}};var hjt=function(){let i=class t extends z{constructor(t){super();Object.assign(this,{type:"LogArrayGeometry"});const i=qi(t,{});this.scA_=t["data"]["logarray"][0].length;let s=Ajt(this.scA_/4).slice(1,this.scA_+1);s=s.map((function(t,i,s){return s[Math.floor(i+s.length/4)%s.length]}));this.ecA_=t["data"]["path"]["x"].length;const e=[],A=[];for(let t=0;t<this.ecA_;t++){for(let t=0;t<this.scA_;t++)e.push(s[t].x,s[t].y,0);t>=1&&njt(e,A,this.scA_)}const n=new Float32Array(e),h=new Float32Array(e),r=new Float32Array(e),o=new Float32Array(e.length);let l=null;this.setAttribute("position",new ut(n,3));this.setIndex(new ut(new Uint32Array(A),1));this.setAttribute(Qzt.vuA_,new ut(h,3));this.setAttribute(Qzt.buA_,new ut(r,3));this.setAttribute(Qzt.NuA_,new ut(o,1));if(t["data"]["values"]!=null){l=new Float32Array(e.length);this.setAttribute(ixt.TXe_,new ut(l,1))}this.boundingBox=new C;this.vW_(i)}vW_(t){if(t["data"]!=null){const i=t["data"],s=i["path"],e=s["x"],A=s["y"],n=s["z"],h=new a;if(this.ecA_!==e.length)throw new Error("Changing sample count in LogArray is not supported.");const r=this.boundingBox.min,o=this.boundingBox.max;r.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);o.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);const l=this.getAttribute(Qzt.vuA_),u=this.getAttribute(Qzt.buA_),g=this.getAttribute(Qzt.NuA_);let c=null;this.getAttribute(ixt.TXe_)!=null&&(c=this.getAttribute(ixt.TXe_));for(let t=0;t<this.ecA_;t++){const s=e[t],a=A[t],I=n[t];t>0?h.set(s-e[t-1],a-A[t-1],I-n[t-1]).normalize():h.set(e[t+1]-s,A[t+1]-a,n[t+1]-I).normalize();for(let e=0;e<this.scA_;e++){const A=t*this.scA_+e;l.setXYZ(A,s,a,I);u.setXYZ(A,h.x,h.y,h.z);g.setX(A,i["logarray"][t][e]);c!=null&&c.setX(A,i["values"][t][e])}r.set(Math.min(r.x,s),Math.min(r.y,a),Math.min(r.z,I));o.set(Math.max(o.x,s),Math.max(o.y,a),Math.max(o.z,I))}this.boundingSphere=new P;this.boundingBox.getBoundingSphere(this.boundingSphere);this.getAttribute(Qzt.vuA_).needsUpdate=!0;this.getAttribute(Qzt.buA_).needsUpdate=!0;this.getAttribute(Qzt.NuA_).needsUpdate=!0;this.getAttribute(ixt.TXe_)!=null&&(this.getAttribute(ixt.TXe_).needsUpdate=!0)}return this}};i=t([_s("geotoolkit3d.scene.well.logarray.LogArrayGeometry")],i);return i}();var rjt=Ci(function(){let i=class t extends xTt{constructor(t){const i=undefined;super(qi(t,{side:e,referencemode:_Wt.yuA_},!0));this.type="LogArrayMaterial";this.vertexShader=Qzt.SuA_;this.fragmentShader=Qzt.GuA_;Qzt.DuA_(this,t)}setOptions(t){super.setOptions(t);Qzt.DuA_(this,t);return this}JV_(){return Pi(Qzt.MuA_(this),super.JV_())}};i=t([_s("geotoolkit3d.scene.well.logarray.LogArrayMaterial")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");$Lt.yZe_(rjt.D_(),yLt);var ojt=Ci(function(){let i=class t extends fUt{constructor(t){super();const i=qi(t,{colorprovider:new l("red"),radiusmin:10,radiusdelta:10,logarraynullvalue:-999.25,colornullvalue:-999.25});if(typeof i["colorprovider"]=="string"){i["color"]=new l(i["colorprovider"]);i["colorprovider"]=null}else if(i["colorprovider"]instanceof l){i["color"]=i["colorprovider"];i["colorprovider"]=null}this.AcA_=new W(new hjt(i),new rjt(i));this.add(this.AcA_);this.boA_=new a;this.setOptions(i)}setOptions(t){if(t==null)return this;super.setOptions(t);const i=qi(t,{});if(typeof i["colorprovider"]=="string"){i["color"]=new l(i["colorprovider"]);i["colorprovider"]=null}else if(i["color"]===null&&i["colorprovider"]!==null)i["color"]=new l(16777215);else if(i["colorprovider"]instanceof l){i["color"]=i["colorprovider"];i["colorprovider"]=null}this.AcA_.geometry.vW_(i);this.AcA_.material.setOptions(i);this.invalidateObject();return this}JV_(){return Pi(this.AcA_.material.JV_(),super.JV_())}beforeRender(t,i,s,e){super.beforeRender(t,i,s,e);const A=s.GZe_().scale;this.boA_.equals(A)||qWt.$lA_(this.AcA_.material)["normscale"].set(1/A.x,0,0,0,1/A.y,0,0,0,1/A.z);this.boA_.copy(A);return this}};i=t([_s("geotoolkit3d.scene.well.logarray.LogArray")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");var ljt=function(){let i=class t extends z{constructor(t){super();this.Kis_={ncA_:t["trajectory"],hcA_:t["projectedshapex"],rcA_:t["projectedshapey"],ocA_:new a(1,1,1),normalized:!0,closed:!1};this.setOptions(t)}setOptions(t){if(t==null)return this;this.Kis_=qi(t,this.Kis_);this.Kis_.ncA_=t["trajectory"]||this.Kis_.ncA_;this.Kis_.hcA_=t["projectedshapex"]||this.Kis_.hcA_;this.Kis_.rcA_=t["projectedshapey"]||this.Kis_.rcA_;this.Kis_.normalized=t.hasOwnProperty("normalized")?t["normalized"]:this.Kis_.normalized;this.Kis_.closed=t.hasOwnProperty("closed")?t["closed"]:this.Kis_.closed;this.Kis_.ocA_=t["upvector"]||this.Kis_.ocA_;const i=this.Kis_.ncA_;let s=this.Kis_.hcA_,e=this.Kis_.rcA_,A=Math.min(s.length,e.length);const n=Math.min(i["x"].length,i["y"].length,i["z"].length);if(this.Kis_.normalized!==!1){let t=0;for(let i=0;i<A;i++){t=Math.max(t,Math.abs(s[i]));t=Math.max(t,Math.abs(e[i]))}for(let i=0;i<A;i++){s[i]=s[i]/t;e[i]=e[i]/t}}if(this.Kis_.closed===!0){s=s.slice(A);s.push(s[0]);e=e.slice(A);e.push(e[0]);A++}const h=[],r=[],o=[],l=[],u=[],g=[],c=[],I=new a,f=new a,C=new a,d=new a,B=new a,w=this.Kis_.ocA_,Q=(t,A)=>{h.push(i["x"][t],i["y"][t],i["z"][t]);o.push(d.x,d.y,d.z);l.push(B.x,B.y,B.z);u.push(s[A],e[A]);g.push((i["values"]!=null?i["values"][t]:0)||0)};for(let t=0;t<n;t++){if(t<n-1){f.set(i["x"][t],i["y"][t],i["z"][t]);C.set(i["x"][t+1],i["y"][t+1],i["z"][t+1])}else{f.set(i["x"][t-1],i["y"][t-1],i["z"][t-1]);C.set(i["x"][t],i["y"][t],i["z"][t])}B.subVectors(C,f).cross(w).normalize();d.subVectors(C,f).cross(B).normalize();for(let i=0;i<A;i++){if(i>0){Q(t,i);const A=s[i]-s[i-1],n=e[i]-e[i-1];I.setScalar(0).addScaledVector(d,-n).addScaledVector(B,A).normalize();r.push(I.x,I.y,I.z)}if(i<A-1){Q(t,i);const A=s[i+1]-s[i],n=e[i+1]-e[i];I.setScalar(0).addScaledVector(d,-n).addScaledVector(B,A).normalize();r.push(I.x,I.y,I.z)}}}const E=(A-1)*2;let p=0;for(let t=0;t<n-1;t++){for(let t=0;t<E-1;t+=2)c.push(p+t,p+t+1,p+E+t,p+t+1,p+E+t+1,p+E+t);p+=E}this.deleteAttribute("position");this.deleteAttribute("normal");this.deleteAttribute("normalx");this.deleteAttribute("normaly");this.deleteAttribute("coordinate");this.deleteAttribute(ixt.TXe_);this.setAttribute("position",new ut(new Float32Array(h),3));this.setAttribute("normal",new ut(new Float32Array(r),3));this.setAttribute("normalx",new ut(new Float32Array(o),3));this.setAttribute("normaly",new ut(new Float32Array(l),3));this.setAttribute("coordinate",new ut(new Float32Array(u),2));this.setAttribute(ixt.TXe_,new ut(new Float32Array(g),1));this.setIndex(c);return this}JV_(){return{trajectory:this.Kis_.ncA_,projectedshapex:this.Kis_.hcA_,projectedshapey:this.Kis_.rcA_,upvector:this.Kis_.ocA_,normalized:this.Kis_.normalized,closed:this.Kis_.closed}}};i=t([_s("geotoolkit3d.scene.well.logarray2d.LogArray2DGeometry")],i);return i}();var ujt=Ci(function(){let i=class t extends xTt{constructor(t){super(t=qi(t,{radius:100}));this.vertexShader=yzt.FuA_;this.fragmentShader=yzt.xuA_;yzt.RuA_(this,t)}setOptions(t){if(t==null)return this;super.setOptions(t);yzt.RuA_(this,t);return this}JV_(){return qi(yzt.kuA_(this),super.JV_())}};i=t([_s("geotoolkit3d.scene.well.logarray2d.LogArray2DMaterial")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");$Lt.yZe_(ujt.D_(),yLt);var ajt=Ci(function(){let i=class t extends fUt{constructor(t){super();this.boA_=new a;this.U9e_=new W(new ljt(t),new ujt(t));this.add(this.U9e_)}setOptions(t){if(t==null)return this;super.setOptions(t);this.U9e_.geometry.setOptions(t);this.U9e_.material.setOptions(t);return this}JV_(){return qi(this.U9e_.material.JV_(),qi(this.U9e_.geometry.JV_(),super.JV_()))}beforeRender(t,i,s,e){super.beforeRender(t,i,s,e);const A=s.GZe_().scale;if(!this.boA_.equals(A)){qWt.$lA_(this.U9e_.material)["normscale"].set(1/A.x,0,0,0,1/A.y,0,0,0,1/A.z);this.boA_.copy(A)}return this}};i=t([_s("geotoolkit3d.scene.well.logarray2d.LogArray2D")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");const gjt=Nzt;var cjt=function(){let i=class t extends hUt{constructor(t){const i=t["data"]["values"],s=Array.isArray(i)?NA.oA_(i,void 0,t["data"]["nullvalue"]):[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],e=qi(t,{radius:1,opacity:1,offset:1,offsetmode:OXt.wgA_,curvemin:s[0],curvemax:s[1],vertexShader:gjt.YuA_,fragmentShader:gjt.TuA_});super(e);this.a3e_=s[0];this.u3e_=s[1];isNaN(e["curvemin"])&&(e["curvemin"]=this.a3e_);isNaN(e["curvemax"])&&(e["curvemax"]=this.u3e_);this.type="LogCurve2DMaterial";this.setOptions(e)}setOptions(t){const i=qi(t,this.JV_());i["normalizedcurvemin"]=this.lcA_(i["curvemin"]);i["normalizedcurvemax"]=this.lcA_(i["curvemax"]);qWt.XlA_(this,i);super.setOptions(i);return this}JV_(){const t=qWt.jlA_(this),i=qi(t,{curvemin:this.ucA_(t["normalizedcurvemin"]),curvemax:this.ucA_(t["normalizedcurvemax"])});return qi(super.JV_(),qi(i,gjt.UuA_(this)))}lcA_(t){return(t-this.a3e_)/(this.u3e_-this.a3e_)}ucA_(t){return(t+this.a3e_)*(this.u3e_-this.a3e_)}};i=t([_s("geotoolkit3d.scene.well.LogCurve2DMaterial")],i);return i}();$Lt.yZe_(cjt.D_(),yLt);const Ijt=[],fjt=(t,i,s)=>{Ijt[0]=t[i]-t[s];Ijt[1]=t[i+1]-t[s+1];Ijt[2]=t[i+2]-t[s+2];return Ijt};var Cjt=function(){let i=class t extends eUt{constructor(t){super(t);this.type="LogCurve2DGeometry"}setData(t){if(t==null)return this;const i=t;i["line"]=!0;super.setData(i);if(i["values"]==null||i["values"].length===0)return this;const s=i["values"],e=new Float32Array(s.length);if(Array.isArray(s)){const i=kxt.y4s_(s,0,1,null,null,t["nullvalue"],ixt.NXe_);e.set(i,0)}else e.fill(s);const A=new q(e,1,1);this.setAttribute("instanceValueStart",new J(A,1,0));this.setAttribute("instanceValueEnd",new J(A,1,1));const n=i["positions"],h=new Float32Array(n.length),r=new Float32Array(n.length);h.set(fjt(n,0,3),0);r.set(fjt(n,0,3),0);let o;for(o=3;o<n.length-3;o+=3){h.set(fjt(n,o-3,o),o);r.set(fjt(n,o,o+3),o)}h.set(fjt(n,n.length-6,n.length-3),n.length-3);r.set(fjt(n,n.length-6,n.length-3),n.length-3);const l=new q(h,3,1),u=new q(r,3,1);this.setAttribute("instancePrevDirStart",new J(l,3,0));this.setAttribute("instanceNextDirStart",new J(u,3,0));this.setAttribute("instancePrevDirEnd",new J(l,3,3));this.setAttribute("instanceNextDirEnd",new J(u,3,3));return this}};i=t([_s("geotoolkit3d.scene.well.LogCurve2DGeometry")],i);return i}();var djt=Ci(function(){let i=class t extends fUt{constructor(t){super();Object.assign(this,{type:"LogCurve2D"});const i=qi(t,{colorprovider:"red",color:"red",radius:1,offset:1});if(typeof i["colorprovider"]=="string")i["color"]=i["color"]||i["colorprovider"];else{i["data"]["colorprovider"]=i["colorprovider"];delete i["color"]}delete i["colorprovider"];typeof i["color"]=="string"&&(i["color"]=new l(i["color"]));i["data"]["line"]=!0;const s=i;s["geometry"]=new Cjt(t["data"]);s["material"]=new cjt(t);this.Gqi_=new dJt(s);this.add(this.Gqi_)}setOptions(t){if(t==null)return this;super.setOptions(t);const i=qi(t,{});if(i["colorprovider"]!=null){if(typeof i["colorprovider"]=="string")i["color"]=i["color"]||i["colorprovider"];else{i["data"]=i["data"]||{};i["data"]["colorprovider"]=i["colorprovider"];delete i["color"]}delete i["colorprovider"]}typeof i["color"]=="string"&&(i["color"]=new l(i["color"]));this.Gqi_.setOptions(i);this.invalidateObject();return this}JV_(){return Pi(this.Gqi_.material.JV_(),super.JV_())}};i=t([_s("geotoolkit3d.scene.well.LogCurve2D")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");const Bjt=new l;var wjt=function(){let i=class t extends z{constructor(){super();Object.assign(this,{type:"LogFill2DGeometry"});this.c3e_=null;this.pi_=[]}ZhA_(){const t=[],i=undefined;if(this.getAttribute("position")==null||this.pi_.length===0)return;const s=this.getAttribute("position").count,e=this.pi_;let A,n=[];if(this.c3e_ instanceof Mo)for(A=0;A<s;A++){const i=this.c3e_.getColor(e[A%e.length]);if(i){n=Bjt.setRGB(i.Is_()/255,i.Cs_()/255,i.fs_()/255).toArray();t.push(n[0],n[1],n[2],n[0],n[1],n[2])}else t.push(null,null,null,null,null,null)}else{n=Bjt.set(this.c3e_).toArray();for(A=0;A<s;A++)t.push(n[0],n[1],n[2],n[0],n[1],n[2])}const h=this.getAttribute("color");if(h==null)this.setAttribute("color",new ut(new Float32Array(t),3));else{h.array=new Float32Array(t);h.needsUpdate=!0}}ggA_(t){const i=t["x"],s=t["y"],e=t["z"];if(!Array.isArray(i)||!Array.isArray(s)||!Array.isArray(e)||i.length<2||s.length<2||e.length<2){ki("LogFill2D: cannot be created due to insufficient data points");return}let A=t["colorvalues"];Array.isArray(A)||(A=A==null?[0]:[A]);this.pi_=A;const n=[],h=[];for(let t=0;t<i.length;t++){n.push(i[t],s[t],e[t]);n.push(i[t],s[t],e[t]);if(t>=1){const i=2*t;h.push(i-2,i-1,i);h.push(i,i-1,i+1)}}this.setAttribute("position",new ut(new Float32Array(n),3));this.setIndex(new ut(new Uint32Array(h),1));const r=t["curvevalues1"]!=null?t["curvevalues1"]:0,o=t["curvevalues2"]!=null?t["curvevalues2"]:1,l=Array.isArray(r)?r:[r],u=Array.isArray(o)?o:[o],a=[],g=[],c=[],I=[],f=e[e.length-1]-e[0]>0?-1:1,C=function(t,A,n,h){const r=i[t]-i[A],o=s[t]-s[A],l=Math.abs(e[t]-e[A])<NA.Je_?f*NA.Je_:e[t]-e[A];n.push(r,o,l);h!=null&&h.push(r,o,l)},d=function(t,i){const s=u[t%u.length],e=l[t%l.length];let A=s>e?1:-1;s===e&&(A=u[(t+=i)%u.length]>l[t%l.length]?1:-1);return A};C(0,1,a,g);c.push(l[0]);I.push(d(0,-1));C(0,1,a,g);c.push(u[0]);I.push(d(0));const B=function(t,i,s,e){C(t,i,a);C(i,s,g);c.push(e)};let w,Q,E;for(E=1;E<i.length-1;E++){w=l[E%l.length];Q=u[E%u.length];B(E-1,E,E+1,w);I.push(d(E,-1));B(E-1,E,E+1,Q);I.push(d(E,1))}C(i.length-2,i.length-1,a,g);c.push(l[l.length-1]);I.push(d(E,-1));C(i.length-2,i.length-1,a,g);c.push(u[u.length-1]);I.push(d(E,1));this.setAttribute(qWt.ouA_,new ut(new Float32Array(c),1));this.setAttribute(qWt.ruA_,new ut(new Float32Array(g),3));this.setAttribute(qWt.huA_,new ut(new Float32Array(a),3));this.setAttribute(xzt.quA_,new ut(new Float32Array(I),1))}setOptions(t){if(t==null)return this;t.hasOwnProperty("data")&&this.ggA_(t["data"]);if(t.hasOwnProperty("colorprovider")&&t["colorprovider"]!==this.c3e_){this.c3e_=t["colorprovider"];this.ZhA_()}return this}JV_(){return{colorprovider:this.c3e_}}};i=t([_s("geotoolkit3d.scene.well.LogFill2DGeometry")],i);return i}();const Qjt=xzt;var Ejt=function(){let i=class t extends d{constructor(t){const i=qi(t,{});super({vertexShader:Qjt.JuA_,fragmentShader:Qjt.PuA_});this.type="LogFill2DMaterial";this.side=e;this.setOptions(i)}JV_(){return Pi(Qjt.HuA_(this),qWt.jlA_(this))}setOptions(t){const i=qi(t,{});this.vertexColors=i["positivecolor"]==null&&i["negativecolor"]==null;i["normalizedcurvemin"]=0;i["normalizedcurvemax"]=1;Qjt.KuA_(this,i);qWt.XlA_(this,i);return this}};i=t([_s("geotoolkit3d.scene.well.LogFill2DMaterial")],i);return i}();$Lt.yZe_(Ejt.D_(),yLt);var pjt=Ci(function(){let i=class t extends fUt{constructor(t){super();Object.assign(this,{type:"LogFill2D"});const i=qi(t,{colorprovider:"blue",radius:1,opacity:1,offset:1,offsetmode:OXt.wgA_});this._xs=[];this._ys=[];this._zs=[];this.acA_={};this.gcA_=[0];this.ccA_=1;this.IcA_=0;this.E4e_=null;this.fcA_=null;this.CcA_=null;this.a3e_=Number.POSITIVE_INFINITY;this.u3e_=Number.NEGATIVE_INFINITY;this.dcA_=null;this.BcA_=null;this.Ci_=new W(new wjt,new Ejt(i));this.add(this.Ci_);this.setOptions(i)}setOptions(t){if(t==null)return this;super.setOptions(t);const i=qi(t,{});if(i.hasOwnProperty("data")){if(i["data"]["colorvalues"]!=null){const t=i["data"]["colorvalues"];Array.isArray(t)?this.gcA_=t.slice(0):this.gcA_=[t]}this._xs=i["data"]["x"]?i["data"]["x"]:this._xs;this._ys=i["data"]["y"]?i["data"]["y"]:this._ys;this._zs=i["data"]["z"]?i["data"]["z"]:this._zs;this.ccA_=i["data"]["curvevalues1"]?i["data"]["curvevalues1"]:this.IcA_;this.IcA_=i["data"]["curvevalues2"]?i["data"]["curvevalues2"]:this.IcA_;this.E4e_=i["data"]["nullvalue"]?i["data"]["nullvalue"]:this.E4e_;this.fcA_=i["data"]["nullvalue1"]?i["data"]["nullvalue1"]:this.fcA_;this.CcA_=i["data"]["nullvalue2"]?i["data"]["nullvalue2"]:this.CcA_;const t=Array.isArray(this.ccA_)?NA.oA_(this.ccA_,void 0,this.fcA_):[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],s=Array.isArray(this.IcA_)?NA.oA_(this.IcA_,void 0,this.CcA_):[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];this.a3e_=t[0]<=s[0]?t[0]:s[0];this.u3e_=t[1]>=s[1]?t[1]:s[1]}if(this.dcA_==null||this.BcA_==null||typeof i["curvemin"]=="number"&&typeof i["curvemax"]=="number"&&(this.dcA_!==i["curvemin"]||this.BcA_!==i["curvemax"])){this.dcA_=i["curvemin"]!=null?i["curvemin"]:this.a3e_;this.BcA_=i["curvemax"]!=null?i["curvemax"]:this.u3e_;const t=this._xs.slice(0),s=this._ys.slice(0),e=this._zs.slice(0),A=this.gcA_.slice(0);let n,h;if(!Array.isArray(t)||!Array.isArray(s)||!Array.isArray(e)||t.length<2||s.length<2||e.length<2){ki("LogFill2D: cannot be created due to insufficient data points");return this}if(Array.isArray(this.ccA_)&&Array.isArray(this.IcA_)){let i=this.dcA_,r=this.BcA_;if(this.dcA_===this.a3e_&&this.BcA_===this.u3e_){i=null;r=null}const o=jXt.NgA_(this.ccA_,this.IcA_,A,i,r,this.E4e_,this.fcA_,this.CcA_,t,s,e);n=o.mgA_;h=o.ygA_}else if(Array.isArray(this.ccA_)){n=jXt.SgA_(this.ccA_,this.IcA_,A,this.dcA_,this.BcA_,this.E4e_,this.fcA_,t,s,e);h=this.IcA_}else{n=this.ccA_;h=jXt.SgA_(this.IcA_,this.ccA_,A,this.dcA_,this.BcA_,this.E4e_,this.CcA_,t,s,e)}this.acA_["x"]=t;this.acA_["y"]=s;this.acA_["z"]=e;this.acA_["colorvalues"]=A;this.acA_["curvevalues1"]=n;this.acA_["curvevalues2"]=h}i["data"]=Pi(this.acA_,i["data"]);this.Ci_.geometry.setOptions(i);this.Ci_.material.setOptions(i);this.invalidateObject();return this}JV_(){const t=Pi(this.Ci_.material.JV_(),this.Ci_.geometry.JV_());t["curvemin"]=this.dcA_;t["curvemax"]=this.BcA_;return Pi(t,super.JV_())}dispose(){this._xs=null;this._ys=null;this._zs=null;this.ccA_=null;this.IcA_=null;this.gcA_=null;this.acA_=null;fLt.dispose(this.Ci_);super.dispose()}};i=t([_s("geotoolkit3d.scene.well.LogFill2D")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");var mjt=function(){let i=class t extends z{constructor(t){super();const i=t["trajectory"]["x"],s=t["trajectory"]["y"],e=t["trajectory"]["z"],A=[],n=[],h=[],r=[],o=[];for(let t=0;t<i.length;t++){A.push(i[t],s[t],e[t],i[t],s[t],e[t]);t===0?h.push(i[t+1]-i[t],s[t+1]-s[t],e[t+1]-e[t],i[t+1]-i[t],s[t+1]-s[t],e[t+1]-e[t]):h.push(i[t]-i[t-1],s[t]-s[t-1],e[t]-e[t-1],i[t]-i[t-1],s[t]-s[t-1],e[t]-e[t-1]);t===i.length-1?r.push(i[t]-i[t-1],s[t]-s[t-1],e[t]-e[t-1],i[t]-i[t-1],s[t]-s[t-1],e[t]-e[t-1]):r.push(i[t+1]-i[t],s[t+1]-s[t],e[t+1]-e[t],i[t+1]-i[t],s[t+1]-s[t],e[t+1]-e[t]);o.push(-1,1);if(t>0){const t=A.length/3-1;n.push(t-3,t-2,t-1,t-2,t-1,t)}}this.setIndex(n);this.setAttribute("position",new ut(new Float32Array(A),3));this.setAttribute("instancePrevDir",new ut(new Float32Array(h),3));this.setAttribute("instanceNextDir",new ut(new Float32Array(r),3));this.setAttribute("offsetDirection",new ut(new Float32Array(o),1))}};i=t([_s("geotoolkit3d.scene.well.loggrid.LogGrid2DBackgroundGeometry")],i);return i}();var yjt=function(){let i=class t extends d{constructor(t){super({vertexShader:Vzt.ZuA_,fragmentShader:Vzt._uA_,side:e});this["isMeshBasicMaterial"]=!0;const i=qi(t,{radius:100});this.setOptions(i)}setOptions(t){if(t==null)return this;Vzt.WuA_(this,t);t.hasOwnProperty("opacity")&&(this.opacity=t["opacity"]);t.hasOwnProperty("color")&&(this.color=t["color"]);return this}JV_(){return qi({opacity:this.opacity,color:this.color},Vzt.zuA_(this))}};i=t([_s("geotoolkit3d.scene.well.loggrid.LogGrid2DBackgroundMaterial")],i);return i}();var Djt=function(){let i=class t extends fUt{constructor(t){super();this.U9e_=new W(new mjt(t),new yjt(t));this.add(this.U9e_)}setOptions(t){if(t==null)return this;super.setOptions(t);this.U9e_.material.setOptions(t);return this}};i=t([_s("geotoolkit.scene.well.loggrid.LogGrid2DBackground")],i);return i}();var Mjt=function(){let i=class t extends hUt{constructor(t){const i=undefined;super(qi(t,{radius:100,vertexShader:Vzt.XuA_,fragmentShader:Vzt.juA_,polygonoffset:!0,polygonoffsetfactor:1}));this.side=e;t==null&&this.setOptions(t)}setOptions(t){super.setOptions(t);Vzt.VuA_(this,t);return this}JV_(){return qi(Vzt.OuA_(this),super.JV_())}};i=t([_s("geotoolkit3d.scene.well.loggrid.LogGrid2DLineMaterial")],i);return i}();var vjt=function(){let i=class t extends fUt{constructor(t){super();const i=t;i["geometry"]=this.createGeometry(t["data"]);i["material"]=new Mjt(t);this.wcA_=new dJt(i);this.add(this.wcA_)}setOptions(t){if(t==null)return this;super.setOptions(t);this.wcA_.setOptions(t);return this}};i=t([_s("geotoolkit3d.scene.well.loggrid.LogGrid2DLine")],i);return i}();var bjt=function(){let i=class t extends eUt{setData(t){if(t==null||t["trajectory"]==null)return this;this.QcA_(t);super.setData(t);const i=t["positions"],s=new Float32Array(i.length),e=new Float32Array(i.length),A=this.EcA_(s,e,t),n=new q(s,3,1),h=new q(e,3,1);this.setAttribute("instancePrevDirStart",new J(n,3,0));this.setAttribute("instanceNextDirStart",new J(h,3,0));this.setAttribute("instancePrevDirEnd",new J(n,3,A));this.setAttribute("instanceNextDirEnd",new J(h,3,A));const r=new Float32Array(i.length/3);this.pcA_(r,t);const o=new q(r,1,1);this.setAttribute("offsetDirectionStart",new J(o,1,0));this.setAttribute("offsetDirectionEnd",new J(o,1,1));return this}};i=t([_s("geotoolkit3d.scene.well.loggrid.LogGrid2DLineGeometry")],i);return i}();const Njt=[],Sjt=(t,i,s)=>{Njt[0]=t[i]-t[s];Njt[1]=t[i+1]-t[s+1];Njt[2]=t[i+2]-t[s+2];return Njt};var Gjt=function(){let i=class t extends bjt{pcA_(t,i){t.fill(-1,0,(t.length-2)*.5+1);t.fill(1,(t.length-2)*.5+1,t.length-1);t.fill(-1,t.length-1,t.length)}EcA_(t,i,s){const e=s["positions"];let A=0;t.set(Sjt(e,A,A+3),A);i.set(Sjt(e,A,A+3),A);for(A=3;A<(e.length-6)*.5-6;A+=3){t.set(Sjt(e,A-3,A),A);i.set(Sjt(e,A,A+3),A)}t.set(Sjt(e,A-3,A),A);i.set(Sjt(e,A-3,A),A);A+=3;t.set(Sjt(e,A-6,A),A);i.set(Sjt(e,A-6,A),A);A+=3;t.set(Sjt(e,A+6,A),A);i.set(Sjt(e,A+6,A),A);A+=3;t.set(Sjt(e,A+3,A),A);i.set(Sjt(e,A+3,A),A);A+=3;for(;A<e.length-9;A+=3){t.set(Sjt(e,A+3,A),A);i.set(Sjt(e,A,A-3),A)}t.set(Sjt(e,A,A-3),A);i.set(Sjt(e,A,A-3),A);A+=3;t.set(Sjt(e,A,A-6),A);i.set(Sjt(e,A,A-6),A);A+=3;t.set(Sjt(e,0,3),A);i.set(Sjt(e,0,3),A);return 3}QcA_(t){const i=t["trajectory"],s=[],e=[],A=[];for(let t=0;t<i.count();t++){const n=i.mcA_(i.G2_(t));s.push(n.x);e.push(n.y);A.push(n.z)}for(let t=i.count()-1;t>=0;t--){const n=i.mcA_(i.G2_(t));s.push(n.x);e.push(n.y);A.push(n.z)}const n=i.mcA_(i.G2_(0));s.push(n.x);e.push(n.y);A.push(n.z);t["x"]=s;t["y"]=e;t["z"]=A}zoe_(){const t=[],i=[],s=[],e=this.getAttribute("instanceStart").data.array,A=(this.instanceCount-1)*1.5;for(let n=0;n<A;n+=3){t.push(e[n]);i.push(e[n+1]);s.push(e[n+2])}return{x:t,y:i,z:s}}};i=t([_s("geotoolkit3d.scene.well.loggrid.LogGrid2DLineEdgeGeometry")],i);return i}();var Rjt=function(){let i=class t extends vjt{createGeometry(t){t["line"]=!0;return new Gjt(t)}zoe_(){return this.wcA_.geometry.zoe_()}};i=t([_s("geotoolkit3d.scene.well.loggrid.LogGrid2DLineEdge")],i);return i}();const kjt=[],Fjt=(t,i)=>{kjt[0]=t.x-i.x;kjt[1]=t.y-i.y;kjt[2]=t.z-i.z;return kjt},xjt=.001;var Ljt=function(){let i=class t extends bjt{pcA_(t,i){for(let i=0;i<t.length;i+=2){t.fill(-1,i,i+1);t.fill(1,i+1,i+2)}}EcA_(t,i,s){const e=s["trajectory"],A=s["depths"];for(let s=0;s<A.length;s++){const n=A[s];let h=n-xjt,r=n+xjt;h<e.Mcs_()&&(h=e.Mcs_());r>e.vcs_()&&(r=e.vcs_());const o=e.mcA_(h),l=e.mcA_(n),u=e.mcA_(r);t.set(Fjt(o,l),s*3);i.set(Fjt(l,u),s*3)}return 0}QcA_(t){const i=t["trajectory"],s=[],e=[],A=[];t["depths"].forEach((t=>{const n=i.mcA_(t);s.push(n.x,n.x);e.push(n.y,n.y);A.push(n.z,n.z)}));t["x"]=s;t["y"]=e;t["z"]=A}};i=t([_s("geotoolkit3d.scene.well.loggrid.LogGrid2DLineTicksGeometry")],i);return i}();var Ujt=function(){let i=class t extends vjt{createGeometry(t){t["line"]=!1;return new Ljt(t)}};i=t([_s("geotoolkit3d.scene.well.loggrid.LogGrid2DLineTicks")],i);return i}();var Yjt=Ci(function(){let i=class t extends $n{constructor(t,i,s,e,A,n){super();if(!t||t.length<1||!i||i.length<1||t.length!==i.length)throw new Error;this._x=t;this._y=i;this._z=s;this._d=A;this.kQt_=t[0];this.FQt_=t[0];this.LQt_=i[0];this.UQt_=i[0];this.tNe_=s[0];this.iNe_=s[0];let h,r;if(this._d==null||this._d.length<this._x.length){this._d=[0];for(h=1,r=t.length;h<r;h++){const e=t[h-1]-t[h],A=i[h-1]-i[h],n=s[h-1]-s[h];this._d.push(this._d[h-1]+Math.sqrt(e*e+A*A+n*n))}}let o=!1;if(e!=null){this.onA_=e.clone();o=!0}else if(t.length>0){this.onA_=new a(t[0],i[0],s[0]);this._x[0]=this._x[0]-this.onA_.x;this._y[0]=this._y[0]-this.onA_.y;this._z[0]=this._z[0]-this.onA_.z}else this.onA_=new a(0,0,0);this.SEs_=this._d[0];this.GEs_=this._d[0];this.pi_=n!=null?n:[];this.ycA_();for(h=1,r=t.length;h<r;h++)if(!o){this._x[h]=this._x[h]-this.onA_.x;this._y[h]=this._y[h]-this.onA_.y;this._z[h]=this._z[h]-this.onA_.z}}ycA_(){const t=this._x,i=this._y,s=this._z;for(let e=1,A=t.length;e<A;e++){t[e]<this.kQt_?this.kQt_=t[e]:t[e]>this.FQt_&&(this.FQt_=t[e]);i[e]<this.LQt_?this.LQt_=i[e]:i[e]>this.UQt_&&(this.UQt_=i[e]);s[e]<this.tNe_?this.tNe_=s[e]:s[e]>this.iNe_&&(this.iNe_=s[e]);s[e]<this.tNe_?this.tNe_=s[e]:s[e]>this.iNe_&&(this.iNe_=s[e]);this._d[e]<this.SEs_?this.SEs_=this._d[e]:this._d[e]>this.GEs_&&(this.GEs_=this._d[e])}}getX(t){return this._x[t]}getY(t){return this._y[t]}getZ(t){return this._z[t]}G2_(t){return this._d[t]}count(){return this._x?this._x.length:0}nIs_(){return this.SEs_}hIs_(){return this.GEs_}F_s_(){return this.kQt_}x_s_(){return this.LQt_}L_s_(){return this.FQt_}U_s_(){return this.UQt_}DcA_(){return this.tNe_}McA_(){return this.iNe_}Mcs_(){return this.SEs_}vcs_(){return this.GEs_}qj_(){return this.onA_}vcA_(t,i,s){let e,A,n=0,h=this._x.length-1;if(t>i){const s=t;t=i;i=s}while(this._d[n]<t||this._d[h]>i){if(this._d[n]<t){n++;if(n>=this._x.length)throw new Error("Depth outside of range")}if(this._d[h]>i){h--;if(h<0)throw new Error("Depth outside of range")}}const r={x:this._x.slice(n,h+1),y:this._y.slice(n,h+1),z:this._z.slice(n,h+1)};if(s!=null){let e=!0;for(let t=1;t<s.length;t++)if(s[t]["depth"]<s[t-1]["depth"]){e=!1;break}if(s[0]["depth"]===t&&s[s.length-1]["depth"]===i&&e){r["widths"]=[];let t=0,i=0;for(let e=n;e<h+1;e++){while(this._d[e]>s[t]["depth"]){const e=this.mcA_(s[t]["depth"]);r["x"].splice(i,0,e.x);r["y"].splice(i,0,e.y);r["z"].splice(i,0,e.z);r["widths"].push(s[t]["radius"]);i++;t++}i++;if(this._d[e]===s[t]["depth"]){r["widths"].push(s[t]["radius"]);t++}else{const i=s[t]["radius"],A=s[t]["depth"],n=s[t+1]["radius"],h=s[t+1]["depth"];r["widths"].push(i+Math.sign(n-i)*Math.abs(i-n)*(this._d[e]-A)/(h-A))}}}else{ki("Wrong depths of radii! It must be sorted interval from start depth to end depth.");s=null}}let o,l,u,a;if(t!=null&&this._d[n]!==t){const i=this._d[n-1];a=(t-i)/(this._d[n]-i);o=(this._x[n]-this._x[n-1])*a;l=(this._y[n]-this._y[n-1])*a;u=(this._z[n]-this._z[n-1])*a;e={x:o+this._x[n-1],y:l+this._y[n-1],z:u+this._z[n-1]};s!=null&&(e["widths"]=s[0]["radius"])}if(i!=null&&this._d[h]!==i){const t=this._d[h];a=(i-t)/(this._d[h+1]-t);o=(this._x[h+1]-this._x[h])*a;l=(this._y[h+1]-this._y[h])*a;u=(this._z[h+1]-this._z[h])*a;A={x:o+this._x[h],y:l+this._y[h],z:u+this._z[h]};s!=null&&(A["widths"]=s[s.length-1]["radius"])}if(e!=null){r["x"].unshift(e["x"]);r["y"].unshift(e["y"]);r["z"].unshift(e["z"]);s!=null&&r["widths"].unshift(e["widths"])}if(A!=null){r["x"].push(A["x"]);r["y"].push(A["y"]);r["z"].push(A["z"]);s!=null&&r["widths"].push(A["widths"])}r["origin"]=this.onA_.clone();s!=null&&(r["heights"]=r["widths"]);return r}bcA_(t,i){if(t==null)return null;i==null&&(i=!0);let s=0;while(this._d[s]<t)if(this._d[s]<t){s++;if(s>=this._x.length)throw new Error("Depth outside of range")}let e=0,A=0;if(this._d[s]!==t){e=s-1;A=s}else{e=i?s:s-1;A=i?s+1:s}if(A>=this._d.length){A=this._d.length-1;e=A-1}if(e<0){e=0;A=1}const n=this._x[A]-this._x[e],h=this._y[A]-this._y[e],r=this._z[A]-this._z[e];return new a(n,h,r).normalize()}mcA_(t){let i=0;while(this._d[i]<t)if(this._d[i]<t){i++;if(i>=this._x.length)throw new Error("Depth outside of range")}let s=new a(this._x[i],this._y[i],this._z[i]);if(t!=null&&this._d[i]!==t){const e=this._d[i-1],A=(t-e)/(this._d[i]-e),n=(this._x[i]-this._x[i-1])*A,h=(this._y[i]-this._y[i-1])*A,r=(this._z[i]-this._z[i-1])*A;s=new a(n+this._x[i-1],h+this._y[i-1],r+this._z[i-1])}return s}NcA_(t,i,s,e){let A,n,h;for(let i=0;i<this.pi_.length;i++)if(this.pi_[i].dn_()===t){A=this.pi_[i];break}if(A==null)return null;let r=0,o=this._x.length-1,l,u;if(i>s){const t=i;i=s;s=t}while(this._d[r]<i&&this._d[o]>s){if(this._d[r]<i){r++;if(r>=this._x.length)throw new Error("Depth outside of range")}if(this._d[o]>s){o++;if(o<0)throw new Error("Depth outside of range")}}const a=A.getValues();if(i!=null&&this._d[r]!==i&&this._d[r]>i){const t=this._d[r-1];l=(i-t)/(this._d[r]-t);u=(a[r]-a[r-1])*l;n=u+a[r]}if(s!=null&&this._d[o]!==s&&this._d[o]<s){const t=this._d[o];l=(s-t)/(this._d[o+1]-t);u=(a[o+1]-a[o])*l;h=u+a[o]}const g=a.slice(r,o+1);if(e!=null){let t=!0;for(let i=1;i<e.length;i++)if(e[i]["depth"]<e[i-1]["depth"]){t=!1;break}if(e[0]["depth"]===i&&e[e.length-1]["depth"]===s&&t){let t=0,i=0;for(let s=r;s<o+1;s++){this._d[s]===e[t]["depth"]&&t++;while(this._d[s]>e[t]["depth"]){const A=a[i],n=a[i+1],h=e[t]["depth"],r=e[t+1]["depth"],o=A+Math.sign(n-A)*Math.abs(A-n)*(this._d[s]-h)/(r-h);g.splice(i,0,o);t++;i++}i++}}else{ki("Wrong depths of radii! It must be sorted interval from start depth to end depth.");e=null}}n!=null&&g.unshift(n);h!=null&&g.push(h);return g}ScA_(){return this._z}};i=t([_s("geotoolkit3d.geodata.Trajectory3d")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXREZXB0aCI6IkcyXyIsIm1pbkRlcHRoIjoibklzXyIsIm1heERlcHRoIjoiaElzXyIsImdldE1pblgiOiJGX3NfIiwiZ2V0TWluWSI6Inhfc18iLCJnZXRNYXhYIjoiTF9zXyIsImdldE1heFkiOiJVX3NfIiwiZ2V0TWluWiI6IkRjQV8iLCJnZXRNYXhaIjoiTWNBXyIsImdldE1pbkRlcHRoIjoiTWNzXyIsImdldE1heERlcHRoIjoidmNzXyIsImdldE9yaWdpbiI6InFqXyIsImdldENvb3JkaW5hdGVzRm9yRGVwdGhzIjoidmNBXyIsImdldERpcmVjdGlvbkF0RGVwdGgiOiJiY0FfIiwiZ2V0Q29vcmRpbmF0ZUZvckRlcHRoIjoibWNBXyIsImdldFZhbHVlc0ZvckRlcHRocyI6Ik5jQV8ifX19");let Tjt,Kjt,Hjt;const qjt=t=>t!=null&&t!=="transparent"&&!(t instanceof nA&&t.ds_()===0),Jjt=t=>{let i,s=1;if(t instanceof nA){i=new l(t.Is_()/255,t.Cs_()/255,t.fs_()/255);s=t.ds_()/255}else i=t instanceof l?t:new l(t);return{color:i,opacity:s}};var Pjt=Ci(function(){let i=class t extends fUt{constructor(t){super();if(t==null||t["data"]==null||t["data"]["x"]==null||t["data"]["y"]==null||t["data"]["z"]==null)throw new Error("LogGrid2D needs trajectory data to be constructed");Tjt=Tjt||new a;Kjt=Kjt||new a;Hjt=Hjt||new xA;const i=t["data"],s=t["grid"]||{},e=s["depths"]||[],A=hl.Wi_(s["commonlinestyle"])||new hl("grey",2),n=s["commontextstyle"]||new qa({color:"white",font:"11px Arial"}),h=s["radius"]||100,r=s["backgroundcolor"],o=s["alignment"]||Lzt.v6_,l=s["edgelinestyle"]||A;this.Kis_=qi({grid:{depths:[],commonlinestyle:null,commontextstyle:null,radius:-1,backgroundcolor:null,alignment:null,edgelinestyle:null}},super.JV_());this.GcA_={};this.RcA_={};this.jFs_=new Yjt(i["x"].slice(),i["y"].slice(),i["z"].slice());this.kcA_=new Rjt({linestyle:hl.Wi_(l),data:{trajectory:this.jFs_},radius:h,alignment:o});this.WH_=new sa(0,this.jFs_.Mcs_(),1,this.jFs_.vcs_());this.add(this.kcA_);this.setOptions({grid:{depths:e,commonlinestyle:A,commontextstyle:n,radius:h,backgroundcolor:r,alignment:o,edgelinestyle:l,tickgenerator:s["tickgenerator"]}});this.KC_(!1)}beforeRender(t,i,s,e){super.beforeRender(t,i,s,e);if(!this.visible)return this;i.updateMatrixWorld();const A=this.Kis_["grid"]["alignment"]===Lzt.X_?-1:1,n=i.getWorldDirection(Tjt),h=s.getSize(Hjt),r=h.Ie_()*.5,o=h.Ts_()*.5,l=[],u=this.Kis_["grid"]["commonlinestyle"].Ie_()*2,a=s.GZe_().scale;for(const h in this.RcA_){const g=this.RcA_[h],c=g.text,I=c.position;I.copy(g.direction).cross(n);const f=Math.abs(I.x),C=Math.abs(I.y),d=Math.abs(I.z);I.z*=d/(f+C+d);I.normalize().multiplyScalar(A*(u+c.scale.x*.6)).divide(a).addScaledVector(g.position,1);c.visible=!0;c.beforeRender(t,i,s,e,!0);c.updateMatrixWorld();const B=Kjt.set(0,0,0).applyMatrix4(c.matrixWorld).project(i),w=(B.x+1)*r,Q=(B.y+1)*o,E=c.material.map.image,p=E.width*.6,m=E.height*.6,y=new mA(w-p,Q-m,w+p,Q+m);let D=!1;for(let t=l.length-1;t>=0;t--)if(l[t].$s_(y)){D=!0;break}c.visible=!D;D||l.push(y)}return this}setOptions(t){if(t==null)return this;super.setOptions(t);const i=t["grid"];if(i==null)return this;if(i["tickgenerator"]!=null){const t=i["tickgenerator"],s=new Mr({visiblemodelbounds:this.WH_,modelbounds:this.WH_,devicevisiblebounds:this.WH_,tickorigin:this.WH_.Ee_(),tickend:this.WH_.pe_(),contexttransformation:Gn.JI_}),e=t.reset(this,fg.ax_,s);let A=0,n=0,h="",r="";const o={};for(let i=0;i<e.length;i++){const l=e[i];s.kE_(l);const u={REt_:[],labels:{},Jvt_:t.Vx_(l),z6_:t.Rx_(l)};if(u.Jvt_!=null){const e=t.jx_(this,fg.ax_,s);for(let i=0;i<e;i++){const e=t._x_(this,fg.ax_,s,i);Number.isNaN(e)||u.REt_.push(e)}if(e>A){A=e;h=l[i]}}if(u.z6_!=null&&t.Gx_(l)){const e=t.Xx_(this,fg.ax_,s);for(let i=0;i<e;i++){const e=t.Zx_(this,fg.ax_,s,i);Number.isNaN(e)||(u.labels[e]=t.Fx_(this,fg.ax_,s,i,e))}if(e>n){n=e;r=l[i]}}o[l]=u}h.length>0&&(i["commonlinestyle"]!=null?h="":i["commonlinestyle"]=o[h].Jvt_);r.length>0&&(i["commontextstyle"]!=null?r="":i["commontextstyle"]=o[h].z6_);i["depths"]=i["depths"]||{};const l=i["depths"];for(const t in o){const i=o[t],s=i.REt_;if(s.length<1)continue;const e=t===h?null:i.Jvt_,A=t===r?null:i.z6_,n=i.labels;for(let t=0;t<s.length;t++){const i=s[t];if(l[i]!=null)continue;l[i]={linestyle:e};const h=n[i];if(h!=null&&h.length>0){l[i]["text"]=h;l[i]["textstyle"]=A}}}}const s=this.Kis_["grid"],e={},A={};let n=!1,h=!1,r=!1,o=!1,l=!1;if(i["commonlinestyle"]!=null&&i["commonlinestyle"]!==s["commonlinestyle"]){i["commonlinestyle"]=hl.Wi_(i["commonlinestyle"]);n=!0;h=!0;s["commonlinestyle"]=i["commonlinestyle"]}if(i["radius"]!=null&&i["radius"]!==s["radius"]){n=!0;r=!0;e["radius"]=i["radius"];A["radius"]=i["radius"];s["radius"]=i["radius"]}if(i["alignment"]!=null&&i["alignment"]!==s["alignment"]){n=!0;r=!0;e["alignment"]=i["alignment"];A["alignment"]=i["alignment"];s["alignment"]=i["alignment"]}if(i["backgroundcolor"]!==void 0&&i["backgroundcolor"]!==s["backgroundcolor"]){if(qjt(i["backgroundcolor"])){r=!0;const t=Jjt(i["backgroundcolor"]);A["color"]=t.color;A["opacity"]=t.opacity}else{this.jk_!=null&&(this.jk_.visible=!1);r=!1}s["backgroundcolor"]=i["backgroundcolor"]}if(i["commontextstyle"]!=null&&i["commontextstyle"]!==s["commontextstyle"]){i["commontextstyle"]=qa.Wi_(i["commontextstyle"]);o=!0;s["commontextstyle"]=i["commontextstyle"]}if(i["edgelinestyle"]!=null&&i["edgelinestyle"]!==s["edgelinestyle"]){i["edgelinestyle"]=hl.Wi_(i["edgelinestyle"]);l=!0;s["edgelinestyle"]=i["edgelinestyle"]}if(i["depths"]!=null){let t=!1;const e=[];for(const A in i["depths"]){const n=+A,h=i["depths"][n],r=s["depths"][n];h["linestyle"]=hl.Wi_(h["linestyle"]);h["textstyle"]=qa.Wi_(h["textstyle"]);if(r==null){if(h["linestyle"]==null){t=!0;e.push(n)}else this.FcA_(n,h["linestyle"]);h["text"]!=null&&this.xcA_(n,h["text"],h["textstyle"])}else{if(h["linestyle"]==null){this.LcA_(n);t=!0;e.push(n)}else if(h["linestyle"]!==r["linestyle"])if(r["linestyle"]==null)this.FcA_(n,h["linestyle"]);else{this.GcA_[n].line.setOptions({linestyle:h["linestyle"]});this.GcA_[n].Jvt_=h["linestyle"]}if(r["text"]==null)h["text"]!=null&&this.xcA_(n,h["text"],h["textstyle"]);else{h["text"]==null&&this.UcA_(n);r["text"]!==h["text"]&&this.RcA_[n].text.a_(h["text"]);if(r["textstyle"]!==h["textstyle"]){this.RcA_[n].text.g_(h["textstyle"]||s["commontextstyle"]);this.RcA_[n].z6_=h["textstyle"]}}}}for(const e in s["depths"]){const A=+e,n=i["depths"][A],h=s["depths"][A];if(n==null){this.UcA_(A);h["linestyle"]==null?t=!0:this.LcA_(A)}}if(t){if(this.YcA_!=null){this.remove(this.YcA_);this.YcA_.dispose();this.YcA_=null}e.length>0&&this.TcA_(e)}s["depths"]=i["depths"]}if(o)for(const t in this.RcA_){const s=this.RcA_[t];s.z6_==null&&s.text.g_(i["commontextstyle"])}h&&this.YcA_!=null&&this.YcA_.setOptions({linestyle:i["commonlinestyle"]});if(n){this.kcA_.setOptions(e);this.YcA_!=null&&this.YcA_.setOptions(e);for(const t in this.GcA_)this.GcA_[t].line.setOptions(e)}l&&this.kcA_.setOptions({linestyle:i["edgelinestyle"]});if(r)if(this.jk_!=null){if(!this.jk_.visible){this.jk_.visible=!0;A["radius"]=s["radius"];A["alignment"]=s["alignment"]}this.jk_.setOptions(A)}else{A["radius"]=s["radius"];A["alignment"]=s["alignment"];A["trajectory"]=this.kcA_.zoe_();this.KcA_(A)}return this}JV_(){return this.Kis_}KcA_(t){const i=new Djt(t);this.jk_=i;this.add(i)}xcA_(t,i,s){const e=new _qt(i,{style:s||this.Kis_["grid"]["commontextstyle"]});this.RcA_[t]={text:e,position:this.jFs_.mcA_(t),direction:this.jFs_.bcA_(t),z6_:s};this.add(e)}TcA_(t){const i=new Ujt({linestyle:this.Kis_["grid"]["commonlinestyle"],data:{trajectory:this.jFs_,depths:t},radius:this.Kis_["grid"]["radius"],alignment:this.Kis_["grid"]["alignment"]});this.YcA_=i;this.add(i)}FcA_(t,i){const s=new Ujt({linestyle:i,data:{trajectory:this.jFs_,depths:[t]},radius:this.Kis_["grid"]["radius"],alignment:this.Kis_["grid"]["alignment"]});this.GcA_[t]={line:s,Jvt_:i};this.add(s)}LcA_(t){this.remove(this.GcA_[t].line);this.GcA_[t].line.dispose();delete this.GcA_[t]}UcA_(t){this.remove(this.RcA_[t].text);this.RcA_[t].text.dispose();delete this.RcA_[t]}rt_(){return this.WH_}getBounds(){return this.WH_}};i=t([Zs(zC),_s("geotoolkit3d.scene.well.loggrid.LogGrid2D")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiZ2V0TW9kZWxMaW1pdHMiOiJydF8ifX19");const Vjt=new a,Ojt=new a;var Wjt=function(){let i=class t extends z{constructor(t){super();Object.assign(this,{type:"MultiLateralTubeGeometry"});this.fk_=t["size"];const i=qi(t,{radiusmin:0,radiusmax:1,tubeprecision:3});this.Us_={};this.setOptions(i);this.A_e_=null;this.HcA_=null;this.abt_=null;this.qcA_=null;this.JcA_=null;this.xm_=null}setOptions(t){const i=qi(t,{radiusmin:this.xgA_,radiusmax:this.LgA_,tubeprecision:this.TgA_,size:this.fk_}),s=undefined;if(!(i["radiusmin"]!==this.xgA_||this.LgA_!==i["radiusmax"]||this.TgA_!==i["tubeprecision"]||i["data"]!=null)){if(this.fk_!==i["size"]){this.fk_=i["size"];this.HcA_&&this.HcA_.set(this.fk_*2,this.fk_*2,1);this.computeBoundingBox()}return this}if(i["data"]!=null){const i=qi(t["data"],{x:this.Us_.xs,y:this.Us_.ys,z:this.Us_.zs,values:this.Us_.values,widths:this.Us_.$7t_,heights:this.Us_.RgA_,rolls:this.Us_.kgA_,bots:this.Us_.PcA_,tops:this.Us_.VcA_});this.Us_.xs=i["x"];this.Us_.ys=i["y"];this.Us_.zs=i["z"];this.Us_.values=i["values"];this.Us_.$7t_=i["widths"];this.Us_.RgA_=i["heights"];this.Us_.kgA_=i["rolls"];this.Us_.PcA_=i["bots"];this.Us_.VcA_=i["tops"]}this.xgA_=i["radiusmin"];this.LgA_=i["radiusmax"];this.TgA_=i["tubeprecision"];this.fk_=i["size"];const e=[],A=jXt.EgA_(this.Us_.$7t_,this.Us_.RgA_,this.xgA_,this.LgA_),n=Array.isArray(this.Us_.kgA_)?this.Us_.kgA_:this.Us_.kgA_==null?[0]:[this.Us_.kgA_];for(let t=0;t<this.Us_.xs.length;t++)e.push(new a(this.Us_.xs[t],this.Us_.ys[t],this.Us_.zs[t]));this.ggA_(e,A.w,A.h,n,this.TgA_);this.OcA_=[];this.ZgA_=[];this.WcA_=[];this.qcA_=null;this.JcA_=null;return this}JV_(){return{radiusmin:this.xgA_,radiusmax:this.LgA_,tubeprecision:this.TgA_,size:this.fk_,data:{x:this.Us_.xs,y:this.Us_.ys,z:this.Us_.zs,values:this.Us_.values,widths:this.Us_.$7t_,heights:this.Us_.RgA_,rolls:this.Us_.kgA_,bots:this.Us_.PcA_,tops:this.Us_.VcA_}}}ggA_(t,i,s,e,A){const n=[],h=[],r=[],o=[];let l;const g=jXt.MgA_(A),c=g.length,I=c-1,f=new a(1,1,1),C=new u;let d=0;const B=new a(0,0,-1),w=new a,Q=w.clone(),E=w.clone(),p=t.length;let m=0;const y=[],D=[];for(let A=0;A<p;A++){if(A>0&&t[A].equals(t[A-1])){m+=1;continue}this.Us_.PcA_.indexOf(A)>-1&&y.push(A-m);this.Us_.VcA_.indexOf(A)>-1&&D.push(A-m);f.x=i[A%i.length]*2;f.y=s[A%s.length]*2;let u=!1,a;if(f.x===0&&f.y===0){f.x=1;f.y=1;u=!0}e[Math.min(A,p-1)]!=null&&(d=e[Math.min(A,p-1)]);a=this.Us_.VcA_.indexOf(A)>-1?Q.copy(t[A+1]).sub(t[A]).normalize():Q.copy(t[A]).sub(t[A-1]).normalize();Math.abs(a.y)===1?E.set(0,0,-1):E.set(0,1,0);C.lookAt(w,a,E);for(l=1;l<c;l++){Q.set(g[l].x,g[l].y,0);Q.multiply(f);Q.applyAxisAngle(B,d);Q.applyMatrix4(C);Q.add(t[A]);u?n.push(t[A].x,t[A].y,t[A].z):n.push(Q.x,Q.y,Q.z);Q.sub(t[A]).normalize();h.push(Q.x,Q.y,Q.z);this.Us_.values==null||isNaN(this.Us_.values[A])?o.push(0):o.push(this.Us_.values[A])}this.Us_.VcA_.indexOf(A)===-1&&n.length/3-2*I>=0&&jXt.DgA_(this,n,r,0,p,I)}const M=new Float32Array(n),v=new Uint32Array(r),b=new Float32Array(o),N=new Float32Array(h);this.setAttribute("position",new ut(M,3));this.setIndex(new ut(v,1));this.setAttribute("normal",new ut(N,3));this.setAttribute(ixt.TXe_,new ut(b,1));this.computeBoundingBox()}computeBoundingBox(){super.computeBoundingBox();this.fk_&&this.boundingBox.expandByScalar(this.fk_)}Ye_(t){this.abt_||this.n_e_((this.Us_.zs[this.Us_.zs.length-1]+this.Us_.zs[0])/2,t);return this.abt_}zcA_(t){this.HcA_||this.n_e_((this.Us_.zs[this.Us_.zs.length-1]+this.Us_.zs[0])/2,t);return this.HcA_}e_e_(t){this.A_e_||this.n_e_((this.Us_.zs[this.Us_.PcA_[0]]+this.Us_.zs[0])/2,t);return this.A_e_}n_e_(t,i){this.xm_||(this.xm_=i);this.xm_.equals(i)||this.xm_.copy(i);if(this.qcA_==null||this.JcA_==null){const t=jXt.QgA_(this.Us_.$7t_,this.Us_.RgA_);this.qcA_=(this.LgA_-this.xgA_)/(t.max-t.min);this.JcA_=this.xgA_-t.min}this.abt_=this.abt_||new a;this.HcA_=this.HcA_||new a(0,0,1);this.A_e_=this.A_e_||new f;let s=NA.findIndex(t,this.Us_.zs,null,null,(function(t,i){return i-t}))||1;s<0&&(s=~s);Vjt.set(this.Us_.xs[s-1],this.Us_.ys[s-1],this.Us_.zs[s-1]);Ojt.set(this.Us_.xs[s],this.Us_.ys[s],this.Us_.zs[s]);const e=(t-this.Us_.zs[s-1])/(this.Us_.zs[s]-this.Us_.zs[s-1]);this.abt_.copy(Ojt).sub(Vjt).multiplyScalar(e).add(Vjt);if(this.Us_.$7t_&&this.Us_.RgA_&&Array.isArray(this.Us_.$7t_)&&Array.isArray(this.Us_.RgA_)){let t=((this.Us_.$7t_[s]-this.Us_.$7t_[s-1])*e+this.Us_.$7t_[s-1])*2,i=((this.Us_.RgA_[s]-this.Us_.RgA_[s-1])*e+this.Us_.RgA_[s-1])*2;t=t*this.qcA_+this.JcA_;i=i*this.qcA_+this.JcA_;this.HcA_.setX(t).setY(i)}else this.HcA_.setX(this.fk_*2).setY(this.fk_*2);Vjt.multiply(this.xm_);Vjt.multiply(this.xm_);Ojt.multiply(this.xm_);Ojt.multiply(this.xm_);Ojt.sub(Vjt).normalize();Vjt.set(-1,0,0);Vjt.crossVectors(Ojt,Vjt).normalize();this.A_e_=kxt.Sje_(Vjt,Ojt,this.A_e_);return this}};i=t([_s("geotoolkit3d.scene.well.MultiLateralTubeGeometry")],i);return i}();function zjt(t,i){const s=1;let e=t-s,A=t+s;e<0&&(e=0);A>=i.length&&(A=i.length-1);const n=i[e],h=undefined,r=undefined;return i[A].clone().sub(n).normalize()}const Xjt=function(t,i,s,e,A){for(t=0;t<=i;t++)for(let n=0;n<=s;n++){e.x=t/i;e.y=n/s;A.push(e.x,e.y)}return t};var jjt=function(){let i=class t extends z{constructor(t){super();Object.assign(this,{type:"PipeGeometry"});this.fk_=t["size"];const i=qi(t,{tubeprecision:4,openended:!1,hardedges:!0});this.setOptions(i)}setOptions(t){const i=qi(t,{tubeprecision:this.TgA_,openended:this.KgA_,size:this.fk_}),s=undefined;if(!(this.TgA_!==i["tubeprecision"]||this.KgA_!==i["openended"]||i["data"]!=null)){if(this.fk_!==i["size"]){this.fk_=i["size"];this.computeBoundingBox()}return this}if(i["data"]!=null){const i=qi(t["data"],{positions:this.U$_,tangents:this.XcA_,normals:this.ZgA_,binormals:this.WcA_,values:this.pi_,radii:this.jcA_});this.U$_=i["positions"];this.ZgA_=i["normals"];this.XcA_=i["tangents"];this.WcA_=i["binormals"];this.pi_=i["values"];this.jcA_=i["radii"]}this.ZcA_=i["hardedges"];this.TgA_=i["tubeprecision"];this.KgA_=i["openended"];this._cA_();return this}JV_(){return{tubeprecision:this.TgA_,openended:this.KgA_,hardedges:this.ZcA_,size:this.fk_,data:{positions:this.U$_,tangents:this.XcA_,normals:this.ZgA_,binormals:this.WcA_,values:this.pi_,radii:this.jcA_}}}$cA_(){const t=this.U$_.length,i=new u;let s=0;const e=new a,A=new a;if(this.WcA_.length!==this.U$_.length||this.ZgA_.length!==this.U$_.length){this.XcA_[0]==null&&(this.XcA_[0]=zjt(0,this.U$_));if(this.ZgA_[0]==null){this.ZgA_[0]=new a;let t=Number.MAX_VALUE;const i=Math.abs(this.XcA_[0].x),s=Math.abs(this.XcA_[0].y),n=Math.abs(this.XcA_[0].z);if(i<=t){t=i;A.set(1,0,0)}if(s<=t){t=s;A.set(0,1,0)}n<=t&&A.set(0,0,1);e.crossVectors(this.XcA_[0],A).normalize();this.ZgA_[0].crossVectors(this.XcA_[0],e)}if(this.WcA_[0]==null){this.WcA_[0]=new a;this.WcA_[0].crossVectors(this.XcA_[0],this.ZgA_[0])}let n;for(s=1;s<=t;s++){this.ZgA_[s]=this.ZgA_[s-1].clone();this.WcA_[s]=this.WcA_[s-1].clone();this.XcA_[s]==null&&(this.XcA_[s]=zjt(s,this.U$_));e.crossVectors(this.XcA_[s-1],this.XcA_[s]);if(e.length()>Number.EPSILON){e.normalize();n=Math.acos(NA.clamp(this.XcA_[s-1].dot(this.XcA_[s]),-1,1));this.ZgA_[s].applyMatrix4(i.makeRotationAxis(e,n))}this.WcA_[s].crossVectors(this.XcA_[s],this.ZgA_[s])}}return s}tIA_(){let t,i=this.jcA_[0];for(t=1;t<this.jcA_.length;t++)if(this.jcA_[t]!==i){this.U$_.splice(t,0,this.U$_[t-1].clone());this.jcA_.splice(t,0,this.jcA_[t]);this.XcA_.length>t&&this.XcA_.splice(t,0,this.XcA_[t-1]);this.pi_.length>t&&this.pi_.splice(t,0,this.pi_[t-1]);this.ZgA_.length>t&&this.ZgA_.splice(t,0,this.ZgA_[t-1]);this.WcA_.length>t&&this.WcA_.splice(t,0,this.WcA_[t-1]);i=this.jcA_[t]}return t}iIA_(t,i,s,e,A,n,h){const r=this;for(let A=1;A<=t-1;A++)for(i=1;i<=s;i++){const t=(s+1)*(A-1)+(i-1),n=(s+1)*A+(i-1),h=(s+1)*A+i,r=(s+1)*(A-1)+i;e.push(t,n,r);e.push(n,h,r)}if(!r.KgA_){const t=A.length/3,o=t-s-1;A.push(r.U$_[0].x,r.U$_[0].y,r.U$_[0].z);const l=(new a).subVectors(r.U$_[0],r.U$_[1]).normalize();n.push(l.x,l.y,l.z);h.push(0,.5);const u=r.U$_.length-1;A.push(r.U$_[u].x,r.U$_[u].y,r.U$_[u].z);l.subVectors(r.U$_[u],r.U$_[u-1]).normalize();n.push(l.x,l.y,l.z);h.push(1,.5);for(i=0;i<=s-1;i++)e.push(t,i,i+1);for(i=0;i<=s-1;i++)e.push(t+1,o+i+1,o+i)}return i}_cA_(){const t=[],i=this.TgA_*4;let s;this.XcA_==null&&(this.XcA_=[]);this.WcA_==null&&(this.WcA_=[]);this.ZgA_==null&&(this.ZgA_=[]);this.jcA_==null?this.jcA_=[]:this.ZcA_&&this.tIA_();const e=this.U$_.length;this.$cA_();const A=this,n=new a,h=new a,r=new g,o=[],l=[],u=[],c=[],I=[],f=function(t){const s=A.U$_[t],e=A.ZgA_[t],r=A.WcA_[t],u=A.jcA_[t];for(let t=0;t<=i;t++){const A=t/i*Math.PI*2,a=Math.sin(A),g=-Math.cos(A);h.x=g*e.x+a*r.x;h.y=g*e.y+a*r.y;h.z=g*e.z+a*r.z;h.normalize();l.push(h.x,h.y,h.z);n.x=s.x;n.y=s.y;n.z=s.z;I!=null&&I.push(u);o.push(n.x,n.y,n.z)}},C=undefined;(function(){for(s=0;s<e;s++)f(s);Xjt(s,e,i,r,u);A.iIA_(e,s,i,c,o,l,u)})();for(s=0;s<e;s++)for(let e=0;e<=i;e++)this.pi_==null||isNaN(this.pi_[s])?t.push(0):t.push(this.pi_[s]);if(!this.KgA_){if(this.pi_!=null){t.push(isNaN(this.pi_[0])?0:this.pi_[0]);t.push(isNaN(this.pi_[this.U$_.length-1])?0:this.pi_[this.U$_.length-1])}else{t.push(0);t.push(0)}I.push(0);I.push(0)}if(I.length>0){const t=new Float32Array(I);this.setAttribute(iXt.iaA_,new ut(t,1))}const d=new Float32Array(o),B=new Uint32Array(c),w=new Float32Array(t),Q=new Float32Array(l);this.setAttribute("position",new ut(d,3));this.setIndex(new ut(B,1));this.setAttribute("normal",new ut(Q,3));this.setAttribute(ixt.TXe_,new ut(w,1));this.setAttribute("uv",new V(u,2));this.computeBoundingBox()}computeBoundingBox(){super.computeBoundingBox();this.fk_&&this.boundingBox.expandByScalar(this.fk_)}};i=t([_s("geotoolkit3d.scene.well.PipeGeometry")],i);return i}();const Zjt=iXt;var _jt=Ci(function(){let i=class t extends xTt{constructor(t){const i=qi(t,{size:100},!0);super(i);this.type="PipeMaterial";this.vertexShader=Zjt.eaA_;this.fragmentShader=Zjt.saA_;Zjt.$uA_(this,i)}setOptions(t){super.setOptions(t);Zjt.$uA_(this,t);return this}JV_(){return Pi(Zjt.taA_(this),super.JV_())}};i=t([_s("geotoolkit3d.scene.well.PipeMaterial")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");$Lt.yZe_(_jt.D_(),yLt);var $jt=Ci(function(){let i=class t extends fUt{constructor(t){if(t==null||!t.hasOwnProperty("data"))throw new Error("geotoolkit3d.scene.well.Pipe has no data");super();this.boA_=new a;let i=[];this.U9e_=[];this.sIA_=!1;Array.isArray(t["data"])?i=t["data"]:t["data"]["radii"]!=null?i.push(t["data"]):i=t["data"].XaA_();this.tcA_(t);for(let s=0;s<i.length;s++){t["data"]=i[s];this.U9e_.push(new W(new jjt(t),new _jt(t)));this.add(this.U9e_[s])}t["data"]=i}setOptions(t,i){if(t==null)return this;super.setOptions(t);if((i=i||0)>this.U9e_.length-1||i<0){ki("The index is out of range.");return this}this.tcA_(t);this.U9e_[i].geometry.setOptions(t);this.U9e_[i].material.setOptions(t);return this}JV_(t){if((t=t||0)>this.U9e_.length-1||t<0)throw new Error("The index is out of range.");const i=Pi(Pi(this.U9e_[t].geometry.JV_(),this.U9e_[t].material.JV_()),super.JV_()),s={name:"unlit",value:i["lights"]?0:1,alt:"Please use Pipe.getOptions.lights instead."};Rs(i,[s],"DynamicTube.getOptions");return i}beforeRender(t,i,s,e){super.beforeRender(t,i,s,e);const A=s.GZe_().scale;for(let t=0;t<this.U9e_.length;t++)this.boA_.equals(A)||qWt.$lA_(this.U9e_[t].material)["normscale"].set(1/A.x,0,0,0,1/A.y,0,0,0,1/A.z);this.boA_.copy(A);return this}tcA_(t){if(t.hasOwnProperty("unlit")){ki("Pipe.Options.unlit is deprecated since 4.0, please use Pipe.Options.lights instead.");t["lights"]=t["unlit"]===0}}};i=t([_s("geotoolkit3d.scene.well.Pipe")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");var tZt=Ci(function(){let i=class t extends fUt{constructor(){super();this.UU_={};this.UU_["fillstyle"]=new wr({color:"gray"});this.jTi_=null;this.U9e_=null}v4_(){return this.jTi_}ZTi_(t){this.jTi_!=null&&this.remove(this.jTi_);this.jTi_=t;this.add(this.jTi_);return this}JV_(){return Pi(this.UU_,super.JV_())}setOptions(t){if(t==null)return this;super.setOptions(t);this.UU_=qi(t,this.UU_,!0);this.U9e_!=null&&this.remove(this.U9e_);this.E3e_();return this}E3e_(){}getBoundingBox(){return null}nt_(){return null}eIA_(){return this.UU_["material"]!=null?this.UU_["material"]:NYt.x5e_(this.UU_["fillstyle"])}};i=t([_s("geotoolkit3d.scene.well.schematic.SchematicBase")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRBbm5vdGF0aW9uIjoidjRfIiwic2V0QW5ub3RhdGlvbiI6IlpUaV8iLCJnZXRPcHRpb25zIjoiSlZfIiwiZ2V0R2VvbWV0cnkiOiJudF8iLCJnZXRNYXRlcmlhbCI6ImVJQV8ifX19");var iZt=Ci(function(){let i=class t extends tZt{constructor(t){super();const i=qi(t,{radiustop:0,radiusbottom:50,height:50,radiussegments:28,heightsegments:1,openended:!1});this.setOptions(i)}E3e_(){const t=this.JV_(),i=t["data"];if(i["x"].length!==2)return;this.AIA_=new hi(t["radiustop"],t["radiusbottom"],t["height"],t["radiussegments"],t["heightsegments"],t["openended"]);let s=(new u).makeRotationAxis(new a(1,0,0).normalize(),Math.PI/2);this.AIA_.applyMatrix4(s);s=(new u).makeTranslation(0,0,t["height"]/2);this.AIA_.applyMatrix4(s);this.AIA_.computeBoundingBox();this.AIA_.computeVertexNormals();const e=new a(i.x[1],i.y[1],i.z[1]);this.U9e_=new W(this.AIA_,this.eIA_());this.U9e_.position.set(i.x[0],i.y[0],i.z[0]);this.U9e_.lookAt(e);this.add(this.U9e_)}getBoundingBox(){return this.U9e_.geometry.boundingBox.clone().applyMatrix4(this.U9e_.matrix)}nt_(){return this.AIA_}};i=t([_s("geotoolkit3d.scene.well.schematic.Cone")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRHZW9tZXRyeSI6Im50XyJ9fX0g");var sZt=Ci(function(){let i=class t extends tZt{constructor(t){super();const i=qi(t,{width:50,widthsegments:1});this.setOptions(i)}E3e_(){const t=this.JV_(),i=t["data"];if(i["x"].length!==2)return;this.nIA_=new mt(t["width"],t["width"],t["width"],t["widthsegments"],t["widthsegments"],t["widthsegments"]);this.nIA_.computeBoundingBox();this.nIA_.computeVertexNormals();const s=new a(i.x[1],i.y[1],i.z[1]);this.U9e_=new W(this.nIA_,this.eIA_());this.U9e_.position.set(i.x[0],i.y[0],i.z[0]);this.U9e_.position.sub(s.clone().sub(this.U9e_.position).setLength(-t["width"]/2));this.U9e_.lookAt(s);this.add(this.U9e_)}getBoundingBox(){return this.U9e_.geometry.boundingBox.clone().applyMatrix4(this.U9e_.matrix)}nt_(){return this.nIA_}};i=t([_s("geotoolkit3d.scene.well.schematic.Cube")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRHZW9tZXRyeSI6Im50XyJ9fX0g");const eZt=new a,AZt=new a;function nZt(t,i){const s=1;let e=t-s,A=t+s;e<0&&(e=0);A>=i.length&&(A=i.length-1);const n=i[e],h=undefined,r=undefined;return i[A].clone().sub(n).normalize()}var hZt=Ci(function(){let i=class t extends z{constructor(t){super();Object.assign(this,{type:"TubeGeometry"});this.fk_=t["size"];const i=qi(t,{radiusmin:0,radiusmax:1,tubeprecision:3,openended:!1,usefrenet:!0});this.Us_={};this.setOptions(i);this.A_e_=null;this.HcA_=null;this.abt_=null;this.qcA_=null;this.JcA_=null;this.xm_=new a(1,1,1)}setOptions(t){const i=qi(t,{radiusmin:this.xgA_,radiusmax:this.LgA_,tubeprecision:this.TgA_,openended:this.KgA_,size:this.fk_,usefrenet:this.hIA_}),s=undefined;if(!(i["radiusmin"]!==this.xgA_||this.LgA_!==i["radiusmax"]||this.TgA_!==i["tubeprecision"]||this.KgA_!==i["openended"]||i["data"]!=null)){if(this.fk_!==i["size"]){this.fk_=i["size"];this.HcA_&&this.HcA_.set(this.fk_*2,this.fk_*2,1);this.computeBoundingBox()}return this}if(i["data"]!=null){const i=qi(t["data"],{x:this.Us_.xs,y:this.Us_.ys,z:this.Us_.zs,values:this.Us_.values,widths:this.Us_.$7t_,heights:this.Us_.RgA_,rolls:this.Us_.kgA_});this.Us_.xs=i["x"];this.Us_.ys=i["y"];this.Us_.zs=i["z"];this.Us_.values=i["values"];this.Us_.$7t_=i["widths"];this.Us_.RgA_=i["heights"];this.Us_.kgA_=i["rolls"]}this.hIA_=i["usefrenet"];this.xgA_=i["radiusmin"];this.LgA_=i["radiusmax"];this.TgA_=i["tubeprecision"];this.KgA_=i["openended"];this.fk_=i["size"];const e=[],A=jXt.EgA_(this.Us_.$7t_,this.Us_.RgA_,this.xgA_,this.LgA_),n=Array.isArray(this.Us_.kgA_)?this.Us_.kgA_:this.Us_.kgA_==null?[0]:[this.Us_.kgA_];for(let t=0;t<this.Us_.xs.length;t++)e.push(new a(this.Us_.xs[t],this.Us_.ys[t],this.Us_.zs[t]));this.hIA_?this._cA_(e,A.w,A.h,n,this.TgA_,this.KgA_):this.ggA_(e,A.w,A.h,n,this.TgA_,this.KgA_);this.OcA_=[];this.ZgA_=[];this.WcA_=[];this.qcA_=null;this.JcA_=null;return this}JV_(){return{radiusmin:this.xgA_,radiusmax:this.LgA_,tubeprecision:this.TgA_,openended:this.KgA_,size:this.fk_,usefrenet:this.hIA_,data:{x:this.Us_.xs,y:this.Us_.ys,z:this.Us_.zs,values:this.Us_.values,widths:this.Us_.$7t_,heights:this.Us_.RgA_,rolls:this.Us_.kgA_}}}ggA_(t,i,s,e,A,n){const h=[],r=[],o=[],l=[];let g;const c=jXt.MgA_(A),I=c.length,f=I-1,C=new a(1,1,1),d=new u;let B=0;const w=new a(0,0,-1),Q=new a,E=Q.clone(),p=Q.clone(),m=t.length;for(let A=0;A<m;A++){if(A>0&&t[A].equals(t[A-1]))continue;C.x=i[A%i.length]*2;C.y=s[A%s.length]*2;let n=!1,u;if(C.x===0&&C.y===0){C.x=1;C.y=1;n=!0}e[Math.min(A,m-1)]!=null&&(B=e[Math.min(A,m-1)]);u=A>0?E.copy(t[A]).sub(t[A-1]).normalize():E.copy(t[A+1]).sub(t[A]).normalize();Math.abs(u.y)===1?p.set(0,0,-1):p.set(0,1,0);d.lookAt(Q,u,p);for(g=1;g<I;g++){E.set(c[g].x,c[g].y,0);E.multiply(C);E.applyAxisAngle(w,B);E.applyMatrix4(d);E.add(t[A]);n?h.push(t[A].x,t[A].y,t[A].z):h.push(E.x,E.y,E.z);E.sub(t[A]).normalize();r.push(E.x,E.y,E.z);this.Us_.values==null||isNaN(this.Us_.values[A])?l.push(0):l.push(this.Us_.values[A])}h.length/3-2*f>=0&&jXt.DgA_(this,h,o,0,m,f)}if(!n){let i=h.length/3-1;const s=h.length/3,e=h.length/3+1;h.push(t[0].x,t[0].y,t[0].z);h.push(t[t.length-1].x,t[t.length-1].y,t[t.length-1].z);const A=t[0].clone().sub(t[1]).normalize();r.push(A.x,A.y,A.z);const n=t[t.length-1].clone().sub(t[t.length-2]).normalize();r.push(n.x,n.y,n.z);if(this.Us_.values!=null){l.push(isNaN(this.Us_.values[t.length-1])?0:this.Us_.values[t.length-1]);l.push(isNaN(this.Us_.values[0])?0:this.Us_.values[0])}else{l.push(0);l.push(0)}let u=i-(f-1);for(g=0;g<f;g++)o.push(e,u+(g+1)%f,u+g);i=f;u=i-f;for(g=0;g<f;g++)o.push(s,u+g,u+(g+1)%f)}const y=new Float32Array(h),D=new Uint32Array(o),M=new Float32Array(l),v=new Float32Array(r);this.setAttribute("position",new ut(y,3));this.setIndex(new ut(D,1));this.setAttribute("normal",new ut(v,3));this.setAttribute(ixt.TXe_,new ut(M,1));this.computeBoundingBox()}_cA_(t,i,s,e,A,n){const h=[],r=t.length;if(r<2)return;A*=4;this.OcA_==null&&(this.OcA_=[]);this.WcA_==null&&(this.WcA_=[]);this.ZgA_==null&&(this.ZgA_=[]);const o=new a,l=new a,c=new u;this.OcA_[0]==null&&r>1&&(this.OcA_[0]=nZt(0,t));if(this.ZgA_[0]==null&&r>1){this.ZgA_[0]=new a;let t=Number.MAX_VALUE;const i=Math.abs(this.OcA_[0].x),s=Math.abs(this.OcA_[0].y),e=Math.abs(this.OcA_[0].z);if(i<=t){t=i;l.set(1,0,0)}if(s<=t){t=s;l.set(0,1,0)}e<=t&&l.set(0,0,1);o.crossVectors(this.OcA_[0],l).normalize();this.ZgA_[0].crossVectors(this.OcA_[0],o)}if(this.WcA_[0]==null&&r>1){this.WcA_[0]=new a;this.WcA_[0].crossVectors(this.OcA_[0],this.ZgA_[0])}let I,f;for(f=1;f<=r;f++){this.ZgA_[f]=this.ZgA_[f-1].clone();this.WcA_[f]=this.WcA_[f-1].clone();this.OcA_[f]==null&&(this.OcA_[f]=nZt(f,t));o.crossVectors(this.OcA_[f-1],this.OcA_[f]);if(o.length()>Number.EPSILON){o.normalize();I=Math.acos(NA.clamp(this.OcA_[f-1].dot(this.OcA_[f]),-1,1));this.ZgA_[f].applyMatrix4(c.makeRotationAxis(o,I))}this.WcA_[f].crossVectors(this.OcA_[f],this.ZgA_[f])}const C=new a,d=new g,B=[],w=[],Q=[],E=[];let p=0;const m=new g(1,1),y=n=>{const h=t[n],o=this.ZgA_[n],u=this.WcA_[n];let a=0;e[Math.min(n,r-1)]!=null&&(a=e[Math.min(n,r-1)]);for(let t=0;t<=A;t++){const e=t/A*Math.PI*2,r=t/A*Math.PI*2+a,g=Math.sin(e),c=-Math.cos(e),I=Math.sin(r),f=-Math.cos(r);m.x=i[n%i.length];m.y=s[n%s.length];const d=undefined;if(m.lengthSq()===0){l.x=c*o.x+g*u.x;l.y=c*o.y+g*u.y;l.z=c*o.z+g*u.z;l.normalize();w.push(l.x,l.y,l.z);C.x=h.x;C.y=h.y;C.z=h.z}else{l.x=f*o.x+I*u.x;l.y=f*o.y+I*u.y;l.z=f*o.z+I*u.z;l.normalize();w.push(l.x,l.y,l.z);const t=m.x*m.y,i=Math.pow(m.x,2)*Math.pow(g,2)+Math.pow(m.y,2)*Math.pow(c,2);p=t/Math.sqrt(i);C.x=h.x+l.x*p;C.y=h.y+l.y*p;C.z=h.z+l.z*p}B.push(C.x,C.y,C.z)}};function D(){for(let t=1;t<=r-1;t++)for(f=1;f<=A;f++){const i=(A+1)*(t-1)+(f-1),s=(A+1)*t+(f-1),e=(A+1)*t+f,n=(A+1)*(t-1)+f;E.push(i,s,n);E.push(s,e,n)}if(!n){const i=B.length/3,s=i-A-1;B.push(t[0].x,t[0].y,t[0].z);const e=(new a).subVectors(t[0],t[1]).normalize();w.push(e.x,e.y,e.z);Q.push(0,.5);const n=t.length-1;B.push(t[n].x,t[n].y,t[n].z);e.subVectors(t[n],t[n-1]).normalize();w.push(e.x,e.y,e.z);Q.push(1,.5);for(f=0;f<=A-1;f++){E.push(i,f,f+1);E.push(i+1,s+f+1,s+f)}}}function M(){for(f=0;f<=r;f++)for(let t=0;t<=A;t++){d.x=f/r;d.y=t/A;Q.push(d.x,d.y)}}function v(){for(f=0;f<r;f++)y(f);M();D()}v();for(f=0;f<=r;f++)for(let t=0;t<=A;t++)this.Us_.values==null||isNaN(this.Us_.values[f])?h.push(0):h.push(this.Us_.values[f]);if(!n)if(this.Us_.values!=null){h.push(isNaN(this.Us_.values[0])?0:this.Us_.values[0]);h.push(isNaN(this.Us_.values[t.length-1])?0:this.Us_.values[t.length-1])}else{h.push(0);h.push(0)}const b=new Float32Array(B),N=new Uint32Array(E),S=new Float32Array(h),G=new Float32Array(w);this.setAttribute("position",new ut(b,3));this.setIndex(new ut(N,1));this.setAttribute("normal",new ut(G,3));this.setAttribute(ixt.TXe_,new ut(S,1));this.setAttribute("uv",new V(Q,2));this.computeBoundingBox()}computeBoundingBox(){super.computeBoundingBox();this.fk_&&this.boundingBox.expandByScalar(this.fk_)}Ye_(t){this.abt_||this.n_e_((this.Us_.zs[this.Us_.zs.length-1]+this.Us_.zs[0])/2,t);return this.abt_}zcA_(t){this.HcA_||this.n_e_((this.Us_.zs[this.Us_.zs.length-1]+this.Us_.zs[0])/2,t);return this.HcA_}e_e_(t){this.A_e_||this.n_e_((this.Us_.zs[this.Us_.zs.length-1]+this.Us_.zs[0])/2,t);return this.A_e_}n_e_(t,i){if(this.xm_.equals(i)&&t===this.X9_)return this;this.X9_||(this.X9_=t);this.xm_.equals(i)||this.xm_.copy(i);if(this.qcA_==null||this.JcA_==null){const t=jXt.QgA_(this.Us_.$7t_,this.Us_.RgA_);this.qcA_=(this.LgA_-this.xgA_)/(t.max-t.min);this.JcA_=this.xgA_-t.min}this.abt_=this.abt_||new a;this.HcA_=this.HcA_||new a(0,0,1);this.A_e_=this.A_e_||new f;let s=!0;for(let t=1;t<this.Us_.zs.length;t++){if(this.Us_.zs[t]>this.Us_.zs[t-1]){s=!1;break}if(this.Us_.zs[t]<this.Us_.zs[t-1])break}let e=NA.findIndex(t,this.Us_.zs,null,null,s?(t,i)=>i-t:null);e<0&&(e=~e);e=e||1;eZt.set(this.Us_.xs[e-1],this.Us_.ys[e-1],this.Us_.zs[e-1]);AZt.set(this.Us_.xs[e],this.Us_.ys[e],this.Us_.zs[e]);const A=(t-this.Us_.zs[e-1])/(this.Us_.zs[e]-this.Us_.zs[e-1]);this.abt_.copy(AZt).sub(eZt).multiplyScalar(A).add(eZt);if(this.Us_.$7t_&&this.Us_.RgA_&&Array.isArray(this.Us_.$7t_)&&Array.isArray(this.Us_.RgA_)){let t=((this.Us_.$7t_[e]-this.Us_.$7t_[e-1])*A+this.Us_.$7t_[e-1])*2,i=((this.Us_.RgA_[e]-this.Us_.RgA_[e-1])*A+this.Us_.RgA_[e-1])*2;t=t*this.qcA_+this.JcA_;i=i*this.qcA_+this.JcA_;this.HcA_.setX(t).setY(i)}else this.HcA_.setX(this.fk_*2).setY(this.fk_*2);eZt.multiply(this.xm_);eZt.multiply(this.xm_);AZt.multiply(this.xm_);AZt.multiply(this.xm_);AZt.sub(eZt).normalize();eZt.set(-1,0,0);eZt.crossVectors(AZt,eZt).normalize();this.A_e_=kxt.Sje_(eZt,AZt,this.A_e_);return this}};i=t([_s("geotoolkit3d.scene.well.TubeGeometry")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");var rZt=Ci(function(){let i=class t extends tZt{constructor(t){super();const i=t&&t["data"],s=qi(t,{radius:t["width"]!=null?t["width"]:30,tubeprecision:8,depth:i&&i["x"]&&i["x"].length>1?new a(i["x"][1],i["y"][1],i["z"][1]).distanceTo(new a(i["x"][0],i["y"][0],i["z"][0])):1});this.setOptions(s)}E3e_(){const t=this.JV_(),i=t["data"];if(i["x"].length<2)return;const s=t["radius"];i["x"].length===2?this.rIA_=new hZt({data:{x:[0,0],y:[0,0],z:[0,t["depth"]]},radiusmax:s,tubeprecision:t["tubeprecision"]}):this.rIA_=new hZt({data:{x:i["x"],y:i["y"],z:i["z"]},radiusmax:s,tubeprecision:t["tubeprecision"]});this.U9e_=new W(this.rIA_,this.eIA_());if(i["x"].length===2){this.U9e_.position.copy(new a(i.x[0],i.y[0],i.z[0]));this.U9e_.lookAt(new a(i.x[1],i.y[1],i.z[1]))}this.add(this.U9e_)}getBoundingBox(){return this.U9e_.geometry.boundingBox.clone().applyMatrix4(this.U9e_.matrix)}nt_(){return this.rIA_}};i=t([_s("geotoolkit3d.scene.well.schematic.Cylinder")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRHZW9tZXRyeSI6Im50XyJ9fX0g");var oZt=Ci(function(){let i=class t extends tZt{constructor(t){super();const i=t&&t["data"],s=qi(t,{width:50,height:50,depth:i&&i["x"]&&i["x"].length>1?new a(i["x"][1],i["y"][1],i["z"][1]).distanceTo(new a(i["x"][0],i["y"][0],i["z"][0])):1,widthsegments:1,heightsegments:1,depthsegments:1});this.setOptions(s)}E3e_(){const t=this.JV_(),i=t["data"];if(!(i["x"].length<2)){if(i["x"].length===2)this.oIA_=new mt(t["width"],t["height"],t["depth"],t["widthsegments"],t["heightsegments"],t["depthsegments"]);else{const s=t["width"]<t["height"]?t["height"]/2:t["width"]/2;this.oIA_=new hZt({data:{x:i["x"],y:i["y"],z:i["z"]},radiusmax:s,tubeprecision:1,openended:!1})}this.oIA_.computeBoundingBox();this.oIA_.computeVertexNormals();this.U9e_=new W(this.oIA_,this.eIA_());if(i["x"].length===2){const s=new a(i.x[1],i.y[1],i.z[1]);this.U9e_.position.set(i.x[0],i.y[0],i.z[0]);this.U9e_.position.sub(s.clone().sub(this.U9e_.position).setLength(-t["depth"]/2));this.U9e_.lookAt(s)}this.add(this.U9e_)}}getBoundingBox(){return this.U9e_.geometry.boundingBox.clone().applyMatrix4(this.U9e_.matrix)}nt_(){return this.oIA_}};i=t([_s("geotoolkit3d.scene.well.schematic.Parallelepiped")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRHZW9tZXRyeSI6Im50XyJ9fX0g");var lZt=Ci(function(){let i=class t extends tZt{constructor(t){super();const i=qi(t,{radius:50,widthsegments:28,heightsegments:14,phistart:0,philength:Math.PI*2,thetastart:0,thetalength:Math.PI});this.setOptions(i)}E3e_(){const t=this.JV_(),i=t["data"];this.lIA_=new pt(t["radius"],t["widthsegments"],t["heightsegments"],t["phistart"],t["philength"],t["thetastart"],t["thetalength"]);this.lIA_.computeBoundingBox();this.lIA_.computeVertexNormals();this.U9e_=new W(this.lIA_,this.eIA_());if(Array.isArray(i["x"])){this.U9e_.position.set(i.x[0],i.y[0],i.z[0]);if(i["x"].length>1){const t=new a(i.x[1],i.y[1],i.z[1]);this.U9e_.lookAt(t)}}else i.x!=null&&this.U9e_.position.set(i.x,i.y,i.z);this.add(this.U9e_)}getBoundingBox(){return this.U9e_.geometry.boundingBox.clone().applyMatrix4(this.U9e_.matrix)}nt_(){return this.lIA_}};i=t([_s("geotoolkit3d.scene.well.schematic.Sphere")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRHZW9tZXRyeSI6Im50XyJ9fX0g");const uZt=2;var aZt=Ci(function(){let i=class t extends fUt{constructor(t){super();Object.assign(this,{type:"Ellipse"});const i=qi(t,{visible:!0,size:120,colorprovider:"blue"});if(!(i["color"]instanceof l))if(typeof i["colorprovider"]=="string"){i["color"]=new l(i["colorprovider"]);i["colorprovider"]=null}else if(i["colorprovider"]instanceof l){i["color"]=i["colorprovider"];i["colorprovider"]=null}this.sB_=i["color"];this.uIA_=new W(new BJt,new yJt({color:this.sB_,transparent:!0,side:e,opacity:i["opacity"]}));this._up=new a(0,1,0);this.aIA_=new a;this.gIA_=new u;this.add(this.uIA_);this.setOptions(i)}beforeRender(t,i,s,e){const A=this.parent.matrixWorld;if(!this.gIA_.equals(A)){this.gIA_.copy(A);const t=(new a).setFromMatrixScale(A),i=this.aIA_.clone().multiply(t),s=this.position.clone().multiply(t),e=new u;e.lookAt(i,s,t.lengthSq()===0?this._up:t);this.uIA_.setRotationFromMatrix(e);t.setFromMatrixScale(A);this.scale.set(this.fk_*uZt/t.x,this.fk_*uZt/t.y,this.fk_*uZt/t.z)}return this}cIA_(t,i){this.position.copy(t);this.aIA_.copy(i)}setOptions(t){if(t==null)return this;super.setOptions(t);const i=qi(t,{visible:!0,size:this.fk_,colorprovider:this.sB_});this.uIA_.visible=i["visible"];if(!(i["color"]instanceof l))if(typeof i["colorprovider"]=="string"){i["color"]=new l(i["colorprovider"]);i["colorprovider"]=null}else if(i["colorprovider"]instanceof l){i["color"]=i["colorprovider"];i["colorprovider"]=null}i["color"]!=null&&i["color"]!==this.sB_&&(this.sB_=i["color"]);if(typeof i["size"]=="number"&&!isNaN(i["size"])&&i["size"]!==this.fk_){this.scale.set(i["size"]*uZt,i["size"]*uZt,i["size"]*uZt);this.fk_=i["size"]}this.uIA_.material.setOptions(i);return this}};i=t([_s("geotoolkit3d.scene.well.top.Ellipse")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJ1cGRhdGVMb2NhdGlvbiI6ImNJQV8ifX19");var gZt=Ci(function(){let i=class t extends fUt{constructor(t){super();Object.assign(this,{type:"Sphere"});const i=qi(t,{visible:!0,size:120,colorprovider:"blue",widthsegments:28,heightsegments:14,phistart:0,philength:Math.PI*2,thetastart:0,thetalength:Math.PI});if(!(i["color"]instanceof l))if(typeof i["colorprovider"]=="string"){i["color"]=new l(i["colorprovider"]);i["colorprovider"]=null}else if(i["colorprovider"]instanceof l){i["color"]=i["colorprovider"];i["colorprovider"]=null}this.sB_=i["color"];this.IIA_=new W(new pt(1,i["widthsegments"],i["heightsegments"],i["phistart"],i["philength"],i["thetastart"],i["thetalength"]),new xTt({color:this.sB_,transparent:!0,side:e,opacity:i["opacity"]}));this.add(this.IIA_);this.gIA_=new u;this.invalidateObject();this.setOptions(i)}beforeRender(t,i,s,e){this.parent.updateMatrixWorld(!0);const A=this.parent.matrixWorld;if(!this.gIA_.equals(A)){this.gIA_.copy(A);this.fIA_()}return this}cIA_(t){this.position.copy(t)}setOptions(t){if(t==null)return this;super.setOptions(t);const i=qi(t,{size:this.fk_,visible:!0,colorprovider:this.sB_,widthsegments:28,heightsegments:14,phistart:0,philength:Math.PI*2,thetastart:0,thetalength:Math.PI});this.IIA_.visible=i["visible"];if(!(i["color"]instanceof l))if(typeof i["colorprovider"]=="string"){i["color"]=new l(i["colorprovider"]);i["colorprovider"]=null}else if(i["colorprovider"]instanceof l){i["color"]=i["colorprovider"];i["colorprovider"]=null}i["color"]!=null&&i["color"]!==this.sB_&&(this.sB_=i["color"]);if(i["size"]!=null&&i["size"]!==this.fk_){this.scale.set(i["size"],i["size"],i["size"]);this.fk_=i["size"];this.fIA_()}this.IIA_.material.setOptions(i);return this}JV_(){const t=Pi({size:this.fk_},this.IIA_.material.JV_());return Pi(t,super.JV_())}fIA_(){const t=(new a).setFromMatrixScale(this.gIA_);this.scale.set(this.fk_/t.x,this.fk_/t.y,this.fk_/t.z)}};i=t([_s("geotoolkit3d.scene.well.top.Sphere")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJ1cGRhdGVMb2NhdGlvbiI6ImNJQV8iLCJnZXRPcHRpb25zIjoiSlZfIn19fSAg");var cZt=Ci(function(){let i=class t extends fUt{constructor(t,i){super();this.U5s_=t;this.CIA_=this.U5s_.JV_()["data"]["x"];this.dIA_=this.U5s_.JV_()["data"]["y"];this.BIA_=this.U5s_.JV_()["data"]["z"];this.MQt_=new y;this.U$_=[];this.wIA_=[];const s=qi(i,{visible:!0,opacity:1,type:"disk",size:30,colorprovider:"blue",heights:[]});this.visible=s["visible"];this.fk_=s["size"];this.wIA_=s["heights"];this.sB_=s["colorprovider"]||s["color"];this.Rb_=s["opacity"];this.add(this.MQt_);this.setOptions(s)}igA_(){return this.U5s_}wKs_(){return this.MQt_.children}setOptions(t){if(t==null)return this;super.setOptions(t);const i=qi(t,{type:this.Qi_,size:this.fk_,colorprovider:this.sB_,heights:this.wIA_,opacity:this.Rb_});this.fk_=i["size"];if(!(i["color"]instanceof l)){if(typeof i["colorprovider"]=="string"){i["color"]=new l(i["colorprovider"]);i["colorprovider"]=null}else if(i["colorprovider"]instanceof l){i["color"]=i["colorprovider"];i["colorprovider"]=null}this.sB_=i["color"]}if(typeof i["type"]=="string"&&i["type"]!==this.Qi_){this.Qi_=i["type"];fLt.dispose(this.MQt_.children);const t=undefined;(i["heights"]||this.wIA_).forEach((()=>{let t;t=this.Qi_==="ball"?new gZt:new aZt;this.MQt_.add(t)}));this.U$_=[]}if(this.U$_.length===0||this.wIA_!==i["heights"]){this.U$_=[];this.wIA_.forEach((t=>{let i=Number.NaN,s=Number.NaN,e=Number.NaN;if(t<=this.BIA_[0]&&t>=this.BIA_[this.BIA_.length-1]){let A=NA.findIndex(t,this.BIA_,null,null,((t,i)=>Math.abs(t-i)<=NA.Je_?0:t<i?1:-1));A<0&&(A=~A);const n=(t-this.BIA_[A-1])/(this.BIA_[A]-this.BIA_[A-1]);i=this.CIA_[A-1]*(1-n)+this.CIA_[A]*n;s=this.dIA_[A-1]*(1-n)+this.dIA_[A]*n;e=this.BIA_[A-1]*(1-n)+this.BIA_[A]*n}isNaN(i)||isNaN(s)||isNaN(e)||this.U$_.push(new a(i,s,e))}));this.wIA_=i["heights"];this.QIA_()}this.MQt_.children.forEach((t=>{t!=null&&t.setOptions(i)}));this.invalidateObject();return this}JV_(){const t={visible:this.visible,type:this.Qi_,size:this.fk_,heights:this.wIA_,colorprovider:this.sB_,well:this.U5s_,positions:this.U$_,opacity:this.Rb_};return Pi(t,super.JV_())}QIA_(){if(this.BIA_.length>1)for(let t=0;t<this.MQt_.children.length;t++){const i=this.MQt_.children[t],s=this.U$_[t];let e=NA.findIndex(s.z,this.BIA_,null,null,((t,i)=>Math.abs(t-i)<=NA.Je_?0:t<i?1:-1));e<0?e=~e:e<this.BIA_.length-1?++e:--e;i.cIA_(s,new a(this.CIA_[e],this.dIA_[e],this.BIA_[e]))}}};i=t([_s("geotoolkit3d.scene.well.top.TopSymbol")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRXZWxsIjoiaWdBXyIsImdldFN5bWJvbHMiOiJ3S3NfIiwiZ2V0T3B0aW9ucyI6IkpWXyJ9fX0g");var IZt=Ci(function(){let i=class t extends fUt{constructor(t){super();this.EIA_=[];this.Gqi_=[];this.jTi_=null;this.pIA_=null;this.boA_=new a;t["data"]instanceof Array&&(t["data"]=new KXt({data:t["data"]}));t["data"]instanceof KXt?this.EIA_=t["data"].tgA_():this.EIA_.push(t["data"]);for(let i=0;i<this.EIA_.length;i++){const s=qi(t,{});s["data"]=this.EIA_[i];s["data"]["line"]=!0;s["data"]["endcaps"]=!1;s["colorprovider"]&&s["data"]["colorprovider"]==null&&(s["data"]["colorprovider"]=s["colorprovider"]);this.Gqi_[i]=new cUt(s);delete s["data"]["line"];this.add(this.Gqi_[i])}}mIA_(t){if(t!=null&&t.hasOwnProperty("colorprovider"))for(let i=0;i<this.Gqi_.length;i++)this.Gqi_[i].geometry.setData(t)}setOptions(t){if(t==null)return this;super.setOptions(t);this.mIA_(t["data"]);this.invalidateObject();return this}beforeRender(t,i,s,e){super.beforeRender(t,i,s,e);const A=s.GZe_().scale;if(this.jTi_){this.pIA_!=null&&this.Gqi_[0].n_e_(this.pIA_,A);this.jTi_.xeA_(this.Gqi_[0].Ye_(A))}return this}ZTi_(t,i){this.jTi_!=null&&this.remove(this.jTi_);this.pIA_=i;this.jTi_=t;this.add(this.jTi_);this.invalidateObject();return this}};i=t([_s("geotoolkit3d.scene.well.TrajectoryLine")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRBbm5vdGF0aW9uIjoiWlRpXyJ9fX0g");var fZt=Ci(function(){let i=class t extends xTt{constructor(t){const i=qi(t,{size:100},!0);super(i);this.type="TrajectoryTubeMaterial";this.vertexShader=gXt.uaA_;this.fragmentShader=gXt.aaA_;gXt.oaA_(this,i);qWt.ZlA_(this,i)}setOptions(t){super.setOptions(t);gXt.oaA_(this,t);qWt.ZlA_(this,t);return this}JV_(){const t=Pi(gXt.laA_(this),super.JV_());return Pi(t,qWt.$lA_(this))}};i=t([_s("geotoolkit3d.scene.well.TrajectoryTubeMaterial")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");$Lt.yZe_(fZt.D_(),yLt);const CZt=new u,dZt=new a,BZt=new a,wZt=new a(0,0,1);var QZt=Ci(function(){let i=class t extends fUt{constructor(t){super();this.sIA_=!1;t["data"]instanceof Array&&(t["data"]=new KXt({data:t["data"]}));if(t["data"]instanceof KXt){this.sIA_=!0;this.yIA_(t);return}const i=qi(t,{size:100});this.zmi_=null;this.DIA_=null;this.MIA_=null;this.vIA_=null;this.bIA_=new u;this.NIA_=new u;this.boA_=new a;i["radiusmin"]=i["radiusmin"]||0;i["radiusmax"]=i["radiusmax"]||0;if(i["closed"]){const t=new BJt,s=new BJt;this.zmi_=new W(t,new F({color:"white",side:e}));this.DIA_=new W(s,new F({color:"white",side:e}));const A=i["data"]["x"],n=i["data"]["y"],h=i["data"]["z"],r=A.length-1;this.zmi_.position.set(A[0],n[0],h[0]);this.DIA_.position.set(A[r],n[r],h[r]);this.MIA_=new a(A[1],n[1],h[1]);this.vIA_=new a(A[r-1],n[r-1],h[r-1]);this.add(this.zmi_);this.add(this.DIA_)}i.hasOwnProperty("openended")||(i["openended"]=!0);if(typeof i["colorprovider"]=="string"){i["color"]=new l(i["colorprovider"]);i["colorprovider"]=null}else if(i["colorprovider"]instanceof l){i["color"]=i["colorprovider"];i["colorprovider"]=null}this.SIA_=new W(new hZt(i),new fZt(i));this.add(this.SIA_);this.GIA_=()=>{const t=this.SIA_.material.userData.pXe_,i=this.SIA_.geometry.getAttribute(ixt.TXe_);this.zmi_.material.color=NYt.L5e_(t.getColor(i.getX(0))).color;this.DIA_.material.color=NYt.L5e_(t.getColor(i.getX(i.count-1))).color;this.invalidateObject()};this.setOptions(i);this.jTi_=null;this.pIA_=null}yIA_(t){t["data"]instanceof KXt&&(t["data"]=t["data"].JV_());const i=t["data"],s=qi(t,{size:100});this.RIA_=[];this.kIA_=[];this.FIA_=[];this.xIA_=[];this.bIA_=new u;this.NIA_=new u;this.boA_=new a;s["radiusmin"]=s["radiusmin"]||0;s["radiusmax"]=s["radiusmax"]||0;this.LIA_=(t,i,s,A,n)=>{const h=new BJt,r=new BJt,o=new W(h,new F({color:"white",side:e}));this.RIA_.push(o);const l=new W(r,new F({color:"white",side:e}));this.kIA_.push(l);o.position.set(s[t],A[t],n[t]);l.position.set(s[i],A[i],n[i]);const u=new a(s[t+1],A[t+1],n[t+1]),g=new a(s[i-1],A[i-1],n[i-1]);this.FIA_.push(u);this.xIA_.push(g);this.add(o);this.add(l)};const A=i["x"],n=i["y"],h=i["z"];if(s["closed"])for(let t=0;t<i["num"];t++){const s=i["tops"][t],e=i["bots"][t];this.LIA_(s,e,A,n,h)}if(typeof s["colorprovider"]=="string"){s["color"]=new l(s["colorprovider"]);s["colorprovider"]=null}else if(s["colorprovider"]instanceof l){s["color"]=s["colorprovider"];s["colorprovider"]=null}this.SIA_=new W(new Wjt(s),new fZt(s));this.add(this.SIA_);this.GIA_=()=>{const t=this.SIA_.material.userData.pXe_,i=this.SIA_.geometry.getAttribute(ixt.TXe_),s=i.count/this.SIA_.geometry.JV_()["data"]["x"].length;for(let e=0;e<this.RIA_.length;e++){const A=Math.round(this.SIA_.geometry.JV_()["data"]["tops"][e]*s),n=Math.round(this.SIA_.geometry.JV_()["data"]["bots"][e]*s);this.RIA_[e].material.color=NYt.L5e_(t.getColor(i.getX(A))).color;this.kIA_[e].material.color=NYt.L5e_(t.getColor(i.getX(n))).color}this.invalidateObject()};this.setOptions(s);this.jTi_=null;this.pIA_=null}setOptions(t){if(t==null)return this;super.setOptions(t);if(this.sIA_)return this.UIA_(t);if(typeof t["colorprovider"]=="string"){t["color"]=new l(t["colorprovider"]);t["colorprovider"]=null}else if(t["color"]==null&&t["colorprovider"]!=null)t["color"]=new l(16777215);else if(t["colorprovider"]instanceof l){t["color"]=t["colorprovider"];t["colorprovider"]=null}if(this.zmi_!=null&&this.DIA_!=null){const t=this.SIA_.material.userData.pXe_;t instanceof bo&&t.off(mo.sC_,this.GIA_)}this.SIA_.geometry.setOptions(t);this.SIA_.material.setOptions(t);if(this.zmi_!=null&&this.DIA_!=null){if(t["colorprovider"]==null&&t["color"]!=null){this.zmi_.material.color=t["color"];this.DIA_.material.color=t["color"]}else if(t["colorprovider"]instanceof bo){this.GIA_();t["colorprovider"].on(mo.sC_,this.GIA_)}if(t["opacity"]!=null){this.zmi_.material.opacity=t["opacity"];this.DIA_.material.opacity=t["opacity"]}if(t["transparent"]!=null){this.zmi_.material.transparent=t["transparent"];this.DIA_.material.transparent=t["transparent"]}if(t["size"]!=null){const i=(Number(t["size"])+1)*2;this.zmi_.scale.set(i,i,i);this.DIA_.scale.set(i,i,i);if(this.boA_.x!==0&&this.boA_.y!==0&&this.boA_.z!==0){this.zmi_.scale.divide(this.boA_);this.DIA_.scale.divide(this.boA_)}}}this.invalidateObject();return this}UIA_(t){if(t==null)return this;if(typeof t["colorprovider"]=="string"){t["color"]=new l(t["colorprovider"]);t["colorprovider"]=null}else if(t["color"]==null&&t["colorprovider"]!=null)t["color"]=new l(16777215);else if(t["colorprovider"]instanceof l){t["color"]=t["colorprovider"];t["colorprovider"]=null}if(this.RIA_.length!==0&&this.kIA_.length!==0){const t=this.SIA_.geometry.userData.pXe_;t instanceof bo&&t.off(mo.sC_,this.GIA_)}this.SIA_.geometry.setOptions(t);this.SIA_.material.setOptions(t);let i;if(this.RIA_.length!==0&&this.kIA_.length!==0){if(t["colorprovider"]==null&&t["color"]!=null)for(i=0;i<this.RIA_.length;i++){this.RIA_[i].material.color=t["color"];this.kIA_[i].material.color=t["color"]}else if(t["colorprovider"]instanceof bo){this.GIA_();t["colorprovider"].on(mo.sC_,this.GIA_)}if(t["opacity"]!=null)for(i=0;i<this.RIA_.length;i++){this.RIA_[i].material.opacity=t["opacity"];this.kIA_[i].material.opacity=t["opacity"]}if(t["transparent"]!=null)for(i=0;i<this.RIA_.length;i++){this.RIA_[i].material.transparent=t["transparent"];this.kIA_[i].material.transparent=t["transparent"]}if(t["size"]!=null){const s=(Number(t["size"])+1)*2;for(i=0;i<this.RIA_.length;i++){this.RIA_[i].scale.set(s,s,s).divide(this.boA_);this.kIA_[i].scale.set(s,s,s).divide(this.boA_)}}}this.invalidateObject();return this}JV_(){return Pi(Pi(this.SIA_.geometry.JV_(),this.SIA_.material.JV_()),super.JV_())}beforeRender(t,i,s,e){super.beforeRender(t,i,s,e);if(this.sIA_){this.YIA_(t,i,s,e);return}const A=s.GZe_().scale;if(this.jTi_){this.pIA_!=null&&this.SIA_.geometry.n_e_(this.pIA_,A);this.jTi_.xeA_(this.SIA_.geometry.Ye_(A));this.jTi_.LeA_(this.SIA_.geometry.zcA_(A),this.SIA_.geometry.e_e_(A))}if(!this.boA_.equals(A)){qWt.$lA_(this.SIA_.material)["normscale"].set(1/A.x,0,0,0,1/A.y,0,0,0,1/A.z);if(this.zmi_!=null&&this.DIA_!=null){const t=(this.SIA_.material.userData["size"]+1)*2;this.zmi_.scale.set(t,t,t).divide(A);this.DIA_.scale.set(t,t,t).divide(A);this.DIA_.geometry.applyMatrix4(CZt.copy(this.NIA_).invert());s.OiA_(dZt.copy(this.DIA_.position));s.OiA_(BZt.copy(this.vIA_));this.DIA_.geometry.applyMatrix4(this.NIA_.identity().lookAt(dZt,BZt,wZt.set(0,0,1)));this.zmi_.geometry.applyMatrix4(CZt.copy(this.bIA_).invert());s.OiA_(dZt.copy(this.zmi_.position));s.OiA_(BZt.copy(this.MIA_));this.zmi_.geometry.applyMatrix4(this.bIA_.identity().lookAt(dZt,BZt,wZt.set(0,0,1)))}this.boA_.copy(A)}}YIA_(t,i,s,e){const A=s.GZe_().scale;this.jTi_&&this.TIA_(A);if(!this.boA_.equals(A)){qWt.$lA_(this.SIA_.material)["normscale"].set(1/A.x,0,0,0,1/A.y,0,0,0,1/A.z);if(this.RIA_.length!==0&&this.kIA_.length!==0){const t=(this.SIA_.material.userData["size"]+1)*2;let i;for(i=0;i<this.RIA_.length;i++){this.RIA_[i].scale.set(t,t,t).divide(A);this.kIA_[i].scale.set(t,t,t).divide(A);this.kIA_[i].geometry.applyMatrix4(CZt.copy(this.NIA_).invert());s.OiA_(dZt.copy(this.kIA_[i].position));s.OiA_(BZt.copy(this.xIA_[i]));this.kIA_[i].geometry.applyMatrix4(this.NIA_.identity().lookAt(dZt,BZt,wZt.set(0,0,1)));this.RIA_[i].geometry.applyMatrix4(CZt.copy(this.bIA_).invert());s.OiA_(dZt.copy(this.RIA_[i].position));s.OiA_(BZt.copy(this.FIA_[i]));this.RIA_[i].geometry.applyMatrix4(this.bIA_.identity().lookAt(dZt,BZt,wZt.set(0,0,1)));this.bIA_=new u;this.NIA_=new u}}this.boA_.copy(A)}}v4_(){return this.jTi_}ZTi_(t,i){this.jTi_!=null&&this.remove(this.jTi_);this.pIA_=i;this.jTi_=t;this.add(this.jTi_);this.TIA_(this.boA_);this.invalidateObject();return this}TIA_(t){this.pIA_!=null&&this.SIA_.geometry.n_e_(this.pIA_,t);this.jTi_.xeA_(this.SIA_.geometry.Ye_(t));this.jTi_.LeA_(this.SIA_.geometry.zcA_(t),this.SIA_.geometry.e_e_(t))}};i=t([_s("geotoolkit3d.scene.well.TrajectoryTube")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiZ2V0QW5ub3RhdGlvbiI6InY0XyIsInNldEFubm90YXRpb24iOiJaVGlfIn19fSAg");var EZt=Ci(function(){let i=class t extends fUt{constructor(t){super();const i=qi(t,{radius:1});this.KIA_(i);if(t["data"]["start"]instanceof a&&t["data"]["end"]instanceof a){const t=[],s=[],e=[],A=[],n=(new a).subVectors(i["data"]["start"],i["data"]["end"]),h=(new a).subVectors(i["data"]["end"],i["data"]["start"]);let r=i["radius"];const o=n.length();o<i["radius"]&&(r=o/2);n.normalize();n.multiplyScalar(r);t.push(0);s.push(0);e.push(0);A.push(i["radius"]);t.push(h.x+n.x);s.push(h.y+n.y);e.push(h.z+n.z);A.push(i["radius"]);t.push(h.x+n.x);s.push(h.y+n.y);e.push(h.z+n.z);A.push(i["radius"]*1.5);t.push(h.x);s.push(h.y);e.push(h.z);A.push(0);i["data"]["x"]=t;i["data"]["y"]=s;i["data"]["z"]=e;i["data"]["widths"]=A;i["radiusmin"]=0;i["radiusmax"]=i["radius"]*1.5;this.position.set(i["data"]["start"].x,i["data"]["start"].y,i["data"]["start"].z)}else Gi("Invalid parameters for "+this.D_());const s=i["color"]!=null?i["color"]:new l("white"),e=new U({color:s,name:"well"});this.CgA_=new W(new hZt(i),e);this.add(this.CgA_);this.boA_=new a;this.setOptions(i)}setOptions(t){if(t==null)return this;super.setOptions(t);const i=qi(t,{});this.KIA_(i);i["color"]!=null&&(this.CgA_.material.color=i["color"]);this.invalidateObject();return this}JV_(){return Pi({color:this.getColor()},super.JV_())}getColor(){return this.CgA_.material.color}KIA_(t){let i,s;if(t["colorprovider"]!=null){ki("Vector: option.colorprovider is deprecated since 4.0, please use option.color instead.");i=t["colorprovider"];delete t["colorprovider"]}t["color"]!=null&&(i=t["color"]);if(i!=null){typeof i=="string"?s=new l(i):i instanceof l&&(s=i);t["color"]=s}}};i=t([_s("geotoolkit3d.scene.well.Vector")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");function pZt(t,i,s,e){const A=Math.cos(i-t)-Math.sin(t)*Math.sin(i)*(1-Math.cos(s-e));return Math.acos(A)}function mZt(t,i,s,e,A,n){const h=(e+s)/2,r=(n+A)/2;t.dy=t.dy+i*Math.sin(h)*Math.cos(r);t.dx=t.dx+i*Math.sin(h)*Math.sin(r);t.dz=t.dz+i*Math.cos(h);return{HIA_:h,qIA_:r}}function yZt(t,i,s,e,A,n,h){const r=pZt(s,e,A,n),o=2/r*Math.tan(r/2);if(r<h)mZt(t,i,s,e,A,n);else{const h=Math.sin(e),r=Math.sin(s),l=i/2;t.dx=t.dx+l*(r*Math.sin(A)+h*Math.sin(n))*o;t.dy=t.dy+l*(r*Math.cos(A)+h*Math.cos(n))*o;t.dz=t.dz+l*(Math.cos(s)+Math.cos(e))*o}return t}const DZt={JIA_:(t,i,s)=>{const e=t["md"],A=t["inclination"],n=t["azimuth"],h=i["x"],r=i["y"],o=i["tvd"];let l={};l.dx=h[0];l.dy=r[0];l.dz=o[0];for(let t=1;t<e.length;++t){l=yZt(l,e[t]-e[t-1],A[t-1],A[t],n[t-1],n[t],s);h[t]=l.dx;r[t]=l.dy;o[t]=l.dz}},PIA_:(t,i,s)=>{const e=t["md"],A=t["inclination"],n=t["azimuth"],h=i["x"],r=i["y"],o=i["tvd"];for(let t=1;t<e.length;t++){const i=e[t]-e[t-1];if(Math.abs(A[t]-A[t-1])<s||Math.abs(n[t]-n[t-1])<s){const e=yZt({dx:h[t-1],dy:r[t-1],dz:o[t-1]},i,A[t-1],A[t],n[t-1],n[t],s);h[t]=e.dx;r[t]=e.dy;o[t]=e.dz;continue}const l=(A[t]-A[t-1])*(n[t]-n[t-1]),u=Math.cos(A[t-1]);r[t]=(e[t]-e[t-1])*(u-Math.cos(A[t]))*(Math.sin(n[t])-Math.sin(n[t-1]));r[t]/=l;r[t]+=r[t-1];h[t]=(e[t]-e[t-1])*(u-Math.cos(A[t]))*(Math.cos(n[t-1])-Math.cos(n[t]));h[t]/=l;h[t]+=h[t-1];o[t]=(e[t]-e[t-1])*(Math.sin(A[t])-Math.sin(A[t-1]));o[t]/=A[t]-A[t-1];o[t]+=o[t-1]}},VIA_:(t,i)=>{const s=t["md"],e=t["inclination"],A=t["azimuth"],n=i["x"],h=i["y"],r=i["tvd"],o={};o.dx=n[0];o.dy=h[0];o.dz=r[0];for(let t=1;t<s.length;t++){const i=undefined;mZt(o,s[t]-s[t-1],e[t-1],e[t],A[t-1],A[t]);n[t]=o.dx;h[t]=o.dy;r[t]=o.dz}},OIA_:(t,i)=>{const s=t["md"],e=t["inclination"],A=t["azimuth"],n=i["x"],h=i["y"],r=i["tvd"];for(let t=1;t<s.length;t++){const i=(s[t]-s[t-1])/2;h[t]=h[t-1]+i*(Math.sin(e[t])*Math.cos(A[t])+Math.sin(e[t-1])*Math.cos(A[t-1]));n[t]=n[t-1]+i*(Math.sin(e[t])*Math.sin(A[t])+Math.sin(e[t-1])*Math.sin(A[t-1]));r[t]=r[t-1]+i*(Math.cos(e[t])+Math.cos(e[t-1]))}}};var MZt=Ci(function(){var t=class{static WIA_(t,i,s){s==null&&(s={});const e=qi(t,{mode:DZt.JIA_,tolerance:1e-10}),A=qi(s,{x:0,y:0,tvd:i["md"][0]}),n={x:[A["x"]],y:[A["y"]],tvd:[A["tvd"]]},h={inclination:i["inclination"].map(kxt.Cje_),azimuth:i["azimuth"].map(kxt.Cje_),md:i["md"]};e["mode"](h,n,e["tolerance"]);return n}};t.zIA_=DZt.OIA_;t.XIA_=DZt.VIA_;t.jIA_=DZt.PIA_;t.bje_=DZt.JIA_;return t}(),2,"eyJjb21wdXRlRGV2aWF0aW9uIjoiV0lBXyJ9");const vZt={JIA_:(t,i)=>{for(let s=1;s<t.x.length;s++){const e=t["y"][s]-t["y"][s-1],A=t["x"][s]-t["x"][s-1],n=t["tvd"][s]-t["tvd"][s-1],h=i["inclination"][s-1],r=i["azimuth"][s-1],o=i["md"][s-1],l=Math.sin(h)*Math.sin(r),u=Math.sin(h)*Math.cos(r),a=Math.cos(h),g=undefined,c=undefined,I=undefined,f=undefined,C=undefined,d=undefined,B=4*(A*A)+4*(e*e)+4*(n*n),w=-(4*A*l+4*e*u+4*n*a),Q=u*u+l*l+a*a-1,E=undefined,p=(-w+Math.sqrt(w*w-4*B*Q))/(2*B),m=Math.acos(2*n*p-a),y=(2*A*p-l)/Math.sin(m),D=(2*e*p-u)/Math.sin(m),M=Math.atan2(y,D),v=Math.acos(Math.cos(m-h)-Math.sin(h)*Math.sin(m)*(1-Math.cos(M-r))),b=2*Math.tan(v/2)/v;i["md"].push(1/(p*b)+o);i["inclination"].push(m);i["azimuth"].push(M)}},PIA_:(t,i,s)=>{for(let e=1;e<t.x.length;e++){const A=t["y"][e]-t["y"][e-1],n=t["x"][e]-t["x"][e-1],h=t["tvd"][e]-t["tvd"][e-1],r=i["inclination"][e-1],o=i["azimuth"][e-1],l=i["md"][e-1];let u=2*Math.atan2(n,A)-o;const a=-(Math.cos(o)-Math.cos(u)),g=Math.sin(u)-Math.sin(o),c=g/(u-o),I=a/(u-o);let f,C;if(Math.abs(u-o)<s){const t=Math.sin(r)*Math.sin(o),i=Math.sin(r)*Math.cos(o),s=Math.cos(r),e=undefined,l=undefined,a=undefined,g=undefined,c=undefined,I=undefined,d=4*(n*n)+4*(A*A)+4*(h*h),B=-(4*n*t+4*A*i+4*h*s),w=i*i+t*t+s*s-1,Q=undefined,E=(-B+Math.sqrt(B*B-4*d*w))/(2*d);f=Math.acos(2*h*E-s);const p=(2*n*E-t)/Math.sin(f),m=(2*A*E-i)/Math.sin(f);u=Math.atan2(p,m);const y=Math.acos(Math.cos(f-r)-Math.sin(r)*Math.sin(f)*(1-Math.cos(u-o))),D=undefined;C=1/(E*(2*Math.tan(y/2)/y))}else{f=-2*Math.atan2(A-n,-h*(I+c))-r;f<0&&(f+=Math.PI*2);f>Math.PI*2&&(f-=Math.PI*2);const t=f-r,i=u-o,s=Math.sin(f)-Math.sin(r),e=-(Math.cos(r)-Math.cos(f));C=(n+A+h)/(s/t+a*e/(i*t)-e*g/(i*t))}i["md"].push(C+l);i["inclination"].push(f);i["azimuth"].push(u)}},VIA_:(t,i)=>{for(let s=1;s<t.x.length;s++){const e=t["y"][s]-t["y"][s-1],A=t["x"][s]-t["x"][s-1],n=t["tvd"][s]-t["tvd"][s-1],h=Math.sqrt(A*A+e*e+n*n),r=h+i["md"][s-1],o=2*Math.atan2(A,e),l=2*Math.acos(n/h);i["md"].push(r);i["inclination"].push(l-i["inclination"][s-1]);i["azimuth"].push(o-i["azimuth"][s-1])}},OIA_:(t,i)=>{for(let s=1;s<t.x.length;s++){const e=t["y"][s]-t["y"][s-1],A=t["x"][s]-t["x"][s-1],n=t["tvd"][s]-t["tvd"][s-1],h=i["inclination"][s-1],r=i["azimuth"][s-1],o=i["md"][s-1],l=Math.sin(h)*Math.sin(r),u=Math.sin(h)*Math.cos(r),a=Math.cos(h),g=undefined,c=undefined,I=undefined,f=undefined,C=undefined,d=undefined,B=4*(A*A)+4*(e*e)+4*(n*n),w=-(4*A*l+4*e*u+4*n*a),Q=u*u+l*l+a*a-1,E=undefined,p=(-w+Math.sqrt(w*w-4*B*Q))/(2*B),m=Math.acos(2*n*p-a),y=(2*A*p-l)/Math.sin(m),D=(2*e*p-u)/Math.sin(m),M=Math.atan2(y,D);i["md"].push(1/p+o);i["inclination"].push(m);i["azimuth"].push(M)}}};var bZt=Ci(function(){var t;return class{static ZIA_(t,i,s){s==null&&(s={});const e=qi(t,{mode:vZt.JIA_,tolerance:1e-10}),A={md:[(s=qi(s,{md:i["tvd"][0],inclination:0,azimuth:0}))["md"]],inclination:[s["inclination"]],azimuth:[s["azimuth"]]};e["mode"](i,A,e["tolerance"]);A["inclination"]=A["inclination"].map(kxt.dje_);A["azimuth"]=A["azimuth"].map(kxt.dje_);return A}}}(),2,"eyJjb21wdXRlRGlyZWN0aW9uIjoiWklBXyJ9");var NZt=Ci(function(){let i=class t{};i.prototype.ryt_=Zi;i.prototype._IA_=Zi;i=t([_s("geotoolkit3d.data.reservoir.AbstractReservoirData")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRNZXRhRGF0YSI6InJ5dF8iLCJnZXROdW1iZXJPZkNlbGxzIjoiX0lBXyJ9fSwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");var SZt=Ci(function(){let i=class t{constructor(t,i,s){this._I=Number.NaN;this._J=Number.NaN;this._K=Number.NaN;this.setOptions(t,i,s)}fromArray(t){this._I=t[0];this._J=t[1];this._K=t[2];return this}toArray(){return[this._I,this._J,this._K]}$IA_(t){const i=qi(t,{I:this._I,J:this._J,K:this._K},!0);this._I=i["i"];this._J=i["j"];this._K=i["k"];return this}toJSON(){ki("IJKIndex.toJSON() is deprecated since 4.0, Json forms need to be all lowercase, please use .toJson() instead.");return{I:this._I,J:this._J,K:this._K}}tfA_(){return{i:this._I,j:this._J,k:this._K}}set(t,i,s){this._I=t;this._J=i;this._K=s;return this}setOptions(t,i,s){t instanceof Array?this.fromArray(t):typeof t=="object"?this.$IA_(t):typeof t=="number"&&this.set(t,i,s);return this}JV_(){return{i:this._I,j:this._J,k:this._K}}eYe_(){return this._I}ifA_(){return this._J}sfA_(){return this._K}add(t){const i=t.JV_();this._I+=i["i"];this._J+=i["j"];this._K+=i["k"];return this}sub(t){const i=t.JV_();this._I-=i["i"];this._J-=i["j"];this._K-=i["k"];return this}};i=t([_s("geotoolkit3d.scene.reservoir.IJKIndex")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJmcm9tSnNvbiI6IiRJQV8iLCJ0b0pzb24iOiJ0ZkFfIiwiZ2V0T3B0aW9ucyI6IkpWXyIsImdldEkiOiJlWWVfIiwiZ2V0SiI6ImlmQV8iLCJnZXRLIjoic2ZBXyJ9fSwiZ2V0Q2xhc3NOYW1lIjoiRF8ifSAg");const GZt=8,RZt=kxt;var kZt=Ci(function(){let i=class t extends NZt{constructor(t){super();this.efA_=new SZt([-1,-1,-1]);this.type="ReservoirData";this.AfA_=new SZt([-1,-1,-1]);this.nfA_=0;this.E4e_=t["nullvalue"]!=null?t["nullvalue"]:-999.25;this.hfA_=[];this.rfA_={};this.iIt_=Number.POSITIVE_INFINITY;this.sIt_=Number.NEGATIVE_INFINITY;this.u6_=this.a6_=this.ofA_=Number.POSITIVE_INFINITY;this.g6_=this.c6_=this.lfA_=Number.NEGATIVE_INFINITY;this.ufA_=[];this.afA_=0;if(t["cellsdata"]!=null)this.gfA_(t["cellsdata"]);else{if(t["cells"]==null)throw new Error("ReservoirData: Invalid constructor arguments.");ki("ReservoirData constructor: The legacy cell data structure is now deprecated. "+'Please instead use the new structure format using more efficient typed arrays (see the parameter "options.cellsdata")');this.cfA_(t["cells"],t["values"])}t["computecellsvolume"]&&this.IfA_()}ffA_(){return qi(this.ryt_(),{positionsx:this.CfA_,positionsy:this.dfA_,positionsz:this.BfA_,values:this.pi_,volume:this.wfA_,ijk:this.QfA_,cellmap:this.ufA_,additionaldata:this.hfA_,additionalcelldata:this.rfA_})}ryt_(){return{boundingbox:this.Lc_,cellcount:this.nfA_,minvalue:this.iIt_,maxvalue:this.sIt_,mini:this.u6_,maxi:this.g6_,minj:this.a6_,maxj:this.c6_,mink:this.ofA_,maxk:this.lfA_,numijk:this.AfA_,nullvalue:this.E4e_}}Uui_(){ki("ReservoirData.getAttributes() is deprecated."+"\nReservoir attributes are for internal use only."+"\nPlease instead use the Reservoir public API.");return this.ffA_()}EfA_(t,i,s){return this.ufA_[t]!=null&&this.ufA_[t][i]!=null&&this.ufA_[t][i][s]!=null?this.ufA_[t][i][s]:null}pfA_(t){return t<0||t>=this.nfA_?null:[this.QfA_.getX(t),this.QfA_.getY(t),this.QfA_.getZ(t)]}mfA_(t,i,s){if(this.ufA_[t]!=null){if(this.ufA_[t][i]!=null)return this.ufA_[t][i][s]!=null?this.ufA_[t][i][s]:this.ufA_[t][i][s]=this.afA_++;this.ufA_[t][i]=[];return this.ufA_[t][i][s]=this.afA_++}this.ufA_[t]=[];this.ufA_[t][i]=[];return this.ufA_[t][i][s]=this.afA_++}reset(){ki("ReservoirData.reset() is deprecated since 4.0, please use dispose() instead.");this.dispose();return this}cfA_(t,i){if(t!=null&&this.nfA_!==0){ki("Updating cells positions after the creation of the Reservoir Data is not allowed, "+"please create a new ReservoirData (and a new ReservoirGrid if applicable)");return this}i!=null&&t==null&&ki("ReservoirData.setCellsOptions() is deprecated."+"\nTo update cellsValuesafter reservoir creation please use ReservoirGrid.setCellsValues() instead."+"\nThis new method change the data layout to be more efficient.");if(t!=null&&this.nfA_===0){if(!Array.isArray(t)||t[0].x==null||t[0].x==null||t[0].x==null||t[0].ijk==null)throw new Error("Cannot build ReservoirData: invalid reservoir data parameters.");this.u6_=this.a6_=this.ofA_=Number.POSITIVE_INFINITY;this.g6_=this.c6_=this.lfA_=Number.NEGATIVE_INFINITY;this.nfA_=t.length;const i=this.nfA_*8;this.CfA_=new ut(new Float32Array(i),1);this.dfA_=new ut(new Float32Array(i),1);this.BfA_=new ut(new Float32Array(i),1);this.QfA_=new ut(new Int16Array(this.nfA_*3),3);this.pi_=new ut(new Float32Array(this.nfA_),1);for(let i=0;i<t.length;i++)this.yfA_(t[i]);this.DfA_()}if(i!=null){this.iIt_=Number.POSITIVE_INFINITY;this.sIt_=Number.NEGATIVE_INFINITY;for(let t=0;t<i.length;t++)this.MfA_(i[t])}return this}yfA_(t){if(t==null||t["ijk"]==null)return;let i,s;i=t["ijk"]instanceof SZt?t["ijk"]:this.efA_.setOptions(t["ijk"]);const e=i.JV_();s=this.afA_<this.nfA_?this.mfA_(e["i"],e["j"],e["k"]):this.EfA_(e["i"],e["j"],e["k"]);const A=s*8,n=t["x"],h=t["y"],r=t["z"];if(n!=null&&h!=null&&r!=null){this.CfA_.setX(A,n[0]);this.CfA_.setX(A+1,n[1]);this.CfA_.setX(A+2,n[2]);this.CfA_.setX(A+3,n[3]);this.CfA_.setX(A+4,n[4]);this.CfA_.setX(A+5,n[5]);this.CfA_.setX(A+6,n[6]);this.CfA_.setX(A+7,n[7]);this.dfA_.setX(A,h[0]);this.dfA_.setX(A+1,h[1]);this.dfA_.setX(A+2,h[2]);this.dfA_.setX(A+3,h[3]);this.dfA_.setX(A+4,h[4]);this.dfA_.setX(A+5,h[5]);this.dfA_.setX(A+6,h[6]);this.dfA_.setX(A+7,h[7]);this.BfA_.setX(A,r[0]);this.BfA_.setX(A+1,r[1]);this.BfA_.setX(A+2,r[2]);this.BfA_.setX(A+3,r[3]);this.BfA_.setX(A+4,r[4]);this.BfA_.setX(A+5,r[5]);this.BfA_.setX(A+6,r[6]);this.BfA_.setX(A+7,r[7]);this.QfA_.setXYZ(s,e["i"],e["j"],e["k"]);this.u6_=Math.min(e["i"],this.u6_);this.g6_=Math.max(e["i"],this.g6_);this.a6_=Math.min(e["j"],this.a6_);this.c6_=Math.max(e["j"],this.c6_);this.ofA_=Math.min(e["k"],this.ofA_);this.lfA_=Math.max(e["k"],this.lfA_);this.AfA_.set(this.g6_-this.u6_+1,this.c6_-this.a6_+1,this.lfA_-this.ofA_+1)}}DfA_(){this.Lc_=(new C).makeEmpty();const t=new a;for(let i=0;i<this.nfA_;i++)for(let s=0;s<8;s++){const e=i*8+s;t.set(this.CfA_.getX(e),this.dfA_.getX(e),this.BfA_.getX(e));this.Lc_.max.max(t);this.Lc_.min.min(t)}}gfA_(t){this.vfA_(t)||(t=this.bfA_());this.CfA_=new ut(t["x"],1);this.dfA_=new ut(t["y"],1);this.BfA_=new ut(t["z"],1);this.nfA_=t["ijk"].length/3;this.NfA_(t["ijk"]);this.DfA_();t["values"]==null&&t["additionalcelldata"]==null||this.SfA_({values:t["values"],additionalcelldata:t["additionalcelldata"]});this.pi_==null&&(this.pi_=new ut(new Float32Array(this.nfA_),1));return this}NfA_(t){this.QfA_=new ut(t,3);this.u6_=this.a6_=this.ofA_=Number.POSITIVE_INFINITY;this.g6_=this.c6_=this.lfA_=Number.NEGATIVE_INFINITY;for(let i=0;i<this.nfA_;i++){const s=3*i,e=t[s],A=t[s+1],n=t[s+2];this.u6_=Math.min(e,this.u6_);this.g6_=Math.max(e,this.g6_);this.a6_=Math.min(A,this.a6_);this.c6_=Math.max(A,this.c6_);this.ofA_=Math.min(n,this.ofA_);this.lfA_=Math.max(n,this.lfA_);this.mfA_(e,A,n)}this.AfA_.set(this.g6_-this.u6_+1,this.c6_-this.a6_+1,this.lfA_-this.ofA_+1)}vfA_(t){if(t["x"]==null||t["y"]==null||t["z"]==null||t["ijk"]==null){ki("ReservoirData constructor is missing one or more mandatory argument in cell datas !");return!1}const i=t["x"].length,s=i/8;if(t["y"].length!==i||t["z"].length!==i||t["ijk"].length!==s*3){ki("ReservoirData constructor cell datas have invalid number of elements !\n"+'For a reservoirgrid with "nbcell" the number of cell, the data structure size must respect:\n'+'  8 * nbcell for the "x" coordinates,\n'+'  8 * nbcell for the "y" coordinates,\n'+'  8 * nbcell for the "z" coordinates,\n'+'  3 * nbcell for the "ijk" indices,\n'+'  1 * nbcell for the "values" (optional)');return!1}return!0}static GfA_(t,i,s){for(let e=0;e<s;e++){const s=e*3;if(i!==s&&(t[s]===t[i]&&t[s+1]===t[i+1]&&t[s+2]===t[i+2]))return!0}return!1}static RfA_(t){let i=0;const s=t.length/3;for(let e=0;e<s;e++){const A=e*3;this.GfA_(t,A,s)&&i++}i>0&&ki("Duplicate IJK indices detected in the provided ReservoirData IJK indices:\n"+"A total of "+i+" duplicates were identified out of the "+s+" cell indices provided.\n"+"Since ReservoirGrid cells must have unique IJK indices, this occurrence indicates an error in the data.")}SfA_(t){const i=t["values"],s=t["additionaldata"],e=t["additionalcelldata"];if(i==null&&s==null&&e==null){ki('Reservoir setCellsValues: invalid arguments, either "values" or "additionalcelldata" should be present !');return}const A=t["ijk"];let n=!1;i!=null&&this.setValues(i,A)&&(n=!0);if(s!=null){ki("option.additionaldata is deprecated since 4.0.\n"+"Please instead use ReservoirData constructor option.cellsdata.additionalcelldata,\n"+" or ReservoirGrid.setCellsValues() option.additionalcelldata");this.kfA_(s,A)&&(n=!0)}e!=null&&this.FfA_(e,A)&&(n=!0);n&&ki("Reservoir setCellsValues: Invalid argument! "+'If the argument "values" have fewer values than the number of cells, '+'it must be associated with a proper "ijk" argument, indexing the passed down values.'+"The same principle apply for additionalcelldatas, if present.")}setValues(t,i){if(i==null){if(t.length!==this.nfA_)return!0;this.pi_!=null&&(this.pi_.array=null);this.pi_=new ut(t,1)}else{if(i.length!==t.length*3)return!0;this.xfA_(t,i)}this.iIt_=Number.POSITIVE_INFINITY;this.sIt_=Number.NEGATIVE_INFINITY;for(let i=0;i<this.nfA_;i++){const s=t[i];if(Number.isFinite(s)&&s!==this.E4e_){this.iIt_=Math.min(s,this.iIt_);this.sIt_=Math.max(s,this.sIt_)}}return!1}FfA_(t,i){const s=Object.keys(t);let e=!1;for(const A of s){const s=t[A];s!=null&&s.length!=null&&(i==null?s.length===this.nfA_?this.rfA_[A]=s:e=!0:i.length!==s.length*3?e=!0:this.LfA_(A,s,i))}return e}kfA_(t,i){if(i==null){if(t.length!==this.nfA_)return!0;this.hfA_=t}else{if(i.length!==t.length*3)return!0;this.UfA_(t,i)}return!1}xfA_(t,i){this.pi_==null&&(this.pi_=new ut(new Float32Array(this.nfA_),1));const s=this.pi_.array;let e=!0;for(let A=0;A<t.length;A++){const n=A*3,h=this.EfA_(i[n],i[n+1],i[n+2]);if(h!=null)s[h]=t[A];else if(e){ki("Reservoir setCellsValue:"+" The given IJK index(es) does not exist in the reservoir as it was created.");e=!1}}}UfA_(t,i){this.hfA_==null&&(this.hfA_=new Array(this.nfA_));let s=!0;for(let e=0;e<t.length;e++){const A=e*3,n=this.EfA_(i[A],i[A+1],i[A+2]);if(n!=null)this.hfA_[n]=t[e];else if(s){ki("Reservoir setCellsValue:"+" The given IJK index(es) does not exist in the reservoir as it was created.");s=!1}}}LfA_(t,i,s){this.rfA_[t]==null&&(this.rfA_[t]=this.YfA_(i,this.nfA_));const e=this.rfA_[t];let A=!0;for(let t=0;t<i.length;t++){const n=t*3,h=this.EfA_(s[n],s[n+1],s[n+2]);if(h!=null)e[h]=i[t];else if(A){ki("Reservoir setCellsValue:"+" The given IJK index ["+s[n]+", "+s[n+1]+", "+s[n+2]+"]"+" does not exist in this Reservoir.");A=!1}}}aKt_(t){let i=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,n=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY;const r=t*8;for(let t=0;t<8;++t){const o=this.CfA_.getX(r+t),l=this.dfA_.getX(r+t),u=this.BfA_.getX(r+t);i=Math.min(i,o);s=Math.min(s,l);e=Math.min(e,u);A=Math.max(A,o);n=Math.max(n,l);h=Math.max(h,u)}return[i,s,e,A,n,h,t]}TfA_(){this.KfA_=new iKt(0,this.Lc_);for(let t=0;t<this.nfA_;t++){const i=this.aKt_(t);this.KfA_.g1_(i)}this.KfA_.L8e_()}HfA_(t){const i=t*8;let s,e,A,n,h,r;s=e=this.CfA_.getX(i);A=n=this.dfA_.getX(i);h=r=this.BfA_.getX(i);for(let t=1;t<8;++t){const o=this.CfA_.getX(i+t),l=this.dfA_.getX(i+t),u=this.BfA_.getX(i+t);s=Math.min(s,o);e=Math.max(e,o);A=Math.min(A,l);n=Math.max(n,l);h=Math.min(h,u);r=Math.max(r,u)}const o=e-s,l=n-A,u=r-h;return[o,l,u,s+o/2,A+l/2,h+u/2,t]}k4e_(){this.F4e_=new oTt({bounds:this.Lc_});for(let t=0;t<this.nfA_;t++)this.F4e_.g1_(this.HfA_(t));this.F4e_.Tnt_()}MfA_(t){if(t==null)return;const i=t["ijk"],s=t["value"];if(i!=null&&s!=null){const e=this.EfA_(i[0],i[1],i[2]);if(Number.isFinite(s)&&s!==this.E4e_){this.iIt_=Math.min(s,this.iIt_);this.sIt_=Math.max(s,this.sIt_)}this.pi_.setX(e,s);t["additionaldata"]!=null&&(this.hfA_[e]=t["additionaldata"])}}_IA_(){return this.nfA_}f9e_(t,i){if(t<0||t>this.nfA_-1)return null;const s=new Array(8),e=new Array(8),A=new Array(8);let n=Number.POSITIVE_INFINITY,h=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY;const a=t*GZt;for(let t=0;t<GZt;++t){s[t]=this.CfA_.getX(a+t);e[t]=this.dfA_.getX(a+t);A[t]=this.BfA_.getX(a+t);n=Math.min(n,s[t]);h=Math.min(h,e[t]);r=Math.min(r,A[t]);o=Math.max(o,s[t]);l=Math.max(l,e[t]);u=Math.max(u,A[t])}i.min.set(n,h,r);i.max.set(o,l,u);return{x:s,y:e,z:A,value:this.pi_!=null?this.pi_.getX(t):null}}qfA_(t){let i;i=Array.isArray(t)?{i:t[0],j:t[1],k:t[2]}:t.JV_();const s=this.EfA_(i["i"],i["j"],i["k"]);if(s==null)return null;const e=new Array(8),A=new Array(8),n=new Array(8);let h=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY;const g=s*GZt;for(let t=0;t<GZt;++t){e[t]=this.CfA_.getX(g+t);A[t]=this.dfA_.getX(g+t);n[t]=this.BfA_.getX(g+t);h=Math.min(h,e[t]);r=Math.min(r,A[t]);o=Math.min(o,n[t]);l=Math.max(l,e[t]);u=Math.max(u,A[t]);a=Math.max(a,n[t])}return{index:t,ijk:[i["i"],i["j"],i["k"]],x:e,y:A,z:n,value:this.pi_!=null?this.pi_.getX(s):null,volume:this.wfA_?this.wfA_[s]:null,bound:[h,r,o,l,u,a],additionalData:this.hfA_[s]||{},additionalcelldata:this.JfA_(s)}}JfA_(t,i){const s=Object.keys(this.rfA_);i==null&&(i={});for(const e of s)i[e]=this.rfA_[e][t];return i}PfA_(){return this.AfA_}L4e_(){ki("ReservoirData.getOctree() is deprecated since 4.0, was meant to be internal.");this.KfA_==null&&this.TfA_();return this.KfA_}c9e_(){this.F4e_==null&&this.k4e_();return this.F4e_}VfA_(t,i){const s=t*GZt;for(let t=0;t<GZt;t++){i[t][0]=this.CfA_.getX(s+t);i[t][1]=this.dfA_.getX(s+t);i[t][2]=this.BfA_.getX(s+t)}}YfA_(t,i){return t instanceof Float32Array?new Float32Array(i):t instanceof Float64Array?new Float64Array(i):t instanceof Uint8Array?new Uint8Array(i):t instanceof Uint8ClampedArray?new Uint8ClampedArray(i):t instanceof Uint16Array?new Uint16Array(i):t instanceof Uint32Array?new Uint32Array(i):t instanceof Int8Array?new Int8Array(i):t instanceof Int16Array?new Int16Array(i):t instanceof Int32Array?new Int32Array(i):new Array(i)}IfA_(){if(this.wfA_!=null)return;this.wfA_=new Float32Array(this.nfA_);const t=new Array(GZt);for(let i=0;i<GZt;i++)t[i]=new Array(3).fill(0);this.OfA_=0;for(let i=0;i<this.nfA_;i++){this.VfA_(i,t);const s=RZt.wje_(t);this.OfA_+=s;this.wfA_[i]=s}}WfA_(){this.wfA_==null&&this.IfA_();return this.OfA_}bfA_(){const t=[0,0,0,0,0,0,0];return{x:new Float32Array(t),y:new Float32Array(t),z:new Float32Array(t),ijk:new Int16Array([0,0,0]),values:new Float32Array([0])}}ybs_(t){this.E4e_=t}Dbs_(){return this.E4e_}dispose(){this.nfA_=0;this.CfA_=null;this.dfA_=null;this.BfA_=null;this.QfA_=null;this.pi_=null;this.wfA_=null;this.hfA_=null;this.rfA_=null;this.iIt_=Number.POSITIVE_INFINITY;this.sIt_=Number.NEGATIVE_INFINITY;this.u6_=Number.POSITIVE_INFINITY;this.g6_=Number.NEGATIVE_INFINITY;this.a6_=Number.POSITIVE_INFINITY;this.c6_=Number.NEGATIVE_INFINITY;this.ofA_=Number.POSITIVE_INFINITY;this.lfA_=Number.NEGATIVE_INFINITY;this.ufA_=[];this.F4e_=null;this.KfA_=null;this.afA_=0}};i=t([_s("geotoolkit3d.data.reservoir.hexahedral.ReservoirData")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRNZXRhRGF0YSI6InJ5dF8iLCJnZXRBdHRyaWJ1dGVzIjoiVXVpXyIsImdldEluZGV4Rm9yQ2VsbCI6IkVmQV8iLCJnZXRDZWxsSUpLYnlJbmRleCI6InBmQV8iLCJzZXRDZWxsc09wdGlvbnMiOiJjZkFfIiwiZ2V0TnVtYmVyT2ZDZWxscyI6Il9JQV8iLCJnZXRDZWxsRGF0YSI6InFmQV8iLCJnZXRJSktDb3VudCI6IlBmQV8iLCJnZXRPY3RyZWUiOiJMNGVfIiwiY29tcHV0ZUNlbGxzVm9sdW1lIjoiSWZBXyIsImdldFJlc2Vydm9pckZ1bGxWb2x1bWUiOiJXZkFfIn19LCJjaGVja0R1cGxpY2F0ZUlKSyI6IlJmQV8ifSAg");var FZt=function(){let i=class t extends z{constructor(t){super();this.E0t_=t["horizonk"];Object.assign(this,{type:"HorizonGeometry"})}zfA_(){return this.E0t_}};i=t([_s("geotoolkit3d.scene.reservoir.AbstractHorizonGeometry")],i);return i}();var xZt=Ci(function(){var t=class extends Array{static get XfA_(){return this.jfA_}static get ZfA_(){return this._fA_}static get $fA_(){return this.tCA_}static get iCA_(){return this.sCA_}static get Lst_(){return this.eCA_}static get Mesh(){return this.ACA_}static get nCA_(){return this.hCA_}static get rCA_(){return this.oCA_}};t.jfA_=[!0,!0,!0];t._fA_=[!0,!0,!1];t.tCA_=[!1,!0,!0];t.sCA_=[!0,!1,!0];t.eCA_=[!1,!0,!1];t.ACA_=[!0,!1,!1];t.hCA_=[!1,!1,!0];t.oCA_=[!1,!1,!1];return t}(),2,"eyJGdWxsIjoiWGZBXyIsIklnbm9yZUhvcml6b25zIjoiWmZBXyIsIklnbm9yZU1lc2giOiIkZkFfIiwiSWdub3JlUHJvcGVydHkiOiJpQ0FfIiwiUHJvcGVydHkiOiJMc3RfIiwiSG9yaXpvbnMiOiJuQ0FfIiwiTm90aGluZyI6InJDQV8ifSAg");const LZt=8;var UZt=function(){let i=class t extends FZt{constructor(t){super(t);Object.assign(this,{type:"HorizonGeometry"});this.lCA_(t)}lCA_(t){const i=t["data"].ffA_(),s=[],e=this.zfA_(),A=e===i["maxk"]+1?e-1:e,n=undefined,h=e===i["maxk"]+1?4:0;for(let e=i["mini"];e<=i["maxi"];++e)for(let n=i["minj"];n<=i["maxj"];++n){const i=t["data"].EfA_(e,n,A);i!=null&&s.push(i)}const r=s.length,o=r*4,l=new Float32Array(o*3),u=new Uint32Array(o*2),a=i["positionsx"].array,g=i["positionsy"].array,c=i["positionsz"].array;for(let t=0;t<r;t++){const i=s[t]*LZt+h,e=t*4*3,A=t*4*2;for(let t=0;t<4;t++){const s=e+t*3;l[s]=a[i+t];l[s+1]=g[i+t];l[s+2]=c[i+t]}const n=4*t;u[A]=n;u[A+1]=n+1;u[A+2]=n+1;u[A+3]=n+3;u[A+4]=n+3;u[A+5]=n+2;u[A+6]=n+2;u[A+7]=n}this.uCA_(l);const I=new ut(u,1),f=new ut(l,3);fLt.IZe_(I);fLt.IZe_(f);this.setIndex(I);this.setAttribute("position",f)}uCA_(t){this.boundingBox=(new C).setFromArray(t)}computeBoundingBox(){}};i=t([_s("geotoolkit3d.scene.reservoir.hexahedral.HorizonGeometry")],i);return i}();var YZt=Ci({aCA_:"frontface",gCA_:"cell",W_:"none"},2,"eyJGcm9udEZhY2UiOiJhQ0FfIiwiQ2VsbCI6ImdDQV8iLCJOb25lIjoiV18ifSAg");const TZt=8,KZt=TZt*3,HZt=1e-6,qZt=22e6,JZt=[2,3,6,3,7,6,0,4,1,4,5,1,1,5,3,5,7,3,0,2,4,2,6,4,0,1,2,1,3,2,5,4,7,4,6,7],PZt=new a;var VZt=function(){var i;let s=i=class t extends H{constructor(t){super();this.type="ReservoirGeometry";this.cCA_();this.ICA_=t["data"];this._4e_=this.ICA_.ffA_();this.fCA_=this._4e_["cellcount"];this.boundingBox=this._4e_["boundingbox"];this.CCA_=!0;this.dCA_=!1;this.BCA_=0;this.wCA_=0;this.QCA_=null;this.ECA_=null;this.pCA_=null;this.mCA_=null;this.yCA_=new A(this._4e_["mini"],this._4e_["minj"],this._4e_["mink"],Number.NEGATIVE_INFINITY);this.DCA_=new A(this._4e_["maxi"],this._4e_["maxj"],this._4e_["maxk"],Number.POSITIVE_INFINITY);this.MCA_=!1;this.vCA_=new a(0,0,0);this.bCA_=new a(0,0,0);this.NCA_=this.yCA_.clone();this.SCA_=this.DCA_.clone();this["_maxInstanceCount"]=this.fCA_;this["userData"].f6e_=this.fCA_;this.dCA_=fLt.aZe_({x:this._4e_["positionsx"],y:this._4e_["positionsy"],z:this._4e_["positionsz"]});this.GCA_();this.RCA_(t,!0)}kCA_(){if(this._4e_["volume"]==null){this.ICA_.IfA_();this._4e_["volume"]=this.ICA_.ffA_()["volume"];this.FCA_()}return this.BCA_}xCA_(){return this.wCA_}cCA_(){const t=new V(this.LCA_(),3);fLt.IZe_(t);this.setAttribute("position",t);const i=new V(this.UCA_(),3);fLt.IZe_(i);this.setAttribute("barycentric",i)}RCA_(t,i){let s=!!i;t.hasOwnProperty("minbound")&&this.NCA_.copy(t["minbound"]);t.hasOwnProperty("maxbound")&&this.SCA_.copy(t["maxbound"]);t.hasOwnProperty("minvalue")&&(this.NCA_.w=t["minvalue"]);t.hasOwnProperty("maxvalue")&&(this.SCA_.w=t["maxvalue"]);t.hasOwnProperty("mini")&&(this.NCA_.x=+t["mini"]);t.hasOwnProperty("minj")&&(this.NCA_.y=+t["minj"]);t.hasOwnProperty("mink")&&(this.NCA_.z=+t["mink"]);t.hasOwnProperty("maxi")&&(this.SCA_.x=+t["maxi"]);t.hasOwnProperty("maxj")&&(this.SCA_.y=+t["maxj"]);t.hasOwnProperty("maxk")&&(this.SCA_.z=+t["maxk"]);if(!this.yCA_.equals(this.NCA_)){this.yCA_.copy(this.NCA_);s=!0}if(!this.DCA_.equals(this.SCA_)){this.DCA_.copy(this.SCA_);s=!0}if(t.hasOwnProperty("nullvalue")&&this.ICA_.Dbs_()!==t["nullvalue"]){this.ICA_.ybs_(t["nullvalue"]);s=!0}if(t.hasOwnProperty("excludemode")&&this.MCA_!==t["excludemode"]){this.MCA_=t["excludemode"];s=!0}if(t.hasOwnProperty("filter")&&this.pCA_!==t["filter"]){ki("ReservoirGrid: options.filter is deprecated since 4.0.\n"+"Please instead use options.cellfilter along with the new ReservoirGrid API for additionalcelldata:\n"+"ReservoirData constructor options.cellsdata.additionalcelldata, or\n"+"ReservoirGrid.setCellsValues options.additionalcelldata");this.pCA_=t["filter"];s=!0}if(t.hasOwnProperty("cellfilter")&&this.mCA_!==t["cellfilter"]){this.mCA_=t["cellfilter"];s=!0}s&&this.zT_();return this}YCA_(){return{minbound:this.yCA_.clone(),maxbound:this.DCA_.clone(),minvalue:this.yCA_.w,maxvalue:this.DCA_.w,mini:this.yCA_.x,minj:this.yCA_.y,mink:this.yCA_.z,maxi:this.DCA_.x,maxj:this.DCA_.y,maxk:this.DCA_.z,nullvalue:this.ICA_.Dbs_(),excludemode:this.MCA_,filter:this.pCA_,cellfilter:this.mCA_}}TCA_(t,i,s,e){const A=3*t,n=s[A],h=s[A+1],r=s[A+2];i[0]=e[n+1][h][r];i[1]=e[n-1][h][r];i[2]=e[n][h+1][r];i[3]=e[n][h-1][r];i[4]=e[n][h][r+1];i[5]=e[n][h][r-1]}FCA_(){const t=[],i=[0,0,0,0,0,0],s=this._4e_["volume"],e=this._4e_["ijk"].array,A=this._4e_["cellmap"];this.BCA_=0;this.wCA_=0;const n=s!=null;for(let h=0;h<this.fCA_;h++){if(this.ECA_[h])continue;this.wCA_++;n&&(this.BCA_+=s[h]);let r=!1;if(this.QCA_[h]){r=!0;this.TCA_(h,i,e,A);for(let t=0;t<6;t++){const s=i[t];if(this.ECA_[s]){r=!1;break}}}r||t.push(h)}const h=t.length;this.instanceCount=h;this.KCA_(h,t)}KCA_(t,i){let s=!1;t<qZt&&(s=this.HCA_(t,i));s||this.qCA_(t,i);this.JCA_(t,i)}JCA_(t,i){const s=new Float32Array(t),e=new Float32Array(t),A=this._4e_["values"].array;for(let n=0;n<t;n++){const t=i[n];s[n]=A[t];e[n]=t/this.fCA_}const n=new si(s,1),h=new si(e,1);this.setAttribute("cgcolormapValue",n);this.setAttribute("cgcellindex",h);fLt.IZe_(n);fLt.IZe_(h)}HCA_(t,i){let s;try{s=new Float32Array(t*KZt)}catch(t){return!1}const e=this._4e_["positionsx"],A=this._4e_["positionsy"],n=this._4e_["positionsz"];for(let h=0;h<t;h++){const t=i[h]*TZt,r=h*KZt;for(let i=0;i<TZt;i++){const h=r+3*i;s[h]=e.getX(t+i);s[h+1]=A.getX(t+i);s[h+2]=n.getX(t+i)}}const h=new q(s,KZt),r=new J(h,3,0);this.setAttribute("positionA",r);this.setAttribute("positionB",new J(h,3,3));this.setAttribute("positionC",new J(h,3,6));this.setAttribute("positionD",new J(h,3,9));this.setAttribute("positionE",new J(h,3,12));this.setAttribute("positionF",new J(h,3,15));this.setAttribute("positionG",new J(h,3,18));this.setAttribute("positionH",new J(h,3,21));fLt.IZe_(r.data);return!0}qCA_(t,i){const s=[];for(let i=0;i<TZt;i++)s.push(new Float32Array(t*3));const e=this._4e_["positionsx"],A=this._4e_["positionsy"],n=this._4e_["positionsz"];for(let h=0;h<t;h++){const t=undefined,r=i[h]*TZt,o=h*3;for(let t=0;t<TZt;t++){s[t][o]=e.getX(r+t);s[t][o+1]=A.getX(r+t);s[t][o+2]=n.getX(r+t)}}const h=[];for(let t=0;t<TZt;t++){const i=new si(s[t],3);fLt.IZe_(i);h.push(i)}this.setAttribute("positionA",h[0]);this.setAttribute("positionB",h[1]);this.setAttribute("positionC",h[2]);this.setAttribute("positionD",h[3]);this.setAttribute("positionE",h[4]);this.setAttribute("positionF",h[5]);this.setAttribute("positionG",h[6]);this.setAttribute("positionH",h[7])}PCA_(){this.ECA_==null&&(this.ECA_=new Array(this.fCA_));const t=this._4e_["ijk"],i=this._4e_["values"].array,s=this.ICA_.Dbs_();if(this.mCA_!=null){const e=this.VCA_();for(let A=0;A<this.fCA_;A++){this.OCA_(e,A,t,i);this.ECA_[A]=this.WCA_(t.getX(A),t.getY(A),t.getZ(A),i[A],s)||this.mCA_(e)}}else if(this.pCA_!=null){let e=this._4e_["additionaldata"];e==null&&(e=[]);for(let A=0;A<this.fCA_;A++)this.ECA_[A]=this.zCA_(t.getX(A),t.getY(A),t.getZ(A),i[A],e[A],s)}else for(let e=0;e<this.fCA_;e++)this.ECA_[e]=this.WCA_(t.getX(e),t.getY(e),t.getZ(e),i[e],s)}VCA_(){const t=[];for(let i=0;i<8;i++)t[i]=[0,0,0];return{index:0,i:0,j:0,k:0,volume:void 0,corners:t,activevalue:this.ICA_.Dbs_(),additionalcelldata:this.ICA_.JfA_(0)}}OCA_(t,i,s,e){t["index"]=i;t["i"]=s.getX(i);t["j"]=s.getY(i);t["k"]=s.getZ(i);t["volume"]=this._4e_["volume"]==null?void 0:this._4e_["volume"][i];const A=t["corners"],n=this._4e_["positionsx"],h=this._4e_["positionsy"],r=this._4e_["positionsz"],o=i*TZt;for(let t=0;t<8;t++){const i=A[t],s=o+t;i[0]=n.getX(s);i[1]=h.getX(s);i[2]=r.getX(s)}t["activevalue"]=e[i];t["additionalcelldata"]=this.ICA_.JfA_(i,t["additionalcelldata"])}XCA_(t){return t<0||t>=this.fCA_||this.ECA_[t]}WCA_(t,i,s,e,A){return this.jCA_(t,i,s)||this.ZCA_(e,A)}zCA_(t,i,s,e,A,n){return this.WCA_(t,i,s,e,n)||this.pCA_(t,i,s,e,A)}jCA_(t,i,s){return this.MCA_?t>=this.yCA_.x&&t<=this.DCA_.x&&i>=this.yCA_.y&&i<=this.DCA_.y&&s>=this.yCA_.z&&s<=this.DCA_.z:t<this.yCA_.x||t>this.DCA_.x||i<this.yCA_.y||i>this.DCA_.y||s<this.yCA_.z||s>this.DCA_.z}ZCA_(t,i){return!Number.isFinite(t)||t<this.yCA_.w||t>this.DCA_.w||t===i}GCA_(){this.QCA_=new Array(this.fCA_).fill(!1);const t=new Array(6),i=new Array(3*TZt).fill(0),s=[];for(let t=0;t<6;t++)s[t]=new Array(3*TZt).fill(0);const e=this._4e_["cellmap"],A=this._4e_["ijk"];for(let n=0;n<this.fCA_;n++){let h=!0;const r=A.getX(n),o=A.getY(n),l=A.getZ(n),u=[[r+1,o,l],[r-1,o,l],[r,o+1,l],[r,o-1,l],[r,o,l+1],[r,o,l-1]];let a;for(a=0;a<6;a++){const i=u[a][0],s=u[a][1],A=u[a][2];if(e[i]==null||e[i][s]==null||e[i][s][A]==null){h=!1;break}t[a]=e[i][s][A]}if(!h)continue;const g=e[r][o][l];this._CA_(g,i);for(a=0;a<6;a++)this._CA_(t[a],s[a]);this.$CA_(i,s)&&(this.QCA_[n]=!0)}}$CA_(t,i){return!!this.tdA_("B","A",t,i[0])&&(!!this.tdA_("D","C",t,i[0])&&(!!this.tdA_("F","E",t,i[0])&&(!!this.tdA_("H","G",t,i[0])&&(!!this.tdA_("A","B",t,i[1])&&(!!this.tdA_("C","D",t,i[1])&&(!!this.tdA_("E","F",t,i[1])&&(!!this.tdA_("G","H",t,i[1])&&(!!this.tdA_("C","A",t,i[2])&&(!!this.tdA_("D","B",t,i[2])&&(!!this.tdA_("G","E",t,i[2])&&(!!this.tdA_("H","F",t,i[2])&&(!!this.tdA_("A","C",t,i[3])&&(!!this.tdA_("B","D",t,i[3])&&(!!this.tdA_("E","G",t,i[3])&&(!!this.tdA_("F","H",t,i[3])&&(!!this.tdA_("E","A",t,i[4])&&(!!this.tdA_("F","B",t,i[4])&&(!!this.tdA_("G","C",t,i[4])&&(!!this.tdA_("H","D",t,i[4])&&(!!this.tdA_("A","E",t,i[5])&&(!!this.tdA_("B","F",t,i[5])&&(!!this.tdA_("C","G",t,i[5])&&this.tdA_("D","H",t,i[5])))))))))))))))))))))))}_CA_(t,i){const s=t*TZt;for(let t=0;t<TZt;t++){i[t*3]=this._4e_["positionsx"].getX(s+t);i[t*3+1]=this._4e_["positionsy"].getX(s+t);i[t*3+2]=this._4e_["positionsz"].getX(s+t)}}tdA_(t,i,s,e){this.idA_(t,s,this.vCA_);this.idA_(i,e,this.bCA_);return this.vCA_.manhattanDistanceTo(this.bCA_)<HZt}idA_(t,i,s){let e;switch(t){case"A":e=0;break;case"B":e=1;break;case"C":e=2;break;case"D":e=3;break;case"E":e=4;break;case"F":e=5;break;case"G":e=6;break;case"H":e=7;break;default:ki("Not a valid cell corner!");break}const A=e*3;s.set(i[A],i[A+1],i[A+2])}sdA_(){this._4e_=this.ICA_.ffA_()}LCA_(){const t=[[0,0,1],[1,0,1],[0,1,1],[1,1,1],[0,0,0],[1,0,0],[0,1,0],[1,1,0]];let s=[];const e=i.edA_();for(let i=0;i<e.length;i++){const A=e[i];s=s.concat(t[A])}return s}static edA_(){return JZt}UCA_(){const t=12,i=[];for(let s=0;s<t;s++){const t=undefined;s%2==0?i.push(0,0,1,0,1,0,1,0,1):i.push(0,1,0,0,0,1,1,0,1)}return i}C6e_(t){const i=[],s=[],e=[];if(t<0||t>=this.fCA_)return{index:t,positions:{}};for(let A=t*TZt;A<(t+1)*TZt;A++){i.push(this._4e_["positionsx"].getX(A));s.push(this._4e_["positionsy"].getX(A));e.push(this._4e_["positionsz"].getX(A))}const A={index:t,positions:{x:i,y:s,z:e}};this._4e_["values"]!=null&&(A["value"]=this._4e_["values"].getX(t));this._4e_["ijk"]!=null&&(A["ijk"]={i:this._4e_["ijk"].getX(t),j:this._4e_["ijk"].getY(t),k:this._4e_["ijk"].getZ(t)});return A}AdA_(t,i){const s=t["positions"]["x"],e=t["positions"]["y"],A=t["positions"]["z"],n=[];n.push(s[0],e[0],A[0],s[1],e[1],A[1],s[1],e[1],A[1],s[3],e[3],A[3],s[3],e[3],A[3],s[2],e[2],A[2],s[2],e[2],A[2],s[0],e[0],A[0],s[0],e[0],A[0],s[4],e[4],A[4],s[4],e[4],A[4],s[5],e[5],A[5],s[5],e[5],A[5],s[1],e[1],A[1],s[5],e[5],A[5],s[7],e[7],A[7],s[7],e[7],A[7],s[3],e[3],A[3],s[7],e[7],A[7],s[6],e[6],A[6],s[6],e[6],A[6],s[2],e[2],A[2],s[6],e[6],A[6],s[4],e[4],A[4]);const h=i.getAttribute("instanceStart");if(h==null||h.data==null||h.data.array.length===0){i.setData({positions:n});return}const r=h.data.array;for(let t=0;t<n.length;t++)r[t]=n[t];h.needsUpdate=!0}ndA_(t){if(!t||!t["ijk"]||!t["positions"])return null;const i=new cUt({data:{positions:[]},color:new l("red"),linewidth:3,opacity:.6,polygonoffset:!0});this.AdA_(t,i.geometry);const s=undefined;i.geometry.getAttribute("instanceStart").data.setUsage(ni);return i}hdA_(){return this.dCA_}computeBoundingSphere(){if(!this.CCA_)return;this.CCA_=!1;const t=new P;this["boundingSphere"]=t;const i=new Array(3*TZt).fill(0),s=t["center"];this._4e_["boundingbox"].getCenter(s);let e=0;for(let t=0;t<this.fCA_;t++){this._CA_(t,i);for(let t=0;t<TZt;t++){const A=t*3;PZt.set(i[A],i[A+1],i[A+2]);e=Math.max(e,s.distanceToSquared(PZt))}}t["radius"]=Math.sqrt(e)}dispose(){super.dispose();if(this._4e_!=null){this._4e_["positionsx"]=null;this._4e_["positionsy"]=null;this._4e_["positionsz"]=null;this._4e_["ijk"]=null;this._4e_["values"]=null;this._4e_["cellmap"]=null;this._4e_["additionaldata"]=null;this._4e_["additionalcelldata"]=null;this._4e_=null}this.QCA_=null;this.ECA_=null;this.pCA_=null;this.mCA_=null}zT_(){this.PCA_();this.FCA_();return this}};s=i=t([_s("geotoolkit3d.scene.reservoir.instanced.ReservoirGeometry")],s);return s}();const OZt=ZWt;var WZt=Ci(function(){let s=class t extends yJt{constructor(t){const s=Pi(t,{mode:xZt.ZfA_,side:i,lights:!1,skeleton:{color:"grey",linewidth:1}},!0);fLt.oZe_(s);super(s);this.type="ReservoirMaterial";this.vertexShader=OZt.VERTEX_SHADER;this.fragmentShader=OZt.FRAGMENT_SHADER;this.extensions["derivatives"]=!0;this.transparent=!1;this.userData.ntA_=!0;this.rdA_(s)}rdA_(t){t["mode"]!=null&&!t["mode"][0]&&t["mode"][1]&&(t["side"]=e);OZt.EuA_(this,t)}setOptions(t){t["colorprovider"]!=null&&fLt.oZe_(t);super.setOptions(t);this.rdA_(t);return this}muA_(t){OZt.muA_(this,t)}JV_(){return Pi(OZt.puA_(this),super.JV_())}};s=t([_s("geotoolkit3d.scene.reservoir.instanced.ReservoirMaterial")],s);return s}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");$Lt.yZe_(WZt.D_(),BKt);var zZt=function(){let i=class t extends fUt{constructor(t,i){super();Object.assign(this,{type:"HorizonCluster"});this.odA_=0;if(t!=null)for(let s=0;s<t.length;++s){const e=t[s];let A=new l("black");if(e["color"]!=null){const t=RA.cs_(e["color"]);A=new l(t.Is_()/255,t.Cs_()/255,t.fs_()/255)}const n=e["width"]!=null?e["width"]:1,h=new Ct(i[s],new Y({color:A,linewidth:n}));h.material.polygonOffset=!0;h.material.polygonOffsetUnits=0;h.material.polygonOffsetFactor=0;this.add(h)}}};i=t([_s("geotoolkit3d.scene.reservoir.HorizonCluster")],i);return i}();const XZt=new a;var jZt=Ci(function(){let i=class t extends dKt{constructor(t){super();this.type="ReservoirGrid";if(t["data"]==null){ki("Reservoir data not found.");return}this.ldA_=YZt.aCA_;this.udA_=!1;t=Pi(t,{highlightmode:this.ldA_,computecellsvolume:this.udA_});this.adA_=new y;this.Us_=t["data"];this.qd_=new VZt(t);this.qd_.hdA_()&&(t["side"]=s);this.x9e_=new WZt(t);this.kD_=this.x9e_.JV_()["skeleton"]["linewidth"];this.U9e_=new W(this.qd_,this.x9e_);this.U9e_.frustumCulled=!1;const i=this.Us_.ryt_();this.boundingBox=i["boundingbox"];this.Bgt_=!1;this.gdA_=null;this.cdA_=!0;t["disableigpuwarning"]!=null&&(this.cdA_=!t["disableigpuwarning"]);this.boundingBox.getCenter(XZt);this.add(this.U9e_);this.IdA_();this.setOptions(t)}IdA_(){mKt.R6e_()&&this.KC_(!1)}OC_(){const t=super.OC_();if(!t&&this.cdA_){this.cdA_=!1;ki("Detected Intel Graphics:\n"+"Reservoir Grid picking and cell highlight are disabled for performances reasons.\n"+"To enable ReservoirGrid picking, please use ReservoirGrid.setSelectable(true).\n"+'To disable this warning, please use the ReservoirGrid constructor option "disableigpuwarning".')}return t}SfA_(t){this.Us_.SfA_(t);this.qd_.sdA_();let i={};t["values"]!=null&&(i={minvalue:Number.NEGATIVE_INFINITY,maxvalue:Number.POSITIVE_INFINITY});this.qd_.RCA_(i,!0)}setOptions(t){if(t==null)return this;super.setOptions(t);if(t["data"]!=null&&this.Bgt_){ki("Changing values through ReservoirGrid.setOptions() to change the reservoir values is deprecated since 4.0. "+"Please instead use ReservoirGrid.setCellsValues() which use the more efficient data layout.");const t={minvalue:Number.NEGATIVE_INFINITY,maxvalue:Number.POSITIVE_INFINITY};this.qd_.sdA_();this.qd_.RCA_(t,!0)}t["computecellsvolume"]&&this.Us_.IfA_();t["skeleton"]!=null&&t["skeleton"]["linewidth"]!=null&&(this.kD_=t["skeleton"]["linewidth"]);if(t["mode"]!=null)if(this.adA_.children.length>0)this.adA_.visible=t["mode"][2];else if(t["mode"][2]&&t["skeleton"]!=null&&t["skeleton"]["horizons"]!=null&&t["skeleton"]["horizons"].length>0){const i=[],s={horizonk:0,data:t["data"]};for(let e=0;e<t["skeleton"]["horizons"].length;e++){s["horizonk"]=t["skeleton"]["horizons"][e]["horizonk"];i[e]=new UZt(s)}const e=new zZt(t["skeleton"]["horizons"],i);this.adA_.add(e);this.add(this.adA_)}t["highlightmode"]!=null&&(this.ldA_=t["highlightmode"]);t["computecellsvolume"]===!0&&(this.udA_=!0);this.x9e_.setOptions(t);this.qd_.RCA_(t);this.Bgt_=!0;this.a6e_();this.invalidateObject();return this}JV_(){const t={highlightmode:this.ldA_,computecellsvolume:this.udA_},i=this.qd_.YCA_(),s=this.x9e_.JV_(),e=qi(t,super.JV_());return qi(qi(e,s),i)}getBoundingBox(){return this.boundingBox.clone()}getData(){return this.Us_}kCA_(){return this.qd_.kCA_()}WfA_(){return this.Us_.WfA_()}xCA_(){return this.qd_.xCA_()}fdA_(t){const i=t.position.clone(),s=this.parent.localToWorld(i).negate(),e=undefined,A=XZt.clone().multiply(this.scale).distanceTo(s);this.CdA_==null&&(this.CdA_=A);const n=Math.min(1,A/this.CdA_);this.x9e_.muA_(this.kD_*n)}beforeRender(t,i,s,e){super.beforeRender(t,i,s,e);this.fdA_(i);return this}d6e_(t,i){if((!this.gdA_||this.gdA_["userData"]["cellIndex"]!==i["index"])&&this.ldA_!==YZt.W_)if(this.gdA_==null){this.gdA_=t.ndA_(i);if(this.gdA_!=null){this.gdA_.name="ReservoirHelperShape";this.gdA_["userData"]["cellIndex"]=i["index"];this.gdA_["userData"]["ijk"]=i["ijk"];this.gdA_.updateMatrixWorld(!0);this.add(this.gdA_)}}else{t.AdA_(i,this.gdA_.geometry);this.gdA_["userData"]["cellIndex"]=i["index"];this.gdA_["userData"]["ijk"]=i["ijk"]}}a6e_(){if(this.gdA_!=null){fLt.dispose(this.gdA_);this.remove(this.gdA_);this.gdA_=null}}l_e_(){return!0}B6e_(){return this.gdA_}ddA_(){const t=new SZt([0,0,0]);if(this.gdA_!=null&&this.gdA_["userData"]["ijk"]){const i=this.gdA_["userData"]["ijk"];t.$IA_(i)}return t}BdA_(t){t instanceof SZt&&(t=t.toArray());return!this.qd_.jCA_(t[0],t[1],t[2])}wdA_(t){return!this.qd_.ZCA_(t,this.Us_.Dbs_())}I9e_(t){return this.qd_.XCA_(t)}dispose(){if(!this.Df_()){this.a6e_();fLt.dispose(this.adA_.children);fLt.dispose(this.U9e_);this.adA_=null;this.U9e_=null;this.x9e_=null;if(this.qd_!=null){this.qd_.dispose();this.qd_=null}if(this.Us_!=null){this.Us_.dispose();this.Us_=null}super.dispose()}}QdA_(){this.qd_.zT_();return this}zT_(){ki("ReservoirGrid.rebuild is deprecated since 4.0,"+" reservoir geometry is now updated automatically when filter options are updated.");this.qd_.zT_();return this}};i=t([_s("geotoolkit3d.scene.reservoir.hexahedral.ReservoirGrid")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpc1NlbGVjdGFibGUiOiJPQ18iLCJzZXRDZWxsc1ZhbHVlcyI6IlNmQV8iLCJnZXRPcHRpb25zIjoiSlZfIiwiZ2V0RmlsdGVyZWRDZWxsc1ZvbHVtZSI6ImtDQV8iLCJnZXRSZXNlcnZvaXJGdWxsVm9sdW1lIjoiV2ZBXyIsImdldEZpbHRlcmVkQ2VsbHNDb3VudCI6InhDQV8iLCJyZW1vdmVIaWdobGlnaHRTaGFwZSI6ImE2ZV8iLCJ1c2VPd25IaWdobGlnaHQiOiJsX2VfIiwiZ2V0U2VsZWN0ZWRDZWxsIjoiQjZlXyIsImdldFNlbGVjdGVkSUpLSW5kZXgiOiJkZEFfIiwiaXNJSktWYWxpZEluRmlsdGVyIjoiQmRBXyIsImlzVmFsdWVWYWxpZEluRmlsdGVyIjoid2RBXyIsImlzQ2VsbEluZGV4RmlsdGVyZWRPdXQiOiJJOWVfIiwidXBkYXRlQ2VsbEZpbHRlciI6IlFkQV8iLCJyZWJ1aWxkIjoielRfIn19fSAg");GHt.IO_().QtA_(jZt.D_(),(function(t){return t.B6e_()}));var ZZt=Ci(function(){let i=class t{constructor(t,i){this.ov_=t;this.pi_=i}dn_(){return this.ov_}getValues(){return this.pi_}};i=t([_s("geotoolkit3d.geodata.TrajectoryValue")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXROYW1lIjoiZG5fIn19LCJnZXRDbGFzc05hbWUiOiJEXyJ9");var _Zt=function(){let i=class t extends fUt{};i=t([_s("geotoolkit3d.widgets.AbstractWidget")],i);return i}();var $Zt={Top:"top",JQ_:"bottom",z_:"left",X_:"right",EdA_:"front",pdA_:"back"};var t_t=function(){let i=class t extends d{constructor(){super({vertexShader:eXt.VERTEX_SHADER,fragmentShader:eXt.FRAGMENT_SHADER,side:e,transparent:!0});this.userData.i_e_=!0}setTexture(t){eXt.setTexture(this,t);return this}};i=t([_s("geotoolkit3d.widgets.ProjectionWidgetMaterial")],i);return i}();$Lt.yZe_(t_t.D_(),yLt);const i_t=new a,s_t=new a,e_t=new a,A_t=new a,n_t=new a,h_t=new v(0,0,1,1),r_t=new u,o_t={width:0,height:0,depth:0},l_t=512;var u_t=Ci(function(){let i=class t extends _Zt{constructor(t){t=t||{};super();this.KC_(!1);this.jCt_=new C;this.fNt_=new APt({});this.nAA_={};this.mdA_=[];this.ydA_=t["dimensionfactor"]||1;this.DdA_=!0;this.add(this.fNt_);t=Pi(t,{planes:{left:!0,right:!0,top:!0,bottom:!0,front:!0,back:!0}});this.setOptions(t)}setOptions(t){if(t==null)return this;super.setOptions(t);t.hasOwnProperty("grid")&&this.fNt_.setOptions(t["grid"]);t.hasOwnProperty("planes")&&Object.keys(t["planes"]).forEach((i=>{const s=t["planes"][i];if(this.nAA_[i]==null){if(s){this.nAA_[i]=new W(new bt,new t_t);this.add(this.nAA_[i]);this.needsUpdate=!0;this.nAA_[i].userData.MdA_=!0}}else{this.nAA_[i].visible=s;this.nAA_[i].userData.MdA_=!0}}));if(t.hasOwnProperty("meshes")){this.mdA_=t["meshes"];this.needsUpdate=!0}if(t.hasOwnProperty("dimensionfactor")){this.ydA_=NA.clamp(t["dimensionfactor"],1,5);this.needsUpdate=!0}return this}JV_(){const t={};Object.keys($Zt).forEach((i=>{t[i]=this.nAA_[i]!=null&&this.nAA_[i].userData.MdA_}));return Pi({grid:this.fNt_.JV_(),planes:t,dimensionfactor:this.ydA_,meshes:this.mdA_},super.JV_())}vdA_(t){for(let i=0;i<this.mdA_.length;i++)if(this.mdA_[i]===t)return this;this.mdA_.push(t);this.needsUpdate=!0;return this}bdA_(t){for(let i=0;i<this.mdA_.length;i++)if(this.mdA_[i]===t){this.mdA_.splice(i,1);this.needsUpdate=!0;return this}return this}dnA_(t){this.fNt_.dnA_(t);this.needsUpdate=!0;return this}n5t_(){this.jCt_.makeEmpty();this.mdA_.forEach((t=>{this.jCt_.expandByObject(t)}));const t=new a;this.jCt_.getSize(t);this.jCt_.expandByVector(t.multiplyScalar(this.ydA_-1));this.jCt_.applyMatrix4(r_t.copy(this.parent.matrixWorld).invert());const i=this.fNt_.JV_();this.DdA_=i["start"]!==this.jCt_.min||i["end"]!==this.jCt_.max;if(this.DdA_){const t=this.jCt_.clone();t.min.z=Math.abs(t.min.z);t.max.z=Math.abs(t.max.z);this.fNt_.setOptions({start:this.jCt_.min,end:this.jCt_.max,modelstart:t.min,modelend:t.max})}this.jCt_.applyMatrix4(this.parent.matrixWorld)}NdA_(t,i,s){this.fNt_.nf_(!1,!0);Object.keys(this.nAA_).forEach((t=>{this.nAA_[t].visible=!1}));Object.keys(this.nAA_).forEach((e=>{this.nAA_[e].userData.SdA_=this.GdA_(e,i);this.BlA_(t,s,e)}));Object.keys(this.nAA_).forEach((t=>{this.nAA_[t].visible=this.nAA_[t].userData.SdA_&&this.nAA_[t].userData.MdA_}));this.fNt_.nf_(!0,!0);this.DdA_=!1}BlA_(t,i,s){const e=this.nAA_[s];if(this.DdA_){this.jCt_.applyMatrix4(r_t.copy(this.parent.matrixWorld).invert());this.RdA_(s);e.scale.set(o_t.width,o_t.height,1);switch(s){case $Zt.Top:case $Zt.JQ_:e.rotation.set(0,0,0);break;case $Zt.z_:case $Zt.X_:e.rotation.set(0,Math.PI*.5,0);break;case $Zt.EdA_:case $Zt.pdA_:e.rotation.set(Math.PI*.5,0,0);break}switch(s){case $Zt.Top:case $Zt.X_:case $Zt.EdA_:e.position.copy(e_t).add(A_t).divideScalar(2);break;case $Zt.JQ_:case $Zt.z_:case $Zt.pdA_:e.position.copy(i_t).add(s_t).divideScalar(2);break}this.jCt_.applyMatrix4(this.parent.matrixWorld)}if(!e.userData.SdA_||!e.userData.MdA_)return;const A=i.getRenderTarget()||null,n=i.getClearAlpha();e.userData.kdA_=e.userData.kdA_||new Rt(l_t,l_t);const h=e.userData.kdA_;i.setClearAlpha(0);i.setRenderTarget(h);this.RdA_(s);h_t.position.copy(i_t).add(s_t).divideScalar(2);n_t.copy(e_t).add(A_t).divideScalar(2);h_t.lookAt(n_t);h_t.left=-o_t.width*.5;h_t.right=o_t.width*.5;h_t.top=-o_t.height*.5;h_t.bottom=o_t.height*.5;h_t.near=-o_t.depth;h_t.far=o_t.depth;h_t.updateProjectionMatrix();i.render(t,h_t);i.setRenderTarget(A);i.setClearAlpha(n);e.material.setTexture(h.texture)}GdA_(t,i){const s=this.jCt_.min,e=this.jCt_.max;switch(t){case $Zt.Top:i_t.set(s.x,s.y,e.z);s_t.set(e.x,e.y,e.z);e_t.set(s.x,s.y,s.z);A_t.set(e.x,e.y,s.z);break;case $Zt.JQ_:i_t.set(s.x,s.y,s.z);s_t.set(e.x,e.y,s.z);e_t.set(s.x,s.y,e.z);A_t.set(e.x,e.y,e.z);break;case $Zt.pdA_:i_t.set(s.x,e.y,s.z);s_t.set(e.x,e.y,e.z);e_t.set(s.x,s.y,s.z);A_t.set(e.x,s.y,e.z);break;case $Zt.EdA_:i_t.set(s.x,s.y,s.z);s_t.set(e.x,s.y,e.z);e_t.set(s.x,e.y,s.z);A_t.set(e.x,e.y,e.z);break;case $Zt.X_:i_t.set(e.x,s.y,s.z);s_t.set(e.x,e.y,e.z);e_t.set(s.x,s.y,s.z);A_t.set(s.x,e.y,e.z);break;case $Zt.z_:i_t.set(s.x,s.y,s.z);s_t.set(s.x,e.y,e.z);e_t.set(e.x,s.y,s.z);A_t.set(e.x,e.y,e.z);break}n_t.copy(i_t).add(s_t).multiplyScalar(.5);const A=i.position.distanceTo(n_t);n_t.copy(e_t).add(A_t).multiplyScalar(.5);const n=undefined;return A>i.position.distanceTo(n_t)}RdA_(t){const i=this.jCt_.min,s=this.jCt_.max;let e,A,n;switch(t){case $Zt.Top:case $Zt.JQ_:h_t.up.set(0,-1,0);e=s.x-i.x;A=s.y-i.y;n=s.z-i.z;i_t.set(i.x,i.y,i.z);s_t.set(s.x,s.y,i.z);e_t.set(i.x,i.y,s.z);A_t.set(s.x,s.y,s.z);break;case $Zt.EdA_:case $Zt.pdA_:h_t.up.set(0,1,0);e=s.x-i.x;A=s.z-i.z;n=s.y-i.y;i_t.set(i.x,s.y,i.z);s_t.set(s.x,s.y,s.z);e_t.set(i.x,i.y,i.z);A_t.set(s.x,i.y,s.z);break;case $Zt.X_:case $Zt.z_:h_t.up.set(0,-1,0);e=s.z-i.z;A=s.y-i.y;n=s.x-i.x;i_t.set(i.x,i.y,i.z);s_t.set(i.x,s.y,s.z);e_t.set(s.x,i.y,i.z);A_t.set(s.x,s.y,s.z);break}o_t.width=e;o_t.height=A;o_t.depth=n}beforeRender(t,i,s,e){super.beforeRender(t,i,s,e);if(this.needsUpdate){this.n5t_();this.needsUpdate=!1}this.NdA_(t,i,e);return this}dispose(){Object.keys(this.nAA_).forEach((t=>{const i=this.nAA_[t];i.material!=null&&i.material.dispose();i.userData.kdA_!=null&&i.userData.kdA_.dispose()}));this.fNt_.dispose();super.dispose()}};i=t([_s("geotoolkit3d.widgets.ProjectionWidget")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiYWRkTWVzaCI6InZkQV8iLCJyZW1vdmVNZXNoIjoiYmRBXyIsImFkZExlZ2VuZCI6ImRuQV8ifX19");const a_t=SOt;var g_t=Ci(function(){let i=class t extends RYt{constructor(t,i){super({vertexShader:a_t.VERTEX_SHADER,fragmentShader:a_t.elA_,transparent:!0,color:t?typeof t["color"]=="string"?new l(t["color"]):t["color"]:void 0,colorprovider:t?t["colorprovider"]:void 0});this.type="ProjectionMaterial";switch(i.name){case UYt.fr_:case UYt.cube:case YYt.cube:t["symbol"]=KYt.fr_;break;case UYt.$5e_:case YYt.s3e_:t["symbol"]=KYt.$5e_;break;case UYt.Afi_:t["symbol"]=KYt.Afi_;break;case UYt._5e_:case UYt.t3e_:case UYt.i3e_:case YYt.t3e_:default:t["symbol"]=KYt._5e_}this.setOptions(t)}setOptions(t){a_t.tlA_(this,t);t&&typeof t["color"]=="string"&&(t["color"]=new l(t["color"]));super.setOptions(t);return this}JV_(){const t=super.JV_();return Pi(t,a_t.slA_(this))}};i=t([_s("geotoolkit3d.widgets.scatter.ProjectionMaterial")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");const c_t=SOt;var I_t=Ci(function(){var i;let s=i=class t extends RYt{constructor(t){super({vertexShader:c_t.VERTEX_SHADER,fragmentShader:c_t.FRAGMENT_SHADER,transparent:!0});this.type="ScatterMaterial";i.prototype.setOptions.call(this,t)}setOptions(t){super.setOptions(t);c_t.$oA_(this,t);return this}JV_(){const t=super.JV_();return Pi(t,c_t.ilA_(this))}XXe_(){return c_t.VERTEX_SHADER}ZXe_(){return c_t.FRAGMENT_SHADER}z5e_(){return this.uniforms}};s=i=t([_s("geotoolkit3d.widgets.scatter.ScatterMaterial")],s);return s}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");$Lt.yZe_(I_t.D_(),xYt);let f_t=5;const C_t={sphere:TYt.t3e_,cube:TYt.cube,pyramid:TYt.s3e_};var d_t=Ci(function(){let i=class t extends _Zt{constructor(t){super();this.Kis_=Pi(t,{colorprovider:"red",symbol:"circle",opacity:1,projection:{enable:!0,sizefactor:.66,topbottom:{color:"lightgray"},leftright:{color:"lightgray"},frontback:{color:"lightgray"}}});fLt.oZe_(this.Kis_);this.kqt_=!0;this.fNt_=this.FdA_(this.Kis_["gridoption"]);this.add(this.fNt_);this.xdA_={};this._objects={};if(this.Kis_["data"]!=null){let t="default";this.Kis_["data"]instanceof qb||this.Kis_["data"]["name"]==null||(t=this.Kis_["data"]["name"]);this.setData(t,this.Kis_["symbol"],this.Kis_["data"],this.Kis_["projection"])}}setData(t,i,s,e){if(t==null||s==null||i==null){ki("Missing at least one input");return}this.Kis_["symbol"]=i;e!==null&&(this.Kis_["projection"]=qi(e,this.Kis_["projection"]));let A,n,h,o,l,u,a,g,c,I;if(s instanceof qb){g=s.iyt_();n=s.tyt_("x")?s.tyt_("x").toArray():new Array(g);h=s.tyt_("y")?s.tyt_("y").toArray():new Array(g);o=s.tyt_("z")?s.tyt_("z").toArray():new Array(g);l=s.tyt_("size")?s.tyt_("size").toArray():new Array(g).fill(5);a=s.tyt_("visible")?s.tyt_("visible").toArray():new Array(g).fill(1);u=s.tyt_("value")?s.tyt_("value").toArray():null}else{g=this.getLength(s["x"],s["y"],s["z"]);n=this.LdA_(s["x"],g);h=this.LdA_(s["y"],g);o=this.LdA_(s["z"],g);l=this.LdA_(s["size"],g,5);a=this.LdA_(s["visible"],g,1);u=s["value"]!=null?this.LdA_(s["value"],g):null}const f=Object.keys(UYt);if(i instanceof r||typeof i=="string"&&f.indexOf(i)>-1){i instanceof r&&(i=i["name"]);const s=t=>{this.invalidateObject();this.Kis_["data"]=null},e=KYt.loadTexture(i,s);this.UdA_(t,e,n,h,o,l,a);this.Kis_["symbol"]=e;c=new I_t(this.Kis_);I=new z;A=new wt(I,c);A["name"]=t;this.YdA_(A,n,h,o,l,a,u);this.add(A);this._objects[t]=A;this.UdA_(t,e,n,h,o,l,a);this.TdA_()}else if(i instanceof z){A=new y;I=i;this.KdA_(A,I,n,h,o,l,a,u);this.add(A);this._objects[t]=A;this.UdA_(t,i,n,h,o,l,a);this.TdA_();this.invalidateObject();this.Kis_["data"]=null}A["userData"].HdA_=t}getLength(t,i,s){const e=this.qdA_(t);if(e!=null)return e;const A=this.qdA_(i);if(A!=null)return A;const n=this.qdA_(s);return n!=null?n:0}qdA_(t){if(t!=null)return t instanceof PD?t.getLength():t.length}LdA_(t,i,s){if(t instanceof PD)return t.toArray();if(Array.isArray(t))return t;const e=new Array(i);s==null&&(s=0);for(let t=0;t<i;t++)e[t]=s;return e}YdA_(t,i,s,e,A,n,h){let r=0;const o=i.length;let l,u;if(this.kqt_){l=new a(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);u=new a(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE);this.kqt_=!1}else{l=this.fNt_.hc_();u=this.fNt_.nc_()}const g=new lt(new Float32Array(o*6),6),c=new J(g,3,0),I=new J(g,1,3),f=new J(g,1,4),C=new J(g,1,5);for(let t=0;t<o;t++){c.setXYZ(t,i[t],s[t],e[t]);l.x=Math.min(l.x,i[t]);l.y=Math.min(l.y,s[t]);l.z=Math.min(l.z,e[t]);u.x=Math.max(u.x,i[t]);u.y=Math.max(u.y,s[t]);u.z=Math.max(u.z,e[t]);f.setX(t,A[t]);I.setX(t,n[t]);h!=null&&C.setX(t,h[t]);r+=A[t]}t.geometry.setAttribute("position",c);t.geometry.setAttribute("cgpointVisible",I);t.geometry.setAttribute("cgpointSize",f);t.geometry.setAttribute("cgcolormapValue",C);f_t=r/o;l.subScalar(f_t);u.addScalar(f_t);this.Kis_["gridoption"]=qi(this.Kis_["gridoption"],{start:l,end:u,modelstart:l,modelend:u});this.fNt_.setOptions(this.Kis_["gridoption"])}KdA_(t,i,s,e,A,n,h,r){let o=0,l,u,g;if(this.kqt_){l=new a(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);u=new a(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE);this.kqt_=!1}else{l=this.fNt_.hc_();u=this.fNt_.nc_()}for(let a=0;a<s.length;a++){l.x=Math.min(l.x,s[a]);l.y=Math.min(l.y,e[a]);l.z=Math.min(l.z,A[a]);u.x=Math.max(u.x,s[a]);u.y=Math.max(u.y,e[a]);u.z=Math.max(u.z,A[a]);o+=n[a];g=NYt.x5e_(new wr);const c=new W(i,g);c["userData"].JdA_=a;c["userData"].PdA_=r[a];c.position.set(s[a],e[a],A[a]);c.scale.set(n[a],n[a],n[a]);c.visible=!(h[a]!==1);const I=this.Kis_["colorprovider"].getColor(r[a]);c.material.userData.Pvt_.setColor("rgba("+I.Is_()+","+I.Cs_()+","+I.fs_()+","+this.Kis_["opacity"]+")");NYt.Y5e_(c.material,c.material.userData.Pvt_);c.name="Point";t.add(c)}f_t=o/s.length;l.subScalar(f_t);u.addScalar(f_t);this.Kis_["gridoption"]=qi(this.Kis_["gridoption"],{start:l,end:u,modelstart:l,modelend:u});this.fNt_.setOptions(this.Kis_["gridoption"])}setOptions(t){if(t==null)return this;t.hasOwnProperty("colorprovider")&&fLt.oZe_(t);super.setOptions(t);this.Kis_=Pi(t,this.Kis_);for(const i in this._objects){const s=this._objects[i];if(s instanceof y)for(let i=0;i<s.children.length;i++){const e=s.children[i],A=e["userData"].PdA_,n=t["colorprovider"].getColor(A);e.material.userData.Pvt_.setColor("rgba("+n.Is_()+","+n.Cs_()+","+n.fs_()+","+this.Kis_["opacity"]+")");NYt.Y5e_(e.material,e.material.userData.Pvt_)}s instanceof wt&&s.material.setOptions({colorprovider:t["colorprovider"]})}if(t["gridoption"]){this.Kis_["gridoption"]=qi(t["gridoption"],this.Kis_["gridoption"]);this.fNt_.setOptions(t["gridoption"])}if(t["projection"]){this.Kis_["projection"]=qi(t["projection"],this.Kis_["projection"]);this.TdA_();t["projection"]["enable"]||this.VdA_()}this.invalidateObject();return this}JV_(){return Pi(this.Kis_,super.JV_())}w3e_(t,i){if(i==null)return null;t=t||"default";if(!(this._objects[t]instanceof wt))return null;const s=undefined,e=undefined,A=this._objects[t].geometry.getAttribute("position").array,n=A[i*6+0],h=A[i*6+1],r=A[i*6+2],o=A[i*6+3],l=A[i*6+4],u=A[i*6+5],a=new lt(new Float32Array(6),6),g=new J(a,3,0),c=new J(a,1,3),I=new J(a,1,4),f=new J(a,1,5);g.setXYZ(0,n,h,r);c.setX(0,o);I.setX(0,l);f.setX(0,u);return Ss({position:g,cgpointvisible:c,cgpointsize:I,cgcolormapvalue:f},["cgpointVisible","cgpointSize","cgcolormapValue"],"ScatterPlot.getPointByIndex")}OdA_(t,i){if(t==null)return null;i=i||"default";if(this._objects[i]==null)return null;let s,e;if(this._objects[i]instanceof wt){const A=undefined,n=undefined,h=this._objects[i].geometry.getAttribute("position").array;if(t<0||t>=h.length/6)return null;const r=h[t*6],o=h[t*6+1],l=h[t*6+2],u=h[t*6+3],g=h[t*6+4];s=h[t*6+5];e=this.Kis_["colorprovider"].getColor(s);return{datasetname:i,index:t,position:new a(r,o,l),visible:u===1,size:g,value:s,color:e}}let A=null;const n=this._objects[i]["children"];if(n==null)return null;for(let i=0;i<n.length;i++)if(n[i]!=null&&n[i]["userData"]!=null&&n[i]["userData"].JdA_===t){A=n[i];break}if(A==null)return null;s=A["userData"].PdA_;e=this.Kis_["colorprovider"].getColor(s);return{datasetname:i,index:t,position:A["position"].clone(),visible:!!A["visible"],size:A["scale"].x,value:s,color:e}}WdA_(t){if(t==null)return null;Array.isArray(t)&&(t=t[0]);if(t==null||t.object==null)return null;const i=t.object;if(!(i instanceof W||i instanceof wt))return null;let s,e;if(i instanceof wt){e=t["pointindex"];if(!(Number.isSafeInteger(e)&&e>=0))return null;if(i["parent"]!==this)return null;s=i["userData"].HdA_}else{if(!(i["parent"]instanceof y))return null;if(i["parent"]["parent"]!==this)return null;s=i["parent"]["userData"].HdA_;e=i["userData"].JdA_}return this.OdA_(e,s)}UdA_(t,i,s,e,A,n,h){const r=this.Kis_["projection"];if(r==null||r["enable"]===!1)return;let o,l,u,a,g,c;const I=s.length,f=new Array(I).fill(0);if(r["topbottom"]!=null){const t=new g_t(r["topbottom"],i);o=new wt(new z,t);l=new wt(new z,t);this.zdA_(o,s,e,f,n,h);this.zdA_(l,s,e,f,n,h);this.add(o);this.add(l);o.visible=!1;l.visible=!1}if(r["leftright"]!=null){const t=new g_t(r["leftright"],i);u=new wt(new z,t);a=new wt(new z,t);this.zdA_(u,f,e,A,n,h);this.zdA_(a,f,e,A,n,h);this.add(u);this.add(a);u.visible=!1;a.visible=!1}if(r["frontback"]!=null){const t=new g_t(r["frontback"],i);g=new wt(new z,t);c=new wt(new z,t);this.zdA_(g,s,f,A,n,h);this.zdA_(c,s,f,A,n,h);this.add(g);this.add(c);g.visible=!1;c.visible=!1}o!=null&&u!=null&&g!=null&&(this.xdA_[t]={top:o,bottom:l,left:u,right:a,front:g,back:c})}zdA_(t,i,s,e,A,n){const h=this.Kis_["projection"]["sizefactor"]||.66,r=i.length,o=new lt(new Float32Array(r*5),5),l=new J(o,3,0),u=new J(o,1,3),a=new J(o,1,4);for(let t=0;t<r;t++){l.setXYZ(t,i[t],s[t],e[t]);a.setX(t,A[t]*h);u.setX(t,n[t])}t.geometry.setAttribute("position",l);t.geometry.setAttribute("cgpointVisible",u);t.geometry.setAttribute("cgpointSize",a)}TdA_(){const t=this.fNt_.hc_(),i=this.fNt_.nc_();for(const s in this.xdA_){this.xdA_[s]["top"].position.setZ(i.z);this.xdA_[s]["bottom"].position.setZ(t.z);this.xdA_[s]["left"].position.setX(t.x);this.xdA_[s]["right"].position.setX(i.x);this.xdA_[s]["front"].position.setY(t.y);this.xdA_[s]["back"].position.setY(i.y)}}beforeRender(t,i,s,e){if(Object.keys(this.xdA_).length===0||this.fNt_==null)return;let A;const n=this.fNt_.KZt_(),h=this.fNt_.CnA_();for(const s in this.xdA_){if(this.xdA_[s]["top"]!=null){A=this.xdA_[s]["top"].userData["enable"]==null||this.xdA_[s]["top"].userData["enable"];this.xdA_[s]["top"].visible=n(h["top"],t,i)&&A;this.xdA_[s]["bottom"].visible=n(h["bottom"],t,i)&&A}if(this.xdA_[s]["left"]!=null){A=this.xdA_[s]["left"].userData["enable"]==null||this.xdA_[s]["left"].userData["enable"];this.xdA_[s]["left"].visible=n(h["left"],t,i)&&A;this.xdA_[s]["right"].visible=n(h["right"],t,i)&&A}if(this.xdA_[s]["front"]!=null){A=this.xdA_[s]["front"].userData["enable"]==null||this.xdA_[s]["front"].userData["enable"];this.xdA_[s]["front"].visible=n(h["front"],t,i)&&A;this.xdA_[s]["back"].visible=n(h["back"],t,i)&&A}}}XdA_(t,i){if(Object.keys(this.xdA_).length!==0){for(const s in this.xdA_)switch(t){case"topbottom":this.xdA_[s]["top"].userData["enable"]=i;break;case"leftright":this.xdA_[s]["left"].userData["enable"]=i;break;case"frontback":this.xdA_[s]["front"].userData["enable"]=i;break}this.invalidateObject()}}jdA_(){return new C(this.fNt_.hc_(),this.fNt_.nc_())}ZdA_(){return Object.keys(this._objects)}VdA_(t){if(t!=null){Object.keys(this.xdA_[t]).forEach((i=>{fLt.dispose(this.xdA_[t][i])}));delete this.xdA_[t]}else{for(const t in this.xdA_)Object.keys(this.xdA_[t]).forEach((i=>{fLt.dispose(this.xdA_[t][i])}));this.xdA_={}}}dispose(t){if(t!=null){if(this._objects[t]==null)return;this.VdA_(t);fLt.dispose(this._objects[t]);delete this._objects[t]}else{this.VdA_();for(const t in this._objects)fLt.dispose(this._objects[t]);this._objects={}}}FdA_(t){t=Pi(t,{start:new a(-1,-1,-1),end:new a(1,1,1),counts:new a(3,3,6),grid:{linestyles:{x:new hl({color:"darkgrey",pattern:el.pD_}),y:new hl({color:"darkgrey",pattern:el.pD_}),z:new hl({color:"darkgrey",pattern:el.pD_})}},axis:{linestyles:{x:new hl({color:"black"}),y:new hl({color:"black"}),z:new hl({color:"black"})},textstyles:{x:new qa({color:"black"}),y:new qa({color:"black"}),z:new qa({color:"black"})}},title:{textstyles:{x:new qa({color:"black"}),y:new qa({color:"black"}),z:new qa({color:"black"})}}});return new APt(t)}};i=t([_s("geotoolkit3d.widgets.scatter.ScatterPlot")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiZ2V0UG9pbnREYXRhIjoiT2RBXyIsImdldFBvaW50RGF0YUJ5UGlja2luZyI6IldkQV8iLCJ1cGRhdGVQcm9qZWN0aW9uIjoiVGRBXyIsInRvZ2dsZVByb2plY3Rpb24iOiJYZEFfIiwiZ2V0R3JpZExpbWl0IjoiamRBXyIsImdldERhdGFTZXROYW1lIjoiWmRBXyJ9fX0g");var B_t=Ci(function(){var t=class{};t.prototype._dA_=Zi;return t}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJyZXNldFRpbGVzIjoiX2RBXyJ9fX0g");var w_t=Ci(function(){let i=class t extends fUt{constructor(t){super();const i=qi(t,{}),s=i["data"],e=i["material"],A=e.$dA_(),n=e.tBA_(),h=s["path"],r=s["index"].XAA_(),o=h["i"],l=h["j"],g=new bt(1,1,A,n);for(let t=0;t<g.index.count;t+=3)g.addGroup(t,3,Math.floor(t/6));g.applyMatrix4((new u).makeTranslation(.5,.5,0));g.applyMatrix4((new u).makeRotationZ(Math.PI/2));g.applyMatrix4((new u).makeRotationY(Math.PI/2));const c=new a;r.getSize(c);const I=g.getAttribute("position"),f=o[0],C=o[1],d=l[0],B=l[1],w=r.min.z,Q=w+c.z;this.iBA_=[new a(f,d,Q),new a(C,B,Q),new a(f,d,w),new a(C,B,w)];for(let t=0;t<=n;t++)for(let i=0;i<=A;i++){const s=i+t*(A+1);I.setX(s,f+(C-f)/A*i);I.setY(s,d+(B-d)/A*i);let e=I.getZ(i+t*(A+1));e=e*c.z+w;I.setZ(s,e)}this.x9e_=i["material"];this.x9e_.jC_(this);this.Z$e_=new W(g,this.x9e_.sBA_());this.add(this.Z$e_);this.setOptions(i)}setOptions(t){if(t==null)return this;super.setOptions(t);this.x9e_.setOptions(t);this.invalidateObject();return this}JV_(){return Pi(this.x9e_.JV_(),super.JV_())}x8_(){return this.x9e_==null?null:this.x9e_.x8_()}eBA_(){return this.x9e_}a9e_(){return this.Z$e_}getBoundingBox(){this.Z$e_.geometry.boundingBox==null&&this.Z$e_.geometry.computeBoundingBox();return this.Z$e_.geometry.boundingBox.clone()}G9e_(){return this.x9e_.G9e_()}beforeRender(t,i,s,e){const A=this.eBA_(),n=A.JV_();A.ABA_();n["disposesurface"]&&A.sBA_().forEach((t=>{t.userData.Rbs_&&(t.userData.nBA_=!1)}));return this}afterRender(t,i,s,e){const A=this.eBA_(),n=undefined;A.JV_()["disposesurface"]&&A.sBA_().forEach((t=>{if(t.userData.nBA_!=null){t.t4t_().image=null;delete t.userData.Rbs_;delete t.userData.nBA_}}));return this}H9e_(t){this.setOptions({overlay:t});return this}cZe_(t,i){const s=this.a9e_();i=this.o9e_(t,i);s.localToWorld(i);return i}o9e_(t,i){i==null&&(i=new a);i.copy(this.iBA_[t]);return i}dispose(){if(!this.Df_()){fLt.dispose(this.Z$e_);this.Z$e_=null;this.x9e_.dispose();this.x9e_=null;super.dispose()}}_dA_(){this.x9e_._dA_()}DH_(t,i){this.x9e_.DH_(t,null,i)}};i=t([Zs(B_t),_s("geotoolkit3d.scene.seismic.FencePanel")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiZ2V0RmVuY2VNYXRlcmlhbCI6ImVCQV8iLCJnZXRDb3JuZXIiOiJjWmVfIiwiZ2V0TG9jYWxDb3JuZXIiOiJvOWVfIiwicmVzZXRUaWxlcyI6Il9kQV8ifX19");var Q_t=Ci(function(){let i=class t extends yJt{constructor(t){t["vertexShader"]=nXt.haA_;t["fragmentShader"]=nXt.raA_;t["map"]==null&&(t["map"]=new ri);super(t);this.i_e_=!0;t["rendertarget"]!=null&&(this.hBA_=t["rendertarget"]);nXt.AaA_(this);nXt.p9e_(this,t)}setOptions(t){super.setOptions(t);nXt.p9e_(this,t);return this}JV_(){return qi(nXt.naA_(this),super.JV_())}t4t_(){return this["map"]}rBA_(t){this["map"]=t}getRenderTarget(){return this.hBA_}dispose(){nXt.dispose(this);super.dispose()}};i=t([_s("geotoolkit3d.scene.seismic.SliceTileMaterial")],i);return i}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIn19fSAg");$Lt.yZe_(Q_t.D_(),CLt);const E_t={willReadFrequently:!0},p_t=new Tc(Number.POSITIVE_INFINITY),m_t=new Oc(0,0,1,1),y_t=2048,D_t=4096,M_t=4096,v_t=512,b_t=24,N_t=10,S_t=()=>{};let G_t=!1,R_t=null;var k_t=Ci(function(){let i=class t extends $n{constructor(t){super();this.Bgt_=!1;this.oBA_=new Lp;this.C8s_=null;this.lBA_=[];this.S1t_=null;this.uBA_=[];this.V7_=Number.MAX_VALUE;this.Rb_=1;this.aBA_={};this.gBA_=[];this.cBA_=!1;this.IBA_=!1;this.fBA_=!1;this.Qi_="SliceMaterial";this.CBA_=S_t;t["pipeline"]==null&&(t["pipeline"]={});t["pipeline"]["options"]==null&&(t["pipeline"]["options"]={});let i=qi(t,{});this.dBA_(t,i);t=null;const s=i["data"]["reader"],e=s.rt_();i["data"]=qi(i["data"],{limits:new mA({x:e.we_()+.5,y:e.Ee_(),width:s.Z5s_(),height:e.Ts_()})});let A=mKt.N6e_();(!Number.isFinite(A)||A<=0)&&(A=y_t);R_t=Math.min(A,D_t);i=Pi(i,{verticalresolution:1,horizontalresolution:1,loadingcolor:"rgba(255, 255, 255, 0.5)",maxpixelsx:M_t,maxpixelsy:M_t,autodecimate:!0,numberofparalleltasks:b_t,materialoptions:{opacity:1},clearpipeline:!0,disposesurface:!1,initialtexturesize:i["maxtilesize"]||R_t,overlay:null});i["pipeline"]["options"]=Pi(i["pipeline"]["options"],{normalization:{type:Qwt.RMS,scale:1},plot:{type:{Wiggle:!1,InterpolatedDensity:!0},decimationSpacing:5},colors:{colorMap:aEt.sx_().qie_("WhiteBlack",320)}});this.BBA_=i["initialtexturesize"];this.wBA_=Math.round(Math.log2(this.BBA_));this.Ott_=Math.round(Math.log2(v_t));this.Wtt_=Math.round(Math.log2(mKt.N6e_()/2));this.setOptions(i);this.Bgt_=!0}QBA_(t,i,s,e,A,n){const h=t.EBA_;if(h.pBA_==null){h.pBA_=Ls(this.mBA_,this.yBA_,!0);h.DBA_=h.pBA_.getContext("2d");h.MBA_=new mA(0,0,this.mBA_,this.yBA_);h.vBA_=fr.Xw_({context:h.DBA_,viewport:h.MBA_,pixelscale:1});h.bBA_=new r(h.pBA_);h.bBA_.minFilter=n.minFilter;h.bBA_.wrapS=n.wrapS;h.bBA_.wrapT=n.wrapT;h.bBA_.anisotropy=n.anisotropy;h.bBA_.generateMipmaps=n.generateMipmaps;t.material.setOptions({overlaymap:h.bBA_})}h.DBA_.clearRect(0,0,h.pBA_.width,h.pBA_.height);const o=new mA(i,s,e,A),l=t.NBA_.rt_().getY(),u=t.NBA_.getReader().f4s_();o.setX(Math.floor(o.getX()));o.setY((o.getY()-l)/u);o.Be_(o.Ts_()/u);G_t=!0;t.SBA_.Lq_(o);t.SBA_.ht_(h.MBA_);G_t=!1;t.SBA_.render(h.vBA_);h.bBA_.needsUpdate=!0}GBA_(t,i){const s=this.RBA_,e=this.kBA_,A=this.mBA_,n=this.yBA_,h=i&&this.BBA_?Math.min(this.BBA_,i):this.BBA_,r=this.FBA_,o=this.WH_.Ie_(),l=this.xBA_,u=this.WH_.Ts_()/t.f4s_()+1;let a=Math.min(o*r,this.LBA_);i&&(a=Math.min(a,i));let g=Math.min(u*l,this.UBA_);i&&(g=Math.min(g,i));const c=Math.min(Math.floor(h*r),h),I=Math.min(Math.floor(h*l),h),f=Math.min(Math.floor((h-2)*r),h),C=Math.min(Math.floor((h-3)*l),h);this.mBA_=a<=c?a:this.YBA_(a,f);this.yBA_=g<=I?g:this.YBA_(g,C);this.RBA_=Math.ceil(a/this.mBA_);this.kBA_=Math.ceil(g/this.yBA_);if(this.RBA_<=0||this.kBA_<=0)throw new Error("Tile count has to be > 0");if(isNaN(this.RBA_)||isNaN(this.kBA_))throw new Error("Tile count cannot be NaN");return this.mBA_===A&&this.yBA_===n&&this.RBA_===s&&this.kBA_===e}TBA_(t){return(i,s,e)=>{if(e.qE_()===!0||t.material.t4t_()==null||t.material.t4t_().image==null){i();return}const A=t.material.t4t_(),n=t.FMt_.Ie_()/t.KBA_,h=t.FMt_.Ts_()/t.HBA_;let r=t.qBA_*n+t.FMt_.getX();const o=t.JBA_*h+t.FMt_.getY();let l=Math.min((t.qBA_+1)*n+t.FMt_.getX(),t.FMt_.Qe_());const u=Math.min((t.JBA_+1)*h+t.FMt_.getY(),t.FMt_.pe_());t.SBA_!=null&&this.QBA_(t,r,o,l,u,A);const a=new mA(0,0,t.PBA_,t.VBA_);if(t.OBA_!=null){const i=t.PBA_/A.image.width,s=t.OBA_*i,e=t.WBA_*i,h=n/t.PBA_;r=t.qBA_*n+t.FMt_.getX()+h*s;l=Math.min(r+h*(e-s),t.FMt_.Qe_());a.ce_(s,0,e,t.PBA_)}const g=new mA(r,o,l,u),c=()=>{if(e.qE_()||t.material.t4t_()==null||t.material.t4t_().image==null){i();return}const s=A.image.getContext("2d"),n=new mA(0,0,A.image.width,A.image.height);s.clearRect(0,0,A.image.width,A.image.height);const h=fr.Xw_({context:s,viewport:n,pixelscale:1}),r=t.material.userData.zBA_.getCanvas();h.drawImage(r,0,0,r.width,r.height,0,0,A.image.width,A.image.height);t.material.userData.XBA_--;if(t.material.userData.XBA_===0){t.material.opacity=this.Rb_;t.material.userData.jBA_=!0;A.needsUpdate=!0}this.oBA_.isEmpty()&&t.ZBA_&&t.NBA_.clear();t._BA_();this.zf_();i()};if(t.material.userData.$BA_&&t.material.userData.zBA_!=null){t._BA_();this.zf_();i()}else{t.material.userData.zBA_==null&&(t.material.userData.zBA_=p_t.uK_(m_t,A.image.width,A.image.height,!0,E_t));t.material.userData.zBA_.clear();t.NBA_.Nm_(g,t.material.userData.zBA_.getCanvas(),a,0,0,c);this.twA_=!1}}}setOptions(t){const i=Pi(t,{pipeline:t["pipeline"]!=null?qi({},t["pipeline"]):{},autodecimate:this.iwA_,clearpipeline:this.swA_,disposesurface:this.ewA_,horizontalresolution:this.FBA_,verticalresolution:this.xBA_,numberofparalleltasks:this.V7_,maxpixelsx:this.LBA_,maxpixelsy:this.UBA_,materialoptions:this.aBA_,readertracedecimation:this.cBA_,maxtilesize:this.BBA_,data:{limits:this.WH_,reader:this.u4s_},lod:this.fBA_});this.dBA_(t,i);i["loadingcolor"]!=null&&this.AwA_(i["loadingcolor"]);i.hasOwnProperty("overlay")&&this.nwA_(i["overlay"]);let s=!1;this.cBA_=i["readertracedecimation"];this.LBA_=i["maxpixelsx"];this.UBA_=i["maxpixelsy"];this.ewA_=i["disposesurface"];this.iwA_=i["autodecimate"];this.swA_=i["clearpipeline"];this.aBA_=i["materialoptions"];this.WH_=i["data"]["limits"];this.V7_=i["numberofparalleltasks"];this.xBA_=i["verticalresolution"];this.FBA_=i["horizontalresolution"];this.oBA_.j7_(this.V7_);this.BBA_=i["maxtilesize"];this.fBA_=this.iwA_&&i["lod"];let e=!1;if(i["data"]["reader"]!=null&&this.u4s_!==i["data"]["reader"]){this.u4s_=i["data"]["reader"];e=!0}this.hwA_(i["data"]["reader"],t)&&(s=!0);if(i["autodecimate"]!==this.iwA_&&this.C8s_!=null){this.iwA_=i["autodecimate"];let t=this.WH_.Ie_()/(this.RBA_*Math.pow(2,this.wBA_));t<1&&(t=1);this.C8s_.xse_(t)}if(i["data"]!=null&&!this.IBA_&&e){const t=this.u4s_.rt_(),e=qi(i["data"],{limits:new mA({x:t.we_()+.5,y:t.Ee_(),width:this.u4s_.Z5s_(),height:t.Ts_()})});this.WH_=e["limits"];i["pipeline"]["options"]=i["pipeline"]["options"]!=null?i["pipeline"]["options"]:this.C8s_.JV_();delete i["pipeline"]["options"]["name"];delete i["pipeline"]["options"]["reader"];delete i["pipeline"]["options"]["statistics"];this.rwA_(i["pipeline"]["options"],this.u4s_,this.WH_,this.CBA_);s=!1}else if(i["pipeline"]["options"]!=null){this.fBA_&&this.owA_!=null&&this.wBA_>this.owA_&&(this.wBA_=this.owA_);this.gee_().setOptions(i["pipeline"]["options"]);s=!1}s&&this.lwA_();return this}dBA_(t,i){if(t["tilesize"]!=null){ki("SliceMaterial: options.tilesize is deprecated since 4.0, please use options.maxtilesize instead.");t["maxtilesize"]==null&&(i["maxtilesize"]=t["tilesize"])}if(t["oninvalidate"]!=null){ki("SliceMaterial option.oninvalidate is deprecated since 4.0. Now the Slice is invalidated automatically,"+" it is no longer necessary to provide an invalidation callback.");this.CBA_=t["oninvalidate"]}}JV_(){const t=this.C8s_.JV_(),i=qi(t,{options:t});return{loadingcolor:this.uwA_,autodecimate:this.iwA_,clearpipeline:this.swA_,disposesurface:this.ewA_,horizontalresolution:this.FBA_,verticalresolution:this.xBA_,numberofparalleltasks:this.V7_,maxpixelsx:this.LBA_,maxpixelsy:this.UBA_,maxtilesize:this.BBA_,data:{limits:this.WH_,reader:this.u4s_},lod:this.fBA_,materialoptions:this.awA_(),initialtexturesize:this.BBA_,readertracedecimation:this.cBA_,pipeline:i,tilesize:this.BBA_}}jC_(t){this.xC_=t}zf_(){this.Bgt_&&(this.xC_!=null?this.xC_.invalidateObject():ki("SliceMaterial parent has not been set, change in the slice might not automatically trigger a new render"))}AwA_(t){if(this.uwA_===t)return this;this.uwA_=t;const i=nA.cs_(this.uwA_),s=new Uint8Array([i.Is_(),i.Cs_(),i.fs_(),i.ds_()]);this.gwA_=new ri(s,1,1);this.gwA_.needsUpdate=!0;return this}nwA_(t){const i=this.S1t_!==t;this.S1t_=t;this.cwA_==null&&(this.cwA_=()=>{if(!G_t){this.lwA_(null,null,!0);this.zf_()}});i&&this.S1t_!=null&&this.S1t_.on(rh.sC_,this.cwA_)}_I_(t){if(t==null||t<0||t>1)ki("SliceMaterial: opacity cannot be set to "+t+", valid range is [0, 1].");else{this.Rb_=t;this.lBA_.forEach((i=>{i.opacity=t}));this.zf_()}}Kb_(){return this.Rb_}cft_(){return this.WH_}rwA_(t,i,s,e){if(this.C8s_!=null){this.C8s_.off(IEt.sC_,this.ile_);this.C8s_.off(IEt.Oie_,this.IwA_);this.C8s_.off(IEt.Wie_,this.fwA_)}const A=i.pvt_();this.C8s_=new CEt({name:"3D_tmp",reader:i,statistics:A});t["normalization"]=qi(t["normalization"],{limits:new fA(A["min"],A["max"])});this.C8s_.setOptions(t);if(this.iwA_){let t=this.WH_.Ie_()/(this.RBA_*Math.pow(2,this.wBA_));t<1&&(t=1);this.C8s_.xse_(t)}this.lwA_(s,e);this.ile_==null&&(this.ile_=()=>{this.CwA_||this.lwA_(s,e)});this.IwA_==null&&(this.IwA_=()=>{this.CwA_=!0;this.Sn_=this.C8s_.an_()});this.fwA_==null&&(this.fwA_=()=>{this.CwA_=!1;this.fBA_&&this.owA_!=null&&this.wBA_>this.owA_&&(this.wBA_=this.owA_);if(this.Sn_!==this.C8s_.an_()){this.lwA_(s,e);this.ABA_()}});this.C8s_.on(IEt.sC_,this.ile_);this.C8s_.on(IEt.Oie_,this.IwA_);this.C8s_.on(IEt.Wie_,this.fwA_)}x8_(){return this.S1t_}gee_(){return this.C8s_}_dA_(){if(!this.twA_){this.lBA_.forEach((t=>{this.dwA_(t,this.uwA_)}));this.CBA_();this.zf_();this.twA_=!0}}BwA_(t){const i=Ls(t.PBA_,t.VBA_,!0),s=new r(i);s.generateMipmaps=!0;s.minFilter=tt;s.anisotropy=16;const A={alphaTest:.01,side:e,map:s};if(t.wwA_>1||t.QwA_>1){const i=A["map"];i.wrapS=st;i.wrapT=st;i.repeat.set(t.wwA_,t.QwA_);const s=(t.j+t.QwA_)%2?0:-1,e=t.i%2?-1:0;i.offset.set(e,s)}return new Q_t(qi(t.EwA_,A))}hwA_(t,i){const s=Math.pow(2,this.wBA_);if(!this.GBA_(t,this.fBA_?s:null)){this.pwA_();this.mwA_();const t={i:0,j:0,wwA_:this.RBA_,QwA_:this.kBA_,PBA_:this.mBA_,VBA_:this.yBA_,EwA_:this.aBA_};for(let i=0;i<this.RBA_;i++){t.i=i;for(let s=0;s<this.kBA_;s++){t.j=s;const e=i+s*this.RBA_;this.uBA_[e]={};this.lBA_[e]=this.BwA_(t)}}return!0}if(i==null)return!1;if(i.hasOwnProperty("materialoptions")){i["materialoptions"].hasOwnProperty("opacity")&&i["materialoptions"]["opacity"]!==this.Rb_&&this._I_(i["materialoptions"]["opacity"]);this.lBA_.forEach((t=>{t.setOptions(i["materialoptions"])}));this.zf_()}if(i.hasOwnProperty("overlay")&&i["overlay"]!==this.S1t_){this.S1t_!=null&&this.S1t_.off(rh.sC_,this.cwA_);this.S1t_=i["overlay"];this.S1t_!=null&&this.S1t_.on(rh.sC_,this.cwA_);this.cwA_();this.zf_()}i.hasOwnProperty("clippingplanes")&&this.lBA_.forEach((t=>{t.setOptions(i["materialoptions"])}));return!1}awA_(){return this.lBA_[0].JV_()}lwA_(t,i,s){this.gBA_.push({FMt_:t,_BA_:i,$BA_:s})}ABA_(){if(this.gBA_.length!==0){for(let t=0;t<this.gBA_.length;t++){const i=this.gBA_[t];this.DH_(i.FMt_,i._BA_,i.$BA_)}this.gBA_=[]}}ywA_(t,i,s,e){if(t&&t.JV_()["decimation"]&&i>=1){const A=N_t,n=Math.abs(Math.ceil(A-A*(i-s)/(e-s))),h=NA.clamp(n,1,A);return new Promise(((i,s)=>{t.update({decimation:{level:h}},(e=>{if(e){s(e);return}const A=t.pie_(),n=new mA(0,A.ibt_(),A.Z5s_()-1,A.ibt_()+(A.Nte_()-1)*A.f4s_()),h=new mA({x:n.we_()+.5,y:n.Ee_(),width:A.Z5s_(),height:n.Ts_()});i(h)}))}))}return Promise.resolve(null)}YBA_(t,i){if(t<i)return Math.max(1,t);let s=2;while(t/s>i)s++;return Math.ceil(t/s)}pwA_(){this.lBA_!=null&&this.lBA_.forEach((t=>{const i=t.getRenderTarget();if(i!=null){fLt.$je_(i["texture"]);i.dispose()}if(t["userData"].zBA_!=null){p_t.release(t["userData"].zBA_);t["userData"].zBA_=null}t.dispose()}));this.lBA_=[]}mwA_(){this.uBA_!=null&&this.uBA_.forEach((t=>{if(t!=null&&t.bBA_!=null){fLt.$je_(t.bBA_);t.bBA_=null}}));this.uBA_=[]}DH_(t,i,s){this.oBA_.abort();t==null&&(t=this.WH_);i==null&&(i=this.CBA_);s==null&&(s=!1);const e=Math.pow(2,this.wBA_);if(this.iwA_){let i=t.Ie_()/(this.RBA_*this.mBA_);i<1&&(i=1);this.C8s_.xse_(i)}for(let A=this.RBA_-1;A>=0;A--)for(let n=this.kBA_-1;n>=0;n--){const h=this.lBA_[A+n*this.RBA_],r=this.uBA_[A+n*this.RBA_];if(h==null||h.t4t_()==null)continue;if(!s&&h.userData.zBA_!=null){p_t.release(h.userData.zBA_);h.userData.zBA_=null}h.t4t_().image=h.t4t_().image||Ls(this.mBA_,this.yBA_,!0);let o=this.mBA_,l;this.DwA_!=null&&(o=Math.ceil(this.DwA_/this.yBA_));h.t4t_().image.width=this.mBA_;h.t4t_().image.height=this.yBA_;const u=h.userData.XBA_>0&&!h.userData.$BA_;(h.userData.jBA_==null||u)&&this.dwA_(h,this.uwA_);h.userData.$BA_=s&&!u;if(o>=this.mBA_){h.userData.XBA_=1;l={material:h,EBA_:r,NBA_:this.C8s_,SBA_:this.x8_(),FMt_:t,qBA_:A,JBA_:n,KBA_:this.RBA_,HBA_:this.kBA_,_BA_:i,ZBA_:this.swA_,PBA_:this.mBA_,VBA_:this.yBA_,MwA_:e};this.oBA_._7_(this.TBA_(l))}else{h.userData.XBA_=Math.ceil(this.mBA_/o);for(let s=0;s<this.mBA_;s+=o){l={OBA_:s,WBA_:s+o,material:h,EBA_:r,NBA_:this.C8s_,SBA_:this.x8_(),FMt_:t,qBA_:A,JBA_:n,KBA_:this.RBA_,HBA_:this.kBA_,_BA_:i,ZBA_:this.swA_,PBA_:this.mBA_,VBA_:this.yBA_,MwA_:e};this.oBA_._7_(this.TBA_(l))}}}}dwA_(t,i){const s=t.t4t_(),e=RA.cs_(i);t.opacity=e.ds_()/255;if(s.image==null)return;const A=s.image.getContext("2d");A.clearRect(0,0,s.image.width,s.image.height);A.fillStyle=new nA(e.Is_(),e.Cs_(),e.fs_(),e.ds_()).Es_();A.fillRect(0,0,s.image.width,s.image.height);s.needsUpdate=!0}$dA_(){return this.RBA_}tBA_(){return this.kBA_}dispose(){if(!this.Df_()){this.xC_=null;this.u4s_=null;this.gBA_=[];this.aBA_=null;this.fwA_=null;this.IwA_=null;this.ile_=null;if(this.oBA_!=null){this.oBA_.abort();this.oBA_=null}if(this.gwA_!=null){fLt.$je_(this.gwA_);this.gwA_=null}this.pwA_();if(this.C8s_!=null){this.C8s_.dispose();this.C8s_=null}if(this.S1t_!=null){this.S1t_.off(rh.sC_,this.cwA_);this.S1t_=null;this.cwA_=null}this.mwA_();super.dispose()}}sBA_(){return this.lBA_}vwA_(t,i,s){t=Math.max(t,0);this.owA_=t;if(!this.fBA_||this.owA_===this.wBA_)return Promise.resolve(null);i&&(this.Ott_=i);s&&(this.Wtt_=s);if(this.owA_<this.wBA_)return Promise.resolve(null);this.oBA_.abort();this.wBA_=this.owA_;const e=this.C8s_&&this.cBA_?this.C8s_.getReader():null;return this.ywA_(e,this.wBA_,this.Ott_,this.Wtt_).then((t=>{t&&(this.WH_=t);this.hwA_(this.C8s_.getReader(),null);this.lwA_();return this.sBA_()})).catch((t=>{Gi(t);return Promise.resolve(null)}))}bwA_(){this.IBA_=!0;return this}G9e_(){const t=this.WH_.clone();t.Be_(t.Ts_()/this.u4s_.f4s_());return t}};i=t([_s("geotoolkit3d.scene.seismic.SliceMaterial")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwic2V0T3BhY2l0eSI6Il9JXyIsImdldE9wYWNpdHkiOiJLYl8iLCJnZXRPdmVybGF5IjoieDhfIiwiZ2V0UGlwZWxpbmUiOiJnZWVfIiwicmVzZXRUaWxlcyI6Il9kQV8iLCJkaXNwb3NlTWF0ZXJpYWxzIjoicHdBXyIsImRpc3Bvc2VPdmVybGF5RGF0YXMiOiJtd0FfIiwic2V0TE9EIjoidndBXyJ9fX0g");$Lt.yZe_(k_t.D_(),wKt);var F_t=function(){let i=class t extends k_t{constructor(t){const i=t["data"]["reader"],s=t["fenceindex"],e=i.ryt_().NQs_(),A=i.rt_();let n=A.we_();for(let t=0;t<s;t++)n+=e[t];t["data"]["limits"]=new mA({x:n,y:A.Ee_(),width:e[s],height:A.Ts_()});super(t)}setOptions(t){this.gee_()!==null&&this.bwA_();super.setOptions(t);return this}};i=t([_s("geotoolkit3d.scene.seismic.FenceMaterial")],i);return i}();$Lt.yZe_(F_t.D_(),wKt);var x_t=Ci(function(){let i=class t extends fUt{constructor(t){super();const i=t["data"];this.NwA_=[];if(i!=null){for(let s=0;s<i["path"]["i"].length-1;s++){const e=new w_t({data:{path:{i:[i["path"]["i"][s],i["path"]["i"][s+1]],j:[i["path"]["j"][s],i["path"]["j"][s+1]]},index:i["index"]},material:new F_t(qi({fenceindex:s},t))});this.add(e);this.NwA_.push(e)}this.Ndt_=i["index"]}else ki("Fence constructor option.data is missing.")}setOptions(t){if(t==null)return this;super.setOptions(t);const i=qi(t,{});this.NwA_.forEach((t=>{t.setOptions(i)}));this.invalidateObject();return this}JV_(){return Pi(this.NwA_.length>0?this.NwA_[0].JV_():{},super.JV_())}x8_(){ki("Fence.getOverlay is deprecated since 4.0.\nBecause a Fence is made of several panels,"+" each panel have its own overlay Group, so this method does not make sense anymore.\n"+"Please use Fence.getFencePanel().forEach((panel) => panel.getOverlay()) instead");return this.NwA_.length>0?this.NwA_[0].x8_():null}SwA_(){return this.NwA_}xlA_(){return this.Ndt_}_dA_(){this.NwA_.forEach((t=>t._dA_()))}DH_(t,i){this.NwA_.forEach((s=>s.DH_(t,i)))}dispose(){if(!this.Df_()){this.NwA_.forEach((t=>{t.dispose()}));super.dispose()}}};i=t([Zs(B_t),_s("geotoolkit3d.scene.seismic.Fence")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiZ2V0T3ZlcmxheSI6Ing4XyIsImdldEZlbmNlUGFuZWwiOiJTd0FfIiwiZ2V0SW5kZXhDb29yZGluYXRlcyI6InhsQV8iLCJyZXNldFRpbGVzIjoiX2RBXyJ9fX0g");GHt.IO_().QtA_(x_t.D_(),(t=>t.SwA_()));var L_t=Ci({GwA_:"triangles",RwA_:"lines",PointCloud:"pointcloud"},2,"eyJUcmlhbmdsZXMiOiJHd0FfIiwiTGluZXMiOiJSd0FfIn0g"),U_t=Ci(function(){let i=class t extends fUt{constructor(t){super();this.name="Horizon";Object.assign(this,{type:"Horizon"});this.Ept_=t["geometrymode"];this.kwA_=t["seismicvolume"];this.E4e_=t["nullvalue"]||Number.NaN;this.ycA_(t);this.FwA_=null;this.adA_=new fUt;this.setOptions(t);this.dds_(this.kwA_.JV_()["displaymode"])}setOptions(t){if(t==null)return this;super.setOptions(t);if((t=t||{})["colorprovider"]!=null)this.FwA_=t["colorprovider"];else{const i=t["values"]?this.minValue:-this.xwA_,s=t["values"]?this.maxValue:-this.LwA_==-this.xwA_?-this.LwA_+1:-this.LwA_;this.FwA_=aEt.sx_().qie_("GreyOrange");this.FwA_._s_(i,s)}let i,s,e;const A=t["elevation"]?t["elevation"].length:0;if(A>0){this.adA_.children=[];let n=[],h=[];for(s=this.UwA_;s<=this.YwA_;++s)for(e=this.TwA_;e<=this.KwA_;++e){n.push(this.E4e_);h.push(Number.NaN)}for(s=0;s<A;++s){n[(this.KwA_-this.TwA_+1)*(t["xline"][s]-this.UwA_)+(t["inline"][s]-this.TwA_)]=-t["elevation"][s];t["values"]!=null?h[(this.KwA_-this.TwA_+1)*(t["xline"][s]-this.UwA_)+(t["inline"][s]-this.TwA_)]=t["values"][s]:h[(this.KwA_-this.TwA_+1)*(t["xline"][s]-this.UwA_)+(t["inline"][s]-this.TwA_)]=-t["elevation"][s]}if(this.Ept_===L_t.RwA_){const t=[],A=[];for(s=this.UwA_;s<=this.YwA_;++s)for(e=this.TwA_;e<=this.KwA_;++e){t.push(e);A.push(s)}const r=new fUt,o=this.KwA_-this.TwA_+1;for(s=0;s<=this.YwA_-this.UwA_;s++){const i=t[s*o],e=A[s*o];let u=s*o;while(u<n.length&&typeof n[u]=="number"&&isNaN(n[u]))u+=1;const a=n[u],g=t[s*o+o-1],c=A[s*o+o-1];let I=s*o+o-1;while(I>=0&&typeof n[I]=="number"&&isNaN(n[I]))I-=1;const f=n[I];let C,d;if(this.FwA_ instanceof l){C=this.FwA_;d=this.FwA_}else if(typeof this.FwA_=="string"){C=new l(this.FwA_);d=new l(this.FwA_)}else{C=new l(this.FwA_.getColor(h[u]).ps_());d=new l(this.FwA_.getColor(h[I]).ps_())}const B=C.toArray(),w=d.toArray();r.add(new cUt({data:{positions:[i,e,a,g,c,f],colors:[B[0],B[1],B[2],w[0],w[1],w[2]]}}))}i=r}else if(this.Ept_===L_t.PointCloud){n=[];h=[];for(s=0;s<A;++s){n.push(-t["elevation"][s]);t["values"]!=null?h.push(t["values"][s]):h.push(-t["elevation"][s])}i=new qYt({data:{x:t["inline"],y:t["xline"],z:n,sizes:1,values:h},pXe_:this.FwA_,HwA_:1,qwA_:5})}else if(this.Ept_===L_t.GwA_){const t=new HTt({data:{elevation:n,width:this.KwA_-this.TwA_+1,height:this.YwA_-this.UwA_+1,xmin:this.TwA_,ymin:this.UwA_,nullvalue:this.E4e_,values:h}});i=new COt({data:{surface:t,nullvalue:this.E4e_},colorprovider:this.FwA_});const s=i.a9e_();s!=null&&(Array.isArray(s)?s.forEach((t=>{t.transparent=!0})):s.material.transparent=!0)}if(i==null)throw new Error("The geometrymode attribute is invalid");this.adA_.add(i)}return this}JV_(){return qi({colorprovider:this.FwA_,geometrymode:this.Ept_,seismicvolume:this.kwA_,horizoncontainer:this.adA_,nullvalue:this.E4e_},super.JV_())}ycA_(t){const i=t["inline"],s=t["xline"],e=t["elevation"],A=t["values"];this.TwA_=i[0];this.KwA_=i[0];this.UwA_=s[0];this.YwA_=s[0];this.LwA_=e[0];this.xwA_=e[0];if(A!=null){this.minValue=A[0];this.maxValue=A[0]}for(let t=1;t<i.length;t++){i[t]<this.TwA_?this.TwA_=i[t]:i[t]>this.KwA_&&(this.KwA_=i[t]);s[t]<this.UwA_?this.UwA_=s[t]:s[t]>this.YwA_&&(this.YwA_=s[t]);e[t]<this.LwA_?this.LwA_=e[t]:e[t]>this.xwA_&&(this.xwA_=e[t]);A!=null&&(A[t]<this.minValue?this.minValue=A[t]:A[t]>this.maxValue&&(this.maxValue=A[t]))}}JwA_(){return this.adA_}dds_(t){const i=this.adA_.children[0],s=this.kwA_,e=s.xlA_(),A=e.jAA_().getSize(new a).divideScalar(2),n=kxt.Gje_(e.jAA_(),new C(A.clone().negate(),A));i.scale.set(1,1,1);i.rotation.set(0,0,0);i.position.set(0,0,0);i.updateMatrix();i.applyMatrix4(n);this.adA_.position.copy(e.jAA_().getCenter(new a));this.adA_.scale.set(1,1,1);this.adA_.rotation.set(0,0,0);if(t===_kt.xy)new qOt(s.xlA_(),s.PwA_()).unA_(this.adA_);else{const e=t===_kt.DWe_?1:-1;i.scale.x*=e*NA.sign(s.matrix.elements[5]);i.scale.y*=NA.sign(s.matrix.elements[0]);i.position.x*=NA.sign(i.scale.x);i.position.y*=NA.sign(i.scale.y)}this.adA_.updateMatrixWorld(!0);this.adA_.invalidateObject()}};i=t([_s("geotoolkit3d.scene.seismic.Horizon")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiZ2V0SG9yaXpvbk9iamVjdCI6Ikp3QV8iLCJzZXREaXNwbGF5TW9kZSI6ImRkc18ifX19");const Y_t={x:new hl("transparent"),y:new hl("transparent"),z:new hl("transparent"),clone:()=>({x:Y_t["x"],y:Y_t["y"],z:Y_t["z"]})};var T_t=function(){let i=class t extends APt{constructor(t){const i=t["index"].XAA_();t["grid"]==null&&(t["grid"]={});t["grid"]["linestyles"]==null&&(t["grid"]["linestyles"]={});t["grid"]["linestyles"]=qi(t["grid"]["linestyles"],Y_t["clone"]());const s=undefined;super(qi(t,{start:new a(i.min.x,i.min.y,i.max.z),end:new a(i.max.x,i.max.y,i.min.z),modelstart:new a(i.min.x,i.min.y,i.max.z),modelend:new a(i.max.x,i.max.y,i.min.z),mode:LJt.box}));this.name="INDEXGRID"}};i=t([_s("geotoolkit3d.scene.seismic.IndexGrid")],i);return i}();const K_t=new a(0,0,1),H_t=1e3,q_t=512,J_t=512,P_t=Math.round(Math.log2(J_t)),V_t=new a,O_t=new a,W_t=new g,z_t=new g,X_t=new g,j_t=new g,Z_t=new a(-.5,-.5,0),__t=new a(-.5,.5,0),$_t=new a(.5,.5,0),t$t=new a(.5,.5,0);var i$t=Ci(function(){let i=class t extends fUt{constructor(t){super();this.VwA_=!1;this.OwA_=Is();this.WwA_=t["material"];this.WwA_.jC_(this);this.Ndt_=t["index"];this.zwA_=null;this.XwA_=this.WwA_.$dA_();this.jwA_=this.WwA_.tBA_();this.Z$e_=new W(this.ZwA_(),this.WwA_.sBA_());this.ggt_=new a;this.cgt_=new a;this._wA_=new a;this.VM_=null;this.$wA_=this.tQA_.bind(this);this.iQA_=Math.round(Math.log2(q_t));this.WwA_.vwA_(this.iQA_).then((t=>{if(t){this.Z$e_.material=t;const i=this.WwA_.$dA_(),s=this.WwA_.tBA_();if(this.XwA_!==i||this.jwA_!==s){this.XwA_=i;this.jwA_=s;this.Z$e_.geometry.dispose();this.Z$e_.geometry=this.ZwA_()}}})).catch((t=>{Gi(t)}));this.Ott_=P_t;this.Wtt_=Math.round(Math.log2(mKt.N6e_()/2));this.sQA_=null;this.add(this.Z$e_);this.setOptions(t)}setOptions(t){if(t==null)return this;super.setOptions(t);this.WwA_.setOptions(t);t.hasOwnProperty("slicelocation")&&(this.zwA_=t["slicelocation"]);t.hasOwnProperty("minlod")&&(this.Ott_=t["minlod"]);t.hasOwnProperty("maxlod")&&(this.Wtt_=t["maxlod"]);const i=this.WwA_.$dA_(),s=this.WwA_.tBA_();if(this.XwA_!==i||this.jwA_!==s){this.XwA_=i;this.jwA_=s;this.Z$e_.geometry.dispose();this.Z$e_.geometry=this.ZwA_()}if(this.zwA_)this.eQA_(t);else if(t.hasOwnProperty("points")&&t["points"].length>2){this.ggt_.copy(t["points"][0]);this.cgt_.copy(t["points"][1]);this._wA_.copy(t["points"][2])}this.AQA_(this.VwA_);this.invalidateObject();this.updateMatrixWorld(!0);return this}eQA_(t){const i=this.Ndt_.XAA_();let s=i.min.x,e=i.min.y,A=i.min.z,n=i.max.x-s,h=i.max.y-e,r=i.max.z-A;if(this.zwA_["j"]!=null){t.hasOwnProperty("xstart")&&(s=t["xstart"]);t.hasOwnProperty("ystart")&&(A=t["ystart"]);t.hasOwnProperty("width")&&(n=t["width"]);t.hasOwnProperty("height")&&(r=t["height"]);this.Jp_=n;this.Pp_=r;this.nQA_=s;this.hQA_=A;this.ggt_.set(s,this.zwA_["j"]+this.Ndt_.blA_()/2,A);this.cgt_.set(s+n,this.zwA_["j"]+this.Ndt_.blA_()/2,A);this._wA_.set(s,this.zwA_["j"]+this.Ndt_.blA_()/2,A+r);this.VwA_=!1}else if(this.zwA_["i"]!=null){t.hasOwnProperty("xstart")&&(e=t["xstart"]);t.hasOwnProperty("ystart")&&(A=t["ystart"]);t.hasOwnProperty("width")&&(h=t["width"]);t.hasOwnProperty("height")&&(r=t["height"]);this.Jp_=h;this.Pp_=r;this.nQA_=e;this.hQA_=A;this.ggt_.set(this.zwA_["i"]+this.Ndt_.vlA_()/2,e,A);this.cgt_.set(this.zwA_["i"]+this.Ndt_.vlA_()/2,e+h,A);this._wA_.set(this.zwA_["i"]+this.Ndt_.vlA_()/2,e,A+r);this.VwA_=!0}else{if(this.zwA_["z"]==null)throw new Error("Slice location is not set");t.hasOwnProperty("xstart")&&(s=t["xstart"]);t.hasOwnProperty("ystart")&&(e=t["ystart"]);t.hasOwnProperty("width")&&(n=t["width"]);t.hasOwnProperty("height")&&(h=t["height"]);this.Jp_=n;this.Pp_=h;this.nQA_=s;this.hQA_=e;this.ggt_.set(s,e,this.zwA_["z"]*this.Ndt_.f4s_()+i.min.z);this.cgt_.set(s+n,e,this.zwA_["z"]*this.Ndt_.f4s_()+i.min.z);this._wA_.set(s,e+h,this.zwA_["z"]*this.Ndt_.f4s_()+i.min.z);this.VwA_=!1}}JV_(){const t=qi({slicelocation:this.zwA_,xstart:this.nQA_,ystart:this.hQA_,width:this.Jp_,height:this.Pp_,points:[this.ggt_,this.cgt_,this._wA_],minlod:this.Ott_,maxlod:this.Wtt_},this.rQA_().JV_());return Pi(t,super.JV_())}rQA_(){return this.WwA_}FlA_(){return this.zwA_}x8_(){return this.WwA_==null?null:this.WwA_.x8_()}tQA_(){if(this.Z$e_!=null&&this.Z$e_.geometry!=null){if(this.sQA_!=null){const t=Math.ceil(Math.log2(this.sQA_));this.iQA_=NA.clamp(t,this.Ott_,this.Wtt_);this.rQA_().vwA_(this.iQA_,this.Ott_,this.Wtt_).then((t=>{t&&(this.Z$e_.material=t);const i=this.WwA_.$dA_(),s=this.WwA_.tBA_();if(this.XwA_!==i||this.jwA_!==s){this.XwA_=i;this.jwA_=s;this.Z$e_.geometry.dispose();this.Z$e_.geometry=this.ZwA_();this.invalidateObject()}})).catch((t=>{Gi(t)}))}this.VM_=null}}beforeRender(t,i,s,e){const A=this.rQA_();this.VM_!=null&&clearTimeout(this.VM_);const n=new xA;s.getSize(n);const h=undefined,r=undefined,o=0,l=0,u=1,a=1;Z_t.set(o,l,0);__t.set(o,a,0);$_t.set(u,a,0);t$t.set(u,l,0);this.localToWorld(Z_t);this.localToWorld(__t);this.localToWorld($_t);this.localToWorld(t$t);fLt.eZe_(Z_t,i,n,W_t);fLt.eZe_(__t,i,n,z_t);fLt.eZe_($_t,i,n,X_t);fLt.eZe_(t$t,i,n,j_t);const g=z_t.distanceTo(X_t),c=W_t.distanceTo(j_t),I=W_t.distanceTo(X_t),f=W_t.distanceTo(z_t),C=X_t.distanceTo(j_t),d=z_t.distanceTo(j_t);this.sQA_=Math.max(g,c,f,C,I,d);this.VM_=setTimeout(this.$wA_,H_t);const B=undefined;A.JV_()["disposesurface"]&&A.sBA_().forEach((t=>{t.userData.Rbs_&&(t.userData.nBA_=!1)}));if(Is()!==this.OwA_){A.DH_();this.OwA_=Is()}A.ABA_();return this}afterRender(t,i,s,e){const A=this.rQA_(),n=undefined;A.JV_()["disposesurface"]&&A.sBA_().forEach((t=>{if(t.userData.nBA_!=null){t.t4t_().image=null;delete t.userData.Rbs_;delete t.userData.nBA_}}));return this}xlA_(){return this.Ndt_}dispose(){fLt.dispose(this.Z$e_);this.Z$e_=null;if(this.WwA_!=null){this.WwA_.dispose();this.WwA_=null}this.ggt_=null;this.cgt_=null;this._wA_=null;this.Ndt_=null;this.$wA_=null;this.zwA_=null;super.dispose()}ZwA_(){const t=new bt(1,1,this.XwA_,this.jwA_);for(let i=0;i<t.index.count;i+=3)t.addGroup(i,3,Math.floor(i/6));return t}AQA_(t){this.position.addVectors(this.cgt_,this._wA_).multiplyScalar(.5);const i=this.Ndt_.XAA_();this.position.setZ(i.max.z-this.position.z+i.min.z);this.scale.setX(this.cgt_.distanceTo(this.ggt_));this.scale.setY(this._wA_.distanceTo(this.ggt_));V_t.subVectors(this.cgt_,this.ggt_);O_t.subVectors(this._wA_,this.ggt_);V_t.cross(O_t);V_t.normalize();O_t.crossVectors(V_t,K_t);O_t.normalize();kxt.Nje_(O_t,Math.acos(V_t.dot(K_t)),this.rotation);if(t){this.rotation.y+=Math.PI;this.rotation.z+=Math.PI/2}else this.rotation.x+=Math.PI;return this}H9e_(t){this.setOptions({overlay:t})}a9e_(){return this.Z$e_}cZe_(t,i){const s=this.a9e_();i=this.o9e_(t,i);s.localToWorld(i);return i}o9e_(t,i){i==null&&(i=new a);switch(t){default:case 0:return i.set(-.5,.5,0);case 1:return i.set(.5,.5,0);case 2:return i.set(-.5,-.5,0);case 3:return i.set(.5,-.5,0)}}G9e_(){return this.WwA_.G9e_()}_dA_(){this.WwA_._dA_()}DH_(t,i){this.WwA_.DH_(t,null,i)}};i=t([Zs(B_t),_s("geotoolkit3d.scene.seismic.Slice")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiZ2V0U2xpY2VNYXRlcmlhbCI6InJRQV8iLCJnZXRTbGljZUxvY2F0aW9uIjoiRmxBXyIsImdldE92ZXJsYXkiOiJ4OF8iLCJnZXRJbmRleENvb3JkaW5hdGVzIjoieGxBXyIsImdldENvcm5lciI6ImNaZV8iLCJnZXRMb2NhbENvcm5lciI6Im85ZV8iLCJyZXNldFRpbGVzIjoiX2RBXyJ9fX0g");const s$t=new a,e$t=new C;var A$t=Ci(function(){let i=class t extends fUt{constructor(t){super();t=qi(t,{displaymode:_kt.xy});this._xy=t["xy"];this.Ndt_=t["index"];this.oQA_=new fUt;super.add(this.oQA_);this.name="SEISMICVOLUME";this.lQA_(t)}setOptions(t){if(t==null)return this;super.setOptions(t);this.lQA_(t);return this}lQA_(t){t=qi(t,{displaymode:this.d4_!=null?this.d4_:_kt.xy});const i=new a;this.Ndt_.XAA_().getSize(i);const s=i.divideScalar(2),e=kxt.Gje_(this.Ndt_.XAA_(),new C(s.clone().negate(),s));this.oQA_.scale.set(1,1,1);this.oQA_.rotation.set(0,0,0);this.oQA_.position.set(0,0,0);this.oQA_.updateMatrix();this.oQA_.applyMatrix4(e);if(t["displaymode"]===_kt.xy){this.Ndt_.jAA_().getCenter(this.position);this.scale.set(1,1,1);this.rotation.set(0,0,0);new qOt(this.Ndt_,this._xy).unA_(this)}else{this.Ndt_.jAA_().getCenter(this.position);this.scale.set(1,1,1);this.rotation.set(0,0,0);const i=t["displaymode"]===_kt.DWe_?1:-1;this.oQA_.scale.x*=i*NA.sign(this.Ndt_.fke_().x-this.Ndt_.hnA_().x);this.oQA_.scale.y*=NA.sign(this.Ndt_.fke_().y-this.Ndt_.hnA_().y);this.oQA_.position.x*=NA.sign(this.oQA_.scale.x);this.oQA_.position.y*=NA.sign(this.oQA_.scale.y)}this.updateMatrixWorld(!0);this.d4_=t["displaymode"];this.invalidateObject()}JV_(){return Pi({displaymode:this.d4_},super.JV_())}xlA_(){return this.Ndt_}PwA_(){return this._xy}_AA_(t){return this._xy._AA_(t)}add(t){this.oQA_.add(t);return this}remove(t){this.oQA_.remove(t);return this}uQA_(){return this.oQA_.children.filter((t=>t instanceof i$t))}aQA_(t){const i=this.xlA_(),s=this.PwA_(),e=i.jAA_().getSize(s$t).divideScalar(2);e$t.set(e.clone().negate(),e);const A=kxt.Gje_(i.jAA_(),e$t);t.children.forEach((t=>{t.scale.set(1,1,1);t.rotation.set(0,0,0);t.position.set(0,0,0);t.updateMatrix();t.applyMatrix4(A)}));t.position.copy(i.jAA_().getCenter(s$t));t.scale.set(1,1,1);t.rotation.set(0,0,0);new qOt(i,s).unA_(t);t.updateMatrixWorld(!0);ys(t,fUt)&&t.invalidateObject()}};i=t([_s("geotoolkit3d.scene.seismic.Volume")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoiSlZfIiwiZ2V0SW5kZXhDb29yZGluYXRlcyI6InhsQV8iLCJnZXRYWUNvb3JkaW5hdGVzIjoiUHdBXyIsImlzUG9pbnRJbnNpZGUiOiJfQUFfIiwiZ2V0U2xpY2VzIjoidVFBXyIsImFwcGx5TWF0cml4VG8iOiJhUUFfIn19fSAg");const n$t=(t,i)=>t>0?Math.ceil(t/i)*i:0,h$t=new a;var r$t=function(){let i=class t extends TOt{constructor(t){const i=qi(t,{name:"SeismicSliderTool",snap:(t,i)=>{const s=i.xlA_(),e=s.hnA_(h$t);t["i"]!=null?t["i"]=n$t(t["i"]-e.x,s.vlA_())+e.x:t["j"]!=null?t["j"]=n$t(t["j"]-e.y,s.blA_())+e.y:t["z"]!=null&&(t["z"]=n$t(t["z"],s.f4s_()))},callback:(t,i,s)=>{t.setOptions({slicelocation:s})}});super(i);const s=i["callback"];this.gQA_=i["volume"];const e=i["snap"];this.plA_(((t,i)=>{const A=t.parent;if(A instanceof i$t&&A.parent!=null&&A.parent.parent===this.gQA_){const t=this.E8_.reA_();t!=null&&t.length&&t.forEach((t=>{if(t.getType()==="OutlinePass"&&t.isEnabled()){t.ytA_();t.DtA_(A);this.E8_.invalidateObject()}}));if(i.length()<2)return!1;const n=i.x,h=i.y,r=A.FlA_(),o=A.xlA_(),l=new g(this.E8_.getSize().Ie_(),this.E8_.getSize().Ts_()),u=o.jAA_();let c=0;const I={};A.parent.updateMatrixWorld();const f=A.parent.matrixWorld,C=this.E8_.project((new a).set(u.min.x,u.min.y,-u.min.z).applyMatrix4(f)),d=this.E8_.project((new a).set(u.max.x,u.min.y,-u.min.z).applyMatrix4(f)),B=this.E8_.project((new a).set(u.min.x,u.max.y,-u.min.z).applyMatrix4(f)),w=this.E8_.project((new a).set(u.min.x,u.min.y,-u.max.z).applyMatrix4(f)),Q=new g((C.x+1)/2,(-C.y+1)/2).multiply(l),E=new a;u.getSize(E);let p,m,y;if(r["i"]!=null){const t=new g(d.x+1,-d.y+1).multiply(l).divideScalar(2);I["i"]=r["i"];m=Math.abs(t.x-Q.x);y=Math.abs(t.y-Q.y);p=m>y?1-y/m:m/y;if(Math.abs(n)>Math.abs(h)){const i=Q.x<t.x?1:-1;r["i"]+=i*n*(E.x/m)*p}else{const i=Q.y<t.y?1:-1;r["i"]+=i*h*(E.x/y)*(1-p)}e(r,A);c=r["i"]-I["i"];r["i"]=Math.min(Math.max(r["i"],u.min.x),u.max.x)}else if(r["j"]!=null){const t=new g(B.x+1,-B.y+1).multiply(l).divideScalar(2);I["j"]=r["j"];m=Math.abs(t.x-Q.x);y=Math.abs(t.y-Q.y);p=m>y?1-y/m:m/y;if(Math.abs(n)>Math.abs(h)){const i=Q.x<t.x?1:-1;r["j"]+=i*n*(E.y/m)*p}else{const i=Q.y<t.y?1:-1;r["j"]+=i*h*(E.y/y)*(1-p)}e(r,A);c=r["j"]-I["j"];r["j"]=Math.min(Math.max(r["j"],u.min.y),u.max.y)}else if(r["z"]!=null){const t=new g(w.x+1,-w.y+1).multiply(l).divideScalar(2);I["z"]=r["z"];r["z"]+=h*(E.z/o.f4s_())/Math.abs(t.y-Q.y);e(r,A);c=r["z"]-I["z"];r["z"]=Math.min(Math.max(r["z"],0),(-u.min.z+u.max.z)/o.f4s_())}if(c!==0){s(A,I,r);return!0}}return!1}))}setVolume(t){this.gQA_=t}};i=t([_s("geotoolkit3d.tool.seismic.SeismicSliderTool")],i);return i}();var o$t=Ci(function(){let i=class t{constructor(){this.M4_=[]}hHi_(t){this.M4_.push(t);this.eT_()}SHi_(t){const i=this.M4_.indexOf(t);i!==-1&&this.M4_.splice(i,1);this.eT_()}dispose(){this.M4_.length=0}cQA_(){return this.M4_}RHi_(){return Au.cN_(this.M4_)}IQA_(){return this.M4_.length}v4_(t){return this.M4_[t]}};i.prototype.eT_=Zi;i=t([_s("geotoolkit3d.schematics.layout.AbstractAnnotationLayout")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJsYXlvdXQiOiJlVF8iLCJnZXRBbm5vdGF0aW9ucyI6IlJIaV8iLCJnZXRBbm5vdGF0aW9uc0NvdW50IjoiSVFBXyIsImdldEFubm90YXRpb24iOiJ2NF8ifX0sImdldENsYXNzTmFtZSI6IkRfIn0g");var l$t=Ci(function(){let i=class t extends o$t{eT_(){this.cQA_().forEach((t=>{t.UeA_(null)}))}};i=t([_s("geotoolkit3d.schematics.layout.DefaultAnnotationLayout")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJsYXlvdXQiOiJlVF8ifX19");let u$t=null;var a$t=Ci(function(){var i;let s=i=class t{constructor(){this.fQA_={};this.CQA_={};this.dQA_=[]}Zwe_(t,i){t!=null&&i!=null&&(this.fQA_[t]=i)}$we_(t){return this.fQA_[t]}BQA_(t,i){t!=null&&i!=null&&(this.CQA_[t]=i)}wQA_(t){return this.CQA_[t]}createElement(t,i){if(this.fQA_[i["name"]]==null){if(this.dQA_.indexOf(i["name"])===-1){ki("Component ("+i["name"]+") not registered with Factory");this.dQA_.push(i["name"])}return null}const s=this.fQA_[i["name"]](t,i);i["id"]=s.id;s.userData["parameters"]=JSON.stringify(i);return s}QQA_(t,i,s){if(this.CQA_[i["name"]]==null)return this.createElement(t,i);this.CQA_[i["name"]](t,i,s);s.userData["parameters"]=JSON.stringify(i);return null}static Ai_(){u$t||(u$t=new i);return u$t}};s=i=t([_s("geotoolkit3d.schematics.factory.SimpleFactory")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXRGYWN0b3J5IjoiWndlXyIsImdldEZhY3RvcnkiOiIkd2VfIiwic2V0VXBkYXRlRmFjdG9yeSI6IkJRQV8iLCJnZXRVcGRhdGVGYWN0b3J5Ijoid1FBXyJ9fSwiZ2V0SW5zdGFuY2UiOiJBaV8iLCJnZXRDbGFzc05hbWUiOiJEXyJ9");let g$t=null;const c$t=.5,I$t=50,f$t=50,C$t="red",d$t="lightblue",B$t="lightgray",w$t="pink",Q$t="yellow",E$t="black",p$t="blue",m$t="gray",y$t=(t,i,s)=>{const e={};let A=t.Mcs_(),n=t.vcs_();const h=i["data"]["geometry"];if(h!=null){const t=FMt.BMs_(h);t!=null&&(A=t);const i=FMt.wMs_(h);i!=null&&(n=i)}e["data"]=t.vcA_(A,n,s);i["data"]["value"]!=null&&(e["data"]["values"]=t.NcA_(i["data"]["value"],A,n,s));return e},D$t=(t,i)=>{i["size"]=I$t*t["radiusscaling"];const s=t["data"]["geometry"],e=FMt.HCe_(s),A=FMt.JCe_(s);e!=null?i["size"]=e*t["radiusscaling"]:A!=null&&(i["size"]=A*t["radiusscaling"]);i["size"]=i["size"]*c$t},M$t=(t,A)=>{const n=new QZt(t);n.position.set(t["data"]["origin"].x,t["data"]["origin"].y,t["data"]["origin"].z);A["data"]["side"]==null&&(A["data"]["side"]=e);if(t["tubevisible"]){const h=n.children[0].material;A["data"]["opacity"]!=null?h.opacity=A["data"]["opacity"]:h.opacity=.5;if(h.opacity<1&&A["data"]["side"]===e){const e=new QZt(t),A=e.children[0].material;A.opacity=h.opacity;h.side=i;A.side=s;h.transparent=A.transparent=!0;e.renderOrder=-t["size"];n.renderOrder=t["size"];n.add(e)}else h.side=A["data"]["side"]}t["annotation"]&&n.ZTi_(new oJt(t["annotation"]));t["tubevisible"]===!1&&n.remove(n.children[0]);return n},v$t=(t,i)=>{const s=new pjt(t);s.position.set(t["data"]["origin"].x,t["data"]["origin"].y,t["data"]["origin"].z);i["data"]["side"]==null&&(i["data"]["side"]=e);i["data"]["opacity"]==null&&(i["data"]["opacity"]=.5);const A=s.children[0].material;A.opacity=i["data"]["opacity"];A.side=i["data"]["side"];return s},b$t=new a,N$t=new a,S$t=new a,G$t=(t,i)=>{const s=i["data"]["casingshoesize"]||f$t,e=i["data"]["casingshoesize"]||f$t,A=t["size"]/e;t["radius"]=e;t["offset"]=A;const n=[],h=t["data"]["x"],r=t["data"]["y"],o=t["data"]["z"];N$t.set(h[h.length-1],r[r.length-1],o[o.length-1]);let l=!1;for(let t=0;t<o.length;t++){b$t.set(h[t],r[t],o[t]);const i=b$t.distanceTo(N$t);if(i<s){if(!l){S$t.set(h[t-1],r[t-1],o[t-1]);S$t.subVectors(S$t,b$t).normalize().multiplyScalar(s-i).add(b$t);if(!Number.isNaN(S$t.x)&&!Number.isNaN(S$t.y)&&!Number.isNaN(S$t.z)){h.splice(t,0,S$t.x);r.splice(t,0,S$t.y);o.splice(t,0,S$t.z);n.push(0);t++}l=!0}n.push(1-i/s)}else n.push(0)}t["data"]["curvevalues1"]=n;const u=new fUt;u.add(v$t(t,i));t["offset"]=-A;u.add(v$t(t,i));return u},R$t=(t,i)=>{const s=y$t(t,i);s["data"]["line"]=!0;i["data"]["colorprovider"]!=null?i["data"]["colorprovider"]instanceof Mo?s["data"]["colorprovider"]=i["data"]["colorprovider"]:s["color"]=i["data"]["colorprovider"]:s["color"]=d$t;const e=new cUt(s);e.position.set(s["data"]["origin"].x,s["data"]["origin"].y,s["data"]["origin"].z);return e},k$t=(t,i)=>{const s=y$t(t,i);i["data"]["colorprovider"]!=null?s["colorprovider"]=i["data"]["colorprovider"]:s["colorprovider"]=C$t;D$t(i,s);const e=new fUt;i["data"]["casing"]===!1&&(s["tubevisible"]=!1);const A=M$t(s,i);e.add(A);if(i["data"]["annotation"]!=null)if(i["data"]["casingshoe"]!==!1&&s["data"]["x"].length>1){e.add(G$t(s,i));const t=A.JV_()["data"]["z"];A.ZTi_(new oJt(i["data"]["annotation"]),t[t.length-1])}else A.ZTi_(new oJt(i["data"]["annotation"]));return e},F$t=(t,i)=>{const s=y$t(t,i);i["data"]["colorprovider"]!=null?s["colorprovider"]=i["data"]["colorprovider"]:s["colorprovider"]=d$t;s["annotation"]=i["data"]["annotation"];D$t(i,s);return M$t(s,i)},x$t=(t,i)=>{const s=y$t(t,i);i["data"]["colorprovider"]!=null?s["colorprovider"]=i["data"]["colorprovider"]:s["colorprovider"]=B$t;s["annotation"]=i["data"]["annotation"];D$t(i,s);return M$t(s,i)},L$t=(t,i)=>{const s=y$t(t,i);i["data"]["colorprovider"]!=null?s["colorprovider"]=i["data"]["colorprovider"]:s["colorprovider"]=w$t;s["annotation"]=i["data"]["annotation"];D$t(i,s);return M$t(s,i)},U$t=(t,i)=>{const s=i["data"]["geometry"],e=FMt.HCe_(s),A=FMt.BMs_(s),n=FMt.wMs_(s),h=[];h.push({radius:e*3/4,depth:A});h.push({radius:e*3/4,depth:A+(n-A)/9});h.push({radius:e*5/8,depth:A+(n-A)/9+NA.Je_});h.push({radius:e*5/8,depth:A+(n-A)*2/9});h.push({radius:e,depth:A+(n-A)/3});h.push({radius:e,depth:A+(n-A)*2/3});h.push({radius:e*5/8,depth:A+(n-A)*7/9});h.push({radius:e*5/8,depth:A+(n-A)*8/9});h.push({radius:e*3/4,depth:A+(n-A)*8/9+NA.Je_});h.push({radius:e*3/4,depth:n});const r=y$t(t,i,h);i["data"]["colorprovider"]!=null?r["colorprovider"]=i["data"]["colorprovider"]:r["colorprovider"]=Q$t;r["annotation"]=i["data"]["annotation"];r["radiusmin"]=0;r["radiusmax"]=e/2;r["size"]=1;return M$t(r,i)},Y$t=(t,i)=>{const s=y$t(t,i);i["data"]["colorprovider"]!=null?s["colorprovider"]=i["data"]["colorprovider"]:s["colorprovider"]=E$t;s["annotation"]=i["data"]["annotation"];D$t(i,s);return M$t(s,i)},T$t=(t,i)=>{const s=y$t(t,i);s["colorprovider"]=i["data"]["colorprovider"]||p$t;s["annotation"]=i["data"]["annotation"];s["closed"]=!0;D$t(i,s);return M$t(s,i)},K$t=(t,i)=>{const s=y$t(t,i);s["colorprovider"]=i["data"]["colorprovider"]||m$t;s["annotation"]=i["data"]["annotation"];D$t(i,s);return M$t(s,i)};var H$t=Ci(function(){var i;let s=i=class t extends a$t{constructor(){super();this.Zwe_("path",R$t);this.Zwe_("casing",k$t);this.Zwe_("tubing",F$t);this.Zwe_("cement",x$t);this.Zwe_("nipple",L$t);this.Zwe_("packer",U$t);this.Zwe_("valve",Y$t);this.Zwe_("perforation",T$t);this.Zwe_("plug cement",K$t)}static EQA_(t,i,s){const e=t.Mcs_(),A=t.vcs_(),n=i["data"]["geometry"];if(n!=null){const t=i["data"]["geometry"],s=FMt.BMs_(n);if(s!=null){s<e&&(t["depth"]["from"]=e);s>A&&(t["depth"]["from"]=A)}const h=FMt.wMs_(n);if(h!=null){h>A&&(t["depth"]["to"]=A);h<e&&(t["depth"]["to"]=e)}}i["radiusscaling"]=s}static Ai_(){g$t||(g$t=new i);return g$t}};s=i=t([_s("geotoolkit3d.schematics.factory.Trajectory")],s);return s}(),2,"eyJnZXRJbnN0YW5jZSI6IkFpXyJ9");const q$t=new a,J$t=new a;var P$t=Ci(function(){var i;let s=i=class t extends fUt{constructor(t){super();if(Array.isArray(t)){this.pQA_=!0;this.mQA_=[];for(let s=0;s<t.length;s++){this.mQA_[s]=new i(t[s]);this.mQA_[s].position.set(0,0,0);this.add(this.mQA_[s])}t.length>0&&t[0]["data"]!=null&&this.position.set(t[0]["data"].getX(0),t[0]["data"].getY(0),t[0]["data"].getZ(0));return}this.pQA_=!1;const s=qi(t,{data:null,radiusscaling:1,factory:H$t.Ai_()});this.yQA_=s["data"];this.DQA_=s["radiusscaling"];this.MQA_=s["components"];this.xut_=s["factory"];this.yQA_!=null&&this.yQA_.getX(0)!=null&&this.yQA_.getY(0)!=null&&this.yQA_.getZ(0)!=null&&this.position.set(this.yQA_.getX(0),this.yQA_.getY(0),this.yQA_.getZ(0));this.vQA_=[];this.bQA_=[];this.NQA_=[];this.SQA_=[];this.GQA_=s["annotationlayout"]||new l$t;this.M4_=[];this.RQA_={};this.kQA_=t=>{this.EQA_(t);if(t["static"]==null||t["static"]!==!0){const i=this.getObjectById(t.id);i==null?this.FQA_(t):i.userData["parameters"]!==JSON.stringify(t)&&this.xQA_(t,i)}};this.MQA_.hcs_().forEach((t=>{this.FQA_(t)}));this.LQA_=(t,i,s)=>{this.FQA_(s)};this.UQA_=(t,i,s)=>{s!=null&&this.kQA_(s)};this.YQA_=(t,i,s)=>{this.oBe_(s)};this.MQA_.on(fm.Add,this.LQA_);this.MQA_.on(fm.mot_,this.UQA_);this.MQA_.on(fm.mt_,this.YQA_)}dispose(){if(this.pQA_)this.mQA_.forEach((t=>{t.dispose();this.remove(t)}));else{this.MQA_.off(fm.Add,this.LQA_);this.MQA_.off(fm.mot_,this.UQA_);this.MQA_.off(fm.mt_,this.YQA_)}super.dispose()}oBe_(t){const i=[];if(t.id!==null){if(this.RQA_&&this.RQA_[t.id]){if(this.bQA_.length>0){const s=this.RQA_[t.id];for(let t=0;t<this.bQA_.length;t++)i.includes(t)||s===this.bQA_[t].x&&i.push(t)}delete this.RQA_[t.id]}const s=this.getObjectById(t.id);this.TQA_(s);this.remove(s);fLt.dispose(s);t.id=null}i.forEach((t=>{this.KQA_(t)}))}FQA_(t){let i;this.EQA_(t);if(t.id==null){i=this.xut_.createElement(this.yQA_,t);if(i!=null){this.HQA_(i);this.add(i)}}else{const s=this.getObjectById(t.id);if(s.userData["parameters"]!==JSON.stringify(t)){i=this.xut_.createElement(this.yQA_,t);if(i!=null){this.HQA_(i);this.add(i)}this.TQA_(s);this.remove(s);fLt.dispose(s)}}this.qQA_(t)}xQA_(t,i){this.EQA_(t);const s=this.xut_.QQA_(this.yQA_,t,i);if(s!==null){if(s!=null){this.HQA_(s);this.add(s)}this.TQA_(i);this.remove(i);fLt.dispose(i)}this.qQA_(t)}EQA_(t){H$t.EQA_(this.yQA_,t,this.DQA_);return null}beforeRender(t,i,s,e){this.pQA_||this.MQA_.hcs_().forEach(this.kQA_);return this}RHi_(){if(this.pQA_){const t=[];this.mQA_.forEach((i=>{t.push(i.RHi_())}));return t.flat(1)}return this.M4_}JQA_(t,i,s){if(this.pQA_){const e=this.mQA_[s];e!=null&&e.JQA_(t,i);return this}this.M4_.forEach((t=>{this.remove(t)}));this.M4_.length=0;this.vQA_.length=0;this.bQA_.length=0;this.NQA_.length=0;this.SQA_.length=0;this.RQA_={};for(let s=0;s<t.length;s++){this.M4_.push(t[s]);const e=i&&i[s];this.n_e_(e!=null?e:(this.yQA_.getZ(0)+this.yQA_.getZ(this.yQA_.count()-1))*.5,s);this.add(t[s]);this.GQA_.hHi_(t[s])}return this}KQA_(t){let i=0;for(const t in this.RQA_)i=Math.max(i,this.RQA_[t]);this.bQA_[t]=this.bQA_[t]||new a(0,0,1);this.bQA_[t].setX(i).setY(i);this.NQA_[t]=this.NQA_[t]||new f;this.M4_[t].LeA_(this.bQA_[t],this.NQA_[t])}n_e_(t,i){let s=NA.findIndex(t,this.yQA_.ScA_(),null,null,((t,i)=>i-t))||1;s<0&&(s=~s);this.vQA_[i]=this.vQA_[i]||new a;this.vQA_[i].set((this.yQA_.getX(s-1)+this.yQA_.getX(s))/2+this.yQA_.qj_().x,(this.yQA_.getY(s-1)+this.yQA_.getY(s))/2+this.yQA_.qj_().y,(this.yQA_.getZ(s-1)+this.yQA_.getZ(s))/2+this.yQA_.qj_().z);this.SQA_[i]=(this.yQA_.G2_(s-1)+this.yQA_.G2_(s))/2;const e=undefined;this.MQA_.hcs_().forEach((t=>{const s=t["data"]["geometry"];s!=null&&FMt.BMs_(s)<=this.SQA_[i]&&FMt.wMs_(s)>=this.SQA_[i]&&(this.RQA_[t.id]=FMt.HCe_(s)||FMt.JCe_(s))}));this.KQA_(i);q$t.set(this.yQA_.getX(s-1),this.yQA_.getY(s-1),this.yQA_.getZ(s-1));q$t.set(this.yQA_.getX(s),this.yQA_.getY(s),this.yQA_.getZ(s));J$t.sub(q$t).normalize();q$t.set(-1,0,0);q$t.crossVectors(J$t,q$t).normalize();this.NQA_[i]=this.NQA_[i]||new f;this.NQA_[i]=kxt.Sje_(q$t,J$t,this.NQA_[i]);this.M4_[i].xeA_(this.vQA_[i]);this.M4_[i].LeA_(this.bQA_[i],this.NQA_[i]);return this}qQA_(t){const i=[];for(let s=0;s<this.M4_.length;s++){const e=t["data"]["geometry"];if(e!=null&&FMt.BMs_(e)!=null&&FMt.wMs_(e)!=null&&FMt.BMs_(e)<=this.SQA_[s]&&FMt.wMs_(e)>=this.SQA_[s]){const A=FMt.HCe_(e)||FMt.JCe_(e);if(A==null)continue;let n=!1;this.RQA_[t.id]!==A&&this.RQA_[t.id]===this.bQA_[s].x&&(n=!0);if(A>this.bQA_[s].x){this.bQA_[s].setX(A).setY(A);this.M4_[s].LeA_(this.bQA_[s],this.NQA_[s]);n=!1}this.RQA_[t.id]=A;n&&i.push(s)}else if(this.RQA_[t.id]){this.RQA_[t.id]===this.bQA_[s].x&&i.push(s);delete this.RQA_[t.id]}}i.forEach((t=>{this.KQA_(t)}))}setOptions(t){if(t==null)return this;super.setOptions(t);if(this.pQA_){this.mQA_.forEach((i=>{i.setOptions(t)}));return this}if(t.hasOwnProperty("radiusscaling")){this.DQA_=t["radiusscaling"];this.MQA_.hcs_().forEach((t=>{this.kQA_(t)}))}return this}JV_(){return Pi({radiusscaling:this.pQA_?this.mQA_[0]&&this.mQA_[0].JV_()["radiusscaling"]:this.DQA_},super.JV_())}zoe_(t){if(this.pQA_){const i=this.mQA_[t];return i!=null?i.zoe_():null}return this.yQA_}HQA_(t){t.traverse((t=>{t instanceof oJt&&this.GQA_.hHi_(t)}))}TQA_(t){t.traverse((t=>{t instanceof oJt&&this.GQA_.SHi_(t)}))}Zzi_(t){if(this.pQA_){this.mQA_.forEach((i=>{i.Zzi_(t)}));return this}const i=undefined;this.GQA_.cQA_().forEach((i=>{t.hHi_(i)}));this.GQA_.dispose();this.GQA_=t;this.invalidateObject();return this}};s=i=t([_s("geotoolkit3d.scene.schematics.SchematicsNode")],s);return s}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRBbm5vdGF0aW9ucyI6IlJIaV8iLCJzZXRBbm5vdGF0aW9ucyI6IkpRQV8iLCJnZXRPcHRpb25zIjoiSlZfIiwiZ2V0VHJhamVjdG9yeURhdGEiOiJ6b2VfIiwic2V0QW5ub3RhdGlvbkxheW91dCI6Ilp6aV8ifX19");const V$t=new C,O$t=new a,W$t=new a;var z$t=Ci(function(){let i=class t extends o$t{eT_(){const t=this.cQA_();if(t.length===0)return;t.sort(((t,i)=>{let s=t.Ye_(),e=i.Ye_();if(s==null){V$t.makeEmpty();V$t.expandByObject(t.parent);s=O$t;V$t.getCenter(s)}if(e==null){V$t.makeEmpty();V$t.expandByObject(i.parent);e=W$t;V$t.getCenter(e)}return s.z-e.z}));let i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;t.forEach((t=>{i=Math.min(i,t.Ye_().z);s=Math.max(s,t.Ye_().z)}));if(t.length!==1){t[0].UeA_(new a(0,0,i));for(let e=1;e<t.length-1;e++)t[e].UeA_(new a(0,0,i+(s-i)*e/(t.length-1)));t[t.length-1].UeA_(new a(0,0,s))}else t[0].UeA_(new a(0,0,i))}};i=t([_s("geotoolkit3d.schematics.layout.ExpandedAnnotationLayout")],i);return i}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJsYXlvdXQiOiJlVF8ifX19");export {_kt,$kt,tFt,iFt,sFt,eFt,AFt,nFt,rFt,lFt,cFt,dFt,QFt,mFt,vFt,bFt,NFt,RFt,YFt,ixt,Dxt,kxt,xxt,Lxt,Uxt,fLt,CLt,dLt,pLt,mLt,yLt,DLt,$Lt,tUt,iUt,eUt,nUt,hUt,cUt,IUt,fUt,wUt,QUt,EUt,mUt,bUt,NUt,SUt,kUt,FUt,xUt,LUt,UUt,YUt,TUt,KUt,HUt,qUt,JUt,PUt,VUt,OUt,WUt,ZUt,$Ut,tYt,mYt,bYt,NYt,GYt,RYt,xYt,LYt,UYt,YYt,TYt,KYt,HYt,qYt,JYt,PYt,VYt,XYt,rTt,oTt,lTt,aTt,CTt,RTt,xTt,UTt,YTt,TTt,KTt,HTt,JTt,VTt,OTt,XTt,jTt,ZTt,_Tt,iKt,aKt,IKt,CKt,dKt,BKt,wKt,EKt,pKt,mKt,yKt,DKt,LKt,KKt,PKt,zKt,$Kt,nHt,uHt,gHt,fHt,CHt,BHt,QHt,EHt,mHt,MHt,vHt,NHt,GHt,RHt,FHt,tqt,eqt,rqt,oqt,lqt,uqt,cqt,fqt,Eqt,pqt,mqt,yqt,Dqt,Mqt,Tqt,_qt,$qt,tJt,iJt,oJt,lJt,cJt,IJt,CJt,dJt,BJt,wJt,QJt,EJt,pJt,yJt,NJt,GJt,RJt,LJt,APt,nPt,uPt,gPt,cPt,CPt,NPt,XPt,eVt,IVt,fVt,MVt,RVt,kVt,$Vt,tOt,nOt,hOt,rOt,COt,dOt,BOt,wOt,QOt,pOt,mOt,yOt,MOt,bOt,NOt,SOt,kOt,xOt,LOt,UOt,YOt,TOt,KOt,HOt,qOt,JOt,WOt,nWt,hWt,lWt,cWt,dWt,BWt,NWt,qWt,zWt,ZWt,_Wt,$Wt,Qzt,yzt,Nzt,xzt,Lzt,Vzt,iXt,eXt,nXt,gXt,DXt,UXt,YXt,TXt,KXt,HXt,qXt,JXt,VXt,OXt,jXt,_Xt,$Xt,tjt,ejt,hjt,rjt,ojt,ljt,ujt,ajt,cjt,Cjt,djt,wjt,Ejt,pjt,mjt,yjt,Djt,Mjt,vjt,bjt,Gjt,Rjt,Ljt,Ujt,Yjt,Pjt,Wjt,jjt,_jt,$jt,tZt,iZt,sZt,hZt,rZt,oZt,lZt,aZt,gZt,cZt,IZt,fZt,QZt,EZt,DZt,MZt,vZt,bZt,NZt,SZt,kZt,FZt,xZt,UZt,YZt,VZt,WZt,zZt,jZt,ZZt,_Zt,$Zt,t_t,u_t,g_t,I_t,C_t,d_t,B_t,w_t,Q_t,k_t,F_t,x_t,L_t,U_t,T_t,i$t,A$t,r$t,o$t,l$t,a$t,H$t,P$t,z$t};